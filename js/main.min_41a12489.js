var __reflect=this&&this.__reflect||function(t,e,a){t.__class__=e,a?a.push(e):a=[e],t.__types__=t.__types__?a.concat(t.__types__):a},__extends=this&&this.__extends||function(t,e){function a(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);a.prototype=e.prototype,t.prototype=new a},__awaiter=this&&this.__awaiter||function(t,e,a,i){return new(a||(a=Promise))(function(n,o){function s(t){try{l(i.next(t))}catch(e){o(e)}}function r(t){try{l(i["throw"](t))}catch(e){o(e)}}function l(t){t.done?n(t.value):new a(function(e){e(t.value)}).then(s,r)}l((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function a(t){return function(e){return i([t,e])}}function i(a){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,o&&(s=o[2&a[0]?"return":a[0]?"throw":"next"])&&!(s=s.call(o,a[1])).done)return s;switch(o=0,s&&(a=[0,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,o=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===a[0]||2===a[0])){l=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){l.label=a[1];break}if(6===a[0]&&l.label<s[1]){l.label=s[1],s=a;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(a);break}s[2]&&l.ops.pop(),l.trys.pop();continue}a=e.call(t,l)}catch(i){a=[6,i],o=0}finally{n=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var n,o,s,r,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),"throw":a(1),"return":a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},Constants;!function(t){t.server_url_tang="192.168.1.125",t.server_url_test="47.98.237.192",t.server_url_online_test="mina-nj.njchunuo.com",t.server_url_online="nanjings.qixiyx.cn",t.server_url_current=t.server_url_online,t.BASE_PATH="resource/",t.BASE_SKIN_PATH=t.BASE_PATH+"skins/",t.UI_GAME_CSB_PATH=t.BASE_SKIN_PATH+"game/",t.DEFAULT_HEAD_IMG_URL="http://res.qixiyx.cn/admin/common/icon_132.png",t.EVENT_STAGE_VIEW_SIZE_CHANGED="EVENT_STAGE_VIEW_SIZE_CHANGED",t.GENDER={man:1,female:2},t.ROOM_TYPE={jinYuanZi:0,changKaiTou:1},t.ROOM_PAY_MODE={creator:1,AA:0,other:2},t.ROOM_TIME_MODE={ba:0,quan:1},t.GAME_ID_SET={nanjing:1,jiangdu:2,lianshui:5,xinghua:6},t.MINI_GAME_ID_SET={mahjong:t.GAME_ID_SET.nanjing,fightThree:101,zhuandan:102,biji:103},t.Item_Type={NULL:0,DIAMOND:1,GOLD:2,RMB:3},t.GOAL_TYPE={NULL:0,EVERY_DAY:1,GROW_UP:2},t.SCENE_INDEX={LOGIN:1,MAIN:2,GAME:3,HOT_UPDATE:4,ZDGAME:5,HOT_UPDATE_MINI_GAME:6,FIGHT_THREE:7,CLUB:8,BIJI:9,WORLDCUP:10,Shop:11},t.UI_PANEL_DATA_SET={about:{index:"1",filePath:"aboutBox.csb"},create_room:{index:"2",filePath:"createRoomBox.csb"},join_room:{index:"3",filePath:"joinRoom.csb"},common_confirm_box:{index:"4",filePath:"confirmBox.csb"},email:{index:"5",filePath:"emailBox.csb"},personInfo:{index:"6",filePath:"personInfo.csb"},applyQuit:{index:"7",filePath:"applyQuitRoom.csb"},setting:{index:"8",filePath:"SetBox.csb"},wechatShare:{index:"9",filePath:"weiChatShareBox.csb"},rulesBox:{index:"10",filePath:"RulesBox.csb"},roomInfoBox:{index:"11",filePath:"RoomInfoBox.csb"},chatBox:{index:"12",filePath:"chat/chatUI.csb"},sendVoice:{index:"13",filePath:"voice/sendVoice.csb"},GameSettle_auto1:{index:"14",filePath:"gameScene/GameSettle_auto1.csb"},GameSettle_auto2:{index:"15",filePath:"gameScene/GameSettle_auto2.csb"},GameSettle_auto3:{index:"16",filePath:"gameScene/GameSettle_auto3.csb"},guide:{index:"17",filePath:"GuideView.csb"},proxyBox:{index:"18",filePath:"proxyBox.csb"},shop:{index:"19",filePath:"shop.csb"},updateGame:{index:"20",filePath:"updateGameBox.csb"},advert:{index:"21",filePath:"advertBox.csb"},daikaiRecords:{index:"22",filePath:"daikaiRecords.csb"},daikaiMsgBox:{index:"23",filePath:"daikaiNotify.csb"},zhanjiBox:{index:"24",filePath:"gameRecords.csb"},storePopBox:{index:"25",filePath:"storePopBox.csb"},personInfoOther:{index:"26",filePath:"personalInfoOther.csb"},preventCheat:{index:"27",filePath:"preventCheat.csb"},checkCheat:{index:"28",filePath:"checkCheatBox.csb"},gameActivity:{index:"29",filePath:"gameActivity.csb"},shareActivity:{index:"30",filePath:"ShareActivity.csb"},shareActivityIntro:{index:"31",filePath:"shareActivityIntro.csb"},changePlayerNumBox:{index:"32",filePath:"changePlayerNum.csb"},preventCheatStatusBox:{index:"33",filePath:"PreventCheatStatusBox.csb"},taskBox:{index:"34",filePath:"taskBox.csb"},todayRecords:{index:"35",filePath:"todayRecords.csb"},GameScoreBoard:{index:"36",filePath:"gameScene/gameScoreBoard.csb"},InviteBoxRedPacket:{index:"37",filePath:"InviteBoxRedPacket.csb"},TaskBoxRedPacket:{index:"38",filePath:"TaskBoxRedPacket.csb"},RedPacketBox:{index:"39",filePath:"RedPacketBox.csb"},turntableBox:{index:"40",filePath:"turntableBox.csb"},TurntableRecordBox:{index:"41",filePath:"TurntableRecord.csb"},TurntableNormalResultBox:{index:"42",filePath:"TurnTableNormalResult.csb"},TurntablePacket:{index:"43",filePath:"TurntablePacket.csb"},confirmShareRedPacketBox:{index:"44",filePath:"confirmShareRedPacketBox.csb"},downloadMiniGameView:{index:"45",filePath:"DownloadMiniGameView.csb"},LoginDeclare:{index:"46",filePath:"LoginDeclare.csb"},LoginDeclareSpe:{index:"47",filePath:"LoginDeclareSpe.csb"},createRoomDeclare:{index:"48",filePath:"CreateRoomDeclareView.csb"},clubCreateView:{index:"49",filePath:"club/clubCreateView.csb"},clubJoinView:{index:"50",filePath:"club/clubJoinView.csb"},clubCommonPopView:{index:"51",filePath:"club/clubCommonPopView.csb"},clubNoticePop:{index:"52",filePath:"club/clubNoticePop.csb"},clubRecordDetails:{index:"53",filePath:"club/clubRecordDetails.csb"},clubMemberHistories:{index:"54",filePath:"club/clubMemberHistories.csb"},clubCommonPopView2:{index:"55",filePath:"club/clubCommonPopView2.csb"},shopBindProxyBox:{index:"56",filePath:"ShopBindProxyBox.csb"},clubMgrDissRoomView:{index:"57",filePath:"club/clubMgrDissRoomView.csb"},clubCheckOthersReplayView:{index:"58",filePath:"club/clubCheckOthersReplayView.csb"},goBackGameView:{index:"59",filePath:"GoBackGameConfirm.csb"},gameSetting:{index:"60",filePath:"GameSettingBox.csb"},discardWinConfirmBox:{index:"61",filePath:"AbandomWinConfirm.csb"},gameOverBox:{index:"62",filePath:"AbandomWinConfirm.csb"},shareOverBox:{index:"63"},bindPhoneBox:{index:"64"},BindIdentityBox:{index:"65"}}}(Constants||(Constants={}));var GameConfig;!function(t){t.isDebug=!1,t.ScreenW=1280,t.ScreenH=720,t.windowWidth=0,t.windowHeight=0,t.pixelRatio=0,t.windowWidth_h5=0,t.windowHeight_h5=0,t.gameID=Constants.GAME_ID_SET.nanjing,t.localVersion=!1,t.keepScreenOn=!1,t.version="1.0.0",t.PLATFORM_SET={H5:"h5",weChat:"weChat"},t.platform=t.PLATFORM_SET.H5}(GameConfig||(GameConfig={}));var GameConst;!function(t){t.operateTime=10,t.CLICK_CARD_TYPE={click:1,doubleClick:2},t.maxPlayerNum=4,t.perPlayerTotalCardNum=14,t.PLAY_DIR={down:0,right:1,up:2,left:3},t.PLAYER_STATUS={OFFLINE:0,LEAVE:2,SIT:4,PLAYING:5,STAND:6,NULL:7},t.ME_DIR=t.PLAY_DIR.down,t.CARD_SIZE={HAND_CARD:[{width:86,height:118,width_playBack:86,height_playBack:118},{width:36,height:68,width_playBack:60,height_playBack:53},{width:45,height:59,width_playBack:47,height_playBack:62},{width:36,height:68,width_playBack:60,height_playBack:53}]},t.CARD_DATA={HAND_CARD:[{path:"card/DownHandCardSkin.exml",offx:85,offy:0,playBackOffx:85,playBackOffy:0,gapLastX:22,gapLastY:0,gapPlayBackLastX:22,gapPlayBackLastY:0},{path:"card/RightHandCardSkin.exml",offx:0,offy:-30,playBackOffx:0,playBackOffy:-32,gapLastX:0,gapLastY:-20,gapPlayBackLastX:0,gapPlayBackLastY:-20},{path:"card/TopHandCardSkin.exml",offx:-42,offy:0,playBackOffx:-42,playBackOffy:0,gapLastX:-20,gapLastY:0,gapPlayBackLastX:-20,gapPlayBackLastY:0},{path:"card/LeftHandCardSkin.exml",offx:0,offy:30,playBackOffx:0,playBackOffy:32,gapLastX:0,gapLastY:20,gapPlayBackLastX:0,gapPlayBackLastY:20}],HUA_CARD:[{path:"card/DownHuaCardSkin.exml",offx:42,offy:0},{path:"card/RightHuaCardSkin.exml",offx:0,offy:-36},{path:"card/TopHuaCardSkin.exml",offx:-42,offy:0},{path:"card/LeftHuaCardSkin.exml",offx:0,offy:36}],OUT_CARD:[{path:"card/DownOutCardSkin.exml",offx:42,offy:0,secondLineXOff:0,secondLineYOff:-48,multiLineXOff:0,multiLineYOff:-10,perlineNum:10,maxLine:2},{path:"card/RightOutCardSkin.exml",offx:0,offy:-36,secondLineXOff:-52,secondLineYOff:0,multiLineXOff:0,multiLineYOff:-15,perlineNum:10,maxLine:2},{path:"card/TopOutCardSkin.exml",offx:-42,offy:0,secondLineXOff:0,secondLineYOff:48,multiLineXOff:0,multiLineYOff:10,perlineNum:10,maxLine:2},{path:"card/LeftOutCardSkin.exml",offx:0,offy:36,secondLineXOff:52,secondLineYOff:0,multiLineXOff:0,multiLineYOff:-15,perlineNum:10,maxLine:2}],EFFECT_OUT_CARD:[{x:GameConfig.ScreenW/2,y:230},{x:1020,y:380},{x:GameConfig.ScreenW/2,y:560},{x:260,y:380}],PONG_KONG_CARD:[{path:"card/DownPongKongNodeSkin.exml",offx:240,offy:0,dirOffx:0,dirOffy:0},{path:"card/RightPongKongNodeSkin.exml",offx:0,offy:-114,dirOffx:0,dirOffy:3},{path:"card/TopPongKongNodeSkin.exml",offx:-134,offy:0,dirOffx:-5,dirOffy:0},{path:"card/LeftPongKongNodeSkin.exml",offx:0,offy:114,dirOffx:0,dirOffy:-3}]},t.CARD_3D_DATA={HAND_CARD:[{path:"3dCard/DownHandCard_3dSkin.exml",offx:87,offy:0,offScaleOffy:0,offScaleOffx:0,offScale:0,playBackPath:"3dCard/DownHandCard_3dSkin.exml",playBackOffx:87,playBackOffy:0,gapLastX:22,gapLastY:0,offPlayBackScaleOffy:0,offPlayBackScaleOffx:0,gapPlayBackLastX:22,gapPlayBackLastY:0,offPlayBackScale:1},{path:"3dCard/RightHandCard_3dSkin.exml",offx:-9.6,offy:-32,offScaleOffy:.5,offScaleOffx:.1,offScale:-.0177,playBackPath:"3dCard/RightPongKongCardNode_3dSkin.exml",playBackOffx:-9.6,playBackOffy:-34,gapLastX:-3,gapLastY:-10,offPlayBackScaleOffy:.5,offPlayBackScaleOffx:.12,gapPlayBackLastX:-5,gapPlayBackLastY:-20,offPlayBackScale:-.0177},{path:"3dCard/TopHandCard_3dSkin.exml",offx:-42,offy:0,offScaleOffy:0,offScaleOffx:0,offScale:0,playBackPath:"3dCard/TopHuaCard_3dSkin.exml",playBackOffx:-42,playBackOffy:0,gapLastX:-20,gapLastY:0,offPlayBackScaleOffy:0,offPlayBackScaleOffx:0,gapPlayBackLastX:-20,gapPlayBackLastY:0,offPlayBackScale:-.23},{path:"3dCard/LeftHandCard_3dSkin.exml",offx:-7.6,offy:32,offScaleOffy:.5,offScaleOffx:-.1,offScale:-.0177,playBackPath:"3dCard/LeftPongKongCardNode_3dSkin.exml",playBackOffx:-7.7,playBackOffy:34,gapLastX:-5,gapLastY:20,offPlayBackScaleOffy:.5,offPlayBackScaleOffx:-.25,gapPlayBackLastX:-6,gapPlayBackLastY:20,offPlayBackScale:-.0177}],HUA_CARD:[{path:"3dCard/DownHuaCard_3dSkin.exml",offx:54,offy:0,offScaleOffy:0,offScaleOffx:0,offScale:0},{path:"3dCard/RightHuaCard_3dSkin.exml",offx:-8.5,offy:-33,offScaleOffy:.7,offScaleOffx:.15,offScale:-.02},{path:"3dCard/TopHuaCard_3dSkin.exml",offx:-37.8,offy:0,offScaleOffy:0,offScaleOffx:0,offScale:.7},{path:"3dCard/LeftHuaCard_3dSkin.exml",offx:-7.2,offy:27,offScaleOffy:.8,offScaleOffx:-.15,offScale:-.02}],OUT_CARD:[{path:"3dCard/DownHuaCard_3dSkin.exml",offx:52,offy:0,multiLineXOff:0,multiLineYOff:-26,secondLineXOff:4,secondLineYOff:-43,secondLineXOff_2_PLAYER:12,secondLineYOff_2_PLAYER:-43,offScaleOffy:0,offScaleOffx:0,offScale:[.98,.964],offScale_2_PLAYER:[.98,.956],perlineNum:10,maxLine:2},{path:"3dCard/RightHuaCard_3dSkin.exml",offx:-6.8,offy:-33,multiLineXOff:2,multiLineYOff:-20,secondLinePerCardXOff:-5.5,secondLineXOff:-63,secondLineYOff:0,secondLineXOff_2_PLAYER:0,secondLineYOff_2_PLAYER:0,offScaleOffy:.8,offScaleOffx:.2,secondOffScaleOffx:.18,offScale:[-.02],offScale_2_PLAYER:[],perlineNum:10,maxLine:2},{path:"3dCard/TopHuaCard_3dSkin.exml",offx:-52,offy:0,multiLineXOff:0,multiLineYOff:-20,secondLineXOff:4,secondLineYOff:36,secondLineXOff_2_PLAYER:10,secondLineYOff_2_PLAYER:36,offScaleOffy:0,offScaleOffx:0,offScale:[.8,.815],offScale_2_PLAYER:[.8,.82],perlineNum:10,maxLine:2},{path:"3dCard/LeftHuaCard_3dSkin.exml",offx:-5.8,offy:27,multiLineXOff:-5,multiLineYOff:-20,secondLinePerCardXOff:-5,secondLineXOff:52,secondLineYOff:0,secondLineXOff_2_PLAYER:0,secondLineYOff_2_PLAYER:0,offScaleOffy:.8,offScaleOffx:-.2,secondOffScaleOffx:-.12,offScale:[-.02],offScale_2_PLAYER:[],perlineNum:10,maxLine:2}],EFFECT_OUT_CARD:[{x:GameConfig.ScreenW/2,y:230},{x:1020,y:380},{x:GameConfig.ScreenW/2,y:560},{x:260,y:380}],PONG_KONG_CARD:[{path:"3dCard/DownPongKongCard_{0}_3dSkin.exml",offx:260,offy:0,offScaleOffy:0,offScaleOffx:0,dirOffx:10,dirOffy:0,offScale:0},{path:"3dCard/RightPongKongCard_3dSkin.exml",offx:-30,offy:-112,offScaleOffy:6,offScaleOffx:-1,dirOffx:0,dirOffy:1,offScale:-.04},{path:"3dCard/TopPongKongCard_{0}_3dSkin.exml",offx:-134,offy:0,offScaleOffy:0,offScaleOffx:0,dirOffx:-5,dirOffy:0,offScale:.504},{path:"3dCard/LeftPongKongCard_3dSkin.exml",offx:-28,offy:88,offScaleOffy:4,offScaleOffx:-1,dirOffx:0,dirOffy:1,offScale:-.04}]},t.GAME_ALL_CARD_NODE_POSITION={HAND_CARD:[{x:86,y:655,playBackx:86,playBacky:655},{x:1120,y:480,playBackx:1110,playBacky:545},{x:876,y:30,playBackx:876,playBacky:35},{x:160,y:140,playBackx:170,playBacky:70}],HUA_CARD:[{x:454,y:540},{x:1037,y:482},{x:834,y:100},{x:243,y:160}],OUT_CARD:[{x:454,y:475},{x:943,y:482},{x:834,y:166},{x:337,y:160}],OUT_CARD_2PLAYERS:[{x:238,y:475},{x:943,y:482},{x:1038,y:166},{x:337,y:160}],PONG_KONG_NODE:[{x:170,y:665},{x:1110,y:540},{x:875,y:35},{x:170,y:80}]},t.GAME_ALL_CARD_NODE_POSITION_3D={HAND_CARD:[{x:66,y:655,playBackx:66,playBacky:655},{x:1190,y:480,playBackx:1210,playBacky:505},{x:876,y:60,playBackx:876,playBacky:55},{x:190,y:100,playBackx:185,playBacky:70}],HUA_CARD:[{x:400,y:555},{x:1110,y:462},{x:830,y:130},{x:245,y:190}],OUT_CARD:[{x:404,y:477},{x:1033,y:462},{x:834,y:182},{x:308,y:190}],OUT_CARD_2PLAYERS:[{x:155,y:477},{x:1033,y:462},{x:1036,y:174},{x:308,y:190}],PONG_KONG_NODE:[{x:150,y:655},{x:1212,y:507},{x:940,y:80},{x:190,y:80}]},t.HAND_CARD_ACTION_TYPE={MOVE_HORIZONTAL:1,INSERT_DRAW_CARD:2,DRAW_CARD_ME:3,DRAW_CARD_OTHER:4},t.GAME_STATUS_TYPE={ready:1,playing:2,over:3,allOver:4,before_playing:5,waiting:6},t.GAIN_TYPE={CHOW:1,PONG:2,PongKong:3,Exposed:4,ConcealedKong:5},t.OPERATE_TYPE={pong:1,kong:2,win:3,ready:4,pass:5,chow:6},t.FaFenType={KONG:1,CONCEALED_KONG:2,FLOWER_KONG:3,DNXB:4,DISCARD_4:5,DISCARD_SAME:6},t.DIRECT_DESC=(e={},e[1]="东",e[2]="南",e[3]="西",e[4]="北",e),t.ACTION_DATA={OPERATE:{KONG:{index:1,data:{name:"gang",dragonbonesData:"gang_ske_json",textureData:"gang_tex_json",texture:"gang_tex_png"}},WIN:{index:2,data:{name:"hupai",dragonbonesData:"hupai_ske_json",textureData:"hupai_tex_json",texture:"hupai_tex_png"}},PONG:{index:3,data:{name:"peng",dragonbonesData:"peng_ske_json",textureData:"peng_tex_json",texture:"peng_tex_png"}},HUA_KONG:{index:4,data:{name:"huagang",dragonbonesData:"huagang_ske_json",textureData:"huagang_tex_json",texture:"huagang_tex_png"}},BUHUA:{index:5,data:{name:"buhua",dragonbonesData:"buhua_ske_json",textureData:"buhua_tex_json",texture:"buhua_tex_png"}},SIFENG:{index:6,data:{name:"sifeng",dragonbonesData:"sifeng_ske_json",textureData:"sifeng_tex_json",texture:"sifeng_tex_png"}},PASS:{index:7,data:{name:"pass",dragonbonesData:"pass_ske_json",textureData:"pass_tex_json",texture:"pass_tex_png"}}},FIREWORKS:{index:7,data:{name:"yanhua",dragonbonesData:"yanhua_ske_json",textureData:"yanhua_tex_json",texture:"yanhua_tex_png"}},ARROW:{index:8,data:{name:"mark",dragonbonesData:"mark_ske_json",textureData:"mark_tex_json",texture:"mark_tex_png"}},SHAIZI:{index:9,data:{dragonbonesData:"",textureData:"",texture:""}},CARDEFFECT:{index:10,data:{dragonbonesData:"",textureData:"",texture:""}},FENGXIANG:{index:11,data:{name:"fengxiang",dragonbonesData:"fengxiang_ske_json",textureData:"fengxiang_tex_json",texture:"fengxiang_tex_png"}},FENGXIANG_3D:{index:12,data:{name:"3d_feng",dragonbonesData:"3d_feng_ske_json",textureData:"3d_feng_tex_json",texture:"3d_feng_tex_png"}}},t.ACTION_POSITION={OPERATE:[{x:641,y:570},{x:955,y:292},{x:627,y:127},{x:302,y:303}],FA_FEN:[{x:145,y:492},{x:1134,y:292},{x:906,y:155},{x:145,y:292}],CHAT_MSG:{EMOTION:[{x:245,y:492},{x:1034,y:292},{x:806,y:155},{x:245,y:292}],TEXT:[{x:345,y:492},{x:934,y:292},{x:706,y:155},{x:345,y:292}]},VOICE:[{x:145,y:472},{x:1134,y:272},{x:856,y:35},{x:145,y:272}]},t.ACTION_DIR_ARROW_DATA=[{actindex:0,offx:78,offy:101},{actindex:1,offx:126,offy:63},{actindex:2,offx:78,offy:25},{actindex:3,offx:30,offy:63}],t.ACTION_DIR_ARROW_DATA_3D=[{actindex:0,offx:80,offy:102},{actindex:1,offx:148,offy:60},{actindex:2,offx:80,offy:17},{actindex:3,offx:10,offy:59}],t.ACTION_WIN_ACTINDEX={hu:"hu",zimo:"zimo",dihu:"dihu",tianhu:"tianhu",gangkai:"gangkai"},t.POINT_EMOTION_NAME=["meigui","feiwen","ganbei","dushen","jidan","zhuantou","caidao","zhadan"],t.CHAT_EMOTION_NAME=["daxiao","hongyun","ku","koubi","shaoxiang","tuosai","tuxue","wenhao","zaijian","zan","zhuakuang","shanzi"],t.CARD_MODE={mode_2d:1,mode_3d:2},t.PLAYER_HEAD_POSITION_DATA=(a={},a[t.CARD_MODE.mode_2d]=[{x:48,y:492},{x:1232,y:282},{x:976,y:82},{x:48,y:282}],a[t.CARD_MODE.mode_3d]=[{x:48,y:512},{x:1232,y:262},{x:976,y:82},{x:48,y:262}],a),t.PLAYER_HEAD_POSITION=t.PLAYER_HEAD_POSITION_DATA[t.CARD_MODE.mode_2d],t.CHAT_MSG_TYPE={EMOTION:1,TEXT:2,VOICE:3},t.DissolveRoomType={MASTER:1,DAIKAI:2,TIMEOUT:3},t.POINT_EMOTION_PRICE=[88,88,58,58,188,188,188,188],t.APPLY_QUIT_STATUS={unchosen:0,apply:1,agree:2,reject:3},t.CHANGE_PALYER_NUM_STATUS={unchosen:0,apply:1,agree:2,reject:3},t.specialHuType={NONE:0,GODHU:1,SUPRICHSEVDUI:2,RICHSEVDUI:3,PAIRSSEVDUI:4,SECONDHU:5,SEAFISHMONTH:6,BIGSTICKBLOOM:7,STICKBLOOM:8,SEVENDUI:9,ALLINONE:10,PRESSJUE:11,ONLYFISHING:12,HUNYICE:13,PAIRSHU:14,FIGHU:15},t.SOUND_TYPE_ENUM={nanjing:0,standard:1},t.card_back_index=0,t.card_face_index=0,t.game_bg_index=0,t.card_mode_index=t.CARD_MODE.mode_2d,t.sound_type=t.SOUND_TYPE_ENUM.nanjing,t.forbid_emotion=!1,t.forbid_voice=!1,t.REPLAY_TYPE={DISCARD:1,DRAW:2,PONG:3,KONG:4,FAFEN:5,JIAPAI:6,CANCELJIPAI:7,TING:8,PASS:10,PLAY_STATUS:11,AUTO_HOST:12,OPERATE:14,OPERATE_CLICK:15},t.top_pongKong_face_rotation=[180,180,180,180,90,-90],t.pongKong_back_img_data=(i={},i[t.PLAY_DIR.down]=(n={},n[0]=(o={},o[0]=(s={},s[0]="3d_me_pair_2{0}_png",s[1]="3d_me_pair_reverseside_2{0}_png",s),o[1]=(r={},r[0]="3d_me_pair_1{0}_png",r[1]="3d_me_pair_reverseside_1{0}_png",r),o[2]=(l={},l[0]="3d_me_pair_3{0}_png",l[1]="3d_me_pair_reverseside_3{0}_png",l),o[3]=(c={},c[0]="3d_me_pair_2{0}_png",c[1]="3d_me_pair_reverseside_2{0}_png",c),o[4]=(h={},h[0]="3d_me_pair_1_dao{0}_png",h),o[5]=(u={},u[0]="3d_me_pair_3_dao{0}_png",u),o),n[1]=(d={},d[0]=(m={},m[0]="3d_me_pair_5{0}_png",m[1]="3d_me_pair_reverseside_5{0}_png",m),d[1]=(p={},p[0]="3d_me_pair_4{0}_png",p[1]="3d_me_pair_reverseside_4{0}_png",p),d[2]=(g={},g[0]="3d_me_pair_6{0}_png",g[1]="3d_me_pair_reverseside_6{0}_png",g),d[3]=(C={},C[0]="3d_me_pair_5{0}_png",C[1]="3d_me_pair_reverseside_5{0}_png",C),d[4]=(_={},_[0]="3d_me_pair_4_dao{0}_png",_),d[5]=(f={},f[0]="3d_me_pair_6_dao{0}_png",f),d),n[2]=(D={},D[0]=(I={},I[0]="3d_me_pair_7{0}_png",I[1]="3d_me_pair_reverseside_7{0}_png",I),D[1]=(b={},b[0]="3d_me_pair_7{0}_png",b[1]="3d_me_pair_reverseside_7{0}_png",b),D[2]=(y={},y[0]="3d_me_pair_6{0}_png",y[1]="3d_me_pair_reverseside_6{0}_png",y),D[3]=(E={},E[0]="3d_me_pair_7{0}_png",E[1]="3d_me_pair_reverseside_7{0}_png",E),D[4]=(v={},v[0]="3d_me_pair_7_dao{0}_png",v),D[5]=(T={},T[0]="3d_me_pair_6_dao{0}_png",T),D),n[3]=(S={},S[0]=(A={},A[0]="3d_me_pair_5{0}_png",A[1]="3d_me_pair_reverseside_5{0}_png",A),S[1]=(M={},M[0]="3d_me_pair_6{0}_png",M[1]="3d_me_pair_reverseside_6{0}_png",M),S[2]=(R={},R[0]="3d_me_pair_4{0}_png",R[1]="3d_me_pair_reverseside_3{0}_png",R),S[3]=(G={},G[0]="3d_me_pair_5{0}_png",G[1]="3d_me_pair_reverseside_5{0}_png",G),S[4]=(N={},N[0]="3d_me_pair_6_dao{0}_png",N),S[5]=(L={},L[0]="3d_me_pair_4_dao{0}_png",L),S),n),i[t.PLAY_DIR.up]=(U={},U[0]=(O={},O[0]=(x={},x[0]="3d_me_pair_5{0}_png",x[1]="3d_me_pair_reverseside_5{0}_png",x),O[1]=(P={},P[0]="3d_me_pair_4{0}_png",P[1]="3d_me_pair_reverseside_3{0}_png",P),O[2]=(w={},w[0]="3d_me_pair_6{0}_png",w[1]="3d_me_pair_reverseside_6{0}_png",w),O[3]=(k={},k[0]="3d_me_pair_5{0}_png",k[1]="3d_me_pair_reverseside_5{0}_png",k),O[4]=(B={},B[0]="3d_me_pair_4_dao{0}_png",B),O[5]=(F={},F[0]="3d_me_pair_6_dao{0}_png",F),O),U[1]=(H={},H[0]=(Y={},Y[0]="3d_me_pair_7{0}_png",Y[1]="3d_me_pair_reverseside_7{0}_png",Y),H[1]=(V={},V[0]="3d_me_pair_6{0}_png",V[1]="3d_me_pair_reverseside_6{0}_png",V),H[2]=(K={},K[0]="3d_me_pair_7{0}_png",K[1]="3d_me_pair_reverseside_7{0}_png",K),H[3]=(W={},W[0]="3d_me_pair_7{0}_png",W[1]="3d_me_pair_reverseside_7{0}_png",W),H[4]=(j={},j[0]="3d_me_pair_6_dao{0}_png",j),H[5]=(J={},J[0]="3d_me_pair_7_dao{0}_png",J),H),U[2]=(q={},q[0]=(X={},X[0]="3d_me_pair_5{0}_png",X[1]="3d_me_pair_reverseside_5{0}_png",X),q[1]=(Z={},Z[0]="3d_me_pair_6{0}_png",Z[1]="3d_me_pair_reverseside_6{0}_png",Z),q[2]=(z={},z[0]="3d_me_pair_4{0}_png",z[1]="3d_me_pair_reverseside_4{0}_png",z),q[3]=(Q={},Q[0]="3d_me_pair_5{0}_png",Q[1]="3d_me_pair_reverseside_5{0}_png",Q),q[4]=($={},$[0]="3d_me_pair_6_dao{0}_png",$),q[5]=(te={},te[0]="3d_me_pair_4_dao{0}_png",te),q),U[3]=(ee={},ee[0]=(ae={},ae[0]="3d_me_pair_2{0}_png",ae[1]="3d_me_pair_reverseside_2{0}_png",ae),ee[1]=(ie={},ie[0]="3d_me_pair_3{0}_png",ie[1]="3d_me_pair_reverseside_3{0}_png",ie),ee[2]=(ne={},ne[0]="3d_me_pair_1{0}_png",ne[1]="3d_me_pair_reverseside_1{0}_png",ne),ee[3]=(oe={},oe[0]="3d_me_pair_2{0}_png",oe[1]="3d_me_pair_reverseside_2{0}_png",oe),ee[4]=(se={},se[0]="3d_me_pair_3_dao{0}_png",se),ee[5]=(re={},re[0]="3d_me_pair_1_dao{0}_png",re),ee),U),i),t.card_face_data_3d_up_down=[17,16,13,10,7,5,4,3,2,1,0,-2,-2,-4,-5,-7,-10,-13,-16,-17];var e,a,i,n,o,s,r,l,c,h,u,d,m,p,g,C,_,f,D,I,b,y,E,v,T,S,A,M,R,G,N,L,U,O,x,P,w,k,B,F,H,Y,V,K,W,j,J,q,X,Z,z,Q,$,te,ee,ae,ie,ne,oe,se,re}(GameConst||(GameConst={}));var game;!function(t){var e=function(){function t(){this.userId=0,this.userName=null,this.headImgUrl=null,this.gender=1,this.ip=null,this.ageType=0;var t=100*Math.random();10>t?this.ageType=SoundCost.soundType.old:this.ageType=SoundCost.soundType.young}return t.prototype.setAgeType=function(t){this.ageType=t},t.prototype.getAgeType=function(){return this.ageType},t.prototype.getGender=function(){return this.gender},t.prototype.setGender=function(t){t!=Constants.GENDER.female&&t!=Constants.GENDER.man&&(t=Constants.GENDER.female),this.gender=t,t==Constants.GENDER.female&&this.setAgeType(SoundCost.soundType.young)},t.prototype.setUserId=function(t){this.userId=t},t.prototype.getUserId=function(){return this.userId},t.prototype.setUserName=function(t){this.userName=t},t.prototype.getUserName=function(){return this.userName},t.prototype.setHeadIMGUrl=function(t){this.headImgUrl=t},t.prototype.getHeadIMGUrl=function(){return this.headImgUrl},t.prototype.setIP=function(t){this.ip=t},t.prototype.getIP=function(){return this.ip},t}();t.BaseUserInfo=e,__reflect(e.prototype,"game.BaseUserInfo")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.eventMap_=[],e.isSelfViewComplete=!1,e.isChildrenCreated=!1,e.isViewCreated=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onSelfViewComplete,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.clean,e),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.isChildrenCreated=!0,this.isSelfViewComplete&&this.onCreateViewComplete()},e.prototype.onSelfViewComplete=function(){this.isSelfViewComplete=!0,this.isChildrenCreated&&this.onCreateViewComplete()},e.prototype.onCreateViewComplete=function(){this.isViewCreated=!0},e.prototype.updateUI=function(){this.isViewCreated&&this.updateUI_()},e.prototype.updateUI_=function(){},e.prototype.addTapEvent=function(t,e){t.addEventListener(egret.TouchEvent.TOUCH_TAP,e,this);var a={obj:t,event:e};this.eventMap_.push(a)},e.prototype.removeTapEvent=function(){for(var t=0;t<this.eventMap_.length;t++){var e=this.eventMap_[t],a=e.obj,i=e.event;a.removeEventListener(egret.TouchEvent.TOUCH_TAP,i,this)}},e.prototype.clean=function(){this.removeTapEvent(),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clean,this)},e}(eui.Component);t.EComponent=e,__reflect(e.prototype,"game.EComponent")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.roomNum=0,this.roomType=Constants.ROOM_TYPE.jinYuanZi,this.roomScore=2,this.turnMode=3,this.turnNumber=4,this.payMode=5,this.huaZa=!1,this.faFen=!1,this.jieZhuangBi=!1,this.roomId=9,this.masterUserId=10,this.turnModeDesc=null,this.payModeDesc=null,this.roomTypeDesc=null,this.maxPlayerNum=GameConst.maxPlayerNum,this.clubId=0,this.calNum=1,this.autoHost=!1,this.autoType=1,this.baoMi=!1,this.clubName=null,this.openVoice=!0,this.haiDiLaoYue=!0,this.dismissSwitch=!0,this.inviteSwitch=!1,this.changePlayerNumber=!0,this.autoMatch=!1,this.hideRoomUserInfo=!1,this.hideGameUserInfo=!1,this.blessSwitch=!1,this.bxhColorSwitch=!1,this.enTuiZiMode=!1}return e.prototype.getAutoType=function(){return this.autoType},e.prototype.isEnTuiZiMode=function(){return this.enTuiZiMode},e.prototype.isBlessSwitch=function(){return this.blessSwitch},e.prototype.isAutoMatch=function(){return this.autoMatch},e.prototype.getBxhColorSwitch=function(){return this.bxhColorSwitch},e.prototype.needHideGameUserInfo=function(){return GlobalData.gameData.isPlayBack()?!1:this.isHideGameUserInfo()},e.prototype.isHideGameUserInfo=function(){return this.hideGameUserInfo},e.prototype.isHideRoomUserInfo=function(){return this.hideRoomUserInfo},e.prototype.isDissmissEnabled=function(){return this.dismissSwitch},e.prototype.getClubName=function(){return this.clubName},e.prototype.getInviteSwitch=function(){return null==this.inviteSwitch&&(this.inviteSwitch=!1),this.inviteSwitch},e.prototype.canChangePlayerNum=function(){return this.changePlayerNumber},e.prototype.getHaiDiLaoYue=function(){return this.haiDiLaoYue},e.prototype.isVoiceEnabled=function(){return this.openVoice},e.prototype.isBaomi=function(){return this.baoMi},e.prototype.getCountNum=function(){var t=0;return this.roomType==Constants.ROOM_TYPE.jinYuanZi?t=this.calNum:this.roomType==Constants.ROOM_TYPE.changKaiTou&&(t=this.calNum/10),t},e.prototype.getClubID=function(){return this.clubId},e.prototype.isClubRoom=function(){return 0==this.clubId?!1:!0},e.prototype.getMaxPlayerNum=function(){return this.maxPlayerNum},e.prototype.getRoomId=function(){return this.roomId},e.prototype.isJieZhuangBi=function(){return this.jieZhuangBi},e.prototype.isFaFen=function(){return this.faFen},e.prototype.isHuaZa=function(){return this.huaZa},e.prototype.getPayMode=function(){return this.payMode},e.prototype.getPayModeDesc=function(){return this.payModeDesc},e.prototype.getTurnMode=function(){return this.turnMode},e.prototype.getTurnModeDesc=function(){return this.turnModeDesc},e.prototype.getTurnNumber=function(){return this.turnNumber},e.prototype.getMasterUserId=function(){return this.masterUserId},e.prototype.getRoomType=function(){return this.roomType},e.prototype.getRoomTypeDesc=function(){return this.roomTypeDesc},e.prototype.getRoomNum=function(){return this.roomNum},e.prototype.getRoomScore=function(){return this.roomScore},e.prototype.parse=function(t){this.maxPlayerNum=t.maxPlayerNum,null==this.maxPlayerNum&&(this.maxPlayerNum=GameConst.maxPlayerNum),this.roomNum=t.roomNumber,this.roomType=t.roomType,this.roomScore=t.roomScore,this.turnMode=t.turnMode,this.turnNumber=t.turnNumber,this.payMode=t.payMode,this.huaZa=t.huaZa,this.faFen=t.faFen,this.baoMi=t.baoMi,this.jieZhuangBi=t.jieZhuangBi,this.roomId=t.roomId,this.masterUserId=t.masterUserId,this.calNum=t.calNum,this.clubId=t.clubId,this.bxhColorSwitch=t.bxhColorSwitch,null==this.clubId&&(this.clubId=0),this.autoHost=t.autoHost,null!=t.autoType&&(this.autoType=t.autoType),null!=t.clubName&&(this.clubName=t.clubName),null!=t.openVoice&&(this.openVoice=t.openVoice),this.haiDiLaoYue=t.haiDiLaoYue,this.dismissSwitch=t.dismissSwitch,this.inviteSwitch=t.inviteSwitch,null!=t.changePlayerNum&&(this.changePlayerNumber=t.changePlayerNum),this.bxhColorSwitch=t.bxhColorSwitch,this.autoMatch=t.autoMatch,this.hideRoomUserInfo=t.hideRoomUserInfo,this.hideGameUserInfo=t.hideGameUserInfo,this.blessSwitch=t.blessSwitch,this.enTuiZiMode=t.enTuiZiMode,this.turnMode==Constants.ROOM_TIME_MODE.ba?this.turnModeDesc="把":this.turnModeDesc="圈","0"==GlobalData.clientConfigs.showCreateRoom&&GameConfig.platform==GameConfig.PLATFORM_SET.weChat?this.payModeDesc="":this.payMode==Constants.ROOM_PAY_MODE.AA?this.payModeDesc="AA模式":this.payMode==Constants.ROOM_PAY_MODE.creator?this.payModeDesc="房主模式":this.payMode==Constants.ROOM_PAY_MODE.other&&(this.isClubRoom()?this.payModeDesc="会长模式 ":this.payModeDesc="代开房间 "),this.roomType==Constants.ROOM_TYPE.jinYuanZi?this.roomTypeDesc="进园子":this.roomType==Constants.ROOM_TYPE.changKaiTou&&(this.roomTypeDesc="敞开头")},e.prototype.getShareRoomInfo=function(){var e="",a=this.turnNumber,i="对局数:"+a+this.turnModeDesc,n=this.getRulesDesc(),o="";if(this.calNum>0&&(o=" 记分:"+this.calNum+"/100分"),this.roomType==Constants.ROOM_TYPE.jinYuanZi)e=this.roomTypeDesc+" "+this.payModeDesc+i+o+" 携带积分: "+this.roomScore+"分 "+n;else if(this.roomType==Constants.ROOM_TYPE.changKaiTou){var s="";s=0==this.roomScore?"无上限":this.roomScore+"分 ",e=this.roomTypeDesc+" :"+this.payModeDesc+i+o+" 单把上限: "+s+" "+n}return this.blessSwitch&&(e="防沉迷 "+e),t.LogUtils.info("微信分享内容 "+e),e},e.prototype.getRulesDesc=function(){var e="";if(t.LogUtils.info("getRulesDesc this.roomType "+this.roomType),this.roomType==Constants.ROOM_TYPE.jinYuanZi?(e=this.isHuaZa()?"花砸2":"",this.isJieZhuangBi()&&(e.length>0?e+="、接庄比":e="接庄比"),this.isFaFen()&&(e.length>0?e+="、东南西北罚分":e="东南西北罚分")):this.roomType==Constants.ROOM_TYPE.changKaiTou&&(e="花砸2、接庄比、东南西北罚分"),this.autoHost){var a="超时托管";2==this.autoType&&(a="超时解散"),""==e?e=a:e+=Utils.format("、{0}",a)}return this.baoMi&&(""==e?e="保米":e+="、保米"),this.haiDiLaoYue&&(""==e?e="海底捞月":e+="、海底捞月"),e},e.prototype.getGameUIRulesDesc=function(){var t="",t=this.getRulesDesc();return t=t.replace("、",","),this.blessSwitch&&(t="防沉迷,"+t),this.payModeDesc+","+this.turnNumber+this.turnModeDesc+","+t},e.prototype.getTemplateMainInfo=function(){return"南京麻将"},e.prototype.clearData=function(){this.roomNum=0},e}();t.RoomInfo=e,__reflect(e.prototype,"game.RoomInfo")}(game||(game={}));var game;!function(t){var e=function(e){function a(a,i,n){void 0===i&&(i=!0),void 0===n&&(n=.6);var o=e.call(this)||this;return o.animationType=0,o.needMask=!0,o.maskClickable=!0,o.maskAlpha=0,void 0==a||null==a?o.dialogUUID=t.UUID.generateUUID():o.dialogUUID=a,o.maskClickable=i,o.maskAlpha=n,o}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.needMask&&this.addBgRect(),this.needShow&&(this.needShow=!1,this.show(this.animationType,this.callback)),t.EAppFacade.getInstance().registerCommand("panel",this.onEventHandler,this)},a.prototype.onEventHandler=function(t){this.eventMsg=t.data,this.eventId=this.eventMsg.cmd,this.eventData=this.eventMsg.data},a.prototype.addBgRect=function(){if(null==this.bgRect){this.bgRect=new eui.Rect,this.bgRect.fillColor=0,this.bgRect.alpha=this.maskAlpha;var t=1560,e=GameConfig.windowHeight_h5+2*GlobalData.deltaY;this.bgRect.width=t,this.bgRect.height=e,this.bgRect.x=(GameConfig.ScreenW-t)/2,this.bgRect.y=(GameConfig.ScreenH-e)/2,this.addChildAt(this.bgRect,0)}this.maskClickable&&this.addTapEvent(this.bgRect,this.close)},a.prototype.show=function(t,e){if(!this.isViewCreated)return this.needShow=!0,this.animationType=t,void(this.callback=e);var i=t;switch(i){case a.show_ani_type_null:var n=this;n.anchorOffsetX=.5*n.width,n.anchorOffsetY=.5*n.height,n.x=.5*GameConfig.ScreenW,n.y=.5*GameConfig.ScreenH;break;case a.show_ani_type_ZoomIn:this.playAnimationZoomIn();break;case a.show_ani_type_MoveDown:this.playMoveDown();break;case a.show_ani_type_MoveFromLeft:this.playMoveFromLeft()}},a.prototype.playAnimationZoomIn=function(){var t=this,e=300;t.scaleX=0,t.scaleY=0,t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=.5*GameConfig.ScreenW,t.y=.5*GameConfig.ScreenH;var a=egret.Tween.get(t);a.to({scaleX:1,scaleY:1},e,egret.Ease.quadIn)},a.prototype.playAnimationExitJump=function(t){},a.prototype.playAniamtionJump=function(t){var e=this;
e.anchorOffsetX=.5*e.width,e.anchorOffsetY=.5*e.height;var a=-30,i=400,n=20,o=egret.Tween.get(e);o.to({y:0+a},i+n),o.to({y:0-a},2*n),o.to({y:0},n),o.call(t)},a.prototype.playAnimationDrop=function(){var t=this;t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height;var e=500,a=50,i=50,n=30,o=0,s=o-n,r=egret.Tween.get(t);r.to({y:o},e,egret.Ease.quadIn),r.to({y:s},a,egret.Ease.quadOut),r.to({y:o},i,egret.Ease.quadIn)},a.prototype.playMoveDown=function(){var t=this,e=200;t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=.5*GameConfig.ScreenW,t.y=-.5*GameConfig.ScreenH;var a=egret.Tween.get(t);a.to({y:.5*GameConfig.ScreenH},e,egret.Ease.getPowIn(2))},a.prototype.playMoveFromLeft=function(){var t=this,e=200;t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=-.5*GameConfig.ScreenW,t.y=.5*GameConfig.ScreenH;var a=egret.Tween.get(t);a.to({x:.5*GameConfig.ScreenW},e,egret.Ease.getPowIn(2))},a.prototype.onShowEnd=function(){},a.prototype.getDialogUUID=function(){return this.dialogUUID},a.prototype.clean=function(){this.close(),e.prototype.clean.call(this)},a.prototype.close=function(){t.EAppFacade.getInstance().removeCommand("panel",this.onEventHandler,this),t.DialogManager.getInstance().close(this)},a.show_ani_type_null=0,a.show_ani_type_ZoomIn=1,a.show_ani_type_MoveDown=2,a.show_ani_type_MoveFromLeft=3,a}(t.EComponent);t.EDialog=e,__reflect(e.prototype,"game.EDialog")}(game||(game={}));var CardCost;!function(t){t.Character=(e={},e[1]=1,e[2]=2,e[3]=3,e[4]=4,e[5]=5,e[6]=6,e[7]=7,e[8]=8,e[9]=9,e),t.Bamboo=(a={},a[1]=11,a[2]=12,a[3]=13,a[4]=14,a[5]=15,a[6]=16,a[7]=17,a[8]=18,a[9]=19,a),t.Dot=(i={},i[1]=21,i[2]=22,i[3]=23,i[4]=24,i[5]=25,i[6]=26,i[7]=27,i[8]=28,i[9]=29,i),t.Flower={spring:51,summer:53,autumn:55,winter:57,wintersweet:61,orchid:63,bamboo:65,mum:67},t.Wind={east:31,south:33,west:35,north:37},t.Dragon={Red:41,Green:43,White:45},t.other={buHua:101,pong:102,kong:103,win:104,kongWin:105,tianHu:106,diHu:107,ziMo:108};var e,a,i}(CardCost||(CardCost={}));var game;!function(t){var e=function(e){function a(a){var i=e.call(this)||this;return i.sceneIndex=a,t.EAppFacade.getInstance().registerCommand(Constants.EVENT_STAGE_VIEW_SIZE_CHANGED,i.onSizeChanged,i),t.EAppFacade.getInstance().registerCommand(t.GameCmd.onPause,i.onPause,i),t.EAppFacade.getInstance().registerCommand(t.GameCmd.onResume,i.onResume,i),i}return __extends(a,e),a.prototype.onSizeChanged=function(){console.log("SceneBase onSizeChanged ")},a.prototype.onShow=function(){},a.prototype.onClose=function(){},a.prototype.onPause=function(){},a.prototype.onResume=function(){},a.prototype.getIndex=function(){return this.sceneIndex},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(Constants.EVENT_STAGE_VIEW_SIZE_CHANGED,this.onSizeChanged,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.onPause,this.onPause,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.onResume,this.onResume,this),e.prototype.clean.call(this)},a}(t.EComponent);t.SceneBase=e,__reflect(e.prototype,"game.SceneBase")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.playerSet=null,this.gameStatus=GameConst.GAME_STATUS_TYPE.ready,this.clickCardType=1,this.flowerCardVisible=!0,this.roomInfo=new t.RoomInfo,this.myChairId=2,this.biXiaHu=!1,this.biXiaHuDesc=null,this.curTurnNum=0,this.eastChairId=1,this.curTurnDirection=1,this.curDiscardChairId=0,this.lastDiscardChairId=0,this.lastDiscardCardValue=0,this.leftCardNum=0,this.leftFlowerNum=0,this.needPlayStartEffect=!1,this.operateTypes=[],this.lastSendChatMsgTime=0,this.bankerChairId=0,this._isPlayBack=!1,this.curArrowDirChairId=0,this._isFirstDrawCard=!0,this.firstDrawCardData=null,this.needCheckCheat=!1,this.preventCheatInfo=null,this.tingPaiData=null,this.myTingInfos=null,this.playerNum=GameConst.maxPlayerNum,this._isCheatStatus=!1,this.autoDelayTimeNum=-1,this.canAutoHost=!0,this.tempDataBeforeGameStart=[],this.kickOfflineTime=0,this.autoDiscardData=null,this.changePlayerNumInfo=null,this.applyQuitInfo=null,this.playerSet=[]}return e.prototype.getOverData=function(){return this.overData},e.prototype.setOverData=function(e){this.overData=e;for(var a=e.winType,i=[],n=[],o=0;o<e.xJSUserInfos.length;o++){var s=e.xJSUserInfos[o],r=s.userChairId,l=s.readyStatus,c=this.getPlayer(r);if(null!=c){var h=s.score;c.setScore(h),c.setReadyStatus(l)}var u=this.changeChairIdToClientId(r);Utils.sendGameEvent(t.GameCmd.PLAYER_SCORE_NUM_CHANGED,{clientId:u,score:h});var d=100,m="";if(null!=s.winTypeInfos)for(var p=0;p<s.winTypeInfos.length;p++){var g=s.winTypeInfos[p].winPointType;g==GameConst.specialHuType.GODHU&&d>g?(m=GameConst.ACTION_WIN_ACTINDEX.tianhu,d=g):g==GameConst.specialHuType.SECONDHU&&d>g?(m=GameConst.ACTION_WIN_ACTINDEX.dihu,d=g):(g==GameConst.specialHuType.BIGSTICKBLOOM||s.superPointType==GameConst.specialHuType.STICKBLOOM)&&d>g&&(m=GameConst.ACTION_WIN_ACTINDEX.gangkai,d=g)}var C=s.win;C&&(i.push(u),""==m?1==a?n.push(GameConst.ACTION_WIN_ACTINDEX.zimo):n.push(GameConst.ACTION_WIN_ACTINDEX.hu):n.push(m))}var _=0,f=e.winPlayerNum;e.dianPaoChairId&&e.dianPaoChairId>0&&(_=this.changeChairIdToClientId(e.dianPaoChairId)),f>0&&Utils.sendGameEvent(t.GameCmd.WIN_OVER,{clientId:i,actionIndex:n,chuchongIndex:_})},e.prototype.setAllOverData=function(t){this.allOverData=t},e.prototype.getAllOverData=function(){return this.allOverData},e.prototype.setKickOfflineTime=function(t){this.kickOfflineTime=t},e.prototype.getKickOfflineTime=function(){return this.kickOfflineTime},e.prototype.getTempDataBeforeGameStart=function(){return this.tempDataBeforeGameStart},e.prototype.addTempDataBeforeGameStart=function(t){this.tempDataBeforeGameStart.push(t)},e.prototype.clearTempDataBeforeGameStart=function(){this.tempDataBeforeGameStart=[]},e.prototype.setAutoDelayTimeNum=function(t){this.autoDelayTimeNum=t},e.prototype.getAutoDelayTimeNum=function(){return this.autoDelayTimeNum},e.prototype.clearAutoDelayTimeNum=function(){this.autoDelayTimeNum=0},e.prototype.setCanAutoHost=function(t){this.canAutoHost=t},e.prototype.getCanAutoHost=function(){return this.canAutoHost},e.prototype.isAutoDelay=function(t){var e=!1,a=this.getPlayerByClientId(t);return null!=a&&(e=a.isAutoDiscardOfDelay()),e},e.prototype.setAutoDiscardInfo=function(t){this.autoDiscardData=t},e.prototype.getAutoDiscardInfo=function(){return this.autoDiscardData},e.prototype.clearAutoDiscardInfo=function(){this.autoDiscardData=null},e.prototype.getPlayerNum=function(){return this.playerNum},e.prototype.setPlayerNum=function(t){this.playerNum=t},e.prototype.setCheatStatus=function(t){this._isCheatStatus=t},e.prototype.isCheatStatus=function(){return this._isCheatStatus},e.prototype.getPreventInfo=function(){return this.preventCheatInfo},e.prototype.setPreventCheatInfo=function(t){this.preventCheatInfo=t},e.prototype.isNeedCheckCheat=function(){return this.needCheckCheat},e.prototype.setNeedCheckCheat=function(t){this.needCheckCheat=t},e.prototype.setMyTingInfo=function(t){null!=t&&t.length>0?this.myTingInfos=t:this.myTingInfos=null},e.prototype.getMyTingInfo=function(){return this.myTingInfos},e.prototype.getTingInfo=function(t){if(this.hasTingPaiInfo()){for(var e=null,a=0;a<this.tingPaiData.length;a++){var i=this.tingPaiData[a];if(i.tileId==t){e=i.tingInfos;break}}return e}},e.prototype.hasTingPaiInfo=function(){return null!=this.tingPaiData&&this.tingPaiData.length>0},e.prototype.clearTingPaiInfo=function(){this.tingPaiData=null},e.prototype.setTingPaiInfo=function(t){this.tingPaiData=t},e.prototype.getTingPaiInfo=function(){return this.tingPaiData},e.prototype.isFirstDrawCard=function(){return this._isFirstDrawCard},e.prototype.clearFirstDrawCardData=function(){this.firstDrawCardData=null},e.prototype.setFirstDrawCardData=function(t){this._isFirstDrawCard=!1,this.firstDrawCardData=t},e.prototype.getFirstDrawCardData=function(){return this.firstDrawCardData},e.prototype.setPlayBack=function(t){this._isPlayBack=t},e.prototype.isPlayBack=function(){return this._isPlayBack},e.prototype.getBankerChairId=function(){return this.bankerChairId},e.prototype.updateSendChatTime=function(){this.lastSendChatMsgTime=(new Date).getTime()},e.prototype.canSendChatMsg=function(){return(new Date).getTime()-this.lastSendChatMsgTime>1e3},e.prototype.getCurTurnDirection=function(){return this.curTurnDirection},e.prototype.getChangePlayerNumInfo=function(){return this.changePlayerNumInfo},e.prototype.setChangePlayerNumInfo=function(t){this.changePlayerNumInfo=t},e.prototype.setApplyQuitInfo=function(t){this.applyQuitInfo=t},e.prototype.getApplyQuitInfo=function(){return this.applyQuitInfo},e.prototype.getLastDiscarChairId=function(){return this.lastDiscardChairId},e.prototype.getLastDiscardValue=function(){return this.lastDiscardCardValue},e.prototype.setEastChairId=function(t){this.eastChairId=t},e.prototype.getEastChairId=function(){return this.eastChairId},e.prototype.changeDirArrow=function(e){this.curArrowDirChairId=e;var a=this.changeChairIdToClientId(e);Utils.sendGameEvent(t.GameCmd.DIR_ARROW_CHANGE,{clientId:a})},e.prototype.curDirArrow=function(){return this.curArrowDirChairId},e.prototype.getDiscardChairId=function(){return this.curDiscardChairId},e.prototype.setDiscardChairId=function(t){this.curDiscardChairId=t},e.prototype.setNeedPlayStartStatus=function(t){this.needPlayStartEffect=t},e.prototype.isNeedPlayStartStatus=function(){return this.needPlayStartEffect},e.prototype.setLeftCardNum=function(t){this.leftCardNum=t},e.prototype.getLeftCardNum=function(){return this.leftCardNum},e.prototype.getLeftFlowerNum=function(){return this.leftFlowerNum},e.prototype.setLeftFlowerNum=function(t){this.leftFlowerNum=t},e.prototype.isBiXiaHu=function(){return this.biXiaHu},e.prototype.getBiXiaHuDesc=function(){return this.biXiaHuDesc},e.prototype.getCurTurnNumber=function(){return this.curTurnNum},e.prototype.setMyChairId=function(e){t.LogUtils.info("我的椅子id "+e),this.myChairId=e},e.prototype.getMyChairId=function(){return this.myChairId},e.prototype.getClickCardType=function(){return this.clickCardType},e.prototype.setClickType=function(t){this.clickCardType!=t&&DataStorage.writeLocalData(LocalStorage.setting.GameDoubleClickType,""+t),this.clickCardType=t},e.prototype.setFlowerCardVisible=function(t){t?DataStorage.writeLocalData(LocalStorage.setting.Flower_card_Visible,"1"):DataStorage.writeLocalData(LocalStorage.setting.Flower_card_Visible,"0"),this.flowerCardVisible=t},e.prototype.getFlowerCardVisible=function(){return this.flowerCardVisible},e.prototype.isMeCreator=function(){return this.roomInfo.getMasterUserId()==GlobalData.userData.getUserId()},e.prototype.getRoomInfo=function(){return this.roomInfo},e.prototype.resetOperateTypes=function(){this.operateTypes=[]},e.prototype.setOperateTypes=function(t){this.operateTypes=t},e.prototype.getOperateTypes=function(){return this.operateTypes},e.prototype.setOperateData=function(t){this.operateData=t;var e=[];if(null!=this.operateData&&this.operateData.length>0)for(var a=0;a<this.operateData.length;a++)e.push(this.operateData[a].operateType);this.setOperateTypes(e)},e.prototype.getKongOperateData=function(){var t=null;if(null==this.operateData||0==this.operateData.length)return t;for(var e=1;e<this.operateData.length;e++){var a=this.operateData[e];if(a.operateType==GameConst.OPERATE_TYPE.kong){t=a.operateOneDataList;break}}return t},e.prototype.needOperate=function(){var t=this.operateTypes.length;return t>0},e.prototype.getPlayerByClientId=function(t){var e=this.changeClientIdToChairId(t);return this.getPlayer(e)},e.prototype.changeIndexToClientId=function(e){var a=this.changeClientIdToChairId(e),i=this.playerSet[a];return null==i?-1:(t.LogUtils.info("changeIndexToClientId index"+e+" ->resultIndex"+a),e)},e.prototype.changeChairIdToClientId=function(e){var a=(e-this.myChairId+GameConst.maxPlayerNum)%GameConst.maxPlayerNum;return t.LogUtils.info("changeChairIdToClientId chairId"+e+" ->clientId"+a),a},e.prototype.changeClientIdToChairId=function(t){if(0>t||t>=GameConst.maxPlayerNum)return 0;var e=(t+this.myChairId-1+GameConst.maxPlayerNum)%GameConst.maxPlayerNum+1;return e},e.prototype.getHeadImgName=function(t){var e=t,a=new a,i=a.sumhexa(e);return"headImage_"+i+".png"},e.prototype.getPlayerHeadImgPathByUserID=function(t){},e.prototype.getPlayerSet=function(){return this.playerSet},e.prototype.addPlayer=function(e,a){t.LogUtils.info("addPlayer chairId "+e),this.playerSet[e]=a},e.prototype.getPlayer=function(t){return 1>t||t>GameConst.maxPlayerNum?void 0:this.playerSet[t]},e.prototype.getPlayerInfoByClientId=function(t){var e=this.changeClientIdToChairId(t);return this.getPlayer(e)},e.prototype.getCardData=function(t){var e=this.getPlayerInfoByClientId(t);return null==e?null:e.getCardData()},e.prototype.getCurPlayerNum=function(){for(var t=0,e=1;e<=GameConst.maxPlayerNum;e++)null!=this.playerSet[e]&&(t+=1);return t},e.prototype.removePlayer=function(t){this.playerSet[t]=null},e.prototype.setGameStatus=function(e){t.LogUtils.info("setGameStatus "+e),this.gameStatus=e},e.prototype.getGameStatus=function(){return this.gameStatus},e.prototype.isMyOutCardTurn=function(){return this.curDiscardChairId==this.myChairId},e.prototype.resetRoomSet=function(){},e.prototype.parse=function(e){this.clearFirstDrawCardData(),t.LogUtils.info("GameData:parse"),this.biXiaHu=e.biXiaHu,this.biXiaHuDesc=e.biXiaHuDesc,this.curTurnNum=e.curTurnNum,this.curTurnDirection=e.curTurnDirection,this.curDiscardChairId=e.curChairId,this.lastDiscardChairId=e.lastDiscardChairId,this.lastDiscardCardValue=e.lastDiscardTileId,this.bankerChairId=e.bankerChairId,t.LogUtils.info("curTurnDirection "+this.curTurnDirection),t.LogUtils.info("curDiscardChairId "+this.curDiscardChairId),t.LogUtils.info("lastDiscardChairId "+this.lastDiscardChairId),t.LogUtils.info("lastDiscardCardValue "+this.lastDiscardCardValue);var a=e.canAutoHost;this.setCanAutoHost(a),this.leftCardNum=e.stackTileNum,this.leftFlowerNum=e.stackFlowerNum;var i=e.msgRoomGaming,n=i.msgRoom;this.roomInfo.parse(n),this.playerNum=this.roomInfo.getMaxPlayerNum(),t.LogUtils.info("this.playerNum "+this.playerNum);var o=i.roomStatus;this.setGameStatus(o);for(var s=e.msgUserGames,r=1,l=0;l<this.playerNum;l++){var c=s[l],h=c.msgUserData,u=h.msgUser.userId;if(u==GlobalData.userData.getUserId()){var d=h.chairId;r=d;break}}this.setMyChairId(r),this.clearPlayerData(),this.clearLastGameData();for(var l=0;l<this.playerNum;l++){var c=s[l];t.LogUtils.info("msgUserGame i == "+l);var h=c.msgUserData,m=h.chairId,p=this.getPlayer(m);if(null==p&&(p=new t.PlayerInfo,this.addPlayer(m,p)),p.parse(h),m==r){var g=c.tingInfos;this.setMyTingInfo(g)}if(o==GameConst.GAME_STATUS_TYPE.playing){for(var C=c.hasTing,_=c.jiaTileId,f=c.discardTileIds,D=c.flowerIds,I=c.gainTileInfos,b=c.userTileIds,y=c.waiBaoStatus,E=[],v=0;v<I.length;v++){var T=I[v],S=T.discardChairId,A=GlobalData.gameData.changeChairIdToClientId(S),M=T.gainType,R={type:M,provideClientId:A,value:T.tileIds[0],waiBaoStatus:y},G=new t.PongKongData(R);E.push(G)}var N=new t.PlayerCardData;N.setTing(C),N.setJiaPaiValue(_),N.setPlayerHuaCards(D),N.setPlayerOutCards(f),N.setPlayerHandCards(b),N.setPongKongCards(E),p.setCardData(N)}}var g=e.tingInfos;this.setTingPaiInfo(g),t.LogUtils.info("gameData init Complete")},e.prototype.clearPlayerData=function(){this.playerSet=[]},e.prototype.clearLastGameData=function(){this.myTingInfos=null,this.clearAutoDiscardInfo(),this.clearAutoDelayTimeNum(),this.clearTempDataBeforeGameStart(),this.resetOperateTypes()},e.prototype.clearData=function(){this.clearPlayerData(),this.clearLastGameData(),this.roomInfo.clearData(),GlobalData.userData.clearRoomNumber(),this.setCheatStatus(!1),this.playerNum=GameConst.maxPlayerNum,this.bankerChairId=0,this.applyQuitInfo=null,this.changePlayerNumInfo=null,this._isFirstDrawCard=!0,this.needCheckCheat=!1,this.preventCheatInfo=null},e}();t.GameData=e,__reflect(e.prototype,"game.GameData")}(game||(game={}));var Utils;!function(t){function e(t,e){var a=Math.random(),i=Math.floor(t+a*(e-t));return i}function a(t){for(var e=[],a=1;a<arguments.length;a++)e[a-1]=arguments[a];if(0==arguments.length)return t;for(var i=0;i<arguments.length;i++){var n=new RegExp("\\{"+(i-1)+"\\}","gm");null!=t.match(n)&&(t=t.replace(n,arguments[i]))}return t}function i(t){var e=t;return 10>t&&(e="0"+t),e}function n(t,e){void 0===e&&(e=null);var a=null;a=null==e?{cmd:t}:{cmd:t,data:e},game.EAppFacade.getInstance().sendNotification("gameScene",a)}function o(t,e){void 0===e&&(e=null);var a=null;a=null==e?{cmd:t}:{cmd:t,data:e},game.EAppFacade.getInstance().sendNotification("panel",a)}function s(t){var e=/^[0-9]+.?[0-9]*$/;return e.test(t)?!0:!1}function r(t,e,a){if(0==t.length)return!1;var i=parseInt(t);return i>=e&&a>=i?!0:!1}function l(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],a=new egret.ColorMatrixFilter(e);t.filters=[a]}function c(t){t.filters=null}function h(e,a){t.clearObjColor(e);var i=function(t){var e={r:-1,g:-1,b:-1};return e.b=t%256,e.g=Math.floor(t/256)%256,e.r=Math.floor(t/256/256),e},n=i(a),o=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];o[0]=n.r/255,o[6]=n.g/255,o[12]=n.b/255;var s=new egret.ColorMatrixFilter(o);e.filters=[s]}function u(t){t.filters=null}function d(t,e,a,i){void 0===i&&(i=255);var n=parseInt((t<<16|e<<8|a).toString(16),16);return n}function m(t,e,a){for(var i=new egret.SpriteSheet(t),n=[],o=t.textureWidth/e,s=t.textureHeight/a,r=0;o*s>r;r++){var l=r%o*e,c=Math.floor(r/o)*a;n.push(i.createTexture("a"+r,l,c,e,a))}return n}function p(t){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(a){switch(a.label){case 0:if(void 0==t||null==t)return[2];if(GameConfig.platform!=GameConfig.PLATFORM_SET.H5)return[3,1];try{e=document.createElement("textarea"),e.readOnly=!0,e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,e.value.length),document.execCommand("copy"),document.body.removeChild(e),game.CommonView.showToast(Strings.copyToClipboardSuccess)}catch(i){game.LogUtils.error("拷贝失败")}return[3,3];case 1:return[4,platform.setClipboardData(t)];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function g(t){for(var e=0,a=t.length,i=-1,n=0;a>n;n++)i=t.charCodeAt(n),e+=i>=0&&128>=i?1:2;return e}function C(){var t=window.document,e=t.documentElement;(t.fullScreenElement&&null!==t.fullScreenElement||!t.mozFullScreen&&!t.webkitIsFullScreen&&!t.mozFullscreen&&!t.webkitIsFullscreen)&&(e.requestFullScreen?e.requestFullScreen():e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.mozRequestFullscreen?e.mozRequestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen())}function _(){var t=window.document;t.cancelFullScreen?t.cancelFullScreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitCancelFullScreen&&t.webkitCancelFullScreen()}function f(){var t=window.document,e=t.documentElement;t.fullScreenElement&&null!==t.fullScreenElement||!t.mozFullScreen&&!t.webkitIsFullScreen&&!t.mozFullscreen&&!t.webkitIsFullscreen?e.requestFullScreen?e.requestFullScreen():e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.mozRequestFullscreen?e.mozRequestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.webkitRequestFullScreen&&e.webkitRequestFullScreen():t.cancelFullScreen?t.cancelFullScreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitCancelFullScreen&&t.webkitCancelFullScreen()}function D(e){return t.format("http://qr.topscan.com/api.php?&text={0}",e)}function I(){var e="weixin://";if("Android"==egret.Capabilities.os)if(/ipad|iphone|mac/i.test(navigator.userAgent)){var a=document.createElement("iframe");a.src=e,a.style.display="none",document.body.appendChild(a)}else window.location.href=e;else"iOS"==egret.Capabilities.os?window.top.postMessage({type:1},"*"):game.DialogManager.getInstance().popUp1(t.format("暂不支持{0}，请使用安卓或者苹果手机浏览器",egret.Capabilities.os));y()&&game.DialogManager.getInstance().popUp1("当前已在微信中，请关闭当前页面")}function b(){return __awaiter(this,void 0,void 0,function(){var t,e,a,i,n;return __generator(this,function(o){switch(o.label){case 0:return t=new egret.RenderTexture,t.drawToTexture(Main.instance,new egret.Rectangle(-140,0,1560,720)),"Android"!=egret.Capabilities.os&&"iOS"!=egret.Capabilities.os?[3,2]:(e=document.getElementById("divImage"),a=document.getElementById("shareImage"),i=a,[4,t.toDataURL("image/jpeg")]);case 1:return i.src=o.sent(),e.style.display="block",[3,4];case 2:return n=Date.parse((new Date).toString()),[4,t.saveToFile("image/jpeg","mahjong_"+n+".png")];case 3:o.sent(),o.label=4;case 4:return[2]}})})}function y(){var t=navigator.userAgent.toString(),e=t.match(/MicroMessenger/i);return"MicroMessenger"==e?!0:!1}function E(t){var e=!1,a=new RegExp("^[A-Za-z0-9一-龥]+$");return e=!a.test(t.trim())}t.getRandom=e,t.format=a,t.getNumberFormatStr=i,t.sendGameEvent=n,t.sendPanelEvent=o,t.isNumbers=s,t.checkInputNumber=r,t.addGrayEffect=l,t.removeGrayEffect=c,t.setObjColor=h,t.clearObjColor=u,t.RGBA2Color=d,t.CreateTextureSheet=m,t.copyToClipboard=p,t.getCharLen=g,t.fullScreen=C,t.exitScreen=_,t.toggleFullScreen=f,t.getQrcodeUrl=D,t.callWxApp=I,t.captureScreen=b,t.isWeiXin=y,t.isHasSpecialWord=E}(Utils||(Utils={}));var game;!function(t){var e=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.roomNumber=0,t.diamond=0,t._isNewPlayer=!0,t.gold=0,t.longitude=0,t.latitude=0,t.bindPhoneNumber="",t.identityCardNumber="",t}return __extends(a,e),a.prototype.parse=function(t){this._isNewPlayer=t.regist,null!=t.roomNumber&&this.setRoomNumber(t.roomNumber);var e=t.user;this.setUserId(e.userId),this.setHeadIMGUrl(e.headImgUrl),this.setGender(e.gender),this.setUserName(e.nickName),this.setIP(e.ip),this.setPhoneNumber(t.phoneNumber),t.userRealInfo&&this.setIdentityCardNumber(t.userRealInfo.idCardNo)},a.prototype.isNewPlayer=function(){return this._isNewPlayer},a.prototype.setNewPlayer=function(t){this._isNewPlayer=t},a.prototype.getRoomNumber=function(){return this.roomNumber},a.prototype.setRoomNumber=function(t){this.roomNumber=t},a.prototype.getGoldNum=function(){return this.gold},a.prototype.setGoldNum=function(e){t.LogUtils.info("setGoldNum "+e);var a=!1;this.gold!=e&&(t.LogUtils.info("gold changed "+e),a=!0),this.gold=e,a&&t.EAppFacade.getInstance().sendNotification(t.GameCmd.GOLD_NUMBER_CHANGE)},a.prototype.setDiamondNum=function(e){t.LogUtils.info("setDiamondNum "+e);var a=!1;this.diamond!=e&&(t.LogUtils.info("diamond changed "+e),a=!0),this.diamond=e,a&&t.EAppFacade.getInstance().sendNotification(t.GameCmd.DIAMOND_NUMBER_CHANGE)},a.prototype.getDiamondNum=function(){return this.diamond},a.prototype.setLocation=function(t,e){this.longitude=t,this.latitude=e},a.prototype.getLocation=function(){return{longitude:this.longitude,latitude:this.latitude}},a.prototype.setIdentityCardNumber=function(t){this.identityCardNumber=t},a.prototype.getIdentityCardNumber=function(){return this.identityCardNumber},a.prototype.setPhoneNumber=function(t){this.bindPhoneNumber=t},a.prototype.getBindPhoneNumber=function(){return this.bindPhoneNumber},a.prototype.clearRoomNumber=function(){this.roomNumber=0},a.prototype.cleanUser=function(){this.setUserId(0)},a}(t.BaseUserInfo);t.UserInfo=e,__reflect(e.prototype,"game.UserInfo")}(game||(game={}));var GameCenterBaseNode=function(t){function e(e){var a=t.call(this)||this;return a.time=0,a.skinName=e,a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.initData(),this.initCenterNode()},e.prototype.setGameScene=function(t){this.gs=t},e.prototype.initData=function(){this.time=0},e.prototype.initCenterNode=function(){this.lightNode=[this.center_light_1,this.center_light_2,this.center_light_3,this.center_light_4],this.darkFengNode=[this.center_dark_dir_1,this.center_dark_dir_2,this.center_dark_dir_3,this.center_dark_dir_4],this.fengNode=[this.center_dir_1,this.center_dir_2,this.center_dir_3,this.center_dir_4];for(var t=0;t<GameConst.maxPlayerNum;t++)this.lightNode[t].visible=!1,this.lightNode[t].alpha=.5,this.darkFengNode[t].visible=!0,this.fengNode[t].visible=!1;this.center_dir_effect.visible=!1},e.prototype.onEventHandler=function(t){var e=t.data,a=e.cmd,i=e.data;if(a==game.GameCmd.LEFT_CARD_NUM_CHANGED){var n=i.leftCardNum,o=i.leftFlowerNum;this.updateLeftCardNum(n),this.updateLeftFlowerNum(o)}else if(a==game.GameCmd.AUTO_DISCARD_TIME){GlobalData.gameData.clearAutoDelayTimeNum();var s=Math.floor(i.leftTime/1e3);this.resetClock(s,!0)}else if(a==game.GameCmd.DIR_ARROW_CHANGE){var r=i.clientId;this.updateDirArrow(r)}else if(a==game.GameCmd.AUTO_DISCARD_TIME){GlobalData.gameData.clearAutoDelayTimeNum();var s=Math.floor(i.leftTime/1e3);this.resetClock(s,!0)}else a==game.GameCmd.AUTO_DISCARD_TIME_STATUS_CHANGED&&this.changeAutoHostStatus()},e.prototype.changeAutoHostStatus=function(){GlobalData.gameData.getCanAutoHost()?this.startTimer():this.stopTimer()},e.prototype.setStatus=function(t){this.status=t,this.updateCenterNode(),this.updateAutoTimer()},e.prototype.updateCenterNode=function(){if(this.status==GameConst.GAME_STATUS_TYPE.ready||this.status==GameConst.GAME_STATUS_TYPE.before_playing||this.status==GameConst.GAME_STATUS_TYPE.waiting?this.centerClock.visible=!1:this.centerClock.visible=!0,this.updateTurnNumber(),this.updateDir(),this.status==GameConst.GAME_STATUS_TYPE.ready)this.Node_centerText.visible=!1;else if(this.status==GameConst.GAME_STATUS_TYPE.playing){this.Node_centerText.visible=!0,this.Node_LeftNum.visible=!0,this.updateLeftCardNum(),this.updateLeftFlowerNum();var t=GlobalData.gameData.getDiscardChairId(),e=GlobalData.gameData.changeChairIdToClientId(t);this.updateDirArrow(e)}else if(this.status==GameConst.GAME_STATUS_TYPE.waiting){this.center_dir_effect.visible=!1;for(var a=0;a<GameConst.maxPlayerNum;a++)this.darkFengNode[a].visible=!0,this.lightNode[a].visible=!1,this.fengNode[a].visible=!1;this.Node_LeftNum.visible=!1}else(this.status==GameConst.GAME_STATUS_TYPE.over||this.status==GameConst.GAME_STATUS_TYPE.allOver)&&this.stopTimer()},e.prototype.updateDirArrow=function(t){for(var e=0;e<GameConst.maxPlayerNum;e++)this.lightNode[e].visible=t==e,this.darkFengNode[e].visible=t!=e,this.fengNode[e].visible=t==e;this.center_dir_effect.visible=!0,this.playEffect(t),this.resetClock()},e.prototype.playEffect=function(t){},e.prototype.updateLeftFlowerNum=function(t){void 0===t&&(t=-1);var e=t;-1==e&&(e=GlobalData.gameData.getLeftFlowerNum()),this.Text_leftFlowerNum.text=""+e},e.prototype.updateLeftCardNum=function(t){void 0===t&&(t=-1);var e=t;-1==e&&(e=GlobalData.gameData.getLeftCardNum()),this.Text_leftCardNum.text=""+e},e.prototype.updateTurnNumber=function(){var t,e=GlobalData.gameData.getCurTurnNumber(),a=GlobalData.gameData.getRoomInfo().getTurnNumber();if(GlobalData.gameData.getRoomInfo().getTurnMode()==Constants.ROOM_TIME_MODE.quan){var i=GlobalData.gameData.getCurTurnDirection();t=GameConst.DIRECT_DESC[i]+e+"/"+a}else t=e+" / "+a;this.Text_turnNum.text=t,this.Text_turnMode.text=GlobalData.gameData.getRoomInfo().getTurnModeDesc()+"数"},e.prototype.updateDir=function(){for(var t=GlobalData.gameData.getEastChairId(),e=GlobalData.gameData.changeChairIdToClientId(t),a=0;a<GameConst.maxPlayerNum;a++){var i=(a-e+GameConst.maxPlayerNum)%GameConst.maxPlayerNum+1,n="feng"+i+"_png",o="nowFeng"+i+"_png";this.fengNode[a].source=o,this.darkFengNode[a].source=n,this.darkFengNode[a].visible=!0}},e.prototype.updateAutoTimer=function(){var t=GlobalData.gameData.getAutoDelayTimeNum();t>0&&(GlobalData.gameData.clearAutoDelayTimeNum(),this.resetClock(t,!0))},e.prototype.resetClock=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1),e&&(this.centerClock.visible=!0),Utils.sendGameEvent(game.GameCmd.UPDATE_AUTODISCARD_Text_Visible,{visible:e}),this.time=GameConst.operateTime,-1!=t&&(this.time=t),this.centerClock.text=""+this.time,this.startTimer()},e.prototype.startTimer=function(){this.stopTimer(),this.tickScheduler=game.TimerItemManager.getInstance().startTimer(game.TimerItem.TimerType.perSec,1e3*this.time,this.timerEventHandler,this)},e.prototype.stopTimer=function(){null!=this.tickScheduler&&(game.TimerItemManager.getInstance().stopTimer(this.tickScheduler),this.tickScheduler=null)},e.prototype.timerEventHandler=function(t){GlobalData.gameData.isPlayBack()&&this.gs.getReplayer()&&this.gs.getReplayer().isPause()||(this.time=Math.max(this.time-1,0),3==this.time&&GlobalData.gameData.getDiscardChairId()==GlobalData.gameData.getMyChairId()&&game.SoundService.getInstance().playAudio("countdown_mp3",3),this.centerClock.text=""+this.time,0==this.time&&this.stopTimer())},e.prototype.release=function(){this.stopTimer()},e}(game.EComponent);__reflect(GameCenterBaseNode.prototype,"GameCenterBaseNode"),window.GameCenterBaseNode=GameCenterBaseNode;var game;!function(t){var e=function(e){function a(t,a,i){var n=e.call(this)||this;return n.dir=t,n._value=a,n.idx=i,n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){this.setCardValue(this._value)},a.prototype.setCardValue=function(t){this._value=t},a.prototype.getDir=function(){return this.dir},a.prototype.getCardValue=function(){return this._value},a.prototype.getCardFaceImgName=function(e){var a=Utils.format("2dmj_cardnum_mahjong_{0}_png",Utils.getNumberFormatStr(e));return t.LogUtils.info(Utils.format("imgName {0}",a)),GameUtils.getCardFace(a)},a}(t.EComponent);t.BaseCardNode=e,__reflect(e.prototype,"game.BaseCardNode")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.handle=function(e){if(e.code!=t.MsgResultStatus.SUCCESS){var a=e.errorCode,i="";switch(a){case t.MsgConstant.ERROR_belss_has_zero_del:i="成员体力值为0才能删除！";break;case t.MsgConstant.ERROR_belss_has_zero_set:i="成员体力值为0才能设置归属！";break;case t.MsgConstant.ERROR_not_set_group_manager:i="会长管理模式下不允许设置组管理员！";break;case t.MsgConstant.ERROR_not_modify_self_bless:i="管理员不可以修改自己的体力！";break;case t.MsgConstant.ERROR_manager_not_by_set:i="管理员不能被更改归属！";break;case t.MsgConstant.ERROR_manager_power_no_enough:i="您当前的拥有的体力数量不够发放！";break;default:return}t.DialogManager.getInstance().popUp1(i)}},e}();t.BaseHandler=e,__reflect(e.prototype,"game.BaseHandler")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this,Constants.UI_PANEL_DATA_SET.about.index)||this;return e.skinName="resource/skins/game/panel/AboutBoxSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.Button_close,this.close.bind(this)),this.updateUI()},e.prototype.updateUI_=function(){this.Text_info.text="当前版本："+GameConfig.version},e}(t.EDialog);t.AboutBox=e,__reflect(e.prototype,"game.AboutBox")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getRoomTypeName=function(t){return t==Constants.ROOM_TYPE.jinYuanZi?"进园子":"敞开头"},t.getPayModeName=function(t,e){return"0"==GlobalData.clientConfigs.showCreateRoom&&GameConfig.platform==GameConfig.PLATFORM_SET.weChat?"":t==Constants.ROOM_PAY_MODE.AA?"AA付费":t==Constants.ROOM_PAY_MODE.creator?"房主付费":t==Constants.ROOM_PAY_MODE.other?e?"会长付费":"代开模式":"未知"},t.getTurnModeName=function(t){return t==Constants.ROOM_TIME_MODE.ba?"把":"圈"},t.getItemIconName=function(t){return t==Constants.Item_Type.DIAMOND?"icon_card_png":t==Constants.Item_Type.GOLD?"icon_gold_png":t==Constants.Item_Type.RMB?"icon_red_package_png":null},t}();t.ConstantUtils=e,__reflect(e.prototype,"game.ConstantUtils")}(game||(game={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,a){function i(i){e.call(a,i,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?i(n):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var EButton=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.buttonReleased=function(){t.prototype.buttonReleased.call(this),game.LogUtils.info("点击按钮----"),game.SoundService.getInstance().playAudio("game_button_click_mp3")
},e}(eui.Button);__reflect(EButton.prototype,"EButton"),window.EButton=EButton;var LocalStorage;!function(t){t.createRoomSet={RoomType:"RoomType",Score:"Score",PayMode:"PayMode",DaiKai:"DaiKai",turnMode:"turnMode",timeModeIndex:"timeModeIndex",HuaZa2:"HuaZa2",DNXBFaFen:"DNXBFaFen",JieZhuangBi:"JieZhuangBi",JieSuanLimit:"JieSuanLimit",countIndex:"countIndex",autoDiscard:"autoDiscard",baoMi:"baomi"},t.createRoomSetZhuanDan={PayMode:"PayModeZD",timeModeIndex:"zdTimeModeIndex"},t.createRoomSetFightThree={PayMode:"PayModeFT",timeModeIndex:"timeModeIndexFT",round:"round_FT",pot:"pot_FT",stuffyNum:"stuffyNum_FT",playType:"playType_FT",isShowPoker:"isShowPoker_FT"},t.createRoomSetBJ={PayMode:"PayModeBJ",timeModeIndex:"timeModeIndexBJ",hasTwoWang:"hasTwoWang",canThrowTile:"canThrowTile",hasPierSort:"hasPierSort",hasFirstShunQing:"hasFirstShunQing",hasSanQing:"hasSanQing",multiple:"multiple"},t.setting={GameDoubleClickType:"GameDoubleClickType",GameMusicOn:"GameMusicOn",GameEffectOn:"GameEffectOn",Card_back_index:"Card_back_index",Card_face_index:"Card_face_index",View_mode:"View_mode",Game_bg_index:"Game_bg_index",forbid_emotion:"forbid_emotion",forbid_voice:"forbid_voice",Flower_card_Visible:"Flower_card_Visible",Game_bg_frame:"Game_bg_frame",Sound_type:"Sound_type"},t.account={wxId:"wxUid",deviceId:"deviceUId",lastLoginId:"lastLoginId",lastLoginWxTime:"lastLoginWxTime",lastLoginVersion:"lastLoginVersionNumber",sexy:"gender",declare_login:"declare_login",declare_create_room:"declare_create_room",lastGameId:"lastGameId",sortByValue_BJ:"sortByValue_BJ"}}(LocalStorage||(LocalStorage={}));var SoundCost;!function(t){t.soundType={young:1,old:2},t.preload_cardCost=CardCost.Bamboo,t.soundData={},t.soundData[1]=[],t.soundData[2]={},t.soundData[1][t.soundType.young]={},t.soundData[1][t.soundType.old]={},t.soundData[2][t.soundType.young]={},t.soundData[2][t.soundType.old]={},t.soundData[1][1][CardCost.Character[1]]=2,t.soundData[1][1][CardCost.Character[2]]=4,t.soundData[1][1][CardCost.Character[3]]=1,t.soundData[1][1][CardCost.Character[4]]=1,t.soundData[1][1][CardCost.Character[5]]=1,t.soundData[1][1][CardCost.Character[6]]=2,t.soundData[1][1][CardCost.Character[7]]=1,t.soundData[1][1][CardCost.Character[8]]=3,t.soundData[1][1][CardCost.Character[9]]=1,t.soundData[1][2][CardCost.Character[1]]=2,t.soundData[1][2][CardCost.Character[2]]=3,t.soundData[1][2][CardCost.Character[3]]=1,t.soundData[1][2][CardCost.Character[4]]=1,t.soundData[1][2][CardCost.Character[5]]=1,t.soundData[1][2][CardCost.Character[6]]=2,t.soundData[1][2][CardCost.Character[7]]=1,t.soundData[1][2][CardCost.Character[8]]=3,t.soundData[1][2][CardCost.Character[9]]=1,t.soundData[2][1][CardCost.Character[1]]=2,t.soundData[2][1][CardCost.Character[2]]=3,t.soundData[2][1][CardCost.Character[3]]=1,t.soundData[2][1][CardCost.Character[4]]=1,t.soundData[2][1][CardCost.Character[5]]=1,t.soundData[2][1][CardCost.Character[6]]=2,t.soundData[2][1][CardCost.Character[7]]=1,t.soundData[2][1][CardCost.Character[8]]=3,t.soundData[2][1][CardCost.Character[9]]=1,t.soundData[2][2][CardCost.Character[1]]=2,t.soundData[2][2][CardCost.Character[2]]=3,t.soundData[2][2][CardCost.Character[3]]=1,t.soundData[2][2][CardCost.Character[4]]=1,t.soundData[2][2][CardCost.Character[5]]=1,t.soundData[2][2][CardCost.Character[6]]=2,t.soundData[2][2][CardCost.Character[7]]=1,t.soundData[2][2][CardCost.Character[8]]=3,t.soundData[2][2][CardCost.Character[9]]=1,t.soundData[1][1][CardCost.Bamboo[1]]=3,t.soundData[1][1][CardCost.Bamboo[2]]=2,t.soundData[1][1][CardCost.Bamboo[3]]=2,t.soundData[1][1][CardCost.Bamboo[4]]=2,t.soundData[1][1][CardCost.Bamboo[5]]=3,t.soundData[1][1][CardCost.Bamboo[6]]=2,t.soundData[1][1][CardCost.Bamboo[7]]=2,t.soundData[1][1][CardCost.Bamboo[8]]=2,t.soundData[1][1][CardCost.Bamboo[9]]=1,t.soundData[1][2][CardCost.Bamboo[1]]=3,t.soundData[1][2][CardCost.Bamboo[2]]=2,t.soundData[1][2][CardCost.Bamboo[3]]=2,t.soundData[1][2][CardCost.Bamboo[4]]=2,t.soundData[1][2][CardCost.Bamboo[5]]=3,t.soundData[1][2][CardCost.Bamboo[6]]=2,t.soundData[1][2][CardCost.Bamboo[7]]=2,t.soundData[1][2][CardCost.Bamboo[8]]=2,t.soundData[1][2][CardCost.Bamboo[9]]=1,t.soundData[2][1][CardCost.Bamboo[1]]=3,t.soundData[2][1][CardCost.Bamboo[2]]=2,t.soundData[2][1][CardCost.Bamboo[3]]=2,t.soundData[2][1][CardCost.Bamboo[4]]=2,t.soundData[2][1][CardCost.Bamboo[5]]=3,t.soundData[2][1][CardCost.Bamboo[6]]=2,t.soundData[2][1][CardCost.Bamboo[7]]=2,t.soundData[2][1][CardCost.Bamboo[8]]=2,t.soundData[2][1][CardCost.Bamboo[9]]=1,t.soundData[2][2][CardCost.Bamboo[1]]=3,t.soundData[2][2][CardCost.Bamboo[2]]=2,t.soundData[2][2][CardCost.Bamboo[3]]=2,t.soundData[2][2][CardCost.Bamboo[4]]=2,t.soundData[2][2][CardCost.Bamboo[5]]=3,t.soundData[2][2][CardCost.Bamboo[6]]=2,t.soundData[2][2][CardCost.Bamboo[7]]=2,t.soundData[2][2][CardCost.Bamboo[8]]=2,t.soundData[2][2][CardCost.Bamboo[9]]=1,t.soundData[1][1][CardCost.Dot[1]]=2,t.soundData[1][1][CardCost.Dot[2]]=3,t.soundData[1][1][CardCost.Dot[3]]=2,t.soundData[1][1][CardCost.Dot[4]]=3,t.soundData[1][1][CardCost.Dot[5]]=2,t.soundData[1][1][CardCost.Dot[6]]=1,t.soundData[1][1][CardCost.Dot[7]]=2,t.soundData[1][1][CardCost.Dot[8]]=4,t.soundData[1][1][CardCost.Dot[9]]=2,t.soundData[1][2][CardCost.Dot[1]]=2,t.soundData[1][2][CardCost.Dot[2]]=3,t.soundData[1][2][CardCost.Dot[3]]=2,t.soundData[1][2][CardCost.Dot[4]]=3,t.soundData[1][2][CardCost.Dot[5]]=2,t.soundData[1][2][CardCost.Dot[6]]=1,t.soundData[1][2][CardCost.Dot[7]]=2,t.soundData[1][2][CardCost.Dot[8]]=4,t.soundData[1][2][CardCost.Dot[9]]=2,t.soundData[2][1][CardCost.Dot[1]]=2,t.soundData[2][1][CardCost.Dot[2]]=3,t.soundData[2][1][CardCost.Dot[3]]=2,t.soundData[2][1][CardCost.Dot[4]]=3,t.soundData[2][1][CardCost.Dot[5]]=2,t.soundData[2][1][CardCost.Dot[6]]=1,t.soundData[2][1][CardCost.Dot[7]]=2,t.soundData[2][1][CardCost.Dot[8]]=4,t.soundData[2][1][CardCost.Dot[9]]=2,t.soundData[2][2][CardCost.Dot[1]]=2,t.soundData[2][2][CardCost.Dot[2]]=3,t.soundData[2][2][CardCost.Dot[3]]=2,t.soundData[2][2][CardCost.Dot[4]]=3,t.soundData[2][2][CardCost.Dot[5]]=2,t.soundData[2][2][CardCost.Dot[6]]=1,t.soundData[2][2][CardCost.Dot[7]]=2,t.soundData[2][2][CardCost.Dot[8]]=4,t.soundData[2][2][CardCost.Dot[9]]=2,t.soundData[1][1][CardCost.Wind.east]=2,t.soundData[1][1][CardCost.Wind.south]=3,t.soundData[1][1][CardCost.Wind.west]=4,t.soundData[1][1][CardCost.Wind.north]=2,t.soundData[2][1][CardCost.Wind.east]=3,t.soundData[2][1][CardCost.Wind.south]=3,t.soundData[2][1][CardCost.Wind.west]=4,t.soundData[2][1][CardCost.Wind.north]=2,t.soundData[1][2][CardCost.Wind.east]=2,t.soundData[1][2][CardCost.Wind.south]=3,t.soundData[1][2][CardCost.Wind.west]=3,t.soundData[1][2][CardCost.Wind.north]=2,t.soundData[2][2][CardCost.Wind.east]=2,t.soundData[2][2][CardCost.Wind.south]=3,t.soundData[2][2][CardCost.Wind.west]=4,t.soundData[2][2][CardCost.Wind.north]=2,t.soundData[1][1][CardCost.other.buHua]=4,t.soundData[1][1][CardCost.other.pong]=4,t.soundData[1][1][CardCost.other.kong]=1,t.soundData[1][1][CardCost.other.win]=1,t.soundData[1][1][CardCost.other.kongWin]=1,t.soundData[1][1][CardCost.other.tianHu]=1,t.soundData[1][1][CardCost.other.diHu]=1,t.soundData[1][1][CardCost.other.ziMo]=1,t.soundData[2][1][CardCost.other.buHua]=4,t.soundData[2][1][CardCost.other.pong]=3,t.soundData[2][1][CardCost.other.kong]=1,t.soundData[2][1][CardCost.other.win]=1,t.soundData[2][1][CardCost.other.kongWin]=1,t.soundData[2][1][CardCost.other.tianHu]=1,t.soundData[2][1][CardCost.other.diHu]=1,t.soundData[2][1][CardCost.other.ziMo]=1,t.soundData[1][2][CardCost.other.buHua]=4,t.soundData[1][2][CardCost.other.pong]=3,t.soundData[1][2][CardCost.other.kong]=1,t.soundData[1][2][CardCost.other.win]=1,t.soundData[1][2][CardCost.other.kongWin]=1,t.soundData[1][2][CardCost.other.tianHu]=1,t.soundData[1][2][CardCost.other.diHu]=1,t.soundData[1][2][CardCost.other.ziMo]=1,t.soundData[2][2][CardCost.other.buHua]=4,t.soundData[2][2][CardCost.other.pong]=3,t.soundData[2][2][CardCost.other.kong]=1,t.soundData[2][2][CardCost.other.win]=1,t.soundData[2][2][CardCost.other.kongWin]=1,t.soundData[2][2][CardCost.other.tianHu]=1,t.soundData[2][2][CardCost.other.diHu]=1,t.soundData[2][2][CardCost.other.ziMo]=1}(SoundCost||(SoundCost={}));var Strings;!function(t){t.dismissRoom="开局前解散房间不会消耗钻石，是否解散房间",t.dismissRoom_timeOut="房间超时,系统将自动解散",t.dismissRoom_leave="因你长时间没有回来，你已自动离开牌桌",t.dismissRoom_daikai="很遗憾，房主解散了当前房间",t.dismissRoom_master="很遗憾，房主解散了当前房间",t.dismissRoom_xieshang="玩家协商解散了当前房间",t.dismissRoom_gameOver="牌局已结束",t.dismissRoom_other="房间已解散或者牌局已结束",t.roomNotExist="您输入的房间号不存在，请重新输入，谢谢！",t.funcNotOpen="亲，功能暂未开放，请耐心等待",t.noRoomCard="您的钻石不足，请充值",t.createRoomFail="创建房间失败",t.logingRoomFail="登录失败",t.joinRoomFail="加入房间失败",t.backRoomFangzhu="返回大厅房间仍会保留，快去邀请大伙来玩吧",t.backRoomJoin="是否退出房间",t.connectGameFail="连接游戏服务器失败",t.connectLoginFail="连接登录服务器失败",t.buyOk="购买成功！",t.heartLost="您的游戏已经断开连接，游戏退到大厅！",t.tuiGuangFailed="绑定失败，请重新绑定",t.tuiGuangFailOne="您输入的邀请码错误，请重新输入",t.tuiGuangFailTwo="出现未知导致绑定失败，请重新绑定",t.tuiGuangFailThree="您已领取过，无法再次绑定",t.tuiGuangSuccess="绑定成功，恭喜你获得钻石*50",t.buyFail="购买失败！",t.getShopListFailed="获取商店信息失败！",t.notopen="该功能暂未开通",t.buyCancel="取消支付",t.reconnect="你上把牌局还未结束，请点击确定自动进入",t.changeAccount="是否注销当前账号",t.exitRoom="你确定要离开房间吗？",t.enterRoom="你已在房间中，不能加入别的房间，是否返回到房间中?",t.offline="哎呀，网络出现问题了，是否尝试重新连接",t.roomNumberNotExist="房间不存在",t.roomHasNotExistInGame="当前牌局已结束，可前往战绩查看详情",t.roomPlayerFull="房间人员已满",t.roomNumberError="房间号错误",t.roomhasJiesan="房间已解散",t.InRoom="你当前已经在房间中",t.networkConnectionsError="当前网络不可用，如果继续，请先设置网络！",t.roomJiesan="由于长时间没有进入房间，房间已解散",t.noWeixin="当前手机不支持微信，请检查是否安装微信",t.WeixinLoginFailed="微信登陆授权失败",t.WeixinCancelLogin="取消登陆",t.outCardError="报听后只能出最后一张",t.copyToClipboardSuccess="复制成功",t.failedGetGameConfig="游戏配置获取失败",t.hasPlayerLeave="有玩家离开，牌局结束，将自动返回大厅",t.tooShortVoice="您的录音长度太短",t.noEmail="暂时没有邮件",t.selectEmail="请选择一封邮件",t.checkVersionFailed="检测更新信息失败，请检查您的网络是否可用",t.receiveSuccess="领取成功",t.getEmailFailed="拉取邮件列表失败",t.tooShortTime="您的操作太频繁",t.exitAppConfirm="是否确认退出游戏?",t.shareFailed="分享失败",t.shareFailedAppNotExist="请先安装应用[%s]",t.shareSuccess="分享成功",t.shareCancel="取消分享",t.invalidOperate="用户非法操作",t.hasInRoomWhenCreateRoom="你已经在{0}房间中,不能创建房间",t.quitReplayerInfo="确认退出当前回放么?",t.replayOver="回放已结束",t.daikaiBeMaxNum="代开房间数已达到上限",t.loginFailed="登陆已失效，请重新登陆",t.onlyCreatOtherPayMode="当前只能创建代开房间",t.mailAttachSuccess="领取成功",t.createRoomParamsError="创建房间参数错误",t.hasInRoomWhenJoinRoom="你已经在房间中,不能加入房间",t.getShareInfoFailed="获取邀请信息失败",t.getShareRewardFailed="领取奖励失败",t.changePlayerNumFailed="当前有用户为老版本，不支持三人麻将",t.changePlayerNumRepeat="当前已是3人房，不需要重复申请",t.goldNotEnough="金币不足",t.fobidLogin="当前账号已限制登陆，详情请联系客服微信号：%s",t.getActivityInfoFailed="获取活动信息失败",t.applyThreePlayer="是否确认要申请3人麻将?",t.taskRewardHasGet="您已领取过奖励",t.redPacketNumNotEnoughError="系统检测到你有刷单嫌疑，如有疑问请加申诉微信号：%s",t.redPacketPlayerNotValidError="系统检测到你有刷单嫌疑，如有疑问请加申诉微信号：%s",t.addTurntableTimes="次数不足，赢得大玩家可以获得抽奖次数,是否前往创建房间?",t.TurntableTimesNoEnough="次数不足，今日抽奖次数花光啦",t.RedPacketOverTime="红包已超时失效",t.activityOver="活动已结束",t.downloadZhuanDanTint="是否立即下载转蛋？",t.downloadFightThreeTint="是否立即下载拼三张？",t.updateZhuanDanTint="是否立即更新转蛋？",t.updateFightThree="是否立即更新拼三张？",t.downloadBijiTint="是否立即下载比鸡？",t.updateBijiTint="是否立即更新比鸡？",t.hotupdateFailed="热更新失败,是否重新下载",t.declare_not_selected="请确认及勾选同意服务条款，即可进入游戏",t.replayDataError="数据出错，暂时不能回放",t.downloadZhuanDanInGameTint="你正在加入到转蛋游戏中，请点击确认开始加载游戏!",t.updateZhuanDanInGameTint="转蛋有新的更新，请点击确认下载最新版本！",t.downloadFightThreeInGameTint="你正在加入到拼三张游戏中，请点击确认开始加载游戏!",t.updateFightThreeInGameTint="拼三张有新的更新，请点击确认下载最新版本！",t.downloadBijiInGameTint="你正在加入到比鸡游戏中，请点击确认开始加载游戏!",t.updateBijiInGameTint="比鸡有新的更新，请点击确认下载最新版本！",t.onlyCreateMajiongGame="当前只能创建麻将房间",t.proxyIdCannotBeNull="邀请ID不能为空",t.purchaseErrorNeedBindProxy="您当前还未绑定代理，请联系客服(官方客服微信号:%s)",t.bind_no_proxy="您绑定的代理游戏ID不存在",t.bind_has_proxy="您已经绑定代理",t.save_pic_success="保存成功",t.save_pic_failed="保存失败",t.gameNotLauncher="%s正在维护中，暂时无法进入",t.smsCode_invalid="验证码已失效，请重新获取",t.club_error_already_joined="您已经加入了俱乐部",t.club_error_already_rejected="请勿重复操作",t.club_error_cant_operate="您没有操作的权限",t.club_error_cant_kick_self="您不能把自己踢出俱乐部",t.club_error_cant_exit="会长不能退出俱乐部",t.club_error_not_joined_club="您尚未加入俱乐部",t.club_error_already_passed="请勿重复操作",t.club_error_not_proxy="需要成为代理，才能创建俱乐部，请联系招商客服：%s 申请成为代理",t.club_error_club_ID_not_exists="该俱乐部不存在",t.club_error_replay_code_not_exists="回放码不存在",t.club_forbid_game="你被禁止加入游戏，如有疑问请联系会长或管理员",t.club_error_bless_score_limit="您当前的体力不足",t.club_rule_delete_tips="确认要删除当前玩法吗？",t.chatText=["来来来，带快点带快点","你这么打会没朋友的","真是有钱难买左膀子对哦","手气不错，今天又是个发财的日子","不急不慌，后面还有老鳖汤","归归，宝庆银楼真精哦","哎呀！打错牌了，说不定错打错成"],t.chatText_standard=["快点啊，都等得我花都谢了","高手啊，厉害，甘拜下风","这牌有点坑爹啊","这一把又有好戏看咯","高手玩牌，讲究的就是一个范","手气这么好，你咋不上天呢","小宇宙要爆发了，好戏在后头"]}(Strings||(Strings={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){var a=t.call(this)||this;return a.floatingWindowView=null,a.noSleep=null,e.instance=a,a.uiToScreenCenter(),a.addEventListener(egret.Event.ADDED_TO_STAGE,a.onAddToStage,a),a}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),document.addEventListener("visibilitychange",function(){if(console.log("document.hidden"+document.hidden),document.hidden)game.EAppFacade.getInstance().sendNotification(game.GameCmd.onPause);else{game.EAppFacade.getInstance().sendNotification(game.GameCmd.onResume);for(var t=document.querySelectorAll(".egret-player"),e=t.length,a=0;e>a;a++){var i=t[a],n=i["egret-player"],o=n.webInput;o.disconnectStageText(o._stageText)}}}),this.init(),this.assetAdapter=new AssetAdapter,egret.registerImplementation("eui.IAssetAdapter",this.assetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.stage.addEventListener(egret.Event.RESIZE,this.onScreenReSize,this),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.init=function(){function t(t,e,a){if(GameConfig.isDebug){var i="";i+="Error: "+t+"\n",i+="Line: "+a+"\n",i+="Url: "+e+"\n",alert(i)}return!0}egret.ImageLoader.crossOrigin="anonymous",console.log("-----------egret.Capabilities.runtimeType:"+egret.Capabilities.runtimeType),egret.Capabilities.runtimeType==egret.RuntimeType.WXGAME?GameConfig.platform==GameConfig.PLATFORM_SET.weChat:egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&GameConfig.platform==GameConfig.PLATFORM_SET.H5,this.sceneLayer=this.createGroup(),this.addChild(this.sceneLayer),this.toastLayer=this.createGroup(),this.toastLayer.touchThrough=!0,this.addChild(this.toastLayer),this.confirmDialogLayer=this.createGroup(),this.addChild(this.confirmDialogLayer),this.initScreenOn(),this.floatingWindowLayer=this.createGroup(),this.floatingWindowLayer.touchThrough=!0,this.addChild(this.floatingWindowLayer),window.addEventListener("message",function(t){var e=t.data;1==e.type&&(console.log("最顶消息"),window.top.location.href="weixin://")}),game.TimerManager.getInstance().start(),window.onerror=t},e.prototype.initScreenOn=function(){var t=this;if(GameConfig.keepScreenOn||GameConfig.platform!=GameConfig.PLATFORM_SET.H5){null==this.noSleep&&(this.noSleep=new NoSleep),this.fullScreenGroup=new eui.Group;var e=new eui.Rect;e.fillColor=0,e.alpha=0;var a=1560,i=GameConfig.windowHeight_h5+2*GlobalData.deltaY;e.width=a,e.height=i,e.x=(GameConfig.ScreenW-a)/2,e.y=(GameConfig.ScreenH-i)/2,this.fullScreenGroup.touchThrough=!0,this.fullScreenGroup.touchChildren=!1,e.touchEnabled=!1,this.fullScreenGroup.addChild(e),this.addChild(this.fullScreenGroup),this.fullScreenGroup.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){t.fullScreenGroup.visible=!1,egret.Capabilities.isMobile&&t.noSleep.enable()},this),egret.Capabilities.isMobile||(this.fullScreenGroup.visible=!1)}},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e,a,i;return __generator(this,function(n){switch(n.label){case 0:return console.log("-----------runGame start"),GameConfig.isDebug,[4,platform.getLaunchOptionsSync()];case 1:return t=n.sent(),[4,platform.setKeepScreenOn()];case 2:return n.sent(),[4,this.loadResource()];case 3:return n.sent(),this.floatingWindowView=new game.floatingWindow,this.floatingWindowLayer.addChild(this.floatingWindowView),[4,platform.getSystemInfo()];case 4:return e=n.sent(),a=e.windowWidth*e.pixelRatio,i=e.windowHeight*e.pixelRatio,GameConfig.windowWidth=a,GameConfig.windowHeight=i,GameConfig.pixelRatio=e.pixelRatio,this.initService(),GameConfig.platform==GameConfig.PLATFORM_SET.weChat?game.SceneSkip.skipToLoginScene():game.SceneSkip.skipToLoadinScene(),[2]}})})},e.prototype.initService=function(){game.UserInfoService.getInstance(),game.GlobalService.init()},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,a){var i=new eui.Theme("resource/default.thm.json?v="+GameConfig.version,t.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,7,,8]),console.log("-----------loadResource start"),GameConfig.platform!=GameConfig.PLATFORM_SET.H5?[3,2]:(console.log("-----------loadResource H5"),[4,RES.loadConfig("resource/default.res.json?v="+GameConfig.version,"resource/")]);case 1:return e.sent(),[3,4];case 2:return GameConfig.platform!=GameConfig.PLATFORM_SET.weChat?[3,4]:(console.log("-----------loadResource weChat"),[4,RES.loadConfig("default.res.json?v="+GameConfig.version,"https://res.qixiyx.cn/file/mahjong_client_egret_new_wxgame_remote/resource/")]);case 3:e.sent(),e.label=4;case 4:return[4,this.loadTheme()];case 5:return e.sent(),[4,RES.loadGroup("preload",0)];case 6:return e.sent(),document.getElementById("preloading").style.display="none",console.log("-----------loadResource finish"),[3,8];case 7:return t=e.sent(),console.error(t),[3,8];case 8:return[2]}})})},e.prototype.createGroup=function(){var t=new eui.Group;return t},e.prototype.onScreenReSize=function(t){this.uiToScreenCenter(),game.EAppFacade.getInstance().sendNotification(Constants.EVENT_STAGE_VIEW_SIZE_CHANGED)},e.prototype.uiToScreenCenter=function(){var t=egret.MainContext.instance.stage.stageWidth,a=egret.MainContext.instance.stage.stageHeight;if(a>t){var i=a;a=t,t=i}GameConfig.windowWidth_h5=t,GameConfig.windowHeight_h5=a;var n=egret.Capabilities.boundingClientWidth/egret.Capabilities.boundingClientHeight,o=GameConfig.ScreenW/GameConfig.ScreenH,s=0,r=0;if(n>=o){var l=GameConfig.ScreenH*egret.Capabilities.boundingClientWidth/egret.Capabilities.boundingClientHeight;s=(l-GameConfig.ScreenW)/2,egret.MainContext.instance.stage.scaleMode=egret.StageScaleMode.FIXED_HEIGHT}else{var c=GameConfig.ScreenW*egret.Capabilities.boundingClientHeight/egret.Capabilities.boundingClientWidth;r=(c-720)/2,egret.MainContext.instance.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH}GlobalData.deltaX=s,GlobalData.deltaY=r,e.instance.x=s,e.instance.y=r,null!=this.floatingWindowView&&this.floatingWindowView.reSet(),game.FixUIManager.getInstance().setOffX(Math.min(Math.abs(s),140))},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var GlobalData;!function(t){function e(e){if(null!=e)for(var a=0;a<e.length;a++){var i=e[a].infoKey,n=e[a].infoValue;t.clientConfigs[i]=n}}function a(e){t.isReconnecting=e}function i(){return t.gameData}function n(t){var e="麻将";return t==Constants.MINI_GAME_ID_SET.biji?e="比鸡":t==Constants.MINI_GAME_ID_SET.zhuandan?e="转蛋":t==Constants.MINI_GAME_ID_SET.fightThree&&(e="拼三张"),e}function o(e){return"undefined"==typeof e||"undefined"==typeof t.clientConfigs.combatUrlNew||null==e||null==t.clientConfigs.combatUrlNew?"":Utils.format("{0}{1}.html?roomId={2}",t.clientConfigs.combatUrlNew,e,e)}function s(){var e="",a=t.clientConfigs.sharedUrl.indexOf("?");return e=-1!=a?Utils.format("{0}&inviteCode={1}",t.clientConfigs.sharedUrl,t.userData.getUserId()):Utils.format("{0}?inviteCode={1}",t.clientConfigs.sharedUrl,t.userData.getUserId())}function r(e){var a="",i=t.clientConfigs.sharedUrl.indexOf("?");return a=-1!=i?Utils.format("{0}&id={1}&inviteCode={2}",t.clientConfigs.sharedJoinRoomUrl,e,t.userData.getUserId()):Utils.format("{0}?id={1}&inviteCode={2}",t.clientConfigs.sharedJoinRoomUrl,e,t.userData.getUserId())}function l(t){var e=Utils.format("{0}?clubId={1}",game.GameHttpConst.inviteToClubURL,t);return e}t.gameData=new game.GameData,t.userData=new game.UserInfo,t.platformRoomNumber=0,t.isReconnecting=!1,t.firstInGame=!1,t.onlightFlag=!1,t.curGameID=Constants.GAME_ID_SET.nanjing,t.deltaX=0,t.deltaY=0,t.msgQueue=[],t.clientConfigs={customer_info:"qhuaimj",weixin_mp_name:"情怀南京麻将",investment_info:"qhuaimj",functionInfos:null,red_bag_customer_info:"qhuaimj",red_bag_appeal_info:"qhuaimj",worldcup:"1",showCreateRoom:"1",showClubRoom:"0",combatUrlNew:"",sharedUrl:"",sharedJoinRoomUrl:""},t.initClientConfigInfo=e,t.setReconnecting=a,t.getCurGameData=i,t.getMiniGameName=n,t.getSettleInfoUrl=o,t.getShareUrlWithShareCode=s,t.getShareJoinRoomUrlWithShareCode=r,t.getInviteToClubUrlWithShareCode=l}(GlobalData||(GlobalData={}));var game;!function(t){var e=function(){function t(){this.handCards=[1,1,1,1,1,1,1,1,1,1,1,1,1],this.outCards=[],this.pongKongCards=[],this.huaCards=[],this.jiapaiId=-1,this._isTing=!1,this.huaNum=0,this.jiapaiValue=0}return t.prototype.isTing=function(){return this._isTing},t.prototype.setTing=function(t){this._isTing=t},t.prototype.setJiaPaiValue=function(t){this.jiapaiValue=t},t.prototype.getJiaPaiValue=function(){return this.jiapaiValue},t.prototype.setPongKongCards=function(t){this.pongKongCards=t},t.prototype.getPongKongCards=function(){return this.pongKongCards},t.prototype.addPongKongData=function(t){this.pongKongCards.push(t)},t.prototype.getPongKongNum=function(){return this.pongKongCards.length},t.prototype.getPongKongTotalCardNum=function(){return 3*this.getPongKongNum()},t.prototype.getDrawCardIndex=function(){return GameConst.perPlayerTotalCardNum-this.getPongKongTotalCardNum()},t.prototype.getDiscardNum=function(){return this.outCards.length},t.prototype.getPlayerOutCards=function(){return this.outCards},t.prototype.setPlayerOutCards=function(t){this.outCards=t},t.prototype.addOutCard=function(t){this.outCards.push(t)},t.prototype.removeOutCard=function(t){this.outCards.splice(t,1)},t.prototype.getOutCardNum=function(){return this.outCards.length},t.prototype.setHuaNum=function(t){this.huaNum=t},t.prototype.getHuaNum=function(){return this.huaNum},t.prototype.getPlayerHuaCards=function(){return this.huaCards},t.prototype.setPlayerHuaCards=function(t){this.huaCards=t},t.prototype.removeHandsCard=function(t){this.handCards.splice(t,1)},t.prototype.getHandCardsNum=function(){return this.handCards.length},t.prototype.setPlayerHandCards=function(t){this.handCards=t},t.prototype.getPlayerHandCards=function(){return this.handCards},t.prototype.clear=function(){this.huaCards=[],this.handCards=[],this.outCards=[],this.pongKongCards=[],this.jiapaiValue=0},t}();t.PlayerCardData=e,__reflect(e.prototype,"game.PlayerCardData")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cardData=null,e.chairId=0,e.status=null,e.score=0,e.fanfen=0,e.totalWaibao=0,e.isRoomCreator=!1,e.detailAddress="",e.userFill=0,e.readyStatus=0,e.autoDiscardOfDelay=!1,e}return __extends(e,t),e.prototype.isAutoDiscardOfDelay=function(){return this.autoDiscardOfDelay},e.prototype.setAutoDiscardOfDelay=function(t){this.autoDiscardOfDelay=t},e.prototype.setDetailAddress=function(t){this.detailAddress=t},e.prototype.getDetailAddress=function(){return this.detailAddress},e.prototype.setScore=function(t){this.score=t},e.prototype.getScore=function(){return this.score},e.prototype.setReadyStatus=function(t){this.readyStatus=t},e.prototype.getReadyStatus=function(){return this.readyStatus},e.prototype.setStatus=function(t){this.status=t},e.prototype.getStatus=function(){return this.status},e.prototype.setChairId=function(t){this.chairId=t},e.prototype.getChairId=function(){return this.chairId},e.prototype.isBanker=function(){return this.chairId==GlobalData.gameData.getBankerChairId()},e.prototype.parse=function(t){var e=t.chairId;this.setChairId(e);var a=t.userStatus;this.setStatus(a);var i=t.readyStatus;this.setReadyStatus(i);var n=t.msgUser,o=n.ip;this.setIP(o);var s=n.userId;this.setUserId(s);var r=n.gender;this.setGender(r);var l=n.headImgUrl;this.setHeadIMGUrl(l);var c=n.nickName;this.setUserName(c);var h=t.detailAddress;this.setDetailAddress(h);var u=t.score;this.setScore(u);var d=t.faScore;this.fanfen=d;var m=t.waiBaoScore;this.totalWaibao=m;var p=t.autoHost;this.setAutoDiscardOfDelay(p)},e.prototype.setCardData=function(t){this.cardData=t},e.prototype.getCardData=function(){return this.cardData},e.prototype.clearCardData=function(){null!=this.cardData&&this.cardData.clear(),this.cardData=null},e}(t.BaseUserInfo);t.PlayerInfo=e,__reflect(e.prototype,"game.PlayerInfo")}(game||(game={}));var game;!function(t){var e=function(){function t(t){this.setType(t.type),this.setProvideClientId(t.provideClientId),this.setValue(t.value),this.setStutre(t.waiBaoStatus)}return t.prototype.setStutre=function(t){this.WBStutre=t},t.prototype.getStutre=function(){return this.WBStutre},t.prototype.setType=function(t){this.type=t},t.prototype.getType=function(){return this.type},t.prototype.setProvideClientId=function(t){this.provideClientId=t},t.prototype.getProvideClientId=function(){return this.provideClientId},t.prototype.setValue=function(t){this.value=t},t.prototype.getValue=function(){return this.value},t}();t.PongKongData=e,__reflect(e.prototype,"game.PongKongData")}(game||(game={}));var EMarqueeText=function(t){function e(){var e=t.call(this)||this;return e.scrollSpeed=30,e.text="",e.addEventListener(eui.UIEvent.COMPLETE,e.onSelfViewComplete,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.clean,e),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.onSelfViewComplete=function(){console.log("ffff")},e.prototype.init=function(){this.touchEnabled=!0,this.label=new eui.Label,this.label.x=0,this.label.y=0,this.label.touchEnabled=!1,this.addChild(this.label),this.mask=new egret.Rectangle(0,0,this.width,this.height)},e.prototype.start=function(t){console.log("marquee text == "+t),this.text=t,this.label.text=this.text,null==this._timer&&(this._timer=new egret.Timer(this.scrollSpeed),this._timer.addEventListener(egret.TimerEvent.TIMER,this.update,this)),this._timer.running&&this._timer.stop(),this.label.width>this.width?(this.resetX(),this._timer.start()):this.label.x=(this.width-this.label.width)/2},e.prototype.setTextSize=function(t){this.label.size=t},e.prototype.setTextColor=function(t){this.label.textColor=t},e.prototype.resetX=function(){this.label.x=this.width+20},e.prototype.update=function(){this.label.x=this.label.x-2,this.label.x+this.label.width<0&&this.resetX()},e.prototype.clean=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clean,this),null!=this._timer&&(this._timer.stop(),this._timer=null),this.removeChild(this.label),this.label=null},e}(eui.Group);__reflect(EMarqueeText.prototype,"EMarqueeText"),window.EMarqueeText=EMarqueeText;var ERadioButton=function(t){function e(){var e=t.call(this)||this;return e.selected=!1,e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.rect,this.onThisClick)},e.prototype.onThisClick=function(){this.setSelected(!this.selected)},e.prototype.setSelected=function(t){this.selected=t,this.imgOn.visible=this.selected},e.prototype.isSelected=function(){return this.selected},e.prototype.setText=function(t){this.labelText.text=t},e.prototype.setFontFamily=function(t){this.labelText.fontFamily=t},e.prototype.setFontSize=function(t){this.labelText.size=t},e.prototype.setFontColor=function(t){this.labelText.textColor=t},e}(game.EComponent);__reflect(ERadioButton.prototype,"ERadioButton"),window.ERadioButton=ERadioButton;var ClubConst;!function(t){t.MemberType={MONITOR:0,ADMIN:1,MEMBER:2,MONITOR2:3},t.PermissionType={Key_roomRules:"roomRules",Key_memberManager:"memberManage",Key_editNotice:"editNotice",Key_cancelRoom:"cancelRoom",Key_divideManage:"divideManage",key_record:"calManage",Key_blessManage:"blessManage",Key_operLog:"operLog",Key_oppartber:"oppartber"},t.PermissionTypes=[t.PermissionType.Key_roomRules,t.PermissionType.Key_memberManager,t.PermissionType.Key_editNotice,t.PermissionType.Key_cancelRoom,t.PermissionType.Key_divideManage,t.PermissionType.key_record,t.PermissionType.Key_blessManage,t.PermissionType.Key_operLog,t.PermissionType.Key_oppartber],t.MemberCheckStatus={UNCHECK:0,PASSED:1,UNPASS:2,THROW:3},t.RightType={EditNotice:1,CreateRoom:2,MemberSetting:3,SetMonitor2:4,SetManager:5,KickMember:6}}(ClubConst||(ClubConst={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,null,!1)||this;return t.gameType=GameConfig.gameID,t.skinName="resource/skins/club/createClubUI.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnCreate,this.clickCreate),this.editPhoneNumber.inputType=egret.TextFieldInputType.TEL,this.editPhoneNumber.restrict="0-9",this.gameType1.setText("麻将"),this.gameType1.setSelected(!0),this.addTapEvent(this.gameType1,this.clickGameTypeMJ),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_CREATE),this.createClubCallback,this)},a.prototype.updateUI_=function(){this.gameType1.setSelected(!1),this.gameType2.setSelected(!1),this.gameType3.setSelected(!1),this.gameType==GameConfig.gameID&&this.gameType1.setSelected(!0)},a.prototype.clickCreate=function(){var e=this.editClubName.text.trim(),a=Utils.getCharLen(e);if(a>12||0>a)return void t.CommonView.showToast("名称长度应该是1-6个文字");var i=this.editPhoneNumber.text.trim(),n=Utils.getCharLen(i);if(11!=n||!Utils.isNumbers(i))return void t.CommonView.showToast("手机号应该是11位的数字");var o=this.editInfo.text.trim();return o.trim().length<=0?void t.CommonView.showToast("请填写你的申请说明信息"):void t.ClubService.getInstance().createClub(this.gameType,e,i,o)},a.prototype.createClubCallback=function(e){var a=e.data;return a.code==t.CmdResultType.SUCCESS?(t.CommonView.showToast("已成功发送申请，请等待审核"),void this.close()):a.errorCode==t.MsgConstant.ERROR_club_UserIdIsNotDaiLi?void t.CommonView.showToast("需要先成为代理才可以创建俱乐部〜"):void 0},a.prototype.clickGameTypeMJ=function(){this.gameType=GameConfig.gameID,this.updateUI()},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_CREATE),this.createClubCallback,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubCreateDialog=e,__reflect(e.prototype,"game.ClubCreateDialog")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.selected=!1,this.watcherName="",this.autoMatch=!1,this.hideRoomUserInfo=!1,this.hideGameUserInfo=!1,this.superBlessSwitch=!1}return t.prototype.parse=function(t){this.gameId=t.gameId,this.clubId=t.clubId,this.clubName=t.name,this.onLineNum=t.onLineNum,this.allNum=t.allNum,this.hasShowRedTip=t.hasShowRedTip,this.noticeContent=t.pubContent,this.hasAutoCreate=t.hasAutoCreate,this.memberType=t.memberType,this.watcherName=t.watcherName,this.watcherIcon=t.watcherIcon,this.autoMatch=t.autoMatch,this.hideRoomUserInfo=t.hideRoomUserInfo,this.hideGameUserInfo=t.hideGameUserInfo,this.superBlessSwitch=t.superBlessSwitch,this.permissions=t.permissions},t}();t.ClubData=e,__reflect(e.prototype,"game.ClubData")
}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.clubData=t,a.skinName="resource/skins/club/clubItemSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.toggle,this.clickItem),this.updateUI()},a.prototype.setData=function(t){this.clubData=t,this.updateUI()},a.prototype.clickItem=function(){t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_ITEM,this.clubData)},a.prototype.updateUI_=function(){null!=this.clubData&&(this.toggle.selected=this.clubData.selected,this.labelClubName.text=this.clubData.clubName,this.labelClubMemberNum.text=this.clubData.onLineNum+"/"+this.clubData.allNum,this.labelGameName.text="麻将",this.imgSelfClub.visible=this.clubData.memberType==ClubConst.MemberType.MONITOR,this.imgRedTip.visible=this.clubData.hasShowRedTip,this.clubData.selected?(this.labelClubName.textColor=16777215,this.labelClubMemberNum.textColor=16777215):(this.labelClubName.textColor=8740668,this.labelClubMemberNum.textColor=8740668))},a}(t.EComponent);t.ClubItem=e,__reflect(e.prototype,"game.ClubItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.logListData=null,a.skinName="resource/skins/club/clubMemberHistories.exml",a.clubData=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,function(){a.close()}),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_get_operLog),this.getOperateLogBack,this);var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_get_operLog,{clubId:this.clubData.clubId});t.SocketManager.getInstance().send(i),this.initScroller()},a.prototype.getOperateLogBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.logListData=[],this.logListData=a.data.logList,this.updateUI())},a.prototype.updateUI_=function(){0==this.logListData.length?this.Text_not_histories.visible=!0:this.Text_not_histories.visible=!1,this.myScroller.setScrollerContent(this.logListData)},a.prototype.initScroller=function(){this.myScroller.setElementViewInfo(76,4),this.myScroller.setElementCreateFunction(this.createElement.bind(this)),this.myScroller.setElementUpdateDataFun(this.updateElement.bind(this)),this.myScroller.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(e){var a=new t.clubMemberHistoriesItem(this.clubData,e);return a},a.prototype.updateElement=function(t,e){t.setData(this.clubData,e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_get_operLog),this.getOperateLogBack,this)},a}(t.EDialog);t.clubMemberHistories=e,__reflect(e.prototype,"game.clubMemberHistories")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.logData=null,i.clubData=t,i.logData=a,i.skinName="resource/skins/club/clubMemberHistoriesItem.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.logData=e,this.updateUI()},a.prototype.updateUI_=function(){this.logData&&(this.info.text=""+t.DateUtils.dateFormat(this.logData.recordTime)+" "+this.logData.info)},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.clubMemberHistoriesItem=e,__reflect(e.prototype,"game.clubMemberHistoriesItem")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.skinName="resource/skins/club/clubMyRecordDataItem.exml",a.data=e,a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.setData=function(t){this.data=t,this.updateUI()},e.prototype.updateUI_=function(){this.Text_total_num.text=this.data.totalNum,this.Text_other_num.text=this.data.validNum,this.Text_time.text=this.data.curDate},e.prototype.clean=function(){t.prototype.clean.call(this)},e}(t.EComponent);t.ClubMyRecordDataItem=e,__reflect(e.prototype,"game.ClubMyRecordDataItem")}(game||(game={})),function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.skinName="resource/skins/club/clubMyRecordDataBox.exml",a.clubData=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_MY_RECORD_DATA),this.getMyRecordList,this);var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_MY_RECORD_DATA,{clubId:this.clubData.clubId});t.SocketManager.getInstance().send(i),this.addTapEvent(this.btnClose,function(){a.close()}),this.scroller.setElementViewInfo(64,4),this.scroller.setElementCreateFunction(function(e){var a=new t.ClubMyRecordDataItem(e);return a}),this.scroller.setElementUpdateDataFun(function(t,e){t.setData(e)}),this.scroller.setElementUpdateUIFun(function(t){t.updateUI()})},a.prototype.getMyRecordList=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&this.scroller.setScrollerContent(a.data.clubAgainsRecords)},a.prototype.updateUI_=function(){},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_MY_RECORD_DATA),this.getMyRecordList,this)},a}(t.EDialog);t.ClubMyRecordDataBox=e,__reflect(e.prototype,"game.ClubMyRecordDataBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a,i){var n=e.call(this,null,!1)||this;return n.canEdit=!1,n.clubId=t,n.notice=a,n.canEdit=i,n.skinName="resource/skins/club/clubNoticeShowSkin.exml",n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnOK,this.clickOK),this.addTapEvent(this.btnPublish,this.clickPublish),this.editNotice.touchEnabled=this.canEdit,this.editNotice.text=this.notice,this.btnOK.visible=!this.canEdit,this.btnClose.visible=this.canEdit,this.btnPublish.visible=this.canEdit,t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SENDNOTICE),this.publishNoticeCallback,this)},a.prototype.clickOK=function(){this.close()},a.prototype.clickPublish=function(){var e=this.editNotice.text.trim();t.ClubService.getInstance().publishNotice(this.clubId,e)},a.prototype.publishNoticeCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("发布公告成功"),this.close())},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SENDNOTICE),this.publishNoticeCallback,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubNoticeShowDialog=e,__reflect(e.prototype,"game.ClubNoticeShowDialog")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.parse=function(e){this.userId=e.userId,this.roomId=e.roomId,this.type=e.type;var a=e.msgDaiKai,i=new t.ClubRoomData;i.parse(a),this.clubRoomData=i},e}();t.ClubRoomInfoChangeInfo=e,__reflect(e.prototype,"game.ClubRoomInfoChangeInfo")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.SCENE_INDEX.CLUB)||this;return t.selectedClubData=null,t.rightTablePosY=[0,108,216,324,432],t.isShowOtherBelssNum=!1,t.skinName="resource/skins/club/clubSceneSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.labelWatchInfo.touchEnabled=!1,this.groupClubUI.visible=!1,this.noClubUI.visible=!1,this.addTapEvent(this.btnBack,this.clickBack),this.addTapEvent(this.btnInviteMember,this.clickInviteMember),this.addTapEvent(this.btnCreateClub,this.clickCreateClub),this.addTapEvent(this.btnJoinClub,this.clickJoinClub),this.addTapEvent(this.btnEditNotice,this.clickEditNotice),this.addTapEvent(this.btnRooms,this.clickRooms),this.addTapEvent(this.btnMembers,this.clickMembers),this.addTapEvent(this.btnApplyJoins,this.clickApplyJoins),this.addTapEvent(this.btnApplyHistory,this.clickLog),this.addTapEvent(this.btnCombatRecords,this.clickCombatRecords),this.addTapEvent(this.btnLuckyScore,this.clickLuckScore),this.addTapEvent(this.marqueeNotice,this.showNotice),this.addTapEvent(this.btnCreateTable,this.createRoom),this.addTapEvent(this.btnSearch,this.searchMember),this.addTapEvent(this.btnSetting,this.clickSetting),this.addTapEvent(this.btnSetWatcher,this.clickSetWatcher),this.addTapEvent(this.Button_divide,this.clickDivide),this.addTapEvent(this.Button_invite_member,function(){Utils.copyToClipboard(GlobalData.getInviteToClubUrlWithShareCode(a.selectedClubData.clubId)),t.DialogManager.getInstance().popUp2("复制成功，是否打开微信粘贴？",function(){Utils.callWxApp()})}),this.addTapEvent(this.Button_find_lucky_member_other,function(){var e=new t.ClubFindOtherMemeberLucky(a.getSelectedClubData());t.DialogManager.getInstance().show(e)}),this.addTapEvent(this.Button_lucky_member,function(){var e=new t.ClubLuckMemeberBox(a.getSelectedClubData(),a.isShowOtherBelssNum);t.DialogManager.getInstance().show(e)}),this.addTapEvent(this.Button_check_others_replay,function(){var e=new t.ViewReplayDialog;t.DialogManager.getInstance().show(e)}),this.addTapEvent(this.Button_partner_group,function(){var e=new t.ClubPartnerBox(a.getSelectedClubData(),a.getSelectedClubData().superBlessSwitch);t.DialogManager.getInstance().show(e)}),this.addTapEvent(this.Button_record_data,function(){var e=new t.ClubMyRecordDataBox(a.getSelectedClubData());t.DialogManager.getInstance().show(e)}),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_LIST),this.getClubListBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_ROOM_AUTOCREATE),this.getSwitchAutoTableBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLICK_CLUB_ITEM,this.clickClubItem,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLICK_CLUB_UpdateRedTip,this.updateRedTip,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLUB_UPDATE_BLESS_VALUE,this.updateBlessValue,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_NOTICE),this.updateNotice,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_setWatcher),this.watcherChange,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_myblessnum),this.getMyBlessNumb,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_MAMAGER_RIGHT),this.getOppartMgr,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLUB_REFRESH_BLESS_LIST,this.updateList,this),this.marqueeNotice.setTextColor(15921097),this.marqueeNotice.setTextSize(24),this.initScroller(),this.getClubList()},a.prototype.updateUI_=function(){var e=this.getSelectedClubData();if(null!=e){GameUtils.sub(this.labelWatchInfo,e.watcherName,140);var a=t.ClubService.getInstance().checkRight(e.permissions,ClubConst.PermissionType.Key_memberManager);this.btnApplyJoins.visible=a,this.btnCombatRecords.visible=!0,this.imgApplyRedTip.visible=e.hasShowRedTip,this.updateClubItems();var i=t.ClubService.getInstance().checkRight(e.permissions,ClubConst.PermissionType.Key_roomRules);this.btnCreateTable.visible=i,this.btnSetting.visible=i,this.btnSetWatcher.visible=t.ClubService.getInstance().checkRight(e.permissions,ClubConst.PermissionType.Key_memberManager),this.labelNotice.text=e.noticeContent,this.marqueeNotice.start(e.noticeContent),this.btnApplyHistory.visible=t.ClubService.getInstance().checkRight(e.permissions,ClubConst.PermissionType.Key_operLog);var n=t.ClubService.getInstance().checkRight(e.permissions,ClubConst.PermissionType.Key_editNotice);this.Button_lucky_member.visible=t.ClubService.getInstance().checkRight(e.permissions,ClubConst.PermissionType.Key_blessManage),this.Button_find_lucky_member_other.visible=t.ClubService.getInstance().checkRight(e.permissions,ClubConst.PermissionType.Key_blessManage),this.btnEditNotice.visible=n,this.noClubUI.visible=!1,this.groupClubUI.visible=!0,this.btnLuckyScore.visible=e.superBlessSwitch}else this.btnCreateTable.visible=!1,this.noClubUI.visible=!0,this.groupClubUI.visible=!1},a.prototype.updateClubList=function(){this.scrollerClubList.clearContent(),this.scrollerClubList.setScrollerContent(this.clubDataList);var e=this.getSelectedClubData();if("undefined"!=typeof e&&null!=e){this.Button_partner_group.visible=t.ClubService.getInstance().checkRight(e.permissions,ClubConst.PermissionType.Key_oppartber);var a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_MAMAGER_RIGHT,{clubId:e.clubId});t.SocketManager.getInstance().send(a)}},a.prototype.initScroller=function(){this.scrollerClubList.setElementViewInfo(72,10),this.scrollerClubList.setElementCreateFunction(this.createElement.bind(this)),this.scrollerClubList.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerClubList.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.registerPushNotice=function(){},a.prototype.createElement=function(e){t.LogUtils.info("createElement===="+e);var a=new t.ClubItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.clickClubItem=function(e){null!=this.selectedClubData&&t.ClubService.getInstance().setPushNotice(this.selectedClubData.clubId,!1),this.setSelectedClubData(e.data),this.updateClubItems(),this.updateUI(),this.clickRooms(),this.Button_partner_group.visible=t.ClubService.getInstance().checkRight(this.selectedClubData.permissions,ClubConst.PermissionType.Key_oppartber);var a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_MAMAGER_RIGHT,{clubId:this.selectedClubData.clubId});t.SocketManager.getInstance().send(a)},a.prototype.updateClubItems=function(){for(var t=this.clubDataList.length,e=0;t>e;e++)this.clubDataList[e].selected=this.clubDataList[e]==this.selectedClubData;this.scrollerClubList.updateUI()},a.prototype.getClubList=function(){t.ClubService.getInstance().getClubList()},a.prototype.getClubListBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.clubDataList=[];var i=a.data;for(var n in i){var o=i[n],s=new t.ClubData;s.parse(o),s.gameId==Constants.GAME_ID_SET.nanjing&&this.clubDataList.push(s)}this.updateClubList(),this.updateUI(),t.LogUtils.info("this.clubDataList==="+this.clubDataList.length),this.clickRooms()}},a.prototype.clickBack=function(){t.SceneSkip.skipToHallScene()},a.prototype.clickCreateClub=function(){var e=new t.ClubCreateDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickJoinClub=function(){var e=new t.JoinClubDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickInviteMember=function(){},a.prototype.clickEditNotice=function(){if(null!=this.selectedClubData){var e=new t.ClubNoticeShowDialog(this.selectedClubData.clubId,this.selectedClubData.noticeContent,!0);t.DialogManager.getInstance().show(e)}},a.prototype.clickRooms=function(){this.updateClubMenus(this.btnRooms),this.updateClubMenuViews(this.clubRoomUI),t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_Rooms,this.getSelectedClubData())},a.prototype.clickMembers=function(){this.updateClubMenus(this.btnMembers),this.updateClubMenuViews(this.clubMembersUI);var e={clubData:this.getSelectedClubData(),patternType:0,patternContent:""};t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_Members,e)},a.prototype.clickApplyJoins=function(){this.updateClubMenus(this.btnApplyJoins),this.updateClubMenuViews(this.clubApplyJoinsUI),t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_ApplyJoins,this.getSelectedClubData())},a.prototype.clickCombatRecords=function(){this.updateClubMenus(this.btnCombatRecords),this.updateClubMenuViews(this.clubCombatRecordsUI),this.clubCombatRecordsUI.setData(this.getSelectedClubData().clubId)},a.prototype.clickLog=function(){var e=new t.clubMemberHistories(this.getSelectedClubData());t.DialogManager.getInstance().show(e)},a.prototype.clickLuckScore=function(){this.updateClubMenus(this.btnLuckyScore),this.updateClubMenuViews(this.ClubLuckyScore),t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_Bless,this.getSelectedClubData())},a.prototype.clickDivide=function(){var e=new t.ClubDivideBox(this.getSelectedClubData());t.DialogManager.getInstance().show(e)},a.prototype.updateLuckyScoreGroup=function(t){this.groupLuckyScore.visible=t},a.prototype.updateBlessValue=function(t){this.setSelectedClubData(t.data),this.Text_lucky_score_num.size=36,this.Text_lucky_score_num.text="我的体力："+t.data.blessNum,this.isShowOtherBelssNum=!1},a.prototype.updateClubMenus=function(e){for(var a=[this.btnRooms,this.btnMembers,this.btnApplyJoins,this.btnCombatRecords,this.btnLuckyScore],i=a.length,n=0,o=0;i>o;o++)a[o].selected=a[o]==e,1==a[o].visible&&(a[o].y=this.rightTablePosY[n],n++);this.groupCreateRoom.visible=this.btnRooms==e,this.groupSearch.visible=!1,this.Button_divide.visible=!1,this.Button_invite_member.visible=!1;var s=this.btnMembers==e;if(s){var r=this.getSelectedClubData(),l=t.ClubService.getInstance().checkRight(r.permissions,ClubConst.PermissionType.Key_memberManager);this.Button_invite_member.visible=l,this.groupSearch.visible=l,this.Button_divide.visible=t.ClubService.getInstance().checkRight(r.permissions,ClubConst.PermissionType.Key_divideManage)}this.btnLuckyScore==e?(this.groupClubIdAdmin.visible=!1,this.updateLuckyScoreGroup(!0)):(this.groupClubIdAdmin.visible=!0,this.updateLuckyScoreGroup(!1)),this.btnCombatRecords==e?(this.groupRecords.visible=!0,this.Button_check_others_replay.visible=t.ClubService.getInstance().checkRight(this.getSelectedClubData().permissions,ClubConst.PermissionType.key_record)):this.groupRecords.visible=!1,this.scrollerClubList.updateUI()},a.prototype.updateClubMenuViews=function(t){for(var e=[this.clubRoomUI,this.clubMembersUI,this.clubApplyJoinsUI,this.clubCombatRecordsUI,this.ClubLuckyScore],a=e.length,i=0;a>i;i++)e[i].visible=e[i]==t;this.scrollerClubList.updateUI()},a.prototype.getSelectedClubData=function(){return null==this.selectedClubData&&this.clubDataList.length>0&&this.setSelectedClubData(this.clubDataList[0]),this.selectedClubData},a.prototype.setSelectedClubData=function(t){this.selectedClubData=t,this.labelClubId.text="俱乐部ID："+this.selectedClubData.clubId},a.prototype.getSwitchAutoTableBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){a.data}},a.prototype.showNotice=function(){if(null!=this.selectedClubData){var e=new t.ClubNoticeShowDialog(this.selectedClubData.clubId,this.selectedClubData.noticeContent,!1);t.DialogManager.getInstance().show(e)}},a.prototype.createRoom=function(){if(null!=this.selectedClubData){var e=new t.ClubRuleDialog(this.selectedClubData.clubId);t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)}},a.prototype.searchMember=function(){if(null!=this.selectedClubData){var e=new t.ClubSearchDialog(this.getSelectedClubData());t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)}},a.prototype.updateNotice=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data;this.selectedClubData.noticeContent=i.pubContent,this.marqueeNotice.start(this.selectedClubData.noticeContent)}},a.prototype.updateRedTip=function(t){if(null!=t.data){var e=t.data;null!=this.selectedClubData&&(this.selectedClubData.hasShowRedTip=e.isShow,this.scrollerClubList.updateUI(),this.imgApplyRedTip.visible=this.selectedClubData.hasShowRedTip)}},a.prototype.clickSetting=function(){if(null!=this.selectedClubData){var e=new t.ClubSettingDialog(this.selectedClubData.clubId);t.DialogManager.getInstance().show(e)}},a.prototype.clickSetWatcher=function(){if(null!=this.selectedClubData){var e=new t.ClubWatcherDialog(this.selectedClubData.clubId);t.DialogManager.getInstance().show(e)}},a.prototype.watcherChange=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data;GameUtils.sub(this.labelWatchInfo,i.memberName,140)}},a.prototype.getMyBlessNumb=function(t){},a.prototype.updateList=function(t){if(null!=t.data)if(t.data.isViewOtherMember){this.Text_lucky_score_num.size=32;var e=t.data.userName;GameUtils.sub(this.Text_lucky_score_num,e,200),e=this.Text_lucky_score_num.text,this.Text_lucky_score_num.text=Utils.format("{0}的体力：{1}",e,t.data.userBlessNum),this.isShowOtherBelssNum=!0}else this.Text_lucky_score_num.size=36,this.Text_lucky_score_num.text="我的体力："+t.data.userBlessNum,this.isShowOtherBelssNum=!1},a.prototype.getOppartMgr=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&this.btnLuckyScore.selected&&(a.data.modifyAnyoneSwitch?t.ClubService.getInstance().checkRight(this.getSelectedClubData().permissions,ClubConst.PermissionType.Key_blessManage)?this.Button_lucky_member.visible=!0:this.Button_lucky_member.visible=!1:t.ClubService.getInstance().checkRight(this.getSelectedClubData().permissions,ClubConst.PermissionType.Key_blessManage)||a.data.groupManager?this.Button_lucky_member.visible=!0:this.Button_lucky_member.visible=!1)},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_LIST),this.getClubListBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_ROOM_AUTOCREATE),this.getSwitchAutoTableBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLICK_CLUB_ITEM,this.clickClubItem,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLICK_CLUB_UpdateRedTip,this.updateRedTip,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLUB_UPDATE_BLESS_VALUE,this.updateBlessValue,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_NOTICE),this.updateNotice,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_setWatcher),this.watcherChange,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_myblessnum),this.getMyBlessNumb,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_MAMAGER_RIGHT),this.getOppartMgr,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLUB_REFRESH_BLESS_LIST,this.updateList,this),null!=this.selectedClubData&&t.ClubService.getInstance().setPushNotice(this.selectedClubData.clubId,!1),e.prototype.clean.call(this)},a}(t.SceneBase);t.ClubScene=e,__reflect(e.prototype,"game.ClubScene")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getMyBlessNumber=function(e){var a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_myblessnum,{clubId:e});t.SocketManager.getInstance().send(a)},e.prototype.getMemberBlessList=function(e){var a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_memberblesslist,{clubId:e});t.SocketManager.getInstance().send(a)},e.prototype.getClubList=function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_LIST,null);t.SocketManager.getInstance().send(e)},e.prototype.joinClub=function(e,a){var i={clubId:e,applyDesc:a},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_JOIN,i);t.SocketManager.getInstance().send(n)},e.prototype.getClubRoomList=function(e){var a={clubId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_ROOMINFOLIST,a);t.SocketManager.getInstance().send(i)},e.prototype.getClubMemberList=function(e,a,i){var n={clubId:e,patternType:a,patternContent:i},o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_MEMBERLIST,n);t.SocketManager.getInstance().send(o)},e.prototype.getClubApplyJoins=function(e){var a={clubId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_WAITCHECK_MEMBERLIST,a);t.SocketManager.getInstance().send(i)},e.prototype.setPushNotice=function(e,a){var i={clubId:e,hashPush:a},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_SET_HASPUSH,i);t.SocketManager.getInstance().send(n)},e.prototype.getClubErrorCodeInfo=function(e){return e==t.MsgConstant.ERROR_club_hasPassed_member?"你已加入俱乐部，不需要重复申请!":e==t.MsgConstant.ERROR_club_IsNotFund?"输入的俱乐部ID不存在!":e==t.MsgConstant.ERROR_club_hasUnCheck_member?"你已提交过申请了，不需要重复申请!":"申请失败!"},e.prototype.forceCancelRoom=function(e){var a={roomNumber:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_forceCancelRoom,a);t.SocketManager.getInstance().send(i)},e.prototype.checkMemberJoin=function(e,a,i){var n={clubId:e,memberId:a,checkStatus:i},o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_MEMBER_CHECK,n);t.SocketManager.getInstance().send(o)},e.prototype.autoCreateTableSwitch=function(e,a){var i={clubId:e,hasAutoCreate:a},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_ROOM_AUTOCREATE,i);t.SocketManager.getInstance().send(n)},e.prototype.publishNotice=function(e,a){var i={clubId:e,pubContent:a},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_SENDNOTICE,i);t.SocketManager.getInstance().send(n)},e.prototype.setMemberType=function(e,a,i){var n={clubId:e,memberId:a,memberType:i},o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_SET_MEMBER,n);t.SocketManager.getInstance().send(o)},e.prototype.kickMember=function(e,a){var i={clubId:e,memberId:a},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_REMOVEMEMBER,i);t.SocketManager.getInstance().send(n)},e.prototype.createClub=function(e,a,i,n){var o={gameId:e,name:a,monitorMobile:i,applyDesc:n},s=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_CREATE,o);t.SocketManager.getInstance().send(s)},e.prototype.getClubSettingInfo=function(e){var a={clubId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_getSettingInfo,a);t.SocketManager.getInstance().send(i)},e.prototype.clubSetting=function(e){var a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_setting,e);t.SocketManager.getInstance().send(a)},e.prototype.forbidGame=function(e,a){var i={clubId:e,memberId:a,forbidGame:!0},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_forbid_game,i);t.SocketManager.getInstance().send(n)},e.prototype.allowGame=function(e,a){var i={clubId:e,memberId:a,forbidGame:!1},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_forbid_game,i);t.SocketManager.getInstance().send(n)},e.prototype.getManagerList=function(e){var a={clubId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_all_manager,a);t.SocketManager.getInstance().send(i)},e.prototype.setWatcher=function(e,a){var i={clubId:e,memberId:a,watcher:!0},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_setWatcher,i);t.SocketManager.getInstance().send(n)},e.prototype.updateCustomInfo=function(e){var a=e,i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_updateTemplate,a);t.SocketManager.getInstance().send(i)},e.prototype.getRoomProgressInfo=function(e,a){var i={clubId:e,roomId:a},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_roominfo_progress,i);t.SocketManager.getInstance().send(n)},e.prototype.checkRight=function(t,e){if(null==t||"undefine"==t)return!1;var a=t[e];return 1==a?!0:!1},e.prototype.checkDefaultRight=function(t){for(var e=ClubConst.PermissionTypes.length,a=0;e>a;a++){var i=this.checkRight(t,ClubConst.PermissionTypes[a]);if(i)return i}return!1},e.prototype.isMonitor=function(t){return t==ClubConst.MemberType.MONITOR?!0:!1},e}();t.ClubService=e,__reflect(e.prototype,"game.ClubService")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.clubId=t,a.skinName="resource/skins/club/clubSettingSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.offlineStartType0.setText("有玩家离线不开局"),this.offlineStartType1.setText(""),this.offlineStartType2.setText("玩家离线也开局"),this.radioAutoHostTime.setText("超时托管"),this.radioAutoDisTime.setText("超时解散"),this.radioNoHost.setText("关闭超时托管"),this.addTapEvent(this.btnClose,this.close),this.editKickTime.inputType=egret.TextFieldInputType.TEL,this.editKickTime.restrict="0-9",this.editAutoHostTime.inputType=egret.TextFieldInputType.TEL,this.editAutoHostTime.restrict="0-9",this.addTapEvent(this.offlineStartType0,this.clickOfflineStartType0),this.addTapEvent(this.offlineStartType1,this.clickOfflineStartType1),this.addTapEvent(this.offlineStartType2,this.clickOfflineStartType2),this.addTapEvent(this.editKickTime,this.clickOfflineStartType1),this.addTapEvent(this.radioAutoHostTime,this.clickAutoHostTime),this.addTapEvent(this.radioNoHost,this.clickNoHost),this.addTapEvent(this.radioAutoDisTime,this.clickAutoDisTime),this.addTapEvent(this.btnSave,this.saveConfig),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_getSettingInfo),this.getSettingConfigInfoCallback,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_setting),this.saveConfigCallback,this),this.getSettingConfigInfo()},a.prototype.getSettingConfigInfo=function(){t.ClubService.getInstance().getClubSettingInfo(this.clubId)},a.prototype.getSettingConfigInfoCallback=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data;this.clubSettingInfo=i,t.LogUtils.info("---------"),this.updateUI()}},a.prototype.updateAutoSetRadio=function(){this.clubSettingInfo.autoHost?(1==this.clubSettingInfo.autoType?(this.radioAutoHostTime.setSelected(!0),this.radioAutoDisTime.setSelected(!1)):2==this.clubSettingInfo.autoType&&(this.radioAutoHostTime.setSelected(!1),this.radioAutoDisTime.setSelected(!0)),this.radioNoHost.setSelected(!1)):(this.radioNoHost.setSelected(!0),this.radioAutoHostTime.setSelected(!1),this.radioAutoDisTime.setSelected(!1))},a.prototype.updateUI_=function(){var t=this.clubSettingInfo;this.labelKickTip.text="（"+Math.floor(t.configDefaultInfo.minKickTime/1e3)+"~"+Math.floor(t.configDefaultInfo.maxKickTime/1e3)+"）秒后踢出离线玩家",this.labelAutoHostTip.text="（"+Math.floor(t.configDefaultInfo.minAutoHostTime/1e3)+"~"+Math.floor(t.configDefaultInfo.maxAutoHostTime/1e3)+"）秒",this.offlineStartType0.setSelected(!1),this.offlineStartType1.setSelected(!1),this.offlineStartType2.setSelected(!1),1==this.clubSettingInfo.offlineStartType?(this.offlineStartType1.setSelected(!0),this.editKickTime.text=Math.floor(this.clubSettingInfo.offlineKickTime/1e3)+""):2==this.clubSettingInfo.offlineStartType?this.offlineStartType2.setSelected(!0):(this.offlineStartType0.setSelected(!0),this.editKickTime.text=Math.floor(this.clubSettingInfo.offlineKickTime/1e3)+""),this.editAutoHostTime.text=Math.floor(t.autoHostTime/1e3)+"",this.updateAutoSetRadio(),this.cbFangZuoBi.setText("防作弊"),this.cbNeedGPS.setText("入桌需开GPS"),this.cbVoice.setText("语音聊天"),this.cbHDLY.setText("海底捞月"),this.cbApplyDismiss.setText("协商解散"),this.cbForbid3.setText("禁止3人开局"),this.cbAutoMatch.setText("自动匹配房间"),this.cbHideRoomUserInfo.setText("隐藏房间列表玩家信息"),this.cbHideGameUserInfo.setText("隐藏牌桌中玩家信息"),this.cbFangZuoBi.setSelected(this.clubSettingInfo.checkCheat),this.cbNeedGPS.setSelected(this.clubSettingInfo.gps),this.cbVoice.setSelected(this.clubSettingInfo.openVoice),this.cbHDLY.setSelected(this.clubSettingInfo.haiDiLaoYue),this.cbApplyDismiss.setSelected(this.clubSettingInfo.dismissSwitch),this.cbForbid3.setSelected(!this.clubSettingInfo.changePlayerNum),this.cbAutoMatch.setSelected(this.clubSettingInfo.autoMatch),this.cbHideRoomUserInfo.setSelected(this.clubSettingInfo.hideRoomUserInfo),this.cbHideGameUserInfo.setSelected(this.clubSettingInfo.hideGameUserInfo)
},a.prototype.clickOfflineStartType0=function(){this.clubSettingInfo.offlineStartType=0,this.updateUI()},a.prototype.clickOfflineStartType1=function(){this.clubSettingInfo.offlineStartType=1,this.updateUI()},a.prototype.clickOfflineStartType2=function(){this.clubSettingInfo.offlineStartType=2,this.updateUI()},a.prototype.clickAutoHostTime=function(){this.clubSettingInfo.autoHost=!0,this.clubSettingInfo.autoType=1,this.updateAutoSetRadio()},a.prototype.clickAutoDisTime=function(){this.clubSettingInfo.autoHost=!0,this.clubSettingInfo.autoType=2,this.updateAutoSetRadio()},a.prototype.clickNoHost=function(){this.clubSettingInfo.autoHost=!1,this.updateAutoSetRadio()},a.prototype.saveConfig=function(){var e=this.clubSettingInfo;if(1==e.offlineStartType){var a=this.editKickTime.text.trim(),i=Math.floor(e.configDefaultInfo.minKickTime/1e3),n=Math.floor(e.configDefaultInfo.maxKickTime/1e3);if(!this.checkInputConfigInfo(a,i,n))return void t.CommonView.showToast(Utils.format("时间应该是{0}-{1}之间",i,n));e.offlineKickTime=1e3*parseInt(a)}if(e.autoHost=e.autoHost,e.autoHost){var o=this.editAutoHostTime.text.trim(),i=Math.floor(e.configDefaultInfo.minAutoHostTime/1e3),n=Math.floor(e.configDefaultInfo.maxAutoHostTime/1e3);if(!this.checkInputConfigInfo(o,i,n))return void t.CommonView.showToast(Utils.format("时间应该是{0}-{1}之间",i,n));e.autoHostTime=1e3*parseInt(o)}this.clubSettingInfo.checkCheat=this.cbFangZuoBi.isSelected(),this.clubSettingInfo.gps=this.cbNeedGPS.isSelected(),this.clubSettingInfo.openVoice=this.cbVoice.isSelected(),this.clubSettingInfo.haiDiLaoYue=this.cbHDLY.isSelected(),this.clubSettingInfo.dismissSwitch=this.cbApplyDismiss.isSelected(),this.clubSettingInfo.changePlayerNum=!this.cbForbid3.isSelected(),this.clubSettingInfo.autoMatch=this.cbAutoMatch.isSelected(),this.clubSettingInfo.hideRoomUserInfo=this.cbHideRoomUserInfo.isSelected(),this.clubSettingInfo.hideGameUserInfo=this.cbHideGameUserInfo.isSelected(),t.ClubService.getInstance().clubSetting(e)},a.prototype.checkInputConfigInfo=function(t,e,a){if(0==t.length)return!1;var i=parseInt(t);return i>=e&&a>=i?!0:!1},a.prototype.saveConfigCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS?(t.CommonView.showToast("俱乐部设置成功"),this.close()):t.CommonView.showToast("俱乐部设置失败")},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EDialog);t.ClubSettingDialog=e,__reflect(e.prototype,"game.ClubSettingDialog")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.offlineStartType=1,this.offlineKickTime=3e4,this.autoHostTime=18e4,this.autoHost=!0,this.autoType=1,this.checkCheat=!0,this.openVoice=!0,this.gps=!1,this.haiDiLaoYue=!0,this.dismissSwitch=!0,this.changePlayerNum=!0,this.autoMatch=!1,this.hideRoomUserInfo=!1,this.hideGameUserInfo=!1}return t}();t.ClubSettingInfo=e,__reflect(e.prototype,"game.ClubSettingInfo");var a=function(){function t(){}return t}();t.ClubSettingDefaultInfo=a,__reflect(a.prototype,"game.ClubSettingDefaultInfo")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getMemberName=function(t){return t==ClubConst.MemberType.MONITOR?"会长":""},t}();t.ClubUtils=e,__reflect(e.prototype,"game.ClubUtils")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.clubCreateView.index,!1)||this;return t.numbers="",t.skinName="resource/skins/club/joinClubSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnOK,this.clickOK),this.addTapEvent(this.btnClear,this.clickClear),this.addTapEvent(this.btnDelete,this.clickDelete),this.initBtnsEvent(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_JOIN),this.joinClubCallback,this)},a.prototype.updateUI_=function(){for(var t=this.getNumbers(),e=t.length,a=0;e>a;a++)this.numbers.length>=a?(t[a].visible=!0,t[a].text=this.numbers.substring(a,a+1)):t[a].visible=!1},a.prototype.clickOK=function(){var e=this.numbers;return 6==e.length&&Utils.isNumbers(e)?void t.ClubService.getInstance().joinClub(e,GlobalData.userData.getUserName()):void t.CommonView.showToast("俱乐部ID应该是6位数字！")},a.prototype.joinClubCallback=function(e){var a=e.data;return a.code==t.CmdResultType.SUCCESS?(t.CommonView.showToast("申请成功，联系会长去审核吧！"),void this.close()):void t.CommonView.showToast(t.ClubService.getInstance().getClubErrorCodeInfo(a.errorCode))},a.prototype.getNumber=function(t){for(var e=t.currentTarget,a=this.getBtnNumbers(),i=a.length,n=0;i>n;n++)if(e==a[n])return n},a.prototype.getBtnNumbers=function(){var t=[this.btnNumber0,this.btnNumber1,this.btnNumber2,this.btnNumber3,this.btnNumber4,this.btnNumber5,this.btnNumber6,this.btnNumber7,this.btnNumber8,this.btnNumber9];return t},a.prototype.getNumbers=function(){return[this.labelNumber1,this.labelNumber2,this.labelNumber3,this.labelNumber4,this.labelNumber5,this.labelNumber6]},a.prototype.clickBtnNumber=function(t){if(!(this.numbers.length>=6)){var e=this.getNumber(t);this.numbers+=e,this.updateUI()}},a.prototype.clickClear=function(){this.numbers="",this.updateUI()},a.prototype.clickDelete=function(){this.numbers.length>0&&(this.numbers=this.numbers.substr(0,this.numbers.length-1)),this.updateUI()},a.prototype.initBtnsEvent=function(){for(var t=this.getBtnNumbers(),e=t.length,a=0;e>a;a++)this.addTapEvent(t[a],this.clickBtnNumber)},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_JOIN),this.joinClubCallback,this),e.prototype.clean.call(this)},a}(t.EDialog);t.JoinClubDialog=e,__reflect(e.prototype,"game.JoinClubDialog")}(game||(game={}));var NoClubUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/club/noClubUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnCreate,this.clickCreate),this.addTapEvent(this.btnJoin,this.clickJoin)},e.prototype.clickCreate=function(){var t=new game.ClubCreateDialog;game.DialogManager.getInstance().show(t)},e.prototype.clickJoin=function(){var t=new game.JoinClubDialog;game.DialogManager.getInstance().show(t)},e}(game.EComponent);__reflect(NoClubUI.prototype,"NoClubUI"),window.NoClubUI=NoClubUI;var game;!function(t){var e=function(){function t(){}return t.prototype.parse=function(t){this.memberId=t.memberId,this.memberName=t.nickName,this.headImgUrl=t.headImgUrl,this.applyInfo=t.memberWx},t}();t.ClubApplyJoinData=e,__reflect(e.prototype,"game.ClubApplyJoinData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.clubData=t,i.clubApplyJoinData=a,i.skinName="resource/skins/club/applyJoin/clubApplyJoinItemSkin.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnAgree,this.clickAgree),this.addTapEvent(this.btnReject,this.clickReject),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.clubApplyJoinData=e,this.updateUI()},a.prototype.updateUI_=function(){if(null!=this.clubApplyJoinData){this.labelMemberName.text=this.clubApplyJoinData.memberName,this.labelMemberID.text="ID:"+this.clubApplyJoinData.memberId,this.labelApplyInfo.text=this.clubApplyJoinData.applyInfo}},a.prototype.clickAgree=function(){t.ClubService.getInstance().checkMemberJoin(this.clubData.clubId,this.clubApplyJoinData.memberId,ClubConst.MemberCheckStatus.PASSED)},a.prototype.clickReject=function(){t.ClubService.getInstance().checkMemberJoin(this.clubData.clubId,this.clubApplyJoinData.memberId,ClubConst.MemberCheckStatus.UNPASS)},a}(t.EComponent);t.ClubApplyJoinItem=e,__reflect(e.prototype,"game.ClubApplyJoinItem")}(game||(game={}));var ClubApplyJoinsUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/club/applyJoin/clubApplyJoinsUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_WAITCHECK_MEMBERLIST),this.getClubApplyJoinsBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.CLICK_CLUB_ApplyJoins,this.getClubApplyJoins,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_MEMBER_CHECK),this.checkMemberStatus,this),this.initScroller()},e.prototype.updateUI_=function(){this.scrollerTables.clearContent(),this.scrollerTables.setScrollerContent(this.clubMemberDataList)},e.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(148,8),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.ClubApplyJoinItem(this.clubData,t);return e},e.prototype.updateElement=function(t,e){t.setData(this.clubData,e)},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.getClubApplyJoins=function(t){null!=t.data&&(this.clubData=t.data,game.ClubService.getInstance().getClubApplyJoins(t.data.clubId))},e.prototype.getClubApplyJoinsBack=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){this.clubMemberDataList=[];var a=e.data,i=a.clubMembers;for(var n in i){var o=i[n],s=new game.ClubApplyJoinData;s.parse(o),this.clubMemberDataList.push(s)}game.EAppFacade.getInstance().sendNotification(game.GameCmd.CLICK_CLUB_UpdateRedTip,{isShow:this.clubMemberDataList.length>0}),this.updateUI()}},e.prototype.checkMemberStatus=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){var a=this.clubData.clubId;game.ClubService.getInstance().getClubApplyJoins(a),game.CommonView.showToast("处理申请操作成功")}},e.prototype.clean=function(){game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_WAITCHECK_MEMBERLIST),this.getClubApplyJoinsBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.CLICK_CLUB_ApplyJoins,this.getClubApplyJoins,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_MEMBER_CHECK),this.checkMemberStatus,this),t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ClubApplyJoinsUI.prototype,"ClubApplyJoinsUI"),window.ClubApplyJoinsUI=ClubApplyJoinsUI;var ClubCombatRecordsUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/club/combatRecord/clubCombatsUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.zhanjiUI.fromClub=!0,this.updateUI()},e.prototype.updateUI_=function(){null!=this.clubId&&this.zhanjiUI.getCombatList_Club(this.clubId)},e.prototype.setData=function(t){this.clubId=t,this.updateUI()},e.prototype.clean=function(){t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ClubCombatRecordsUI.prototype,"ClubCombatRecordsUI"),window.ClubCombatRecordsUI=ClubCombatRecordsUI;var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this,null,!1)||this;return i.groupData=null,i.memberListData=null,i.clubData=a,i.groupData=t,i.skinName="resource/skins/club/divide/ClubAddDivideMemberBox.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btn_close,function(){a.close()}),this.addTapEvent(this.btnSearch,function(){var e=a.editSearch.text.trim(),i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_divide_all_member_list,{clubId:a.clubData.clubId,patternContent:e,divideId:a.groupData.divideId});t.SocketManager.getInstance().send(i)}),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_divide_all_member_list),this.getDivideMemberList,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_addDivideMember),this.addDivideMember,this),this.myScroller.setElementViewInfo(124,6),this.myScroller.setElementCreateFunction(this.createElement.bind(this)),this.myScroller.setElementUpdateDataFun(this.updateElement.bind(this)),this.myScroller.setElementUpdateUIFun(this.updateElementUI.bind(this)),this.updateUI();var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_divide_all_member_list,{clubId:this.clubData.clubId,divideId:this.groupData.divideId});t.SocketManager.getInstance().send(i)},a.prototype.createElement=function(e){var a=new t.ClubAddDivideMemberBoxItem(this.groupData,e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.getDivideMemberList=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.memberListData=a.data.memberList,this.myScroller.clearContent(),this.myScroller.setScrollerContent(this.memberListData))},a.prototype.addDivideMember=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){for(var i in this.memberListData)if(this.memberListData[i].memberId==a.data.memberId){this.memberListData[i].hasDivided=!0;break}this.myScroller.updateUI()}},a.prototype.updateUI_=function(){this.lbInfo.text="添加成员至"+this.groupData.divideName},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_divide_all_member_list),this.getDivideMemberList,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_addDivideMember),this.addDivideMember,this)},a}(t.EDialog);t.ClubAddDivideMemberBox=e,__reflect(e.prototype,"game.ClubAddDivideMemberBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.diviData=null,i.diviData=t,i.data=a,i.skinName="resource/skins/club/divide/ClubAddDivideMemberBoxItem.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;this.addTapEvent(this.btn_Add,function(){t.DialogManager.getInstance().popUp2("确定添加玩家"+a.data.memberName+"为隔离成员么？",function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_Divide_addDivideMember,{clubId:a.diviData.clubId,divideId:a.diviData.divideId,memberId:a.data.memberId});t.SocketManager.getInstance().send(e)})}),e.prototype.onCreateViewComplete.call(this),this.updateUI()},a.prototype.setData=function(t){this.data=t,this.updateUI()},a.prototype.updateUI_=function(){var e=this;this.added.visible=this.data.hasDivided,this.btn_Add.visible=!this.data.hasDivided,t.ResManager.loadWebImage(this.data.headImgUrl,function(t){e.imgHead.texture=t,e.imgHead.addEventListener(eui.UIEvent.COMPLETE,function(){e.imgHead.texture=t},e)},this),GameUtils.sub(this.lbName,this.data.memberName,178),this.lbID.text="ID:"+this.data.memberId},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubAddDivideMemberBoxItem=e,__reflect(e.prototype,"game.ClubAddDivideMemberBoxItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this,null,!1)||this;return i.divideGroupData=[],i.gourpData=null,i.clubData=a,i.gourpData=t,i.skinName="resource/skins/club/divide/ClubAddDivideTabBox.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,function(){a.close()}),this.addTapEvent(this.btnIAdd,function(){var e=a.editSearch.text.trim();if(0==e.length)return void t.CommonView.showToast("请输入名称");if(e.length>6)return void t.DialogManager.getInstance().popUp1("名称最多6个字");var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_Divide_addDivide,{clubId:a.clubData.clubId,divideName:e});t.SocketManager.getInstance().send(i)}),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_addDivide),this.addDivide,this),this.updateUI()},a.prototype.addDivide=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.close(),t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLUB_ADD_DIVIDE_GROUP,a.data))},a.prototype.updateUI_=function(){},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_addDivide),this.addDivide,this)},a}(t.EDialog);t.ClubAddDivideTabBox=e,__reflect(e.prototype,"game.ClubAddDivideTabBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.leftDataList=[],a.rightDataList=[],a.selecedData=null,a.skinName="resource/skins/club/divide/ClubDivideBox.exml",a.clubData=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btn_close,function(){a.close()}),this.initScroller(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLICK_CLUB_DIVIDE_TAB_ITEM,this.clickTabItem,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLUB_REMOVE_DIVIDE_MEMBER,this.removeMember,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLUB_ADD_DIVIDE_GROUP,this.addGroup,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLUB_MODIFY_DIVIDE_GROUP_NAME,this.modifyGroupName,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_removeDivide),this.removeGroup,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_getDivides),this.getDivides,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_getDivideMembers),this.getDividesMembers,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_addDivideMember),this.addDivideMember,this),this.addTapEvent(this.btnAddGroup,function(){var e=new t.ClubAddDivideTabBox(a.selecedData,a.clubData);t.DialogManager.getInstance().show(e)}),this.addTapEvent(this.btnDelGroup,function(){t.DialogManager.getInstance().popUp2("确定要删除当前分组么？",function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_Divide_removeDivide,{clubId:a.clubData.clubId,divideId:a.selecedData.divideId});t.SocketManager.getInstance().send(e)})}),this.addTapEvent(this.btnModifyName,function(){var e=new t.ClubModifyDivideNameBox(a.selecedData,a.clubData);t.DialogManager.getInstance().show(e)}),this.addTapEvent(this.btnAddMember,function(){var e=new t.ClubAddDivideMemberBox(a.selecedData,a.clubData);t.DialogManager.getInstance().show(e)});var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_Divide_getDivides,{clubId:this.clubData.clubId});t.SocketManager.getInstance().send(i),this.updateUI()},a.prototype.removeGroup=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){if(t.CommonView.showToast("删除隔离组成功"),null==this.leftDataList)return;for(var i in this.leftDataList)if(this.leftDataList[i].divideId==a.data.divideId){if(this.leftDataList.splice(Number(i),1),this.leftDataList.length>0){this.selecedData=this.leftDataList[0],this.selecedData.selected=!0;var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_Divide_getDivideMembers,{clubId:this.clubData.clubId,divideId:this.selecedData.divideId});t.SocketManager.getInstance().send(n)}break}this.scrollerLeft.updateUI(),0==this.leftDataList.length&&(this.btnAddMember.visible=this.btnDelGroup.visible=this.btnModifyName.visible=!1)}},a.prototype.modifyGroupName=function(e){var a=e.data;if(t.CommonView.showToast("修改成功"),null!=this.leftDataList){for(var i in this.leftDataList)if(this.leftDataList[i].divideId==a.divideId){this.leftDataList[i].divideName=a.divideName;break}this.scrollerLeft.updateUI()}},a.prototype.addGroup=function(e){var a=e.data;if(t.CommonView.showToast("新增成功"),null==this.leftDataList&&(this.leftDataList=[]),this.leftDataList.push(a),1==this.leftDataList.length){this.selecedData=this.leftDataList[0],this.selecedData.selected=!0;var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_Divide_getDivideMembers,{clubId:this.clubData.clubId,divideId:this.selecedData.divideId});t.SocketManager.getInstance().send(i)}this.scrollerLeft.updateUI(),this.leftDataList.length>0&&(this.btnAddMember.visible=this.btnDelGroup.visible=this.btnModifyName.visible=!0)},a.prototype.removeMember=function(e){var a=e.data;if(t.CommonView.showToast("移除成功"),a.clubId==this.clubData.clubId&&a.divideId==this.selecedData.divideId&&0!=this.rightDataList.length){for(var i in this.rightDataList)this.rightDataList[i].memberId==a.memberId&&this.rightDataList.splice(Number(i),1);this.scrollerRight.clearContent(),this.scrollerRight.setScrollerContent(this.rightDataList)}},a.prototype.clickTabItem=function(e){var a=e.data;this.selecedData=a;for(var i=0;i<this.leftDataList.length;i++)this.leftDataList[i].selected=this.leftDataList[i]==this.selecedData;this.scrollerLeft.updateUI();var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_Divide_getDivideMembers,{clubId:this.clubData.clubId,divideId:this.selecedData.divideId});t.SocketManager.getInstance().send(n)},a.prototype.addDivideMember=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.rightDataList.push(a.data),this.scrollerRight.updateUI(),t.CommonView.showToast("添加成功"))},a.prototype.getDivides=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data.divideList;for(var n in i)if("0"==n){i[n].selected=!0,this.selecedData=i[n];var o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_Divide_getDivideMembers,{clubId:this.clubData.clubId,divideId:i[n].divideId});t.SocketManager.getInstance().send(o)}else i[n].selected=!1;this.leftDataList=i,this.scrollerLeft.clearContent(),this.scrollerLeft.setScrollerContent(this.leftDataList),0==this.leftDataList.length&&(this.btnAddMember.visible=this.btnDelGroup.visible=this.btnModifyName.visible=!1)}},a.prototype.getDividesMembers=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data.memberList;this.rightDataList=i,this.scrollerRight.clearContent(),this.scrollerRight.setScrollerContent(this.rightDataList)}},a.prototype.initScroller=function(){this.scrollerLeft.setElementViewInfo(72,6),this.scrollerLeft.setElementCreateFunction(this.createTabElement.bind(this)),this.scrollerLeft.setElementUpdateDataFun(this.updateTabElement.bind(this)),this.scrollerLeft.setElementUpdateUIFun(this.updateTabElementUI.bind(this)),this.scrollerLeft.setScrollerContent(this.leftDataList),this.scrollerRight.setElementViewInfo(108,6),this.scrollerRight.setElementCreateFunction(this.createRecordsListElement.bind(this)),this.scrollerRight.setElementUpdateDataFun(this.updateRecordsListElement.bind(this)),this.scrollerRight.setElementUpdateUIFun(this.updateRecordsListElementUI.bind(this)),this.scrollerRight.setScrollerContent(this.rightDataList)},a.prototype.createTabElement=function(e){var a=new t.ClubDivideGroupItem(e);return a},a.prototype.updateTabElement=function(t,e){t.setData(e)},a.prototype.updateTabElementUI=function(t){t.updateUI()},a.prototype.createRecordsListElement=function(e){var a=new t.ClubDivideMemberItem(this.selecedData,e);return a},a.prototype.updateRecordsListElement=function(t,e){t.setData(e)},a.prototype.updateRecordsListElementUI=function(t){t.updateUI()},a.prototype.updateUI_=function(){},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLICK_CLUB_DIVIDE_TAB_ITEM,this.clickTabItem,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLUB_REMOVE_DIVIDE_MEMBER,this.removeMember,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLUB_ADD_DIVIDE_GROUP,this.addGroup,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLUB_MODIFY_DIVIDE_GROUP_NAME,this.modifyGroupName,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_removeDivide),this.removeGroup,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_getDivides),this.getDivides,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_getDivideMembers),this.getDividesMembers,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_addDivideMember),this.addDivideMember,this)},a}(t.EDialog);t.ClubDivideBox=e,__reflect(e.prototype,"game.ClubDivideBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.data=t,a.skinName="resource/skins/club/divide/ClubDivideGroupItem.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.lbName.touchEnabled=!1,this.addTapEvent(this.tab,this.clickItem),this.updateUI()},a.prototype.setData=function(t){this.data=t,this.updateUI()},a.prototype.clickItem=function(){t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_DIVIDE_TAB_ITEM,this.data)},a.prototype.updateUI_=function(){this.lbName.text=this.data.divideName,this.tab.selected=this.data.selected,this.tab.selected?this.lbName.textColor=16777215:this.lbName.textColor=8412465},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubDivideGroupItem=e,__reflect(e.prototype,"game.ClubDivideGroupItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.diviData=null,i.diviData=t,i.data=a,i.skinName="resource/skins/club/divide/ClubDivideMemberItem.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_removeDivideMember),this.removeMemberBack,this),this.addTapEvent(this.btnRemove,function(){t.DialogManager.getInstance().popUp2("确定要移除玩家"+a.data.nickName+"么?",function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_Divide_removeDivideMember,{clubId:a.diviData.clubId,divideId:a.diviData.divideId,memberId:a.data.memberId});t.SocketManager.getInstance().send(e)})}),this.updateUI()},a.prototype.setData=function(t){this.data=t,this.updateUI()},a.prototype.removeMemberBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data;t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLUB_REMOVE_DIVIDE_MEMBER,i)}},a.prototype.updateUI_=function(){var e=this;t.ResManager.loadWebImage(this.data.headImgUrl,function(t){e.imgHead.texture=t,e.imgHead.addEventListener(eui.UIEvent.COMPLETE,function(){e.imgHead.texture=t},e)},this),GameUtils.sub(this.lbName,this.data.nickName,117),this.lbID.text="ID:"+this.data.memberId,GameUtils.sub(this.lbAdderName,this.data.operatorName,141),this.lbAddTime.text=t.DateUtils.dateFormat1(Number(this.data.recordTime),!1)},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubDivideMemberItem=e,__reflect(e.prototype,"game.ClubDivideMemberItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this,null,!1)||this;return i.divideGroupData=[],i.gourpData=null,i.clubData=a,i.gourpData=t,i.skinName="resource/skins/club/divide/ClubModifyDivideNameBox.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,function(){a.close()}),this.addTapEvent(this.btnSave,function(){var e=a.editSearch.text.trim();if(0==e.length)return void t.CommonView.showToast("请输入新名称");if(e.length>6)return void t.DialogManager.getInstance().popUp1("名称最多6个字");var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_Divide_updateDivideName,{clubId:a.clubData.clubId,divideId:a.gourpData.divideId,divideName:e});t.SocketManager.getInstance().send(i)}),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_updateDivideName),this.modifyDivide,this),this.updateUI()},a.prototype.modifyDivide=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.close(),t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLUB_MODIFY_DIVIDE_GROUP_NAME,a.data))},a.prototype.updateUI_=function(){},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_Divide_updateDivideName),this.modifyDivide,this)},a}(t.EDialog);t.ClubModifyDivideNameBox=e,__reflect(e.prototype,"game.ClubModifyDivideNameBox")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.prototype.parse=function(t){console.log(t),this.changeNum=t.changeNum,this.clubId=t.clubId,this.createTime=t.createTime,this.curBlessNum=t.curBlessNum,this.id=t.id,this.nickName=t.nickName,this.operId=t.operId,this.operName=t.operName,this.operTypeInfo=t.operTypeInfo,this.roomId=t.roomId,this.roomNumber=t.roomNumber,this.source=t.source,this.userId=t.userId},t}();t.ClubBlessChangedRecordsData=e,__reflect(e.prototype,"game.ClubBlessChangedRecordsData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.skinName="resource/skins/club/luckyScore/ClubFindOtherMemeberLucky.exml",a.clubData=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,function(){a.close()}),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_blesschangerecord),this.blessChangeCallBack,this),this.addTapEvent(this.btnIDFind,function(){var e=a.editSearch.text;if(0==e.length)return void t.DialogManager.getInstance().popUp1("请输入玩家的ID");var i={clubId:a.clubData.clubId,memberId:e},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_blesschangerecord,i);t.SocketManager.getInstance().send(n)})},a.prototype.blessChangeCallBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS?(this.close(),t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLUB_REFRESH_BLESS_LIST,a.data)):a.errorCode==t.MsgConstant.ERROR_club_bless_isnot_member&&t.DialogManager.getInstance().popUp1("请输入正确的俱乐部成员ID")},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_blesschangerecord),this.blessChangeCallBack,this)},a}(t.EDialog);t.ClubFindOtherMemeberLucky=e,__reflect(e.prototype,"game.ClubFindOtherMemeberLucky")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this,null,!1)||this;return i.isOrderDown=!0,i.tableListData=[],i.memberListData=[],i.modifyAnyoneSwitch=!1,i.hasBlessManager=!1,i.tabClickIdx=0,i.curChoicePartnerGroupId=-1,i.curChoicePartnerGroupName="",i.isSearch=!1,i.SearchString="",i.skinName="resource/skins/club/luckyScore/ClubLuckMemeberBox.exml",i.clubData=t,i.isShowOtherBelssNum=a,i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLUB_REFRESH_BLESS_INFO_LIST,this.refreshList,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_LIST),this.getGroupList,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_MEMBER_LIST),this.getGroupMemberList,this);var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_LIST,{clubId:this.clubData.clubId,fromType:0});t.SocketManager.getInstance().send(i),this.addTapEvent(this.btn_close,function(){a.close()}),this.addTapEvent(this.btnSort0,this.onSortClick),this.addTapEvent(this.btnSearch,function(){var e=a.editSearch.text.trim();a.isSearch=!0,a.SearchString=e;
var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_MEMBER_LIST,{groupId:a.curChoicePartnerGroupId,fromType:0,clubId:a.clubData.clubId,patternContent:e});t.SocketManager.getInstance().send(i)}),this.addTapEvent(this.btnModifyRecord,function(){var e=new t.ClubLuckySendRecordBox(a.clubData,a.curChoicePartnerGroupId);t.DialogManager.getInstance().show(e)}),this.initScroller()},a.prototype.onSortClick=function(){console.log("列表排序"),this.isOrderDown=!this.isOrderDown,this.updateSort(),this.scrollerTables.updateUI()},a.prototype.getGroupMemberList=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.memberListData=[];var i=a.data;for(var n in i.groupMemberList){var o=new t.ClubPartnerMemberListData;o.parse(i.groupMemberList[n]),this.memberListData.push(o)}this.isOrderDown=!0,this.updateSort(),this.scrollerTables.clearContent(),this.scrollerTables.setScrollerContent(this.memberListData),-2==i.groupId&&this.tabTo(null)}},a.prototype.getGroupList=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.tableListData=[];var i=a.data;this.modifyAnyoneSwitch=i.isMonitorMode,this.hasBlessManager=i.hasBlessManager,this.modifyAnyoneSwitch?this.Text_desc.text="当前为会长管理模式":this.Text_desc.text="当前为合伙人管理模式",this.hasBlessManager&&(this.modifyAnyoneSwitch?(this.tableListData.push(new t.ClubPartnerListData),this.tableListData[0].parse({idx:0,type:1,name:"未设置",id:-999,isSelected:!0})):(this.tableListData.push(new t.ClubPartnerListData),this.tableListData[0].parse({idx:0,type:0,name:"管理员",id:-999,isSelected:!0}),this.tableListData.push(new t.ClubPartnerListData),this.tableListData[1].parse({idx:1,type:1,name:"未设置",id:-999,isSelected:!1})));for(var n=0;n<i.oppartners.length;n++){var o=i.oppartners[n],s=new t.ClubPartnerListData;s.parse({idx:this.tableListData.length,type:2,name:o.nickName,id:o.id,isSelected:!1}),this.tableListData.push(s)}this.leftScroller.setScrollerContent(this.tableListData),this.tabTo(this.tableListData[this.tabClickIdx])}},a.prototype.refreshList=function(e){var a=e.data,i=a.blessRecord,n=a.operBlessRecord,o=(this.memberListData,!1),s=!1;for(var r in this.memberListData)if(this.memberListData[r].memberId==i.memberId?(this.memberListData[r].blessNum=i.blessNum,o=!0):this.memberListData[r].memberId==n.memberId&&(this.memberListData[r].blessNum=n.blessNum,s=!0),o&&s)break;"undefined"==typeof n||null==n||this.isShowOtherBelssNum||(this.clubData.blessNum=n.blessNum,t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLUB_UPDATE_BLESS_VALUE,this.clubData)),this.scrollerTables.updateUI()},a.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(94,6),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this)),this.leftScroller.setElementViewInfo(76,6),this.leftScroller.setElementCreateFunction(this.createLeftElement.bind(this)),this.leftScroller.setElementUpdateDataFun(this.updateLeftElement.bind(this)),this.leftScroller.setElementUpdateUIFun(this.updateLeftElementUI.bind(this))},a.prototype.createLeftElement=function(e){var a=this,i=new t.ClubPartnerNameItem(this.clubData,e,function(t){a.tabClickIdx=t;for(var e=0;e<a.tableListData.length;e++)a.tabClickIdx==e?a.tableListData[e].isSelected=!0:a.tableListData[e].isSelected=!1;a.leftScroller.updateUI(),a.tabTo(a.tableListData[a.tabClickIdx])});return i},a.prototype.updateLeftElement=function(t,e){t.setData(this.clubData,e)},a.prototype.updateLeftElementUI=function(t){t.updateUI()},a.prototype.createElement=function(e){var a=new t.ClubLuckyListGeneralItem(this.clubData,e);return a},a.prototype.updateElement=function(t,e){t.setData(this.clubData,e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.updateSort=function(){var t=this;this.memberListData.length>0&&(this.imgArrow0.rotation=this.isOrderDown?0:180,this.memberListData.sort(function(e,a){if(1==e.userType&&1!=a.userType||1!=e.userType&&1==a.userType){if(1==e.userType)return-1;if(1==a.userType)return 1}else if(e.blessNum!=a.blessNum){if(e.blessNum>a.blessNum)return t.isOrderDown?-1:1;if(e.blessNum<a.blessNum)return t.isOrderDown?1:-1}else{if(e.memberId>a.memberId)return 1;if(e.memberId<a.memberId)return-1}return 0}))},a.prototype.tabTo=function(e){var a;if(null==e){this.tabClickIdx=-1;for(var i=0;i<this.tableListData.length;i++)this.tableListData[i].isSelected=!1;return this.leftScroller.clearContent(),void this.leftScroller.setScrollerContent(this.tableListData)}switch(this.isSearch=!1,this.SearchString="",e.type){case 0:this.curChoicePartnerGroupId=-1,a=-1;break;case 1:this.curChoicePartnerGroupId=0,a=0;break;default:a=e.id,this.curChoicePartnerGroupId=a,this.curChoicePartnerGroupName=e.nickName}this.scrollerTables.clearContent();var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_MEMBER_LIST,{clubId:this.clubData.clubId,groupId:a,fromType:0});t.SocketManager.getInstance().send(n)},a.prototype.updateUI_=function(){this.clubData&&(this.updateSort(),this.scrollerTables.clearContent(),this.scrollerTables.setScrollerContent(this.memberListData))},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLUB_REFRESH_BLESS_INFO_LIST,this.refreshList,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_LIST),this.getGroupList,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_MEMBER_LIST),this.getGroupMemberList,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubLuckMemeberBox=e,__reflect(e.prototype,"game.ClubLuckMemeberBox")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.prototype.parse=function(t){console.log(t),this.iconName=t.iconName,this.clubId=t.clubId,this.nickName=t.nickName,this.memberId=t.memberId,this.blessNum=t.blessNum,this.hasOnline=t.hasOnline},t}();t.ClubLuckMemeberListData=e,__reflect(e.prototype,"game.ClubLuckMemeberListData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.buttons=[],a.hasPoint=!1,a.isPlus=t,a.skinName="resource/skins/club/luckyScore/ClubLuckModifyNumBox.exml",a.buttons=[a.btn_0,a.btn_1,a.btn_2,a.btn_3,a.btn_4,a.btn_5,a.btn_6,a.btn_7,a.btn_8,a.btn_9],a}return __extends(a,e),a.prototype.updateSymbol=function(){this.hasPoint=!1,this.btn_plus.visible=!this.isPlus,this.btn_minus.visible=this.isPlus},a.prototype.updateText=function(){this.number.text=this.numbers},a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.numbers=this.isPlus?"+":"-",this.updateSymbol(),this.updateText(),this.addTapEvent(this.btn_plus,function(){a.isPlus=!0,a.numbers="+",a.updateSymbol(),a.updateText()}),this.addTapEvent(this.btn_minus,function(){a.isPlus=!1,a.numbers="-",a.updateSymbol(),a.updateText()}),this.addTapEvent(this.btn_delete,function(){if(1!=a.numbers.length){var t=a.numbers.search(/\./);-1!=t&&t==a.numbers.length-1&&(console.log("删除小数点"),a.hasPoint=!1),a.numbers=a.numbers.substring(0,a.numbers.length-1),a.updateText()}}),this.addTapEvent(this.btn_point,function(){1==a.numbers.length&&(a.numbers+="0"),a.numbers+=".",a.hasPoint=!0,a.updateText()}),this.addTapEvent(this.btn_close,function(){a.close()}),this.addTapEvent(this.btn_confirm,function(){t.EAppFacade.getInstance().sendNotification("SEND_NUMER",a.numbers),a.close()});for(var i=function(e){n.addTapEvent(n.buttons[e],function(){var i=a.numbers+e.toString();if(a.hasPoint){var n=i.split(".");if(n[1].length>2)return void t.DialogManager.getInstance().popUp1("小数点后只能输入两位数!")}else if(Math.abs(parseInt(i))>99999)return void t.DialogManager.getInstance().popUp1("最大只能输入到万位!");a.numbers+=e.toString(),a.updateText()})},n=this,o=0;o<this.buttons.length;o++)i(o)},a.prototype.updateUI_=function(){},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EDialog);t.ClubLuckModifyNumBox=e,__reflect(e.prototype,"game.ClubLuckModifyNumBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.clubData=t,i.listData=a,i.skinName="resource/skins/club/luckyScore/clubLuckyMemberItem.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnModify,function(){var e=new t.ClubLuckySendBox({clubId:a.clubData.clubId,userId:a.listData.memberId,nickName:a.listData.nickName,iconName:a.listData.iconName});t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)}),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.listData=e,this.updateUI()},a.prototype.updateUI_=function(){var e=this;t.ResManager.loadWebImage(this.listData.iconName,function(t){e.imgHead.texture=t,e.imgHead.addEventListener(eui.UIEvent.COMPLETE,function(){e.imgHead.texture=t},e)},this),GameUtils.sub(this.lbName,this.listData.nickName,117),this.lbID.text=""+this.listData.memberId,this.lbBless.text=""+this.listData.blessNum,this.listData.hasOnline?(this.lbIsOnline.text="在线",this.lbIsOnline.textColor=5488664):(this.lbIsOnline.text="离线",this.lbIsOnline.textColor=14693914)},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.clubLuckyMemberItem=e,__reflect(e.prototype,"game.clubLuckyMemberItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.clubData=t,i.recordsData=a,i.skinName="resource/skins/club/luckyScore/ClubLuckyRecordItem.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.recordsData=e,this.updateUI()},a.prototype.updateUI_=function(){var e=["试试手气","麻将","比鸡","转蛋","体力商城","跑得快"],a=this.recordsData.source,i=this.recordsData.changeNum,n=this.recordsData.nickName||"您",o=e[a-1];GameUtils.sub(this.desc,n,177),n=this.desc.text,this.desc.text="";var s=[];switch(a){case 1:s=i>=0?[{text:'管理员将"'+n+'"的体力增加',style:{size:26,textColor:10308874}},{text:""+Math.abs(i),style:{size:26,textColor:3440830}}]:[{text:'管理员将"'+n+'"的体力减少',style:{size:26,textColor:10308874}},{text:""+Math.abs(i),style:{size:26,textColor:3440830}}];break;case 2:case 3:case 4:case 6:s=i>0?[{text:n+'在"'+o+'"游戏中 体力 增加',style:{size:26,textColor:10308874}},{text:""+Math.abs(i),style:{size:26,textColor:3440830}}]:[{text:n+'在"'+o+'"游戏中 体力 减少',style:{size:26,textColor:10308874}},{text:""+Math.abs(i),style:{size:26,textColor:3440830}}];break;case 5:s=[{text:n+'在"'+o+'"中 体力 减少',style:{size:26,textColor:10308874}},{text:""+Math.abs(i),style:{size:26,textColor:3440830}}]}this.desc.textFlow=s,this.date.text=t.DateUtils.dateFormat(this.recordsData.createTime)},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubLuckyRecordItem=e,__reflect(e.prototype,"game.ClubLuckyRecordItem")}(game||(game={}));var ClubLuckyScore=function(t){function e(){var e=t.call(this)||this;return e.ClubBlessChangeRecordList=[],e.OneClubBlessChangeRecordList=[],e.curList=[],e.skinName="resource/skins/club/luckyScore/ClubLuckyScore.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_myblessnum),this.getMyBlessDataCallBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.CLICK_CLUB_Bless,this.getMyBless,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.CLUB_REFRESH_BLESS_LIST,this.updateList,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_Combat_REPLAY_data),this.getCombatReplayDataCallback,this),this.initScroller()},e.prototype.updateList=function(t){if(null!=t.data){this.OneClubBlessChangeRecordList=[];for(var e in t.data.blessChangeRecords){var a=t.data.blessChangeRecords[e],i=new game.ClubBlessChangedRecordsData;i.parse(a),this.OneClubBlessChangeRecordList.push(i)}this.curList=this.OneClubBlessChangeRecordList,this.updateUI()}},e.prototype.getMyBless=function(t){if(null!=t.data){var e=t.data;this.clubData=e,game.ClubService.getInstance().getMyBlessNumber(this.clubData.clubId)}},e.prototype.getMyBlessDataCallBack=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){this.ClubBlessChangeRecordList=[],this.clubData.blessNum=e.data.blessNum;for(var a in e.data.blessChangeRecords){var i=e.data.blessChangeRecords[a],n=new game.ClubBlessChangedRecordsData;n.parse(i),this.ClubBlessChangeRecordList.push(n)}this.curList=this.ClubBlessChangeRecordList,game.EAppFacade.getInstance().sendNotification(game.GameCmd.CLUB_UPDATE_BLESS_VALUE,this.clubData),this.updateUI()}},e.prototype.getCombatReplayDataCallback=function(t){game.CommonView.hideWaiting();var e=t.data;if(e.code==game.CmdResultType.SUCCESS){var a=e.data;GlobalData.gameData.setAllOverData(a),game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.gameOverBox.index,{isFromReplay:!0})}},e.prototype.updateUI_=function(){this.clubData&&(this.scrollerTables.clearContent(),this.scrollerTables.setScrollerContent(this.curList))},e.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(60,4),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.ClubLuckySendRecordListItem2(t);return e},e.prototype.updateElement=function(t,e){t.setData(e)},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.clean=function(){game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_myblessnum),this.getMyBlessDataCallBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.CLICK_CLUB_Bless,this.getMyBless,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.CLUB_REFRESH_BLESS_LIST,this.updateList,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_Combat_REPLAY_data),this.getCombatReplayDataCallback,this),t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ClubLuckyScore.prototype,"ClubLuckyScore");var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.skinName="resource/skins/club/luckyScore/ClubLuckySendBox.exml",a.data=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.editSearch.restrict="0-9\\-\\+",this.editSearch.text="",t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_blessmember),this.getBlessMerberBack,this),t.EAppFacade.getInstance().registerCommand("SEND_NUMER",this.getSendNumber,this),this.addTapEvent(this.Button_plus,function(){var e=new t.ClubLuckModifyNumBox(!0);t.DialogManager.getInstance().show(e)}),this.addTapEvent(this.Button_minus,function(){var e=new t.ClubLuckModifyNumBox(!1);t.DialogManager.getInstance().show(e)}),this.addTapEvent(this.Button_help,function(){var e=a.Button_help.parent.localToGlobal(a.Button_help.x,a.Button_help.y),i=e.x,n=e.y;t.TipsUtils.showTips(2,i+20,n+40,"点击+-号可以对成员体力进行增减操作。",280)}),this.addTapEvent(this.btn_close,function(){a.close()}),this.addTapEvent(this.btn_save,function(){if(0==a.editSearch.text.length)return void t.CommonView.showToast("请输入赠送数字");var e=Number(a.editSearch.text);if(isNaN(e))return void t.CommonView.showToast("请检查输入内容");if(Math.abs(e)>99999)return void t.DialogManager.getInstance().popUp1("99999代表满满的祝福，你送的祝福太多了吧");var i="是否确认赠加"+Math.abs(e)+"体力给玩家"+a.data.nickName+"?";0>e&&(i="是否确认让玩家"+a.data.nickName+"减少"+Math.abs(e)+"体力?"),t.DialogManager.getInstance().popUp2(i,function(){var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_blessmember,{clubId:a.data.clubId,toMemberId:a.data.userId,blessNum:e});t.SocketManager.getInstance().send(i)})}),this.updateUI()},a.prototype.getBlessMerberBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLUB_REFRESH_BLESS_INFO_LIST,e.data.data),t.CommonView.showToast("修改成功！"),this.close())},a.prototype.getSendNumber=function(t){this.sendNumber=t.data,this.editSearch.text=this.sendNumber},a.prototype.updateUI_=function(){var e=this;this.lbName.text="昵称："+this.data.nickName,this.lbID.text="ID："+this.data.userId,t.ResManager.loadWebImage(this.data.iconName,function(t){e.imgHead.texture=t,e.imgHead.addEventListener(eui.UIEvent.COMPLETE,function(){e.imgHead.texture=t},e)},this)},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_blessmember),this.getBlessMerberBack,this),t.EAppFacade.getInstance().removeCommand("SEND_NUMER",this.getSendNumber,this)},a}(t.EDialog);t.ClubLuckySendBox=e,__reflect(e.prototype,"game.ClubLuckySendBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this,null,!1)||this;return i.dateDataList=[],i.recordsListData=[],i.selecedData=null,i.blessTotalAdd=0,i.blessTotalSub=0,i.skinName="resource/skins/club/luckyScore/ClubLuckySendRecordBox.exml",i.clubData=t,i.groupId=a,i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this);for(var i=t.DateUtils.getRangeDate(-7,"more",["","月","号"]),n=0;n<i.length;n++){var o=i[n],s={selected:!1,days:o,daysAgo:n};if(0==n){s.selected=!0;var r=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_blessrecord,{clubId:this.clubData.clubId,daysAgo:s.daysAgo,unGrant:!1,groupId:this.groupId});t.SocketManager.getInstance().send(r)}this.dateDataList.push(s)}t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLICK_CLUB_MODIFY_BLESS_RECORDS_ITEM,this.click_item,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_blessrecord),this.getBlessRecords,this),this.addTapEvent(this.btn_close,function(){a.close()}),this.initScroller()},a.prototype.click_item=function(e){var a=e.data;this.selecedData=a;for(var i=0;i<this.dateDataList.length;i++)this.dateDataList[i].selected=this.dateDataList[i]==this.selecedData;this.scrollerTab.updateUI();var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_blessrecord,{clubId:this.clubData.clubId,daysAgo:a.daysAgo,unGrant:!1,groupId:this.groupId});t.SocketManager.getInstance().send(n)},a.prototype.getBlessRecords=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data.blessRecords;this.recordsListData=i,this.blessTotalAdd=0,this.blessTotalSub=0;for(var n=0;n<this.recordsListData.length;n++)this.recordsListData[n].blessNum>0?this.blessTotalAdd+=this.recordsListData[n].blessNum:this.recordsListData[n].blessNum<0&&(this.blessTotalSub+=this.recordsListData[n].blessNum);this.blessTotalSub=Math.abs(this.blessTotalSub),this.updateUI()}},a.prototype.initScroller=function(){this.scrollerTab.setElementViewInfo(64,4),this.scrollerTab.setElementCreateFunction(this.createTabElement.bind(this)),this.scrollerTab.setElementUpdateDataFun(this.updateTabElement.bind(this)),this.scrollerTab.setElementUpdateUIFun(this.updateTabElementUI.bind(this)),this.scrollerTab.setScrollerContent(this.dateDataList),this.scrollerDesc.setElementViewInfo(60,4),this.scrollerDesc.setElementCreateFunction(this.createRecordsListElement.bind(this)),this.scrollerDesc.setElementUpdateDataFun(this.updateRecordsListElement.bind(this)),this.scrollerDesc.setElementUpdateUIFun(this.updateRecordsListElementUI.bind(this)),this.scrollerDesc.setScrollerContent(this.recordsListData)},a.prototype.createTabElement=function(e){var a=new t.ClubLuckySendRecordDateItem(e);return a},a.prototype.updateTabElement=function(t,e){t.setData(e)},a.prototype.updateTabElementUI=function(t){t.updateUI()},a.prototype.createRecordsListElement=function(e){var a=new t.ClubLuckySendRecordListItem(e);return a},a.prototype.updateRecordsListElement=function(t,e){t.setData(e)},a.prototype.updateRecordsListElementUI=function(t){t.updateUI()},a.prototype.updateUI_=function(){this.scrollerDesc.clearContent(),this.scrollerDesc.setScrollerContent(this.recordsListData),this.lbTotalAdd.text="累计增加："+this.blessTotalAdd,this.lbTotalSub.text="累计减少："+this.blessTotalSub},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLICK_CLUB_MODIFY_BLESS_RECORDS_ITEM,this.click_item,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_blessrecord),this.getBlessRecords,this)},a}(t.EDialog);t.ClubLuckySendRecordBox=e,__reflect(e.prototype,"game.ClubLuckySendRecordBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.data=t,a.skinName="resource/skins/club/luckyScore/ClubLuckySendRecordDateItem.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.tab,this.clickItem),this.lbDate.touchEnabled=!1,this.updateUI()},a.prototype.setData=function(t){this.updateUI()},a.prototype.clickItem=function(){t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_MODIFY_BLESS_RECORDS_ITEM,this.data)},a.prototype.updateUI_=function(){this.lbDate.text=this.data.days,this.tab.selected=this.data.selected,this.tab.selected?(this.lbDate.strokeColor=12279105,this.lbDate.textColor=16777215,this.lbDate.stroke=2):(this.lbDate.strokeColor=16045731,this.lbDate.textColor=8412465,this.lbDate.stroke=0)},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubLuckySendRecordDateItem=e,__reflect(e.prototype,"game.ClubLuckySendRecordDateItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.data=t,a.skinName="resource/skins/club/luckyScore/ClubLuckySendRecordListItem.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.updateUI()},a.prototype.setData=function(t){this.data=t,this.updateUI()},a.prototype.updateUI_=function(){this.Text_time.text=t.DateUtils.dateFormat1(this.data.createTime,!0,!0),this.Text_limitValue.text=this.data.curBlessNum,this.data.blessNum>0?this.Text_changedValue.text="+"+this.data.blessNum:this.Text_changedValue.text=""+this.data.blessNum,GameUtils.sub(this.Text_type,this.data.fromUserName,144);var e=this.Text_type.text;GameUtils.sub(this.Text_type,this.data.toUserName,144);var a=this.Text_type.text;this.Text_type.text=a+"("+this.data.toUserId+")",this.Text_operator.text=e},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubLuckySendRecordListItem=e,__reflect(e.prototype,"game.ClubLuckySendRecordListItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.data=t,a.skinName="resource/skins/club/luckyScore/ClubLuckySendRecordListItem2.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this,function(){var e=a.data.operId,i=a.data.source;if("undefined"!=typeof e&&null!=e)switch(i){case 2:case 3:case 4:case 6:var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_Combat_REPLAY_data,{roomId:e});t.SocketManager.getInstance().send(n)}}),this.updateUI()},a.prototype.setData=function(t){this.data=t,this.updateUI()},a.prototype.updateUI_=function(){this.Text_time.text=t.DateUtils.dateFormat1(this.data.createTime,!0,!1),this.Text_limitValue.text=this.data.curBlessNum,this.data.changeNum>0?this.Text_changedValue.text="+"+this.data.changeNum:this.Text_changedValue.text=""+this.data.changeNum,this.Text_type.text=this.data.operTypeInfo,2==this.data.source||3==this.data.source||4==this.data.source||6==this.data.source?this.Text_operator.text="房间号："+this.data.operName:this.Text_operator.text=this.data.operName},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubLuckySendRecordListItem2=e,__reflect(e.prototype,"game.ClubLuckySendRecordListItem2")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.prototype.parse=function(t){this.memberId=t.memberId,this.memberType=t.memberType,this.memberName=t.memberName,this.headImgUrl=t.headImgUrl,this.hasOnline=t.hasOnline,this.achieveNum=t.achieveNum,this.todayAchieveNum=t.todayAchieveNum,this.forbidGame=t.forbidGame,this.watcher=t.watcher,this.permissions=t.permissions||[]},t}();t.ClubMemberData=e,__reflect(e.prototype,"game.ClubMemberData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.clubData=t,i.clubMemberData=a,i.skinName="resource/skins/club/member/clubMemberItemSkin.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnSetting,this.clickMemberManage),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SET_MEMBER),this.setMemberCallback,this),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.clubMemberData=e,this.updateUI()},a.prototype.updateUI_=function(){if(null!=this.clubMemberData){var e=this;e.imgHead.visible=!1,t.ResManager.loadWebImage(this.clubMemberData.headImgUrl,function(t,a){return a!=this.clubMemberData.headImgUrl?void console.log("url 不一样"):(e.imgHead.visible=!0,void(e.imgHead.texture=t))},this),this.labelMemberName.text=this.clubMemberData.memberName,this.labelMemberID.text="ID:"+this.clubMemberData.memberId,this.imgMemberType.visible=!0,this.clubMemberData.memberType==ClubConst.MemberType.MONITOR?this.imgMemberType.source="img_club_member_position_1_png":this.imgMemberType.visible=!1,this.labelStatus.text=this.clubMemberData.hasOnline?"在线":"离线",this.labelStatus.textColor=this.clubMemberData.hasOnline?3001920:10309128,this.labelTodayNum.text=this.clubMemberData.todayAchieveNum+"局",this.labelTotalNum.text=this.clubMemberData.achieveNum+"局";var a=t.ClubService.getInstance().checkDefaultRight(this.clubData.permissions);this.labelTotalNum.visible=a,this.btnSetting.visible=a&&this.clubMemberData.memberType!=ClubConst.MemberType.MONITOR,this.imgWatcher.visible=this.clubMemberData.watcher,this.imgGameStatus.visible=this.clubMemberData.forbidGame}},a.prototype.clickMemberManage=function(){var e=new t.clubMemberManageDialog(this.clubData,this.clubMemberData);t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.setMemberCallback=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data;this.clubMemberData.memberId==i.memberId&&(this.clubMemberData=i,this.updateUI())}},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SET_MEMBER),this.setMemberCallback,this),e.prototype.clean.call(this)},a}(t.EComponent);t.ClubMemberItem=e,__reflect(e.prototype,"game.ClubMemberItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.tabState=0,i.clubData=t,i.clubMemberData=a,i.skinName="resource/skins/club/member/clubMemberManageUISkin.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;if(e.prototype.onCreateViewComplete.call(this),this.clubData.memberType==ClubConst.MemberType.MONITOR){var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_get_permission,{clubId:this.clubData.clubId,memberId:this.clubMemberData.memberId});t.SocketManager.getInstance().send(i)}this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnAllowGame,this.clickAllowGame),this.addTapEvent(this.btnForbidGame,this.clickForbidGame),this.addTapEvent(this.btnKickMember,this.clickKickMember),this.addTapEvent(this.Button_forbid,function(){a.tabState=0,a.updateUI()}),this.addTapEvent(this.Button_permission,function(){a.tabState=1,a.updateUI()}),this.addTapEvent(this.btnSave,function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_set_permission,{clubId:a.clubData.clubId,memberId:a.clubMemberData.memberId,permissions:a.clubMemberData.permissions});t.SocketManager.getInstance().send(e)}),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SET_MEMBER),this.operCallback,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_forbid_game),this.operCallback,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_REMOVEMEMBER),this.kickMemberCallback,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_get_permission),this.getMemberPermission,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_set_permission),this.setMemberPermission,this),this.radioRoomRules.setText("房间规则"),this.radioRoomRules.setFontFamily("fzzy"),this.radioRoomRules.setFontColor(6834735),this.radioRoomRules.setFontSize(26),this.radioRoomRules.setSelected(1==this.clubMemberData.permissions[ClubConst.PermissionType.Key_roomRules]),this.addTapEvent(this.radioRoomRules,function(){1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_roomRules]?a.clubMemberData.permissions[ClubConst.PermissionType.Key_roomRules]=0:a.clubMemberData.permissions[ClubConst.PermissionType.Key_roomRules]=1,a.radioRoomRules.setSelected(1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_roomRules])}),this.radioCancelRoom.setText("房间解散"),this.radioCancelRoom.setFontFamily("fzzy"),this.radioCancelRoom.setFontColor(6834735),this.radioCancelRoom.setFontSize(26),this.radioCancelRoom.setSelected(1==this.clubMemberData.permissions[ClubConst.PermissionType.Key_cancelRoom]),this.addTapEvent(this.radioCancelRoom,function(){1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_cancelRoom]?a.clubMemberData.permissions[ClubConst.PermissionType.Key_cancelRoom]=0:a.clubMemberData.permissions[ClubConst.PermissionType.Key_cancelRoom]=1,a.radioCancelRoom.setSelected(1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_cancelRoom])}),this.radioEditNotice.setText("编辑公告"),this.radioEditNotice.setFontFamily("fzzy"),this.radioEditNotice.setFontColor(6834735),this.radioEditNotice.setFontSize(26),this.radioEditNotice.setSelected(1==this.clubMemberData.permissions[ClubConst.PermissionType.Key_editNotice]),this.addTapEvent(this.radioEditNotice,function(){1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_editNotice]?a.clubMemberData.permissions[ClubConst.PermissionType.Key_editNotice]=0:a.clubMemberData.permissions[ClubConst.PermissionType.Key_editNotice]=1,a.radioEditNotice.setSelected(1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_editNotice])}),this.radioMemberManager.setText("成员管理"),this.radioMemberManager.setFontFamily("fzzy"),this.radioMemberManager.setFontColor(6834735),this.radioMemberManager.setFontSize(26),this.radioMemberManager.setSelected(1==this.clubMemberData.permissions[ClubConst.PermissionType.Key_memberManager]),this.addTapEvent(this.radioMemberManager,function(){1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_memberManager]?a.clubMemberData.permissions[ClubConst.PermissionType.Key_memberManager]=0:a.clubMemberData.permissions[ClubConst.PermissionType.Key_memberManager]=1,a.radioMemberManager.setSelected(1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_memberManager])}),this.radioRecordManager.setText("记录管理"),this.radioRecordManager.setFontFamily("fzzy"),this.radioRecordManager.setFontColor(6834735),this.radioRecordManager.setFontSize(26),this.radioRecordManager.setSelected(1==this.clubMemberData.permissions[ClubConst.PermissionType.key_record]),this.addTapEvent(this.radioRecordManager,function(){1==a.clubMemberData.permissions[ClubConst.PermissionType.key_record]?a.clubMemberData.permissions[ClubConst.PermissionType.key_record]=0:a.clubMemberData.permissions[ClubConst.PermissionType.key_record]=1,a.radioRecordManager.setSelected(1==a.clubMemberData.permissions[ClubConst.PermissionType.key_record])
}),this.radioOperLog.setText("操作日志"),this.radioOperLog.setFontFamily("fzzy"),this.radioOperLog.setFontColor(6834735),this.radioOperLog.setFontSize(26),this.radioOperLog.setSelected(1==this.clubMemberData.permissions[ClubConst.PermissionType.Key_operLog]),this.addTapEvent(this.radioOperLog,function(){1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_operLog]?a.clubMemberData.permissions[ClubConst.PermissionType.Key_operLog]=0:a.clubMemberData.permissions[ClubConst.PermissionType.Key_operLog]=1,a.radioOperLog.setSelected(1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_operLog])}),this.radioDivideManager.setText("隔离组管理"),this.radioDivideManager.setFontFamily("fzzy"),this.radioDivideManager.setFontColor(6834735),this.radioDivideManager.setFontSize(26),this.radioDivideManager.setSelected(1==this.clubMemberData.permissions[ClubConst.PermissionType.Key_divideManage]),this.addTapEvent(this.radioDivideManager,function(){1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_divideManage]?a.clubMemberData.permissions[ClubConst.PermissionType.Key_divideManage]=0:a.clubMemberData.permissions[ClubConst.PermissionType.Key_divideManage]=1,a.radioDivideManager.setSelected(1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_divideManage])}),this.radioBlessManager.setText("体力管理"),this.radioBlessManager.setFontFamily("fzzy"),this.radioBlessManager.setFontColor(6834735),this.radioBlessManager.setFontSize(26),this.radioBlessManager.setSelected(1==this.clubMemberData.permissions[ClubConst.PermissionType.Key_blessManage]),this.addTapEvent(this.radioBlessManager,function(){1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_blessManage]?a.clubMemberData.permissions[ClubConst.PermissionType.Key_blessManage]=0:a.clubMemberData.permissions[ClubConst.PermissionType.Key_blessManage]=1,a.radioBlessManager.setSelected(1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_blessManage])}),this.radioPartnerManager.visible=this.clubData.superBlessSwitch,this.radioPartnerManager.setText("合伙组管理"),this.radioPartnerManager.setFontFamily("fzzy"),this.radioPartnerManager.setFontColor(6834735),this.radioPartnerManager.setFontSize(26),this.radioPartnerManager.setSelected(1==this.clubMemberData.permissions[ClubConst.PermissionType.Key_oppartber]),this.addTapEvent(this.radioPartnerManager,function(){1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_oppartber]?a.clubMemberData.permissions[ClubConst.PermissionType.Key_oppartber]=0:a.clubMemberData.permissions[ClubConst.PermissionType.Key_oppartber]=1,a.radioPartnerManager.setSelected(1==a.clubMemberData.permissions[ClubConst.PermissionType.Key_oppartber])}),this.updateUI()},a.prototype.setContentPostion=function(t){this.group.x=t.x-this.group.width-10,this.group.y=t.y-50},a.prototype.updateUI_=function(){var e=this.clubData.memberType==ClubConst.MemberType.MONITOR;this.groupTab.visible=e,0==this.tabState?(this.Button_forbid.alpha=1,this.Button_permission.alpha=0,this.group1.visible=!0,this.group2.visible=!1,this.labelTitle.text="设置【"+this.clubMemberData.memberName+"】成员状态:"):(this.Button_forbid.alpha=0,this.Button_permission.alpha=1,this.group1.visible=!1,this.group2.visible=!0,this.labelTitle.text="设置【"+this.clubMemberData.memberName+"】成员拥有以下权限:");var a=this.clubMemberData.forbidGame;this.labelGameStatus.text=a?"禁止游戏":"允许游戏";var i=t.ClubService.getInstance().checkRight(this.clubData.permissions,ClubConst.PermissionType.Key_memberManager);i?(this.btnAllowGame.enabled=a,this.btnForbidGame.enabled=!a):(this.btnAllowGame.enabled=!1,this.btnForbidGame.enabled=!1)},a.prototype.checkPermissions=function(e){return t.ClubService.getInstance().checkRight(this.clubMemberData.permissions,e)},a.prototype.clickAllowGame=function(){var e=this.clubData.clubId,a=this.clubMemberData.memberId;t.ClubService.getInstance().allowGame(e,a)},a.prototype.clickForbidGame=function(){var e=this.clubData.clubId,a=this.clubMemberData.memberId;t.ClubService.getInstance().forbidGame(e,a)},a.prototype.operCallback=function(e){var a=this,i=e.data;i.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("操作成功"),a.clubMemberData=i.data,a.updateUI())},a.prototype.clickKickMember=function(){var e=this.clubData.clubId,a=this.clubMemberData.memberId;t.ClubService.getInstance().kickMember(e,a)},a.prototype.kickMemberCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.close(),t.CommonView.showToast("操作成功"))},a.prototype.getMemberPermission=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.clubMemberData.permissions=a.data.permissions||[])},a.prototype.setMemberPermission=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&t.CommonView.showToast("保存成功")},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SET_MEMBER),this.operCallback,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_forbid_game),this.operCallback,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_REMOVEMEMBER),this.kickMemberCallback,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_get_permission),this.getMemberPermission,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_set_permission),this.setMemberPermission,this),e.prototype.clean.call(this)},a}(t.EDialog);t.clubMemberManageDialog=e,__reflect(e.prototype,"game.clubMemberManageDialog")}(game||(game={}));var ClubMembersUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/club/member/clubMembersUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_MEMBERLIST),this.getClubMemberListBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.CLICK_CLUB_Members,this.getClubMemberList,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_REMOVEMEMBER),this.kickMemberCallback,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_SET_MEMBER),this.operCallback,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_forbid_game),this.operCallback,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_setWatcher),this.operSetWatcherCallback,this),this.initScroller()},e.prototype.updateUI_=function(){if(this.clubData){var t=game.ClubService.getInstance().checkDefaultRight(this.clubData.permissions);this.labelTotalNumTitle.visible=t,this.scrollerTables.setScrollerContent(this.clubMemberDataList)}},e.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(104,8),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.ClubMemberItem(this.clubData,t);return e},e.prototype.updateElement=function(t,e){t.setData(this.clubData,e)},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.getClubMemberList=function(t){if(null!=t.data){var e=t.data;this.clubData=e.clubData;var a=e.patternType,i=e.patternContent;game.ClubService.getInstance().getClubMemberList(this.clubData.clubId,a,i)}},e.prototype.getClubMemberListBack=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){this.clubMemberDataList=[],this.clubMemberDataListAll=[];var a=e.data,i=a.clubMemberList;for(var n in i){var o=i[n],s=new game.ClubMemberData;s.parse(o),this.clubMemberDataList.push(s),this.clubMemberDataListAll.push(s)}this.updateUI()}},e.prototype.operCallback=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){var a=e.data;this.updateMemberData(a),this.updateUI()}},e.prototype.kickMemberCallback=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){for(var a in this.clubMemberDataListAll)if(this.clubMemberDataListAll[a].memberId==e.data.memberId){this.clubMemberDataListAll.splice(Number(a),1);break}for(var a in this.clubMemberDataList)if(this.clubMemberDataList[a].memberId==e.data.memberId){this.clubMemberDataList.splice(Number(a),1);break}this.scrollerTables.updateUI()}},e.prototype.operSetWatcherCallback=function(t){this.clearWatcherStatus(),this.operCallback(t)},e.prototype.updateMemberData=function(t){var e=0;null!=this.clubMemberDataList&&(e=this.clubMemberDataList.length);for(var a=0;e>a;a++)if(this.clubMemberDataList[a].memberId==t.memberId)return this.clubMemberDataList[a]=t,!0;return!1},e.prototype.clearWatcherStatus=function(){var t=0;null!=this.clubMemberDataList&&(t=this.clubMemberDataList.length);for(var e=0;t>e;e++)this.clubMemberDataList[e].watcher=!1},e.prototype.filterMember=function(t){for(var e=[],a=this.clubMemberDataListAll.length,i=0;a>i;i++){var n=this.clubMemberDataListAll[i];((n.memberId+"").indexOf(t)>=0||n.memberName.indexOf(t)>=0)&&e.push(n)}0==e.length?game.CommonView.showToast("未找到对应的玩家"):(this.clubMemberDataList=e,this.updateUI())},e.prototype.clean=function(){game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_REMOVEMEMBER),this.kickMemberCallback,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_MEMBERLIST),this.getClubMemberListBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.CLICK_CLUB_Members,this.getClubMemberList,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_SET_MEMBER),this.operCallback,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_forbid_game),this.operCallback,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_setWatcher),this.operCallback,this),t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ClubMembersUI.prototype,"ClubMembersUI"),window.ClubMembersUI=ClubMembersUI;var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.patternType=0,a.clubData=t,a.skinName="resource/skins/club/member/ClubSearchDialogSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnIDFind,this.searchMemberID),this.addTapEvent(this.btnTypeFind,this.searchMemberType),this.addTapEvent(this.radioAll,this.clickRadioAll),this.addTapEvent(this.radioForbidGame,this.clickRadioForbidGame),this.addTapEvent(this.editSearch,this.resetSearch),this.radioAll.setText("全体成员"),this.radioAll.setFontFamily("fzch"),this.radioAll.setFontSize(30),this.radioForbidGame.setText("禁止参与游戏"),this.radioForbidGame.setFontFamily("fzch"),this.radioForbidGame.setFontSize(30),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_MEMBERLIST),this.getClubMemberListBack,this),this.updateUI()},a.prototype.updateUI_=function(){var t=!1;0==this.patternType&&(t=!0),this.radioAll.setSelected(t),this.radioForbidGame.setSelected(!t)},a.prototype.searchMemberID=function(){var e=this.editSearch.text.trim(),a={clubData:this.clubData,patternType:0,patternContent:e};t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_Members,a)},a.prototype.searchMemberType=function(){var e=(this.editSearch.text.trim(),{clubData:this.clubData,patternType:this.patternType,patternContent:""});t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_Members,e)},a.prototype.getClubMemberListBack=function(e){var a=this,i=e.data;i.code==t.CmdResultType.SUCCESS&&a.close()},a.prototype.clickRadioAll=function(){this.patternType=0,this.updateUI()},a.prototype.clickRadioForbidGame=function(){this.patternType=1,this.updateUI()},a.prototype.resetSearch=function(){this.editSearch.text=""},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_MEMBERLIST),this.getClubMemberListBack,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubSearchDialog=e,__reflect(e.prototype,"game.ClubSearchDialog")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.skinName="resource/skins/club/partner/clubAddGroupBox.exml",a.clubId=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_ADD),this.addGroupCallBack,this),this.addTapEvent(this.btnClose,function(){a.close()}),this.addTapEvent(this.btn,function(){var e=a.editSearch.text.trim();if(0==e.length)return void t.DialogManager.getInstance().popUp1("合伙组名称不能为空");if(Utils.getCharLen(e)>12)return void t.DialogManager.getInstance().popUp1("合伙组名称最多6个字");var i=Utils.isHasSpecialWord(e);if(i)return void t.DialogManager.getInstance().popUp1("合伙组名称不能含有特殊字符");var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_ADD,{clubId:a.clubId,groupName:e});t.SocketManager.getInstance().send(n)})},a.prototype.addGroupCallBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&this.close()},a.prototype.updateUI_=function(){},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_ADD),this.addGroupCallBack,this)},a}(t.EDialog);t.ClubAddGroupBox=e,__reflect(e.prototype,"game.ClubAddGroupBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.skinName="resource/skins/club/partner/clubCancelManagerBox.exml",a.data=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btn_close,function(){a.close()}),this.addTapEvent(this.Button_cancel,function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_SET_MANAGER,{clubId:a.data.clubId,groupId:a.data.curGroup.groupId,memberId:a.data.member[0].id,userType:0});t.SocketManager.getInstance().send(e)}),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_SET_MANAGER),this.setManagerCallBack,this),this.updateUI()},a.prototype.setManagerCallBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("取消管理员成功"),this.close())},a.prototype.updateUI_=function(){var e=this;GameUtils.sub(this.Text_name,this.data.member[0].nickName,114),this.groupName.text=this.data.curGroup.groupName,this.Text_id.text="ID:"+this.data.member[0].id,t.ResManager.loadWebImage(this.data.member[0].headImgUrl,function(t,a){e.data.member[0].headImgUrl==a&&(e.Image_head.texture=t,e.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){e.Image_head.texture=t},e))},this)},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_SET_MANAGER),this.setManagerCallBack,this)},a}(t.EDialog);t.ClubCancelManagerBox=e,__reflect(e.prototype,"game.ClubCancelManagerBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.clubData=t,i.listData=a,i.skinName="resource/skins/club/partner/clubLuckyListGeneralItem.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.Button_send,function(){var e=new t.ClubLuckySendBox({clubId:a.clubData.clubId,userId:a.listData.memberId,nickName:a.listData.nickName,iconName:a.listData.iconName});t.DialogManager.getInstance().show(e)}),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.listData=e,this.updateUI()},a.prototype.updateUI_=function(){var e=this;this.Button_send.visible=this.listData.canModifyPower,GameUtils.sub(this.Text_name,this.listData.nickName,114),t.ResManager.loadWebImage(this.listData.iconName,function(t){e.headImage.texture=t,e.headImage.addEventListener(eui.UIEvent.COMPLETE,function(){e.headImage.texture=t},e)},this),this.Text_ID.text="ID:"+this.listData.memberId,this.Image_admin_icon.visible=1==this.listData.userType,this.Text_group_name.text=""==this.listData.groupName?"无":this.listData.groupName,this.Text_bless_num.text=""+this.listData.blessNum},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubLuckyListGeneralItem=e,__reflect(e.prototype,"game.ClubLuckyListGeneralItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.clubData=t,i.listData=a,i.skinName="resource/skins/club/partner/clubLuckyListGeneralItem2.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.listData=e,this.updateUI()},a.prototype.updateUI_=function(){var e=this;GameUtils.sub(this.Text_name,this.listData.nickName,114),t.ResManager.loadWebImage(this.listData.iconName,function(t){e.headImage.texture=t,e.headImage.addEventListener(eui.UIEvent.COMPLETE,function(){e.headImage.texture=t},e)},this),this.Text_ID.text="ID:"+this.listData.memberId,this.Image_admin_icon.visible=1==this.listData.userType,this.Text_group_name.text=""==this.listData.groupName?"无":this.listData.groupName,this.Text_bless_num.text=""+this.listData.blessNum,this.Text_bless_num.visible=this.clubData.superBlessSwitch},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubLuckyListGeneralItem2=e,__reflect(e.prototype,"game.ClubLuckyListGeneralItem2")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a,i,n){var o=e.call(this)||this;return o.clubData=t,o.listData=a,o.modifyAnyoneSwitch=n,o.groupData=i,o.skinName="resource/skins/club/partner/clubLuckyListGeneralItemBySelect.exml",o}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.CheckBox_selected.setText(""),this.addTapEvent(this.selected,function(){a.listData.isSelected=!a.listData.isSelected,a.listData.isSelected?a.obj.selectedCount++:a.obj.selectedCount--,a.obj.selectedCount>10&&(t.DialogManager.getInstance().popUp1("最多可以选择10名玩家"),a.obj.selectedCount--,a.listData.isSelected=!1),a.CheckBox_selected.setSelected(a.listData.isSelected)}),this.addTapEvent(this.Button_settingBelong,this.clickBtnSetBelong),this.addTapEvent(this.Button_setting,this.clickBtnSetting),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.listData=e,this.updateUI()},a.prototype.setObj=function(t){this.obj=t},a.prototype.clickBtnSetting=function(){if(this.modifyAnyoneSwitch){var e={clubId:this.clubData.clubId,member:[{nickName:this.listData.nickName,id:this.listData.memberId,blessNum:this.listData.blessNum}],curGroup:{groupId:this.listData.groupId,groupName:this.listData.groupName},group:this.groupData,modifyAnyoneSwitch:this.modifyAnyoneSwitch},a=new t.ClubSetBelongToBox(e);t.DialogManager.getInstance().show(a)}else if(0==this.listData.userType){var e={clubId:this.clubData.clubId,member:[{nickName:this.listData.nickName,id:this.listData.memberId,blessNum:this.listData.blessNum,headImgUrl:this.listData.iconName}],curGroup:{groupId:this.listData.groupId,groupName:this.listData.groupName},group:this.groupData,modifyAnyoneSwitch:this.modifyAnyoneSwitch},a=new t.ClubSetManagerAndGroupBox(e);t.DialogManager.getInstance().show(a)}else if(1==this.listData.userType){var e={clubId:this.clubData.clubId,member:[{nickName:this.listData.nickName,id:this.listData.memberId,blessNum:this.listData.blessNum,headImgUrl:this.listData.iconName}],curGroup:{groupId:this.listData.groupId,groupName:this.listData.groupName}},a=new t.ClubCancelManagerBox(e);t.DialogManager.getInstance().show(a)}},a.prototype.clickBtnSetBelong=function(){var e={clubId:this.clubData.clubId,member:[{nickName:this.listData.nickName,id:this.listData.memberId,blessNum:this.listData.blessNum}],curGroup:{groupId:this.listData.groupId,groupName:this.listData.groupName},group:this.groupData,modifyAnyoneSwitch:this.modifyAnyoneSwitch},a=new t.ClubSetBelongToBox(e);t.DialogManager.getInstance().show(a)},a.prototype.updateUI_=function(){var e=this;this.CheckBox_selected.setSelected(this.listData.isSelected),GameUtils.sub(this.Text_name,this.listData.nickName,114),t.ResManager.loadWebImage(this.listData.iconName,function(t,a){e.listData.iconName==a&&(e.headImage.texture=t,e.headImage.addEventListener(eui.UIEvent.COMPLETE,function(){e.headImage.texture=t},e))},this),this.Text_ID.text="ID:"+this.listData.memberId,this.Image_admin_icon.visible=1==this.listData.userType,this.Text_group_name.text=""==this.listData.groupName?"无":this.listData.groupName,this.Text_bless_num.text=""+this.listData.blessNum,this.Text_bless_num.visible=this.clubData.superBlessSwitch,0==this.listData.groupId?(this.Button_settingBelong.visible=!0,this.Button_setting.visible=!1):(this.Button_settingBelong.visible=!1,this.Button_setting.visible=!0)},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubLuckyListGeneralItemBySelect=e,__reflect(e.prototype,"game.ClubLuckyListGeneralItemBySelect")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a,i){var n=e.call(this,null,!1)||this;return n.curGroupName="",n.skinName="resource/skins/club/partner/clubModifyGroupNameBox.exml",n.clubId=t,n.groupId=a,n.curGroupName=i,n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_MODIFYGROUPNAME),this.modifyGroupNameCallBack,this),this.addTapEvent(this.btnClose,function(){a.close()}),this.addTapEvent(this.btn,function(){var e=a.editSearch.text.trim();if(0==e.length)return void t.DialogManager.getInstance().popUp1("合伙组名称不能为空");if(Utils.getCharLen(e)>12)return void t.DialogManager.getInstance().popUp1("合伙组名称最多6个字");var i=Utils.isHasSpecialWord(e);if(i)return void t.DialogManager.getInstance().popUp1("合伙组名称不能含有特殊字符");var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_MODIFYGROUPNAME,{clubId:a.clubId,groupId:a.groupId,groupName:e});t.SocketManager.getInstance().send(n)}),this.editSearch.text=this.curGroupName},a.prototype.modifyGroupNameCallBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&this.close()},a.prototype.updateUI_=function(){},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_MODIFYGROUPNAME),this.modifyGroupNameCallBack,this)},a}(t.EDialog);t.ClubModifyGroupNameBox=e,__reflect(e.prototype,"game.ClubModifyGroupNameBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this,null,!1)||this;return i.isOrderDown=!0,i.tableListData=[],i.onlyGourpData=[],i.memberListData=[],i.modifyAnyoneSwitch=!1,i.hasBlessManager=!1,i.tabClickIdx=0,i.curChoicePartnerGroupId=-1,i.curChoicePartnerGroupName="",i.isSearch=!1,i.SearchString="",i.selectedCount=0,i.skinName="resource/skins/club/partner/clubPartnerBox.exml",i.clubData=t,i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLUB_REFRESH_BLESS_INFO_LIST,this.refreshList,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_LIST),this.getGroupList,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_MEMBER_LIST),this.getGroupMemberList,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_ADD),this.addGroupCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_DEL),this.deleteGroupCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_MODIFYGROUPNAME),this.modifyGroupNameCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_BATCH_SETTING),this.batchSettingCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_MEMBER_DEL),this.batchSettingCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_SET_MANAGER),this.batchSettingCallBack,this),this.Group_unset_luckyTitle.visible=this.clubData.superBlessSwitch,this.Group_admin_luckyTitle.visible=this.clubData.superBlessSwitch;var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_LIST,{clubId:this.clubData.clubId,fromType:1});t.SocketManager.getInstance().send(i),this.addTapEvent(this.btn_close,function(){a.close()}),this.addTapEvent(this.btnSort_unSet,this.onSortClick),this.addTapEvent(this.btnSort_admin,this.onSortClick),this.addTapEvent(this.btnSearch,function(){var e=a.editSearch.text.trim();a.isSearch=!0,a.SearchString=e;var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_MEMBER_LIST,{groupId:a.curChoicePartnerGroupId,fromType:1,clubId:a.clubData.clubId,patternContent:e});t.SocketManager.getInstance().send(i)}),this.addTapEvent(this.Button_batch_of_belonging,function(){if(0==a.selectedCount)return void t.DialogManager.getInstance().popUp1("请先选择玩家");for(var e=[],i=0;i<a.memberListData.length;i++){var n=a.memberListData[i],o={nickName:"",id:0,blessNum:0};n.isSelected&&(o.nickName=n.nickName,o.id=n.memberId,o.blessNum=n.blessNum,e.push(o))}var s={clubId:a.clubData.clubId,member:e,curGroup:{groupId:1,groupName:""},group:a.onlyGourpData,modifyAnyoneSwitch:a.modifyAnyoneSwitch};-1==a.curChoicePartnerGroupId?(s.curGroup.groupName="",s.curGroup.groupId=-1):(s.curGroup.groupName=a.curChoicePartnerGroupName,s.curGroup.groupId=a.curChoicePartnerGroupId);var r=new t.ClubSetBelongToBox(s);t.DialogManager.getInstance().show(r)}),this.addTapEvent(this.Button_add_partnerGroup,function(){t.DialogManager.getInstance().show(new t.ClubAddGroupBox(a.clubData.clubId))}),this.addTapEvent(this.Button_delete_partnerGroup,function(){t.DialogManager.getInstance().popUp2("您确认删除当前合伙组吗？",function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_DEL,{groupId:a.curChoicePartnerGroupId,clubId:a.clubData.clubId});t.SocketManager.getInstance().send(e)})}),this.addTapEvent(this.Button_modify_name,function(){t.DialogManager.getInstance().show(new t.ClubModifyGroupNameBox(a.clubData.clubId,a.curChoicePartnerGroupId,a.curChoicePartnerGroupName))}),this.initScroller()},a.prototype.onSortClick=function(){console.log("列表排序"),this.isOrderDown=!this.isOrderDown,this.updateSort(),this.scrollerTables.updateUI()},a.prototype.getGroupMemberList=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.memberListData=[],this.selectedCount=0;var i=a.data;for(var n in i.groupMemberList){var o=new t.ClubPartnerMemberListData;o.parse(i.groupMemberList[n]),this.memberListData.push(o)}this.isOrderDown=!0,this.updateSort(),-2==i.groupId&&this.tabTo(null),this.scrollerTables.clearContent(),this.scrollerTables.setScrollerContent(this.memberListData)}},a.prototype.getGroupList=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.onlyGourpData=[],this.tableListData=[];var i=a.data;this.modifyAnyoneSwitch=i.isMonitorMode,this.hasBlessManager=i.hasBlessManager,this.modifyAnyoneSwitch?this.Text_desc.text="当前为会长管理模式":this.Text_desc.text="当前为合伙人管理模式",this.hasBlessManager&&(this.modifyAnyoneSwitch?(this.tableListData.push(new t.ClubPartnerListData),this.tableListData[0].parse({idx:0,type:1,name:"未设置",id:-999,isSelected:0==this.tabClickIdx})):(this.tableListData.push(new t.ClubPartnerListData),this.tableListData[0].parse({idx:0,type:0,name:"管理员",id:-999,isSelected:0==this.tabClickIdx}),this.tableListData.push(new t.ClubPartnerListData),this.tableListData[1].parse({idx:1,type:1,name:"未设置",id:-999,isSelected:1==this.tabClickIdx})));for(var n=0;n<i.oppartners.length;n++){var o=i.oppartners[n],s=new t.ClubPartnerListData;s.parse({idx:this.tableListData.length,type:2,name:o.nickName,id:o.id,isSelected:this.tabClickIdx==this.tableListData.length}),this.tableListData.push(s),this.onlyGourpData.push(s)}this.leftScroller.setScrollerContent(this.tableListData),this.tabTo(this.tableListData[this.tabClickIdx])}},a.prototype.addGroupCallBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){t.CommonView.showToast("添加成功");var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_LIST,{clubId:this.clubData.clubId,fromType:1});t.SocketManager.getInstance().send(i)}},a.prototype.deleteGroupCallBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.tabClickIdx--,t.CommonView.showToast("删除成功");var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_LIST,{clubId:this.clubData.clubId,fromType:1});t.SocketManager.getInstance().send(i)}},a.prototype.modifyGroupNameCallBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){t.CommonView.showToast("修改成功");var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_LIST,{clubId:this.clubData.clubId,fromType:1});t.SocketManager.getInstance().send(i)}},a.prototype.batchSettingCallBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=void 0;i=this.isSearch?{clubId:this.clubData.clubId,groupId:this.curChoicePartnerGroupId,fromType:1,patternContent:this.SearchString}:{clubId:this.clubData.clubId,groupId:this.curChoicePartnerGroupId,fromType:1};var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_MEMBER_LIST,i);t.SocketManager.getInstance().send(n)}},a.prototype.refreshList=function(t){var e=t.data,a=e.blessRecord,i=e.operBlessRecord,n=(this.memberListData,!1),o=!1;for(var s in this.memberListData)if(this.memberListData[s].memberId==a.memberId?(this.memberListData[s].blessNum=a.blessNum,n=!0):this.memberListData[s].memberId==i.memberId&&(this.memberListData[s].blessNum=i.blessNum,o=!0),n&&o)break;this.scrollerTables.updateUI()},a.prototype.initScroller=function(){this.leftScroller.setElementViewInfo(76,6),this.leftScroller.setElementCreateFunction(this.createLeftElement.bind(this)),this.leftScroller.setElementUpdateDataFun(this.updateLeftElement.bind(this)),this.leftScroller.setElementUpdateUIFun(this.updateLeftElementUI.bind(this))},a.prototype.createLeftElement=function(e){var a=this,i=new t.ClubPartnerNameItem(this.clubData,e,function(t){a.tabClickIdx=t;for(var e=0;e<a.tableListData.length;e++)a.tabClickIdx==e?a.tableListData[e].isSelected=!0:a.tableListData[e].isSelected=!1;a.leftScroller.updateUI(),a.tabTo(a.tableListData[a.tabClickIdx])});return i},a.prototype.updateLeftElement=function(t,e){t.setData(this.clubData,e)},a.prototype.updateLeftElementUI=function(t){t.updateUI()},a.prototype.createElement=function(e){var a=new t.ClubLuckyListGeneralItem2(this.clubData,e);return a},a.prototype.updateElement=function(t,e){t.setData(this.clubData,e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.updateSort=function(){var t=this;if(this.memberListData.length>0){var e=void 0;e=this.Group_memberTitle_admin.visible?this.imgArrow_admin:this.imgArrow_unSet,e.rotation=this.isOrderDown?0:180,this.memberListData.sort(function(e,a){if(1==e.userType&&1!=a.userType||1!=e.userType&&1==a.userType){if(1==e.userType)return-1;if(1==a.userType)return 1}else if(e.blessNum!=a.blessNum){if(e.blessNum>a.blessNum)return t.isOrderDown?-1:1;
if(e.blessNum<a.blessNum)return t.isOrderDown?1:-1}else{if(e.memberId>a.memberId)return 1;if(e.memberId<a.memberId)return-1}return 0})}},a.prototype.tabTo=function(e){var a,i=this;if(null==e){this.tabClickIdx=-1;for(var n=0;n<this.tableListData.length;n++)this.tableListData[n].isSelected=!1;return this.Button_batch_of_belonging.visible=!1,this.leftScroller.clearContent(),this.leftScroller.setScrollerContent(this.tableListData),this.Group_memberTitle_unSet.visible=!0,this.Group_memberTitle_admin.visible=!1,this.scrollerTables.setElementViewInfo(94,6),this.scrollerTables.setElementCreateFunction(function(e){var a=new t.ClubLuckyListGeneralItemBySelect(i.clubData,e,i.onlyGourpData,i.modifyAnyoneSwitch);return a.setObj(i),a}),this.scrollerTables.setElementUpdateDataFun(function(t,e){t.setData(i.clubData,e)}),void this.scrollerTables.setElementUpdateUIFun(function(t){t.updateUI()})}switch(this.isSearch=!1,this.SearchString="",e.type){case 0:this.curChoicePartnerGroupId=-1,a=-1,this.Button_add_partnerGroup.visible=!0,this.Button_delete_partnerGroup.visible=!1,this.Button_batch_of_belonging.visible=!1,this.Button_modify_name.visible=!1,this.scrollerTables.setElementViewInfo(94,6),this.scrollerTables.setElementCreateFunction(function(e){var a=new t.ClubLuckyListGeneralItem2(i.clubData,e);return a}),this.scrollerTables.setElementUpdateDataFun(function(t,e){t.setData(i.clubData,e)}),this.scrollerTables.setElementUpdateUIFun(function(t){t.updateUI()}),this.Group_memberTitle_unSet.visible=!1,this.Group_memberTitle_admin.visible=!0;break;case 1:this.curChoicePartnerGroupId=0,a=0,this.Button_add_partnerGroup.visible=!0,this.Button_delete_partnerGroup.visible=!1,this.Button_batch_of_belonging.visible=!0,this.Button_modify_name.visible=!1,this.scrollerTables.setElementViewInfo(94,6),this.scrollerTables.setElementCreateFunction(function(e){var a=new t.ClubLuckyListGeneralItemBySelect(i.clubData,e,i.onlyGourpData,i.modifyAnyoneSwitch);return a.setObj(i),a}),this.scrollerTables.setElementUpdateDataFun(function(t,e){t.setData(i.clubData,e)}),this.scrollerTables.setElementUpdateUIFun(function(t){t.updateUI()}),this.Group_memberTitle_unSet.visible=!0,this.Group_memberTitle_admin.visible=!1;break;default:a=e.id,this.curChoicePartnerGroupId=a,this.curChoicePartnerGroupName=e.name,this.Button_add_partnerGroup.visible=!1,this.Button_delete_partnerGroup.visible=!0,this.Button_batch_of_belonging.visible=!0,this.Button_modify_name.visible=!0,this.scrollerTables.setElementViewInfo(94,6),this.scrollerTables.setElementCreateFunction(function(e){var a=new t.ClubLuckyListGeneralItemBySelect(i.clubData,e,i.onlyGourpData,i.modifyAnyoneSwitch);return a.setObj(i),a}),this.scrollerTables.setElementUpdateDataFun(function(t,e){t.setData(i.clubData,e)}),this.scrollerTables.setElementUpdateUIFun(function(t){t.updateUI()}),this.Group_memberTitle_unSet.visible=!0,this.Group_memberTitle_admin.visible=!1}var o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_MEMBER_LIST,{clubId:this.clubData.clubId,groupId:a,fromType:1});t.SocketManager.getInstance().send(o)},a.prototype.updateUI_=function(){this.clubData&&(this.updateSort(),this.scrollerTables.clearContent(),this.scrollerTables.setScrollerContent(this.memberListData))},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLUB_REFRESH_BLESS_INFO_LIST,this.refreshList,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_LIST),this.getGroupList,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_MEMBER_LIST),this.getGroupMemberList,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_ADD),this.addGroupCallBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_DEL),this.deleteGroupCallBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_MODIFYGROUPNAME),this.modifyGroupNameCallBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_BATCH_SETTING),this.batchSettingCallBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_MEMBER_DEL),this.batchSettingCallBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_SET_MANAGER),this.batchSettingCallBack,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubPartnerBox=e,__reflect(e.prototype,"game.ClubPartnerBox")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.isSelected=!1}return t.prototype.parse=function(t){this.idx=t.idx,this.type=t.type,this.name=t.name,this.id=t.id,this.isSelected=t.isSelected},t}();t.ClubPartnerListData=e,__reflect(e.prototype,"game.ClubPartnerListData")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.isSelected=!1}return t.prototype.parse=function(t){this.blessNum=t.blessNum,this.canModifyPower=t.canModifyPower,this.clubId=t.clubId,this.groupId=t.groupId,this.groupName=t.groupName,this.iconName=t.iconName,this.memberId=t.memberId,this.nickName=t.nickName,this.userType=t.userType},t}();t.ClubPartnerMemberListData=e,__reflect(e.prototype,"game.ClubPartnerMemberListData")}(game||(game={}));var game;!function(t){var e=function(t){function e(e,a,i){var n=t.call(this)||this;return n.clubData=e,n.listData=a,n.skinName="resource/skins/club/partner/clubPartnerNameItem.exml",n.callBack=i,n}return __extends(e,t),e.prototype.onCreateViewComplete=function(){var e=this;t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.tab,function(){e.callBack(e.listData.idx)}),this.updateUI()},e.prototype.setData=function(t,e){this.clubData=t,this.listData=e,this.updateUI()},e.prototype.updateUI_=function(){this.tab.selected=this.listData.isSelected;var t=Utils.RGBA2Color(255,255,255),e=Utils.RGBA2Color(144,66,22),a=Utils.RGBA2Color(128,93,49),i=Utils.RGBA2Color(244,214,163),n=this.listData.isSelected?t:a,o=this.listData.isSelected?e:i;switch(this.listData.type){case 0:this.group_admin.visible=!0,this.group_unSet.visible=this.group_normal.visible=!1,this.admin_icon.source=this.listData.isSelected?"img_admin1_png":"img_admin2_png",this.Text_admin.textColor=n,this.Text_admin.strokeColor=o;break;case 1:this.group_unSet.visible=!0,this.group_admin.visible=this.group_normal.visible=!1,this.unset_icon.source=this.listData.isSelected?"img_set1_png":"img_set_png",this.Text_unSet.textColor=n,this.Text_unSet.strokeColor=o;break;default:this.group_normal.visible=!0,this.group_admin.visible=this.group_unSet.visible=!1,this.Text_name.text=this.listData.name,this.Text_name.textColor=n,this.Text_name.strokeColor=o}},e.prototype.clean=function(){t.prototype.clean.call(this)},e}(t.EComponent);t.ClubPartnerNameItem=e,__reflect(e.prototype,"game.ClubPartnerNameItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.sendMemberId=[],i.groupData=t,i.allData=a,i.skinName="resource/skins/club/partner/clubSetBelongItem.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this);for(var i in this.allData.member)if(this.allData.member.hasOwnProperty(i)){var n=this.allData.member[i];this.sendMemberId.push(n.id)}this.addTapEvent(this.Button_belongGroup,function(){if(a.checkHasMembersBlessNumberNotZero())return void t.DialogManager.getInstance().popUp1("有成员体力值不为0,不可归属");var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_BATCH_SETTING,{clubId:a.allData.clubId,groupId:a.groupData.id,memberIds:a.sendMemberId});t.SocketManager.getInstance().send(e)}),this.addTapEvent(this.Button_removeGroup,function(){if(a.checkHasMembersBlessNumberNotZero())return void t.DialogManager.getInstance().popUp1("有成员体力值不为0,不可移除");var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_GROUP_MEMBER_DEL,{clubId:a.allData.clubId,groupId:a.groupData.id,memberIds:a.sendMemberId});t.SocketManager.getInstance().send(e)}),this.updateUI()},a.prototype.checkHasMembersBlessNumberNotZero=function(){var t=!1;if(this.allData.modifyAnyoneSwitch)return!1;for(var e=0;e<this.allData.member.length;e++){var a=this.allData.member[e];if(0!=a.blessNum){t=!0;break}}return t},a.prototype.setData=function(t,e){this.groupData=t,this.allData=e,this.updateUI()},a.prototype.updateUI_=function(){this.Text_groupName.text=this.groupData.name,this.groupData.id==this.allData.curGroup.groupId?(this.Button_belongGroup.visible=!1,this.Button_removeGroup.visible=!0):(this.Button_belongGroup.visible=!0,this.Button_removeGroup.visible=!1)},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubSetBelongItem=e,__reflect(e.prototype,"game.ClubSetBelongItem")}(game||(game={})),function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.skinName="resource/skins/club/partner/clubSetBelongToBox.exml",a.data=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_BATCH_SETTING),this.batchSettingCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_MEMBER_DEL),this.batchSettingCallBack,this),this.addTapEvent(this.btn_close,function(){a.close()}),this.data.member.length>1?this.Text_setBelong.text="设置 所有选中成员 的归属合伙组为":1==this.data.member.length?this.Text_setBelong.text=Utils.format("设置 {0} 的归属合伙组为",this.data.member[0].nickName):this.Text_setBelong.visible=!1,this.scroller.setElementViewInfo(80,4),this.scroller.setElementCreateFunction(this.createElement.bind(this)),this.scroller.setElementUpdateDataFun(this.updateElement.bind(this)),this.scroller.setElementUpdateUIFun(this.updateElementUI.bind(this)),this.scroller.setScrollerContent(this.data.group)},a.prototype.batchSettingCallBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("变更成功"),this.close())},a.prototype.createElement=function(e){var a=new t.ClubSetBelongItem(e,this.data);return a},a.prototype.updateElement=function(t,e){t.setData(e,this.data),this.updateUI()},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.updateUI_=function(){},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_BATCH_SETTING),this.batchSettingCallBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_MEMBER_DEL),this.batchSettingCallBack,this)},a}(t.EDialog);t.ClubSetBelongToBox=e,__reflect(e.prototype,"game.ClubSetBelongToBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.skinName="resource/skins/club/partner/clubSetManagerAndGroupBox.exml",a.data=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_SET_MANAGER),this.setManagerCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_BATCH_SETTING),this.batchSettingCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_MEMBER_DEL),this.batchSettingCallBack,this),this.addTapEvent(this.btn_close,function(){a.close()}),this.ClubSetManagerItem.setData({member:this.data.member[0],groupId:this.data.curGroup.groupId,clubId:this.data.clubId}),this.scroller.setElementViewInfo(80,4),this.scroller.setElementCreateFunction(this.createElement.bind(this)),this.scroller.setElementUpdateDataFun(this.updateElement.bind(this)),this.scroller.setElementUpdateUIFun(this.updateElementUI.bind(this)),this.scroller.setScrollerContent(this.data.group),this.updateUI()},a.prototype.setManagerCallBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("设置管理员成功"),this.close())},a.prototype.batchSettingCallBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("变更成功"),this.close())},a.prototype.createElement=function(e){var a=new t.ClubSetBelongItem(e,this.data);return a},a.prototype.updateElement=function(t,e){t.setData(e,this.data),this.updateUI()},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.updateUI_=function(){this.Text_curGroup_name.text=this.data.curGroup.groupName},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_SET_MANAGER),this.setManagerCallBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_BATCH_SETTING),this.batchSettingCallBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_OPPART_GROUP_MEMBER_DEL),this.batchSettingCallBack,this)},a}(t.EDialog);t.ClubSetManagerAndGroupBox=e,__reflect(e.prototype,"game.ClubSetManagerAndGroupBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.skinName="resource/skins/club/partner/clubSetManagerItem.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.Button_setManager,function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_OPPART_SET_MANAGER,{clubId:a.data.clubId,groupId:a.data.groupId,memberId:a.data.member.id,userType:1});t.SocketManager.getInstance().send(e)})},a.prototype.setData=function(t){this.data=t,this.updateUI()},a.prototype.updateUI_=function(){var e=this;t.ResManager.loadWebImage(this.data.member.headImgUrl,function(t){e.headImage.texture=t,e.headImage.addEventListener(eui.UIEvent.COMPLETE,function(){e.headImage.texture=t},e)},this),GameUtils.sub(this.Text_name,this.data.member.nickName,114),this.Text_ID.text="ID:"+this.data.member.id},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ClubSetManagerItem=e,__reflect(e.prototype,"game.ClubSetManagerItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.roomNumber=t,a.skinName="resource/skins/club/room/clubCancelRoomConfirmSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnCancel,this.close),this.addTapEvent(this.btnOK,this.clickOK),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_forceCancelRoom),this.cancelRoomCallback,this),this.updateUI()},a.prototype.updateUI_=function(){},a.prototype.clickOK=function(){this.inputNumberUI.checkInput()&&(this.roomNumber==this.inputNumberUI.getInpuNumbers()?t.ClubService.getInstance().forceCancelRoom(this.roomNumber):t.CommonView.showToast("输入的房间号不正确！"))},a.prototype.cancelRoomCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("房间解散成功"),this.close())},a}(t.EDialog);t.ClubCancelRoomConfirmDialog=e,__reflect(e.prototype,"game.ClubCancelRoomConfirmDialog")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.parse=function(e){this.roomJson=e.roomJson,this.gaming=e.gaming,this.curTurnNum=e.curTurnNum,this.curTurnDirection=e.curTurnDirection,this.roomUsers=[];var e=e.roomUsers;for(var a in e){var i=e[a],n=new t.ClubRoomUserData;n.parse(i),this.roomUsers.push(n)}},e.prototype.getTemplateColor=function(){var t=this.roomJson,e=t.templateColor;return e},e.prototype.getTemplateId=function(){var t=this.roomJson,e=t.templateId;return e+""},e.prototype.getCreatePlayerNum=function(){var t=this.roomJson,e=t.createPlayerNum;return e},e.prototype.updateTemplateInfo=function(t){this.roomJson.templateColor=t.getTemplateColor(),this.roomJson.calNum=t.getCalNum(),this.roomJson.templateNum=t.getTemplateName()},e}();t.ClubRoomData=e,__reflect(e.prototype,"game.ClubRoomData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.clubData=t,i.clubRoomData=a,i.skinName="resource/skins/club/room/clubRoomItemSkin.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnRoomInfo,this.clickRoomInfo),this.addTapEvent(this.btnCancelRoom,this.clickCancelRoom),this.addTapEvent(this.rectJoinRoom,this.clickJoinRoom),this.addTapEvent(this.labelGaming,this.clickRoomProgress),this.addTapEvent(this.labelTurnNum,this.clickRoomProgress),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.clubRoomData=e,this.updateUI()},a.prototype.clickRoomInfo=function(){var e=this.btnRoomInfo.localToGlobal(this.btnRoomInfo.x,this.btnRoomInfo.y),a=e.x-GlobalData.deltaX,i=e.y-GlobalData.deltaY;t.TipsUtils.showTips(1,a-100,i-51,this.getRulesInfo_(),280)},a.prototype.updateUI_=function(){if(null!=this.clubRoomData){var e=this.clubRoomData.roomJson;this.labelRoomType.text=e.templateName,this.labelRoomNumber.text="房号:"+e.roomNumber,this.labelRoomTurnNum.text=e.turnNumber+t.ConstantUtils.getTurnModeName(e.turnMode),this.labelPayMode.text=t.ConstantUtils.getPayModeName(e.payMode,!0);for(var a=[this.userItem1,this.userItem2,this.userItem3,this.userItem4],i=this.clubRoomData.roomUsers.length,n=0;n<a.length;n++){var o=null;i>n&&(o=this.clubRoomData.roomUsers[n]),a[n].setData(o,this.clubData.permissions,this.clubRoomData.gaming)}var s=this.getCurTurnNumberInfo();this.imgTemplateColor.source="img_color_room_"+this.clubRoomData.getTemplateColor()+"_png";var r=t.ClubService.getInstance().checkRight(this.clubData.permissions,ClubConst.PermissionType.Key_cancelRoom);if(r)this.labelTurnNum.textFlow=Utils.TextUtils.getOutLineStr(s),this.btnCancelRoom.visible=!0,this.clubRoomData.gaming?(this.btnInvitePlayer.visible=!1,this.labelGaming.visible=!0,this.labelTurnNum.visible=!0,this.labelGaming.y=12,this.labelTurnNum.y=41,this.labelGaming.textFlow=Utils.TextUtils.getOutLineStr("游戏中")):(this.btnInvitePlayer.visible=!0,this.btnInvitePlayer.y=2,this.labelGaming.visible=!1,this.labelTurnNum.visible=!1);else if(this.labelTurnNum.text=s,this.btnCancelRoom.visible=!1,this.clubRoomData.gaming){this.btnInvitePlayer.visible=!1,this.labelGaming.visible=!0,this.labelTurnNum.visible=!0;var l=40;this.labelGaming.y=l+0,this.labelTurnNum.y=l+29}else this.btnInvitePlayer.visible=!0,this.btnInvitePlayer.y=33,this.labelGaming.visible=!1,this.labelTurnNum.visible=!1}},a.prototype.getRulesInfo=function(){var e=this.clubRoomData.roomJson,a="房号:"+e.roomNumber+"    ";return a+=e.turnNumber+t.ConstantUtils.getTurnModeName(e.turnMode)+"    ",a+=t.ConstantUtils.getPayModeName(e.payMode,!0)+"    ",e.autoHost&&(a+="超时托管    "),a},a.prototype.getCurTurnNumberInfo=function(){var t=this.clubRoomData.roomJson;return t.turnMode==Constants.ROOM_TIME_MODE.ba?Utils.format("{0}/{1}把",this.clubRoomData.curTurnNum,t.turnNumber):Utils.format("{0} {1}/{2}圈",GameConst.DIRECT_DESC[this.clubRoomData.curTurnDirection],this.clubRoomData.curTurnNum,t.turnNumber)},a.prototype.getRulesInfo_=function(){return t.RoomUtils.getRulesInfo(this.clubRoomData.roomJson)},a.prototype.clickCancelRoom=function(){var e=this.clubRoomData.roomJson;if(this.clubRoomData.gaming){var a=new t.ClubCancelRoomConfirmDialog(e.roomNumber);t.DialogManager.getInstance().show(a)}else t.RoomService.getInstance().cancelDaiKaiRoom(e.roomId)},a.prototype.clickJoinRoom=function(){var e=this.clubRoomData.roomJson;t.RoomService.getInstance().joinRoom(e.roomNumber)},a.prototype.clickRoomProgress=function(){var e=new t.ClubRoomProgressDialog(this.clubData.clubId,this.clubRoomData.roomJson.roomId);t.DialogManager.getInstance().show(e)},a.prototype.toString=function(){return this.clubRoomData?this.clubRoomData.roomJson.roomNumber:"null"},a}(t.EComponent);t.ClubRoomItem=e,__reflect(e.prototype,"game.ClubRoomItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this,null,!1)||this;return i.clubId=t,i.roomId=a,i.skinName="resource/skins/club/room/ClubRoomProgressDialogSkin.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnCancelRoom,this.clickCancelRoom),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_roominfo_progress),this.getRoomProgressInfoBack,this),this.initScroller(),this.getRoomProgressInfo()},a.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(47,10),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.updateUI_=function(){this.labelRoomNumber.text="房间号:"+this.roomProgressInfo.roomNumber;var e="进度:",a=this.roomProgressInfo.turnMode,i=this.roomProgressInfo.curTurnNum,n=this.roomProgressInfo.turnNumber,o=this.roomProgressInfo.curTurnDirection,o=this.roomProgressInfo.curTurnDirection;e+=a==Constants.ROOM_TIME_MODE.ba?Utils.format("{0}/{1}把",i,n):Utils.format("{0} {1}/{2}圈",GameConst.DIRECT_DESC[o],i,n);var s=this.roomProgressInfo.roomType;this.labelTurnNum.text=e,this.labelRoomType.text="类型:"+t.ConstantUtils.getRoomTypeName(s),this.labelTotalTime.text="进行时间:"+t.DateUtils.dateDesc(this.roomProgressInfo.durationTime),this.scrollerTables.setScrollerContent(this.msgUserDataList,!1)},a.prototype.createElement=function(e){var a=new t.ClubRoomProgressItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.getRoomProgressInfo=function(){t.ClubService.getInstance().getRoomProgressInfo(this.clubId,this.roomId)},a.prototype.getRoomProgressInfoBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data;this.roomProgressInfo=i.roomProgressInfo,this.msgUserDataList=i.roomProgressInfo.msgUserDatas,this.updateUI()}},a.prototype.clickCancelRoom=function(){this.close();var e=new t.ClubCancelRoomConfirmDialog(this.roomProgressInfo.roomNumber);t.DialogManager.getInstance().show(e)},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_roominfo_progress),this.getRoomProgressInfoBack,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubRoomProgressDialog=e,__reflect(e.prototype,"game.ClubRoomProgressDialog")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.jsonData=e,a.skinName="resource/skins/club/room/clubRoomProgressItemSkin.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.setData=function(t){this.jsonData=t,this.updateUI()},e.prototype.updateUI_=function(){if(null!=this.jsonData){this.labelID.text=this.jsonData.msgUser.userId,this.labelNickName.text=this.jsonData.msgUser.nickName,this.labelScore.text=this.jsonData.score,this.labelWaiBaoScore.text=this.jsonData.waiBaoScore;var t=this.jsonData.userStatus,e=this.jsonData.autoHost,a=15162688,i="在线";t==GameConst.PLAYER_STATUS.LEAVE||t==GameConst.PLAYER_STATUS.OFFLINE?i="离线":a=4753676,e&&(i+="托管"),this.labelStatus.text=i,this.labelStatus.textColor=a}},e}(t.EComponent);t.ClubRoomProgressItem=e,__reflect(e.prototype,"game.ClubRoomProgressItem")}(game||(game={}));var ClubRoomUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/club/room/clubRoomUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ROOMINFOLIST),this.getClubRoomListBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.CLICK_CLUB_Rooms,this.getClubRoomList,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ROOMINFO_CHANGE),this.roomInfoChange,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_templateChange),this.templateChanage,this),this.initScroller()},e.prototype.updateUI_=function(){this.sortRoomList(),this.scrollerTables.setScrollerContent(this.clubRoomDataList,!1)},e.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(152,8),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.ClubRoomItem(this.clubData,t);return e},e.prototype.updateElement=function(t,e){t.setData(this.clubData,e),console.info("roomData == "+t.toString())},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.getClubRoomList=function(t){null!=t.data&&(this.clubData=t.data,game.ClubService.getInstance().getClubRoomList(t.data.clubId))},e.prototype.getClubRoomListBack=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){this.clubRoomDataList=[];var a=e.data,i=a.getBoardInfos;for(var n in i){var o=i[n],s=new game.ClubRoomData;s.parse(o),this.clubRoomDataList.push(s)}game.ClubService.getInstance().setPushNotice(this.clubData.clubId,!0),this.updateUI()}},e.prototype.divideTemplateRoom=function(t){for(var e=[],a=[],i=t.length,n=0;i>n;n++){var o=t[n];o.gaming||o.getCreatePlayerNum()==o.roomUsers.length?a.push(o):e.push(o)}return e.sort(function(t,e){var a=t.roomUsers.length,i=e.roomUsers.length;if(a!=i)return i-a;var n=t.roomJson,o=e.roomJson;return n.roomId-o.roomId}),a.sort(function(t,e){var a=t.roomJson,i=e.roomJson;return a.roomId-i.roomId}),{idleList:e,gameingList:a}},e.prototype.sortRoomList=function(){var t=this.list2Map(this.clubRoomDataList),e=t.keySet();e.sort();for(var a=[],i=[],n=[],o=e.length,s=0;o>s;s++){var r=e[s],l=t.get(r),c=this.divideTemplateRoom(l),h=c.idleList,u=c.gameingList;if(h.length>0){var d=h.shift();a.push(d)}i=i.concat(u),n=n.concat(h)}var m=[];m=m.concat(a),m=m.concat(i),m=m.concat(n),this.clubRoomDataList=m},e.prototype.list2Map=function(t){for(var e=new game.HashMap,a=t,i=a.length,n=0;i>n;n++){var o=a[n],s=o.getTemplateId(),r=[];e.containsKey(s)?r=e.get(s):(r=[],e.put(s,r)),r.push(o)}return e},e.prototype.roomInfoChange=function(t){if(null!=t.data){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){var a=e.data,i=new game.ClubRoomInfoChangeInfo;if(i.parse(a),0==i.type)this.clubRoomDataList.push(i.clubRoomData);else if(1==i.type){var n=this.getClubRoomDataIndex(i.roomId);-1!=n&&(this.clubRoomDataList[n]=i.clubRoomData)}else if(2==i.type){var n=this.getClubRoomDataIndex(i.roomId);-1!=n&&this.clubRoomDataList.splice(n,1)}this.updateUI()}}},e.prototype.getClubRoomDataIndex=function(t){for(var e=this.clubRoomDataList.length,a=0;e>a;a++){var i=this.clubRoomDataList[a].roomJson;if(i.roomId==t)return a}return-1},e.prototype.clickBack=function(){game.SceneSkip.skipToHallScene()},e.prototype.clickCreateClub=function(){},e.prototype.clickJoinClub=function(){var t=new game.JoinClubDialog;game.DialogManager.getInstance().show(t,game.EDialog.show_ani_type_null)},e.prototype.clickInviteMember=function(){},e.prototype.clickApplyRecord=function(){},e.prototype.clickEditNotice=function(){},e.prototype.templateChanage=function(t){if(null!=t.data){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){var a=e.data,i=a.templateId,n=a.type,o=a.templateInfo,s=new game.ClubRuleData(o);if(3==n){for(var r=this.clubRoomDataList.length,l=0;r>l;l++)this.clubRoomDataList[l].roomJson.templateId==i&&this.clubRoomDataList[l].updateTemplateInfo(s);this.updateUI()}}}},e.prototype.clean=function(){game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ROOMINFOLIST),this.getClubRoomListBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.CLICK_CLUB_Rooms,this.getClubRoomList,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ROOMINFO_CHANGE),this.roomInfoChange,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_templateChange),this.templateChanage,this),t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ClubRoomUI.prototype,"ClubRoomUI"),window.ClubRoomUI=ClubRoomUI;var game;!function(t){var e=function(){function t(){this.ready=!0}return t.prototype.parse=function(t){this.headImgUrl=t.headImgUrl,this.nickName=t.nickName,this.autoHost=t.autoHost,this.userStatusType=t.userStatusType},t}();t.ClubRoomUserData=e,__reflect(e.prototype,"game.ClubRoomUserData")}(game||(game={}));var ClubRoomUserItem=function(t){function e(e,a,i){var n=t.call(this)||this;return n.clubRoomUserData=e,n.permissions=a,n.isGaming=i,n.skinName="resource/skins/club/room/clubRoomUserItemSkin.exml",n}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.setData=function(t,e,a){console.log("data=="+t),this.clubRoomUserData=t,this.permissions=e,this.isGaming=a,this.updateUI()},e.prototype.updateUI_=function(){var t=this;if(null!=this.clubRoomUserData){this.labelNickName.text=this.clubRoomUserData.nickName,this.labelLeave.visible=!1,this.imgMask.visible=!1,this.labelHost.visible=!1;var e=game.ClubService.getInstance().checkDefaultRight(this.permissions);if(e){(this.clubRoomUserData.userStatusType==GameConst.PLAYER_STATUS.LEAVE||this.clubRoomUserData.userStatusType==GameConst.PLAYER_STATUS.OFFLINE)&&(this.labelLeave.visible=!0,this.labelLeave.y=36,this.imgMask.visible=!0,this.labelLeave.text="离开",this.clubRoomUserData.userStatusType==GameConst.PLAYER_STATUS.OFFLINE&&(this.labelLeave.text="离线"));var a=this.clubRoomUserData.autoHost;this.labelHost.visible=a,a&&(this.imgMask.visible=!0,this.labelHost.y=36),this.labelLeave.visible&&this.labelHost.visible&&(this.labelLeave.y=24,this.labelHost.y=47)}t.imgHeadIcon.visible=!0,game.ResManager.loadWebImage(this.clubRoomUserData.headImgUrl,function(e){t.imgHeadIcon.texture=e,t.imgHeadIcon.addEventListener(eui.UIEvent.COMPLETE,function(){t.imgHeadIcon.texture=e},this)},this)}else this.labelHide.visible=this.isGaming,this.groupShow.visible=!this.isGaming,this.isGaming||(this.labelNickName.text="",this.imgMask.visible=!1,this.labelLeave.visible=!1,this.labelHost.visible=!1,this.imgHeadIcon.visible=!1)},e}(game.EComponent);__reflect(ClubRoomUserItem.prototype,"ClubRoomUserItem"),window.ClubRoomUserItem=ClubRoomUserItem;var game;!function(t){var e=function(){function e(t){this.roomJson=t}return e.prototype.parse=function(t){this.roomJson=t.roomJson},e.prototype.clone=function(){var t=JSON.stringify(this.roomJson);return new e(JSON.parse(t))},e.prototype.getClubID=function(){var t=this.roomJson;return t.clubId},e.prototype.getRulesInfo=function(){return t.RoomUtils.getRulesInfo(this.roomJson)},e.prototype.getTemplateName=function(){var t=this.roomJson,e=t.templateName;return e?e:"无"},e.prototype.getTemplateID=function(){var t=this.roomJson;return t.templateId},e.prototype.getTemplateColor=function(){var t=this.roomJson;return t.templateColor},e.prototype.setTemplateColor=function(t){var e=this.roomJson;e.templateColor=t},e.prototype.getCalNum=function(){var t=this.roomJson;return t.calNum},e.prototype.getCustomInfo=function(){var t=this.roomJson,e=t.calNum;return e||(e=0),"记分:"+e+"/100分"},e}();t.ClubRuleData=e,__reflect(e.prototype,"game.ClubRuleData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.clubId=t,a.skinName="resource/skins/club/rules/clubRuleDialogSkin.exml",a
}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnAdd,this.addRule),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_queryTemplates),this.getClubTemplateListBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_deleteTemplate),this.deleteTemplateBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_templateChange),this.templateChanage,this),this.initScroller(),this.getClubRuleList()},a.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(148,10),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.updateUI_=function(){this.clubRuleDataList.length>0?this.labelNoRuleTip.visible=!1:this.labelNoRuleTip.visible=!0,this.scrollerTables.setScrollerContent(this.clubRuleDataList,!1)},a.prototype.createElement=function(e){var a=new t.ClubRuleItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.getClubRuleList=function(){t.ClubRuleService.getInstance().getClubRuleList(this.clubId)},a.prototype.getClubTemplateListBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.clubRuleDataList=[];var i=a.data,n=i.getTemplateInfos;for(var o in n){var s=n[o],r=new t.ClubRuleData(s);this.clubRuleDataList.push(r)}this.updateUI()}},a.prototype.deleteTemplateBack=function(t){this.getClubRuleList()},a.prototype.addRule=function(){var e=new t.CreateRoomDialog(this.clubId);t.DialogManager.getInstance().show(e)},a.prototype.templateChanage=function(e){if(null!=e.data){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=i.templateId,o=i.type,s=i.templateInfo,r=new t.ClubRuleData(s);if(1==o)this.clubRuleDataList.push(r);else if(3==o){var l=this.getClubRuleIndex(n);-1!=l&&(this.clubRuleDataList[l]=r)}else if(2==o){var l=this.getClubRuleIndex(n);-1!=l&&this.clubRuleDataList.splice(l,1)}this.updateUI()}}},a.prototype.getClubRuleIndex=function(t){for(var e=this.clubRuleDataList.length,a=0;e>a;a++){var i=this.clubRuleDataList[a].getTemplateID();if(i==t)return a}return-1},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_queryTemplates),this.getClubTemplateListBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_deleteTemplate),this.deleteTemplateBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_templateChange),this.templateChanage,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubRuleDialog=e,__reflect(e.prototype,"game.ClubRuleDialog")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.clubRuleData=t.clone(),a.skinName="resource/skins/club/rules/ClubRuleEditDialogSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnOK,this.clickOK),this.addTapEvent(this.rectColor1,this.clickRadio1),this.addTapEvent(this.rectColor2,this.clickRadio2),this.addTapEvent(this.rectColor3,this.clickRadio3),this.addTapEvent(this.TLMK,this.clickTLMK),this.addTapEvent(this.XZJS,this.clickXZJS),this.addTapEvent(this.FCMTX,this.clickFCMTX),this.addTapEvent(this.FCMTX,this.clickFCMTX),this.addTapEvent(this.tips,function(){t.TipsUtils.showTips(2,a.tips.x+100,a.tips.y,"成员累计游戏时间超过5小时，将会弹出健康游戏提醒。",280)}),this.editCalNum.inputType=egret.TextFieldInputType.TEL,this.editCalNum.restrict="0-9",this.editSZMK.inputType=egret.TextFieldInputType.TEL,this.editSZMK.restrict="0-9",this.editZDJS.inputType=egret.TextFieldInputType.TEL,this.editZDJS.restrict="0-9",t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_templateChange),this.templateChanage,this),this.radio1.setText(""),this.radio2.setText(""),this.radio3.setText(""),this.TLMK.setText("体力门槛"),this.TLMK.setFontSize(27),this.TLMK.setFontFamily("fzch"),this.TLMK.setFontColor(8412465),this.XZJS.setText("每日限制局数"),this.XZJS.setFontSize(27),this.XZJS.setFontFamily("fzch"),this.XZJS.setFontColor(8412465),this.FCMTX.setText("防沉迷提醒"),this.FCMTX.setFontSize(27),this.FCMTX.setFontFamily("fzch"),this.FCMTX.setFontColor(8412465),this.editSZMK.text=""+typeof this.clubRuleData.roomJson.minBlessNum=="undefined"?1:this.clubRuleData.roomJson.minBlessNum,this.editZDJS.text=""+typeof this.clubRuleData.roomJson.limitTurnNum=="undefined"?20:this.clubRuleData.roomJson.limitTurnNum,this.editCalNum.text=""+this.clubRuleData.getCalNum(),this.editName.text=this.clubRuleData.getTemplateName(),this.updateUI()},a.prototype.updateUI_=function(){this.radio1.setSelected(!1),this.radio2.setSelected(!1),this.radio3.setSelected(!1);var t=this.clubRuleData.getTemplateColor();2==t?this.radio2.setSelected(!0):3==t?this.radio3.setSelected(!0):this.radio1.setSelected(!0),this.TLMK.setSelected(this.clubRuleData.roomJson.blessSwitch||!1),this.XZJS.setSelected(this.clubRuleData.roomJson.limitTurnSwitch||!1),this.FCMTX.setSelected(this.clubRuleData.roomJson.limitTip||!1)},a.prototype.clickOK=function(){var e=this.clubRuleData.getClubID(),a=this.clubRuleData.getTemplateID(),i=this.editName.text.trim();if(i.length<=0||i.length>6)return void t.CommonView.showToast(Utils.format("标题长度应该是{0}-{1}之间",1,6));var n=this.clubRuleData.getTemplateColor(),o=this.editCalNum.text.trim(),s=0,r=1e3;if(!Utils.checkInputNumber(o,s,r))return void t.CommonView.showToast(Utils.format("记分应该是{0}-{1}之间",s,r));var l={clubId:e,templateId:a,templateName:i,templateColor:n,calNum:o,blessSwitch:this.clubRuleData.roomJson.blessSwitch,minBlessNum:parseInt(this.editSZMK.text.trim()),limitTip:this.clubRuleData.roomJson.limitTip,limitTurnNum:parseInt(this.editZDJS.text.trim()),limitTurnSwitch:this.clubRuleData.roomJson.limitTurnSwitch};t.ClubService.getInstance().updateCustomInfo(l)},a.prototype.templateChanage=function(e){if(null!=e.data){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("修改成功"),this.close())}},a.prototype.clickRadio1=function(){this.clubRuleData.setTemplateColor(1),this.updateUI()},a.prototype.clickRadio2=function(){this.clubRuleData.setTemplateColor(2),this.updateUI()},a.prototype.clickRadio3=function(){this.clubRuleData.setTemplateColor(3),this.updateUI()},a.prototype.clickTLMK=function(){this.clubRuleData.roomJson.blessSwitch=!this.clubRuleData.roomJson.blessSwitch,this.updateUI()},a.prototype.clickXZJS=function(){this.clubRuleData.roomJson.limitTurnSwitch=!this.clubRuleData.roomJson.limitTurnSwitch,this.updateUI()},a.prototype.clickFCMTX=function(){this.clubRuleData.roomJson.limitTip=!this.clubRuleData.roomJson.limitTip,this.updateUI()},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_templateChange),this.templateChanage,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubRuleEditDialog=e,__reflect(e.prototype,"game.ClubRuleEditDialog")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.clubRuleData=t,a.skinName="resource/skins/club/rules/clubRuleItemSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnCustomSet,this.clickCustomSet),this.addTapEvent(this.btnDelete,this.clickDelete),this.updateUI()},a.prototype.setData=function(t){this.clubRuleData=t,this.updateUI()},a.prototype.clickCustomSet=function(){var e=new t.ClubRuleEditDialog(this.clubRuleData);t.DialogManager.getInstance().show(e)},a.prototype.updateUI_=function(){if(null!=this.clubRuleData){var t=this.clubRuleData.getTemplateColor();t||(t=1),this.imgTitleBg.source="img_color_room_"+t+"_png",this.labelRuleName.text=this.clubRuleData.getTemplateName(),this.labelCustomInfo.text=this.clubRuleData.getCustomInfo(),this.labelRuleInfo.text=this.clubRuleData.getRulesInfo()}},a.prototype.clickDelete=function(){var e=this;t.DialogManager.getInstance().popUp2(Strings.club_rule_delete_tips,function(){var a=e.clubRuleData.getClubID(),i=e.clubRuleData.getTemplateID();t.ClubRuleService.getInstance().deleteClubRule(a,i)})},a}(t.EComponent);t.ClubRuleItem=e,__reflect(e.prototype,"game.ClubRuleItem")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.intstance&&(e.intstance=new e),e.intstance},e.prototype.deleteClubRule=function(e,a){var i={};i.clubId=e,i.templateId=a;var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_deleteTemplate,i);t.SocketManager.getInstance().send(n)},e.prototype.getClubRuleList=function(e){var a={clubId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_queryTemplates,a);t.SocketManager.getInstance().send(i)},e.prototype.addRule=function(e,a){var i={msgRoom:a},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_createTemplate,i);t.SocketManager.getInstance().send(n)},e.prototype.createRoomCallBack=function(e){if(e.code==t.CmdResultType.SUCCESS){var a=e.data,i=a.fromClub;if(null==i||!i){if(null!=a.diamond&&GlobalData.userData.setDiamondNum(a.diamond),Constants.ROOM_PAY_MODE.other==a.msgRoom.payMode){a.useDiamond,a.msgRoom;return}var n={roomNumber:a.msgRoom.roomNumber};t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,n)}}else{var o=e.errorCode;if(o==t.MsgConstant.ERROR_diamondNoEnough)t.DialogManager.getInstance().popUp2(Strings.noRoomCard,function(){var e=new t.ShopScene(1);t.DialogManager.getInstance().show(e)});else if(o==t.MsgConstant.ERROR_creamRoom_paramError)t.DialogManager.getInstance().popUp1(Strings.createRoomParamsError);else if(o==t.MsgConstant.ERROR_creamRoom_inRoom){var a=e.data,s=(a.gameId,Utils.format(Strings.hasInRoomWhenCreateRoom,"麻将"));t.DialogManager.getInstance().popUp1(s)}}},e.prototype.joinRoomCallBack=function(e){if(e.code==t.CmdResultType.SUCCESS){var a=e.data;null!=a.diamond&&GlobalData.userData.setDiamondNum(a.diamond);var i=a.roomStatus;GlobalData.gameData.setGameStatus(i),GlobalData.gameData.getRoomInfo().parse(a.msgRoom);var n=!1;null!=a.doCheat&&(n=a.doCheat),n&&GlobalData.gameData.setCheatStatus(n);var o=a.kickLeftTime;null!=o&&GlobalData.gameData.setKickOfflineTime(Math.floor(o/1e3));var s=a.userInfos;GlobalData.gameData.clearPlayerData();for(var r=0;r<s.length;r++){var l=s[r].chairId,c=GlobalData.gameData.getPlayer(l);null==c&&(c=new t.PlayerInfo,GlobalData.gameData.addPlayer(l,c)),c.parse(s[r]),c.getUserId()==GlobalData.userData.getUserId()&&(GlobalData.gameData.setMyChairId(l),t.LogUtils.info("我的椅子id "+l))}GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.ready&&GlobalData.isReconnecting&&GlobalData.setReconnecting(!1),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED),t.SceneManager.getInstance().curScene.getIndex()!=Constants.SCENE_INDEX.GAME&&t.SceneSkip.skipToGameScene()}else{var h=e.errorCode;h==t.MsgConstant.ERROR_join_ROOM_USERMAX?t.DialogManager.getInstance().popUp1(Strings.roomPlayerFull):h==t.MsgConstant.ERROR_join_inOtherRoom?t.DialogManager.getInstance().popUp1(Strings.hasInRoomWhenJoinRoom):h==t.MsgConstant.ERROR_joinRoom_roomId_error?t.DialogManager.getInstance().popUp1(Strings.roomNumberNotExist):h==t.MsgConstant.ERROR_diamondNoEnough&&t.DialogManager.getInstance().popUp2(Strings.noRoomCard,function(){var e=new t.ShopScene(1);t.DialogManager.getInstance().show(e)})}},e.prototype.cancelRoom=function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CANCEL_ROOM,null);t.SocketManager.getInstance().send(e)},e.prototype.cancelDaiKaiRoom=function(e){var a={roomId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CANCEL_DAIKAI_ROOM,a);t.SocketManager.getInstance().send(i)},e.prototype.joinRoom=function(e){var a={roomNumber:e},i=GlobalData.userData.getLocation();(0!=i.longitude||0!=i.latitude)&&(a.gpsLocation=i);var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,a);t.SocketManager.getInstance().send(n)},e.intstance=null,e}();t.ClubRuleService=e,__reflect(e.prototype,"game.ClubRuleService")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.prototype.parse=function(t){this.memberId=t.memberId,this.memberType=t.memberType,this.memberName=t.memberName,this.headImgUrl=t.headImgUrl,this.watcher=t.watcher},t}();t.ClubWatcherData=e,__reflect(e.prototype,"game.ClubWatcherData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.clubId=t,a.skinName="resource/skins/club/watcher/clubWatcherDialogSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_all_manager),this.getClubManagerListBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_setWatcher),this.operCallback,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_setWatcher),this.operCallback,this),this.initScroller(),this.getClubManagerList()},a.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(124,8),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.updateUI_=function(){this.scrollerTables.setScrollerContent(this.clubWatcherDataList,!1)},a.prototype.createElement=function(e){var a=new t.ClubWatcherItem(this.clubId,e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.getClubManagerList=function(){t.ClubService.getInstance().getManagerList(this.clubId)},a.prototype.getClubManagerListBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.clubWatcherDataList=[];var i=a.data,n=i.managerList;for(var o in n){var s=n[o],r=new t.ClubWatcherData;r.parse(s),this.clubWatcherDataList.push(r)}this.updateUI()}},a.prototype.addRule=function(){var e=new t.CreateRoomDialog(this.clubId);t.DialogManager.getInstance().show(e)},a.prototype.operCallback=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data;this.updateData(i),this.updateUI()}},a.prototype.updateData=function(t){var e=0;null!=this.clubWatcherDataList&&(e=this.clubWatcherDataList.length);for(var a=0;e>a;a++)this.clubWatcherDataList[a].memberId==t.memberId?this.clubWatcherDataList[a]=t:this.clubWatcherDataList[a].watcher=!1;return!1},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_all_manager),this.getClubManagerListBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_setWatcher),this.operCallback,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_setWatcher),this.operCallback,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubWatcherDialog=e,__reflect(e.prototype,"game.ClubWatcherDialog")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.clubId=t,i.clubWatcherData=a,i.skinName="resource/skins/club/watcher/clubWatcherItemSkin.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnSetting,this.clickSetting),this.updateUI()},a.prototype.setData=function(t){this.clubWatcherData=t,this.updateUI()},a.prototype.clickSetting=function(){t.ClubService.getInstance().setWatcher(this.clubId,this.clubWatcherData.memberId)},a.prototype.updateUI_=function(){if(null!=this.clubWatcherData){var e=this;t.ResManager.loadWebImage(this.clubWatcherData.headImgUrl,function(t){e.imgHead.texture=t,e.imgHead.addEventListener(eui.UIEvent.COMPLETE,function(){e.imgHead.texture=t},this)},this),this.labelMemberName.text=this.clubWatcherData.memberName,this.labelMemberID.text=this.clubWatcherData.memberId,this.labelMemberType.text=t.ClubUtils.getMemberName(this.clubWatcherData.memberType),this.imgWatcher.visible=this.clubWatcherData.watcher}},a}(t.EComponent);t.ClubWatcherItem=e,__reflect(e.prototype,"game.ClubWatcherItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.isWaiting=!1,t.moveX=0,t.curIndex=1,t.skinName="resource/skins/common/Broadcast.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){this.initData(),this.x=(GameConfig.ScreenW-this.width)/2,this.y=120,this.scrollerGroup=new eui.Group,this.scrollerGroup.width=this.labelScroller.width,this.scrollerGroup.height=this.labelScroller.height,this.labelScroller.viewport=this.scrollerGroup},a.prototype.initData=function(){},a.prototype.show=function(){if(!this.isWaiting){if(t.SceneManager.getInstance().curScene.getIndex()!=Constants.SCENE_INDEX.MAIN)return void(this.visible=!1);var e=GlobalData.msgQueue.length;if(0>=e)return void(this.visible=!1);this.curIndex>=e&&(this.curIndex=0),this.isWaiting=!0,this.visible=!0,this.curMsg=GlobalData.msgQueue[this.curIndex],this.curLabel=new eui.Label(this.curMsg.msg),this.curLabel.fontFamily="fzzy",this.curLabel.size=25,this.scrollerGroup.addChild(this.curLabel);var a=this.labelScroller.width;this.curLabel.x=a,this.curLabel.y=this.curLabel.height-this.labelScroller.height/2;var i=a+this.curLabel.width,n=this,o=egret.Tween.get(this.curLabel,{loop:!1});o.to({x:a-i},10*i),o.call(function(){null!=n.curMsg.needRunTimes&&"undefined"!=n.curMsg.needRunTimes?n.curMsg.needRunTimes>0&&(n.curMsg.needRunTimes=n.curMsg.needRunTimes-1,0==n.curMsg.needRunTimes?GlobalData.msgQueue.splice(n.curIndex,1):n.curIndex=n.curIndex+1):n.curIndex=n.curIndex+1,n.isWaiting=!1,n.curLabel.parent.removeChild(n.curLabel),n.curLabel=null,n.show()})}},a.prototype.removeBroadcast=function(){},a.prototype.savePosition=function(){},a.prototype.addMsg=function(t){this.clearAllData();for(var e=0;e<t.length;e++){var a=t[e],i=a.runTimes;i>0&&(a.needRunTimes=a.runTimes),GlobalData.msgQueue.push(a)}},a.prototype.clearAllData=function(){GlobalData.msgQueue=[],this.curLabel&&(egret.Tween.removeTweens(this.curLabel),this.curLabel.parent.removeChild(this.curLabel),this.curLabel=null),this.isWaiting=!1,this.curIndex=1},a}(t.EComponent);t.Broadcast=e,__reflect(e.prototype,"game.Broadcast")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.showWaiting=function(){null==e.waiting&&(e.waiting=new t.CommonWaiting);var a=Main.instance.confirmDialogLayer;e.waiting.show(a)},e.hideWaiting=function(){null!=e.waiting&&e.waiting.hide()},e.showToast=function(e){var a=new t.Toast;Main.instance.toastLayer.addChild(a),a.showText(e)},e.showBroadcast=function(a){void 0===a&&(a=null),null==this.broadcast&&(e.broadcast=new t.Broadcast,e.broadcast.visible=!1),null==e.broadcast.parent&&t.SceneManager.getInstance().curScene.addChild(e.broadcast),a&&e.broadcast.addMsg(a),t.SceneManager.getInstance().curScene.getIndex()==Constants.SCENE_INDEX.MAIN&&e.broadcast.show()},e.hideBroadcast=function(){null!=e.broadcast&&(e.broadcast.parent.removeChild(e.broadcast),e.broadcast=null)},e}();t.CommonView=e,__reflect(e.prototype,"game.CommonView")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/common/LoadingSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.background=new eui.Rect,this.background.fillColor=0,this.background.alpha=.5;var e=1560,a=GameConfig.windowHeight_h5;this.background.width=e,this.background.height=a,this.background.x=(GameConfig.ScreenW-e)/2,this.background.y=(GameConfig.ScreenH-a)/2,this.addChildAt(this.background,0)},e.prototype.show=function(t){t.addChild(this),this.playAnimation(this.waiting,!0)},e.prototype.hide=function(){this.waiting.pause(),null!=this.parent&&this.parent.removeChild(this)},e.prototype.playAnimation=function(t,e){if(e)for(var a in t.items)t.items[a].props={loop:!0};t.play()},e}(t.EComponent);t.CommonWaiting=e,__reflect(e.prototype,"game.CommonWaiting")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.params=t,a.skinName="resource/skins/common/ConfirmBoxSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this);var t=this.params.type;this.params.confirmFunc,this.params.cancelFun;1==t&&(this.Button_cancel.visible=!1,this.Button_Ok.x=(GameConfig.ScreenW-this.Button_Ok.width)/2),this.addTapEvent(this.Button_Ok,this.clickConfirmEvent),this.addTapEvent(this.Button_cancel,this.clickCancelEvent),this.Text_info.text=this.params.info},a.prototype.clickConfirmEvent=function(){var t=this.params.confirmFunc;null!=t&&t.call(),this.close()},a.prototype.clickCancelEvent=function(){var t=this.params.cancelFun;null!=t&&t.call(),this.close()},a.prototype.getDialogUUID=function(){return(new t.md5).hex_md5(this.params.info)},a.prototype.close=function(){e.prototype.close.call(this)},a}(t.EDialog);t.ConfirmBox=e,__reflect(e.prototype,"game.ConfirmBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t._touchStatus=!1,t._distance=new egret.Point,t._isDrag=!1,t.rightX=675,t.rightX2=575,t.leftX=225,t.isLeft=!1,t.isRight=!1,t.isTop=!1,t.isBottom=!1,t.isFullScreen=!1,t.isLightOn=!1,t.skinName="resource/skins/common/floatingWindow.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.onPause,this.onPause,this),this.btn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.btnTouchBegin,this),this.btn.addEventListener(egret.TouchEvent.TOUCH_END,this.btnTouchEnd,this),this.btn.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,function(){a.btnTouchEnd()},this),this.exitFullScreen.visible=!1,this.lightingOff.visible=!1,this.popMenuGroup.visible=!1,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.x=this.btn.width/2,this.y=this.btn.height/2,this.addTapEvent(this.enterFullScreen,this.clickedEnterFullScreen),this.addTapEvent(this.exitFullScreen,this.clickedExitFullScreen),this.addTapEvent(this.refreshWeb,this.clickedRefresh),this.addTapEvent(this.lightingOn,this.ClickedLightingOn),this.addTapEvent(this.lightingOff,this.ClickedLightingOff),this.updateLayout()},a.prototype.btnTouchBegin=function(t){this.touchPoint=new egret.Point(t.stageX,t.stageY),this._isDrag=!1,this._distance.x=t.stageX-this.x,this._distance.y=t.stageY-this.y,this._touchStatus=!0,this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.btnTouchMove,this);var e=egret.Tween.get(this);this.popMenuGroup.visible||(this.isLeft?e.to({scaleX:1,scaleY:1,x:this.x+50},150):this.isRight?e.to({scaleX:1,scaleY:1,x:this.x-50},150):this.isTop?e.to({scaleX:1,scaleY:1,y:this.y+50},150):this.isBottom?e.to({scaleX:1,scaleY:1,y:this.y-50},150):e.to({scaleX:1,scaleY:1},150))},a.prototype.btnTouchEnd=function(){var t=egret.Tween.get(this);if(this._isDrag){var e=this.localToGlobal(this.btn.x,this.btn.y),a=this.btn.width/2,i=e.x-a,n=egret.MainContext.instance.stage.stageWidth-(e.x+a),o=e.y-a,s=egret.MainContext.instance.stage.stageHeight-(e.y+a),r=[{key:"left",dis:i},{key:"right",dis:n},{key:"top",dis:o},{key:"bottom",dis:s}];r.sort(function(t,e){return t.dis>e.dis?1:t.dis<e.dis?-1:0});var l=0;switch(r[0].key){case"left":l=this.x-r[0].dis,this.isLeft=!0;break;case"right":l=this.x+r[0].dis,this.isRight=!0;break;case"top":l=this.y-r[0].dis,this.isTop=!0;break;case"bottom":l=this.y+r[0].dis,this.isBottom=!0}this._isDrag=!1,this.isLeft?t.to({x:l},100).to({scaleX:1,scaleY:1,x:l-50},150):this.isRight?t.to({x:l},100).to({scaleX:1,scaleY:1,x:l+50},150):this.isTop?t.to({y:l},100).to({scaleX:1,scaleY:1,y:l-50},150):this.isBottom?t.to({y:l},100).to({scaleX:1,scaleY:1,y:l+50},150):t.to({scaleX:1,scaleY:1},150)}else{var e=this.localToGlobal(this.btn.x,this.btn.y);e.x>egret.MainContext.instance.stage.stageWidth/2?(this.popMenuGroup.x=this.leftX,this.bgImage.scaleX=1):("iOS"==egret.Capabilities.os?this.popMenuGroup.x=this.rightX2:this.popMenuGroup.x=this.rightX,this.bgImage.scaleX=-1),this.popMenuGroup.visible=!this.popMenuGroup.visible,this.scaleX=this.scaleY=1,this.popMenuGroup.visible||(this.isLeft?t.to({scaleX:1,scaleY:1,x:this.x-50},150):this.isRight?t.to({scaleX:1,scaleY:1,x:this.x+50},150):this.isTop?t.to({scaleX:1,scaleY:1,y:this.y-50},150):this.isBottom?t.to({scaleX:1,scaleY:1,y:this.y+50},150):t.to({scaleX:1,scaleY:1},150))}this._touchStatus=!1,this.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.btnTouchMove,this)},a.prototype.btnTouchMove=function(t){if(this._touchStatus){egret.Tween.removeTweens(this),this.popMenuGroup.visible=!1;var e=egret.Point.distance(this.touchPoint,new egret.Point(t.stageX,t.stageY));this._isDrag||(this._isDrag=e>10);var a=new egret.Point(t.stageX-this._distance.x,t.stageY-this._distance.y);this.x=a.x,this.y=a.y;var i=this.localToGlobal(this.btn.x,this.btn.y),n=void 0,o=void 0;i.x-this.btn.width/2<0?(n=Math.abs(i.x-this.btn.width/2),this.x+=n,this.isLeft=!0):i.x+this.btn.width/2>egret.MainContext.instance.stage.stageWidth?(n=Math.abs(i.x+this.btn.width/2)-egret.MainContext.instance.stage.stageWidth,this.x-=n,this.isRight=!0):(this.isLeft=!1,this.isRight=!1),i.y-this.btn.height/2<0?(o=Math.abs(i.y-this.btn.height/2),this.y+=o,this.isTop=!0):i.y+this.btn.height/2>egret.MainContext.instance.stage.stageHeight?(o=Math.abs(i.y+this.btn.height/2)-egret.MainContext.instance.stage.stageHeight,this.y-=o,this.isBottom=!0):(this.isTop=!1,this.isBottom=!1)}},a.prototype.reSet=function(){var t,e,a=this.localToGlobal(this.btn.x,this.btn.y);a.x-this.btn.width/2<0?(t=Math.abs(a.x-this.btn.width/2),this.x+=t):a.x+this.btn.width/2>egret.MainContext.instance.stage.stageWidth&&(t=Math.abs(a.x+this.btn.width/2)-egret.MainContext.instance.stage.stageWidth,this.x-=t),a.y-this.btn.height/2<0?(e=Math.abs(a.y-this.btn.height/2),this.y+=e):a.y+this.btn.height/2>egret.MainContext.instance.stage.stageHeight&&(e=Math.abs(a.y+this.btn.height/2)-egret.MainContext.instance.stage.stageHeight,this.y-=e)},a.prototype.updateButton=function(){this.enterFullScreen.visible=!this.isFullScreen,this.exitFullScreen.visible=this.isFullScreen,this.lightingOn.visible=!this.isLightOn,this.lightingOff.visible=this.isLightOn},a.prototype.clickedEnterFullScreen=function(){Utils.fullScreen(),this.isFullScreen=!0,this.updateButton()},a.prototype.clickedExitFullScreen=function(){Utils.exitScreen(),this.isFullScreen=!1,this.updateButton()},a.prototype.clickedRefresh=function(){if(Utils.isWeiXin()){var t=window.location.href.indexOf("?");t>0?window.location.href=window.location.href.substring(0,t)+"?"+Math.random():window.location.href=window.location.href+"?"+Math.random()}else location.reload()},a.prototype.ClickedLightingOn=function(){this.isLightOn=!0,this.updateButton()},a.prototype.ClickedLightingOff=function(){this.isLightOn=!1,this.updateButton()},a.prototype.updateLayout=function(){"iOS"==egret.Capabilities.os&&(this.bgImage.width=350,this.enterFullScreenGroup.visible=!1)},a.prototype.onPause=function(t){this.isFullScreen=!1,this.updateButton()},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.onPause,this.onPause,this)},a}(t.EComponent);t.floatingWindow=e,__reflect(e.prototype,"game.floatingWindow")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.activityHasShow=!1,this.activityShowType=0,this.mailTip=!1,this.dayTaskTip=!1,this.growTaskTip=!1,t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_EMAIL_TIP),this.mailTipEvent,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_TASK_TIP),this.taskTipEvent,this)}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.init=function(){e.instance&&e.getInstance().clean(),e.getInstance()},e.prototype.mailTipEvent=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=i.needTip;this.setMailTip(n)}},e.prototype.setMailTip=function(e){this.mailTip=e,t.EAppFacade.getInstance().sendNotification(t.GameCmd.UPDATE_MAIL_TIP)},e.prototype.taskTipEvent=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=i.redPointTip_day,o=i.redPointTip_grow;this.setTaskTip(n,o)}},e.prototype.setTaskTip=function(e,a){this.dayTaskTip=e,this.growTaskTip=a,t.EAppFacade.getInstance().sendNotification(t.GameCmd.UPDATE_TASK_TIP)},e.prototype.hasTaskTip=function(){return this.dayTaskTip||this.growTaskTip},e.prototype.hasDayTaskTip=function(){return this.dayTaskTip},e.prototype.hasGrowTaskTip=function(){return this.growTaskTip},e.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_EMAIL_TIP),this.mailTipEvent,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_TASK_TIP),this.taskTipEvent,this),e.instance=null},e}();t.GlobalService=e,__reflect(e.prototype,"game.GlobalService")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.numbers="",t.skinName="resource/skins/common/InputNumberSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClear,this.clickClear),this.addTapEvent(this.btnDelete,this.clickDelete),this.initBtnsEvent()},a.prototype.updateUI_=function(){for(var t=this.getNumbers(),e=t.length,a=0;e>a;a++)this.numbers.length>=a?(t[a].visible=!0,t[a].text=this.numbers.substring(a,a+1)):t[a].visible=!1},a.prototype.checkInput=function(){var e=this.numbers;return 6==e.length&&Utils.isNumbers(e)?!0:(t.CommonView.showToast("俱乐部ID应该是6位数字！"),!1)},a.prototype.getInpuNumbers=function(){return this.numbers},a.prototype.getNumber=function(t){for(var e=t.currentTarget,a=this.getBtnNumbers(),i=a.length,n=0;i>n;n++)if(e==a[n])return n},a.prototype.getBtnNumbers=function(){var t=[this.btnNumber0,this.btnNumber1,this.btnNumber2,this.btnNumber3,this.btnNumber4,this.btnNumber5,this.btnNumber6,this.btnNumber7,this.btnNumber8,this.btnNumber9];return t},a.prototype.getNumbers=function(){return[this.labelNumber1,this.labelNumber2,this.labelNumber3,this.labelNumber4,this.labelNumber5,this.labelNumber6]},a.prototype.clickBtnNumber=function(t){if(!(this.numbers.length>=6)){var e=this.getNumber(t);this.numbers+=e,this.updateUI(),6==this.numbers.length&&this.numberFullFunc&&this.numberFullFunc.call(null,null)}},a.prototype.clickClear=function(){this.numbers="",this.updateUI()},a.prototype.clickDelete=function(){this.numbers.length>0&&(this.numbers=this.numbers.substr(0,this.numbers.length-1)),this.updateUI()},a.prototype.initBtnsEvent=function(){for(var t=this.getBtnNumbers(),e=t.length,a=0;e>a;a++)this.addTapEvent(t[a],this.clickBtnNumber)},a.prototype.setNumberFullFunc=function(t){this.numberFullFunc=t},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.InputNumberUI=e,__reflect(e.prototype,"game.InputNumberUI")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.itemData=t,a.skinName="resource/skins/common/ShareOverResultItemSkin.exml",a
}return __extends(a,e),a.prototype.loadHeadImg=function(){var e=this;t.ResManager.loadWebImage(this.itemData.headImgUrl,function(a){e.Image_head.texture=a,t.EAppFacade.getInstance().sendNotification(t.GameCmd.SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE)},this)},a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.updateUI()},a.prototype.setData=function(t){this.itemData=t,this.updateUI()},a.prototype.updateUI_=function(){this.Text_userName.text=this.itemData.userName,this.itemData.score>=0?(this.Text_score.text="+"+this.itemData.score,this.Text_score.textColor=Utils.RGBA2Color(114,90,63)):(this.Text_score.text=this.itemData.score,this.Text_score.textColor=Utils.RGBA2Color(136,180,243)),this.itemData.waibaoFen>=0?(this.Text_wbScore.text="+"+this.itemData.waibaoFen,this.Text_wbScore.textColor=Utils.RGBA2Color(114,90,63)):(this.Text_wbScore.text=this.itemData.waibaoFen,this.Text_wbScore.textColor=Utils.RGBA2Color(136,180,243)),this.Image_homer.visible=this.itemData.master,this.loadHeadImg()},a}(t.EComponent);t.ShareOverResultItem=e,__reflect(e.prototype,"game.ShareOverResultItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.shareOverBox.index)||this;return a.curCompleteHeadNum=0,a.hasAdd=!1,a.addEventListener(eui.UIEvent.CREATION_COMPLETE,a.onCreationComplete,a),a.data=t,a.skinName="resource/skins/common/ShareOverResultViewSkin.exml",a}return __extends(a,e),a.prototype.onCreationComplete=function(){this.hasAdd=!0,this.showShare()},a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.initScroller(),this.updateUI(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE,this.headDownloadCompeteEvent,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.onResume,this.onResume,this)},a.prototype.onResume=function(){this.close()},a.prototype.headDownloadCompeteEvent=function(){this.curCompleteHeadNum=this.curCompleteHeadNum+1,this.showShare()},a.prototype.showShare=function(){var e=RES.isGroupLoaded("shareResult");e||RES.loadGroup("shareResult"),this.hasAdd&&e&&this.curCompleteHeadNum==this.data.userInfoList.length&&(t.EAppFacade.getInstance().removeCommand(t.GameCmd.SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE,this.headDownloadCompeteEvent,this),egret.setTimeout(this.callShare.bind(this),this,100))},a.prototype.callShare=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,platform.share("没有硝烟的雀坛，留下你不败的神话！","",123,GameConfig.windowWidth,GameConfig.windowHeight)];case 1:return t=e.sent(),console.log(t),[2]}})})},a.prototype.initScroller=function(){this.userList.setElementViewInfo(87,0),this.userList.setElementCreateFunction(this.createElement.bind(this)),this.userList.setElementUpdateDataFun(this.updateElement.bind(this)),this.userList.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(e){var a=new t.ShareOverResultItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.updateUI_=function(){this.userList.clearContent(),this.userList.setScrollerContent(this.data.userInfoList),this.Text_roomNumber.text="房间号 "+this.data.msgRoom.roomNumber,this.data.msgRoom.roomType==Constants.ROOM_TYPE.jinYuanZi?this.Text_roomType.text="进园子":this.data.msgRoom.roomType==Constants.ROOM_TYPE.changKaiTou&&(this.Text_roomType.text="敞开头")},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE,this.headDownloadCompeteEvent,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.onResume,this.onResume,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ShareOverResultView=e,__reflect(e.prototype,"game.ShareOverResultView")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.tbX=160,e.lrY=52,e.skinName="resource/skins/common/TipsViewSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this)},e.prototype.setInfo=function(t,e,a){void 0===e&&(e=120),void 0===a&&(a=28),this.info.maxWidth=e,this.info.text=t},e.prototype.setPopPosition=function(t,e,a){this.x=e,this.y=a,2==t?(this.anchorOffsetX=70,this.anchorOffsetY=8):1==t?(this.anchorOffsetX=-20,this.anchorOffsetY=120):4==t?(this.anchorOffsetX=5,this.anchorOffsetY=54):3==t&&(this.anchorOffsetX=this.width,this.anchorOffsetY=70)},e}(t.EComponent);t.TipsView=e,__reflect(e.prototype,"game.TipsView")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/common/ToastSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.x=GameConfig.ScreenW/2-this.width/2,this.y=-this.height},e.prototype.showText=function(t){var e=this;this.Text_msg.text=t,this.x=GameConfig.ScreenW/2-this.width/2;var a=egret.Tween.get(this);a.to({y:0},300,egret.Ease.getPowOut(3)),a.wait(1500),a.to({y:-this.height},300,egret.Ease.getPowIn(3)),a.call(function(){e.parent.removeChild(e)})},e}(t.EComponent);t.Toast=e,__reflect(e.prototype,"game.Toast")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.SUCCESS=1,t.FAIL=0,t}();t.CmdResultType=e,__reflect(e.prototype,"game.CmdResultType")}(game||(game={}));var game;!function(t){var e=function(){function e(t,e,a){this.tingTint=null,this.status=-1,this.clickedIndex=-1,this.selectIndex=-1,this.moveIndex=-1,this.canMove=!1,this.beginStartX=0,this.beginStartY=0,this.flagValue=0,this.flagSet=[],this._isBuHuaing=!1,this._needClearCardWhenStatusIsOver=!1,this.playerCardNode={},this.tempDataType={DRAW_CARD:1,AUTO_DISCARD_TILE:2,DISCARD_OTHER:3},this.gs=t,this.cardGroup=a,this.touchErea=e,this.init()}return e.prototype.init=function(){this.status=GameConst.GAME_STATUS_TYPE.ready,null==this.tingTint&&(this.tingTint=new t.TingTint,this.tingTint.visible=!1,this.gs.addChild(this.tingTint)),this.initData(),this.setFlowerCardVisible(),this.initTouchEvent()},e.prototype.initData=function(){this.handCardNode=[],this.pongKongNode=[],this.huaCardNode=[],this.outCardNode=[],this.RightCardGroup=new eui.Group,this.cardGroup.addChild(this.RightCardGroup),this.UpCardGroup=new eui.Group,this.cardGroup.addChild(this.UpCardGroup),this.LeftCardGroup=new eui.Group,this.cardGroup.addChild(this.LeftCardGroup),this.DownCardGroup=new eui.Group,this.cardGroup.addChild(this.DownCardGroup),this.HandCardGroupSet=[],this.HuaCardGroupSet=[],this.PongKongCardGroupSet=[],this.OutCardGroupSet=[];for(var t=0;t<GameConst.maxPlayerNum;t++){this.handCardNode[t]=[],this.pongKongNode[t]=[],this.huaCardNode[t]=[],this.outCardNode[t]=[],this.HandCardGroupSet[t]=new eui.Group,this.HuaCardGroupSet[t]=new eui.Group,this.PongKongCardGroupSet[t]=new eui.Group,this.OutCardGroupSet[t]=new eui.Group;var e=null;t==GameConst.ME_DIR?e=this.DownCardGroup:t==GameConst.PLAY_DIR.left?e=this.LeftCardGroup:t==GameConst.PLAY_DIR.right?e=this.RightCardGroup:t==GameConst.PLAY_DIR.up&&(e=this.UpCardGroup),e.addChild(this.HuaCardGroupSet[t]),e.addChild(this.OutCardGroupSet[t]),e.addChild(this.PongKongCardGroupSet[t]),t==GameConst.PLAY_DIR.right?e.addChildAt(this.HandCardGroupSet[t],1):e.addChild(this.HandCardGroupSet[t])}this.flagValue=0,this.flagSet=[],this._isBuHuaing=!1,this._needClearCardWhenStatusIsOver=!1,this.playerCardNode={},this.allScheduler=[]},e.prototype.onEventHandler=function(e){var a=e.data,i=a.cmd,n=a.data;if(i==t.GameCmd.OPERATE_PONG||i==t.GameCmd.OPERATE_PONG_BACK)var o=n.clientId,s=n.pongData;if(i==t.GameCmd.OPERATE_PONG)this.pong(o,s);else if(i==t.GameCmd.OPERATE_PONG_BACK)this.pongBack(o,s);else if(i==t.GameCmd.OPERATE_KONG||i==t.GameCmd.OPERATE_KONG_BACK){var o=n.clientId,r=n.kongData;i==t.GameCmd.OPERATE_KONG?this.kong(o,r):i==t.GameCmd.OPERATE_KONG_BACK&&this.kongBack(o,r)}else if(i==t.GameCmd.DRAW_CARD||i==t.GameCmd.DRAW_CARD_BACK){GlobalData.gameData.clearFirstDrawCardData();var l=n.chairId,c=n.cardValues,o=GlobalData.gameData.changeChairIdToClientId(l);this.status!=GameConst.GAME_STATUS_TYPE.playing?GlobalData.gameData.addTempDataBeforeGameStart({type:this.tempDataType.DRAW_CARD,data:n}):i==t.GameCmd.DRAW_CARD?this.drawCard(o,c):i==t.GameCmd.DRAW_CARD_BACK&&this.drawBackCard(o,c)}else if(i==t.GameCmd.DISCARD||i==t.GameCmd.DISCARD_BACK){var l=n.chairId,h=n.cardValue,o=GlobalData.gameData.changeChairIdToClientId(l);if(this.status!=GameConst.GAME_STATUS_TYPE.playing)GlobalData.gameData.addTempDataBeforeGameStart({type:this.tempDataType.DISCARD_OTHER,data:n});else if(GlobalData.gameData.isPlayBack())if(i==t.GameCmd.DISCARD){var u=this.getHandCardIdxByValue(o,h);this.discard(o,u)}else i==t.GameCmd.DISCARD_BACK&&this.discardBack(o,h);else this.otherDiscard(o,h)}else if(i==t.GameCmd.UPDATE_DISCARD_ARROW){var o=n.clientId;this.playDiscardArrow(o)}else if(i==t.GameCmd.UPDATE_HUA)this.updateHuaCards(GameConst.ME_DIR,n);else if(i==t.GameCmd.AUTO_DISCARD_INFO)if(GlobalData.gameData.clearAutoDiscardInfo(),this.clearAllScheduler(),this.status!=GameConst.GAME_STATUS_TYPE.playing)t.LogUtils.info("~~~~~~~~~~~~~~~~增加 自动打牌数据"),GlobalData.gameData.addTempDataBeforeGameStart({type:this.tempDataType.AUTO_DISCARD_TILE,data:n});else{var d=n.tileId;this.autoDelayDiscard(d)}else i==t.GameCmd.CHANGE_CARD_BACK?this.changeCardBack():i==t.GameCmd.FLOWER_VISIBLE?this.setFlowerCardVisible():i==t.GameCmd.CHANGE_CARD_FACE&&this.changeCardFace()},e.prototype.setStatus=function(t,e){var a=this;void 0===e&&(e=!1),this.status=t,this.status==GameConst.GAME_STATUS_TYPE.ready?this.clearAllCard():this.status==GameConst.GAME_STATUS_TYPE.before_playing?this.clearAllCard():this.status==GameConst.GAME_STATUS_TYPE.playing?(e?this.addSchedulerFunc(function(){a.setTouchEnable(!0)},1e3):this.setTouchEnable(!0),this.showPlayerCard(e),this.excuteTempDataWhenGameBegin()):this.status==GameConst.GAME_STATUS_TYPE.waiting?(this.clearAllCard(),this.gs.getEffectLayer().hideCurDiscardArrow()):(this.status==GameConst.GAME_STATUS_TYPE.over||this.status==GameConst.GAME_STATUS_TYPE.allOver)&&(GlobalData.gameData.clearTempDataBeforeGameStart(),this.clearSelectCard())},e.prototype.changeCardFace=function(){for(var t=0;t<this.handCardNode.length;t++)for(var e=0;e<this.handCardNode[t].length;e++){var a=this.handCardNode[t][e];a.changeCardFace()}for(var t=0;t<this.huaCardNode.length;t++)for(var e=0;e<this.huaCardNode[t].length;e++){var a=this.huaCardNode[t][e];a.changeCardFace()}for(var t=0;t<this.outCardNode.length;t++)for(var e=0;e<this.outCardNode[t].length;e++){var a=this.outCardNode[t][e];a.changeCardFace()}for(var t=0;t<this.pongKongNode.length;t++)for(var e=0;e<this.pongKongNode[t].length;e++){var a=this.pongKongNode[t][e];a.changeCardFace()}},e.prototype.changeCardBack=function(){for(var t=0;t<this.handCardNode.length;t++)for(var e=0;e<this.handCardNode[t].length;e++){var a=this.handCardNode[t][e];a.changeCardBack()}for(var t=0;t<this.huaCardNode.length;t++)for(var e=0;e<this.huaCardNode[t].length;e++){var a=this.huaCardNode[t][e];a.changeCardBack()}for(var t=0;t<this.outCardNode.length;t++)for(var e=0;e<this.outCardNode[t].length;e++){var a=this.outCardNode[t][e];a.changeCardBack()}for(var t=0;t<this.pongKongNode.length;t++)for(var e=0;e<this.pongKongNode[t].length;e++){var a=this.pongKongNode[t][e];a.changeCardBack()}},e.prototype.playDiscardArrow=function(t){var e=this.getLastOutCard(t);if(null!=e){var a=e.localToGlobal(e.width/2,e.height/2);a.x=a.x-GlobalData.deltaX,a.y=a.y-GlobalData.deltaY,this.gs.getEffectLayer().playCurDiscardArrow(a)}},e.prototype.excuteTempDataWhenGameBegin=function(){for(var t=GlobalData.gameData.getTempDataBeforeGameStart(),e=0;e<t.length;e++){var a=t[e],i=a.type,n=a.data;if(i==this.tempDataType.DRAW_CARD){var o=n.chairId,s=n.cardValues,r=GlobalData.gameData.changeChairIdToClientId(o);this.drawCard(r,s)}else if(i==this.tempDataType.AUTO_DISCARD_TILE){this.clearAllScheduler();var l=n.tileId;this.autoDelayDiscard(l,!0)}else if(i==this.tempDataType.DISCARD_OTHER){var o=n.chairId,c=n.cardValue,r=GlobalData.gameData.changeChairIdToClientId(o);this.otherDiscard(r,c)}}GlobalData.gameData.clearTempDataBeforeGameStart();var h=GlobalData.gameData.getFirstDrawCardData();if(null!=h){var o=h.chairId,s=h.cardValues,r=GlobalData.gameData.changeChairIdToClientId(o);this.drawCard(r,s),GlobalData.gameData.clearFirstDrawCardData()}var u=GlobalData.gameData.getAutoDiscardInfo();if(null!=u){this.clearAllScheduler();var l=u.tileId;this.autoDelayDiscard(l,!0),GlobalData.gameData.clearAutoDiscardInfo()}},e.prototype.setTouchEnable=function(t){GlobalData.gameData.isPlayBack()||(this.touchErea.touchEnabled=t)},e.prototype.showPlayerCard=function(e){this.clearAllScheduler();for(var a=0;a<GameConst.maxPlayerNum;a++){var i=GlobalData.gameData.changeIndexToClientId(a);-1!=i&&(this.initPongKongNode(i),this.initOutCard(i),this.initHuaCard(i,e),this.initHandCard(i))}var n=GlobalData.gameData.getLastDiscarChairId();if(0!=n){var o=GlobalData.gameData.changeChairIdToClientId(n),s=GlobalData.gameData.getLastDiscardValue(),r=this.getLastOutCard(o);t.LogUtils.info("lastDiscardClientId "+o),t.LogUtils.info("lastDiscardCardValue "+s),null!=r&&t.LogUtils.info("cur lastDiscardCardValue "+r.getCardValue()),r&&s==r.getCardValue()&&this.playDiscardArrow(o)}this.gs.getGameUILayer().checkMyTingInfoBtn()},e.prototype.initPongKongNode=function(e){this.clearPongKongCard(e);var a=GlobalData.gameData.getCardData(e);if(null==a)return void t.LogUtils.error("initPongKongNode cardData is null dir "+e);for(var i=a.getPongKongCards(),n=i.length,o=0;n>o;o++)this.createPongKongNode(e,i[o],o)},e.prototype.createPongKongNode=function(e,a,i,n){void 0===n&&(n=0);var o=GameConst.CARD_DATA.PONG_KONG_CARD[e].path;GameUtils.is3dMode()&&(o=GameConst.CARD_3D_DATA.PONG_KONG_CARD[e].path),(e==GameConst.PLAY_DIR.down||e==GameConst.PLAY_DIR.up)&&(o=Utils.format(o,i+1));var s=new t.PongKongCardNode(Constants.UI_GAME_CSB_PATH+o,a,e,i);n>0?(s.visible=!1,this.addSchedulerFunc(function(){t.EAppFacade.getInstance().sendNotification(t.GameCmd.REPLAYER_ACTION_FINISH),s.visible=!0},n)):t.EAppFacade.getInstance().sendNotification(t.GameCmd.REPLAYER_ACTION_FINISH);var r=-1;e==GameConst.PLAY_DIR.right&&(r=0),-1==r?this.PongKongCardGroupSet[e].addChild(s):this.PongKongCardGroupSet[e].addChildAt(s,0),this.pongKongNode[e].push(s)},e.prototype.initOutCard=function(e){this.clearOutCard(e);var a=GlobalData.gameData.getCardData(e);if(null!=a){var i=a.getPlayerOutCards();t.LogUtils.info(i.toString());for(var n=i.length,o=0;n>o;o++)this.createOutCard(e,i[o],o)}},e.prototype.createOutCard=function(e,a,i){var n=this.getOutCardCsbPath(e,i),o=new t.OutCardNode(Constants.UI_GAME_CSB_PATH+n,a,e,i),s=-1;(e==GameConst.PLAY_DIR.up||e==GameConst.PLAY_DIR.right)&&(s=0,i>=20&&(s=20)),-1==s?this.OutCardGroupSet[e].addChild(o):this.OutCardGroupSet[e].addChildAt(o,s),this.outCardNode[e].push(o)},e.prototype.initHuaCard=function(t,e){var a=this,i=GlobalData.gameData.getCardData(t);if(null!=i){var n=i.getPlayerHuaCards(),o=n.length,s=function(){a.clearHuaCard(t);for(var e=0;o>e;e++)a.createHuaCard(t,n[e],e)};t==GameConst.ME_DIR&&o>0&&e?this.addSchedulerFunc(function(){a.gs.getEffectLayer().playBuHua(GameConst.ME_DIR,1),s()},500):s()}},e.prototype.getOutCardCsbPath=function(e,a){var i=GameConst.CARD_DATA,n=GameUtils.is3dMode();n&&(i=GameConst.CARD_3D_DATA);var o=i.OUT_CARD[e].path;return t.LogUtils.info("nodePath"+o),o},e.prototype.initHandCard=function(t){this.clearHandCard(t);var e=GlobalData.gameData.getCardData(t);if(null!=e){var a,i=e.getPlayerHandCards(),n=i.length,o=[],s=e.getDrawCardIndex();if(n>=s){for(var r=0;s-1>r;r++)o[r]=i[r];a=i[n-1]}else o=i;o.sort(function(t,e){return t-e}),null!=a&&o.push(a);for(var r=0;n>r;r++)this.createHandCard(t,o[r],r);this.checkShowTingInfo()}},e.prototype.pongBack=function(t,e){var a=e.getValue(),i=e.getProvideClientId(),n=this.getPongKongNum(t),o=this.pongKongNode[t][n-1];if(o.getCardValue()==a){this.pongKongNode[t].splice(n-1,1),this.PongKongCardGroupSet[t].removeChild(o);var s=this.handCardNode[t],r=this.getHandCardsNum(t),l=s[r-1],c=this.calcCardInsertIndex(t,l.getCardValue());s.splice(r-1,1),s.splice(c,0,l);for(var h=0;2>h;h++){var c=this.calcCardInsertIndex(t,a);this.createHandCard(t,a,c)}for(var u=this.getHandCardsNum(t),h=0;u>h;h++){var d=s[h];t==GameConst.PLAY_DIR.right?this.HandCardGroupSet[t].addChildAt(d,0):t==GameConst.PLAY_DIR.left&&this.HandCardGroupSet[t].addChild(d),d.resetPosition(h,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL)}}var m=this.getDiscardNum(i);this.createOutCard(i,a,m)},e.prototype.pong=function(t,e){var a=t==GameConst.ME_DIR||GlobalData.gameData.isPlayBack(),i=e.getValue(),n=this.getPongCardIndex(t,i);if(null!=n)for(var o=this.handCardNode[t],s=0;2>s;s++){var r=o[n];if(null!=r){if(a){var l=this.getUpOffData(t),c=l.moveOffX,h=l.moveOffY,u=egret.Tween.get(r);u.to({x:r.x+c,y:r.y+h},200),u.wait(200),u.call(function(){this.parent.removeChild(this)})}else this.HandCardGroupSet[t].removeChild(r);o.splice(n,1)}}var d=this.getPongKongNum(t);a?this.createPongKongNode(t,e,d,400):this.createPongKongNode(t,e,d);var m=e.getProvideClientId();this.removePongKongProvideCard(t,m),this.resetAllHandCardPosition(t),e.getStutre()?this.addTwoOrThreeCardFlag(t):this.clearTwoOrThreeCardFlag(t),this.checkShowTingInfo()},e.prototype.addTwoOrThreeCardFlag=function(t){for(var e=GlobalData.gameData.changeIndexToClientId(t),a=this.pongKongNode[e],i=0;i<a.length;i++)a[i].getData().getStutre()||(a[i].getData().setStutre(!0),a[i].flagTwoOrThreeCard())},e.prototype.clearTwoOrThreeCardFlag=function(t){var e=GlobalData.gameData.changeIndexToClientId(t);if(-1!=e)for(var a=this.pongKongNode[e],i=0;i<a.length;i++)a[i].getData().getStutre()&&(a[i].getData().setStutre(!1),a[i].ClearTwoOrThreeCard())},e.prototype.updateHuaCards=function(e,a){for(var i=this.huaCardNode[e].length,n=0;i>n;n++)this.HuaCardGroupSet[e].removeChild(this.huaCardNode[e][n]);this.huaCardNode[e]=[];for(var n=0;n<a.length;n++){this.getHuaNum(e);this.createHuaCard(e,a[n],n)}var o=this.huaCardNode[e].length;Utils.sendGameEvent(t.GameCmd.PLAYER_HUA_NUM_CHANGED,{clientId:e,huaNum:o})},e.prototype.getUpOffData=function(t){var e=0,a=0;return GlobalData.gameData.isPlayBack()?t==GameConst.ME_DIR?e=-GameConst.CARD_SIZE.HAND_CARD[t].height_playBack:t==GameConst.PLAY_DIR.up?e=GameConst.CARD_SIZE.HAND_CARD[t].height_playBack:t==GameConst.PLAY_DIR.left?a=GameConst.CARD_SIZE.HAND_CARD[t].width_playBack:t==GameConst.PLAY_DIR.right&&(a=-GameConst.CARD_SIZE.HAND_CARD[t].width_playBack):t==GameConst.ME_DIR?e=-GameConst.CARD_SIZE.HAND_CARD[t].height:t==GameConst.PLAY_DIR.up?e=GameConst.CARD_SIZE.HAND_CARD[t].height:t==GameConst.PLAY_DIR.left?a=GameConst.CARD_SIZE.HAND_CARD[t].width:t==GameConst.PLAY_DIR.right&&(a=-GameConst.CARD_SIZE.HAND_CARD[t].width),{moveOffX:a,moveOffY:e}},e.prototype.checkShowTingInfo=function(){if(!GlobalData.gameData.isPlayBack()&&(this.clearTingFlag(),GlobalData.gameData.hasTingPaiInfo()))for(var t=this.handCardNode[GameConst.ME_DIR],e=GlobalData.gameData.getTingPaiInfo(),a=0;a<e.length;a++)for(var i=e[a].tileId,n=0;n<t.length;n++){var o=t[n].getCardValue();o==i&&t[n].setTingFlagVisible(!0)}},e.prototype.setFlowerCardVisible=function(){for(var t=GlobalData.gameData.getFlowerCardVisible(),e=0;e<this.HuaCardGroupSet.length;e++)this.HuaCardGroupSet[e].visible=t},e.prototype.createHuaCard=function(e,a,i){var n=GameConst.CARD_DATA.HUA_CARD[e].path,o=GameUtils.is3dMode();n=o?GameConst.CARD_3D_DATA.HUA_CARD[e].path:GameConst.CARD_DATA.HUA_CARD[e].path;var s={nodePath:Constants.UI_GAME_CSB_PATH+n,cardValue:a,dir:e,idx:i},r=new t.HuaCardNode(s);this.huaCardNode[e].pu;var l=-1;e==GameConst.PLAY_DIR.right&&(l=0),-1==l?this.HuaCardGroupSet[e].addChild(r):this.HuaCardGroupSet[e].addChildAt(r,l),this.huaCardNode[e].push(r);var c=this.huaCardNode[e].length;Utils.sendGameEvent(t.GameCmd.PLAYER_HUA_NUM_CHANGED,{clientId:e,huaNum:c})},e.prototype.createHandCard=function(e,a,i,n){void 0===n&&(n=-1);var o=this.getDrawCardIndex(e),s=this.getHandCardsNum(e);if(!(s>=o+1)){null==a&&t.LogUtils.error("数据错误");var r=this.getHandCardCsbPath(e,i),l={nodePath:Constants.UI_GAME_CSB_PATH+r,cardValue:a,dir:e,idx:i,actionType:n},c=new t.HandCardNode(this,l);this.handCardNode[e].push(c);var h=-1;e==GameConst.PLAY_DIR.right&&(h=0),-1==h?this.HandCardGroupSet[e].addChild(c):this.HandCardGroupSet[e].addChildAt(c,h)}},e.prototype.getHandCardCsbPath=function(t,e){var a="";return GameUtils.is3dMode()?(a=GameConst.CARD_3D_DATA.HAND_CARD[t].path,t!=GameConst.ME_DIR&&GlobalData.gameData.isPlayBack()&&(a=GameConst.CARD_3D_DATA.HAND_CARD[t].playBackPath)):(a=GameConst.CARD_DATA.HAND_CARD[t].path,t!=GameConst.ME_DIR&&GlobalData.gameData.isPlayBack()&&(a=GameConst.CARD_DATA.OUT_CARD[t].path)),a},e.prototype.initTouchEvent=function(){this.clickedIndex=-1;this.touchErea.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchEventBegin,this),this.touchErea.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchEventMove,this),this.touchErea.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEventEnd,this),this.touchErea.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchEventEnd,this),this.touchErea.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEventEnd,this)},e.prototype.checkAutoDelay=function(){if(GlobalData.gameData.isAutoDelay(GameConst.ME_DIR)){if(-1!=this.moveIndex){var t=this.getHandCardByIdx(GameConst.ME_DIR,this.moveIndex);null!=t&&(t.resetPosition(this.moveIndex),this.clearSelectCard()),this.moveIndex=-1}return!0}return!1},e.prototype.touchEventBegin=function(t){if(this.isGestureDiscardEnable()&&!this.checkAutoDelay()){var e=this.isMeGestureDiscard();if(e){this.clickedIndex=-1,this.moveIndex=-1,this.canMove=!1;var a=this.getTouchIndex(t.stageX,t.stageY);if(-1==a)return void this.gs.resetClickEvent();this.clickedIndex=a,this.beginStartX=t.stageX,this.beginStartY=t.stageY}else this.clickedIndex=this.getTouchIndex(t.stageX,t.stageY),-1==this.clickedIndex&&this.gs.resetClickEvent()}},e.prototype.touchEventMove=function(e){if(this.status==GameConst.GAME_STATUS_TYPE.playing&&!this.checkAutoDelay()){var a=this.isMeGestureDiscard();if(a&&-1!=this.clickedIndex){var i=e.stageX,n=e.stageY;if(!this.canMove){var o=this.beginStartX-i,s=this.beginStartY-n;if(Math.abs(o)<5&&Math.abs(s)<5)return;this.canMove=!0}this.clearSelectCard();var r=this.getHandCardByIdx(GameConst.ME_DIR,this.clickedIndex);if(null!=r&&r.canSelect()){this.moveIndex=this.clickedIndex;var l=this.HandCardGroupSet[GameConst.ME_DIR].getChildIndex(r),c=this.getHandCardsNum(GameConst.ME_DIR);c>l&&this.HandCardGroupSet[GameConst.ME_DIR].setChildIndex(r,c),r.x=i-GameConst.CARD_SIZE.HAND_CARD[GameConst.ME_DIR].width/2-GlobalData.deltaX,r.y=n-GameConst.CARD_SIZE.HAND_CARD[GameConst.ME_DIR].height/2-30-GlobalData.deltaY,t.LogUtils.info("touchEventMove evt y:"+n)}}}},e.prototype.touchEventEnd=function(e){if(!this.isGestureDiscardEnable())return void this.gs.resetClickEvent();if(!this.checkAutoDelay()){var a=this.isMeGestureDiscard();if(a){if(-1==this.clickedIndex)return;var i=e.stageX,n=e.stageY,o=this.getTouchIndex(i,n);if(-1!=this.moveIndex){var s=this.getHandCardByIdx(GameConst.ME_DIR,this.moveIndex);this.HandCardGroupSet[GameConst.ME_DIR].setChildIndex(s,0),t.LogUtils.info("touchEventEnd evt y:"+n),570>n?this.discard(GameConst.ME_DIR,this.clickedIndex):(s.resetPosition(this.moveIndex),this.clearSelectCard())}else if(GlobalData.gameData.getClickCardType()==GameConst.CLICK_CARD_TYPE.click)o==this.clickedIndex&&this.discard(GameConst.ME_DIR,this.clickedIndex);else if(GlobalData.gameData.getClickCardType()==GameConst.CLICK_CARD_TYPE.doubleClick){if(o!=this.clickedIndex)return;var r=this.getHandCardByIdx(GameConst.ME_DIR,this.clickedIndex);if(null==r)return;r.isSelected()?this.discard(GameConst.ME_DIR,this.clickedIndex):this.setSelectCardIndex(this.clickedIndex)}}else{var l=this.getTouchIndex(e.stageX,e.stageY);if(l!=this.clickedIndex)return;this.setSelectCardIndex(this.clickedIndex),this.clickedIndex=-1}}},e.prototype.getTouchIndex=function(e,a){for(var i=-1,n=this.handCardNode[GameConst.ME_DIR].length,o=0;n>o;o++){var s=this.handCardNode[GameConst.ME_DIR][o];if(s.hitTestPoint(e,a)){t.LogUtils.info("选中"+(o+1)+"张"),i=o;break}}return i},e.prototype.setSelectCardIndex=function(t){var e=this.getHandCardByIdx(GameConst.ME_DIR,t);if(this.selectIndex==t)return void this.clearSelectCard();if(this.clearSelectCard(),null!=e&&e.canSelect()){e.setSelect(!0),this.flagSameValueCardForSelectedCard(e.getCardValue()),this.selectIndex=t;var a=GlobalData.gameData.getTingInfo(e.getCardValue());if(null!=a){var i=e.localToGlobal(0,0);this.tingTint.initData(a,i.x),this.tingTint.visible=!0}}},e.prototype.calcCardInsertIndex=function(t,e){for(var a=this.getHandCardsNum(t),i=a+1,n=0;a>n;n++){var o=this.handCardNode[t][n].getCardValue();if(o>=e){i=n;break}}return i},e.prototype.autoDelayDiscard=function(t,e){void 0===e&&(e=!1);var a=this.getHandCardsNum(GameConst.ME_DIR),i=this.getDrawCardIndex(GameConst.ME_DIR)+1;if(i==a){for(var n=-1,o=a-1;o>=0;o--){var s=this.handCardNode[GameConst.ME_DIR][o].getCardValue();if(s==t){n=o;break}}-1!=n&&this.discard(GameConst.ME_DIR,n,!0)}},e.prototype.discardBack=function(e,a){var i=this.getDrawCardIndex(e);this.createHandCard(e,a,i);var n=this.getLastOutCard(e);if(null!=n){n.getCardValue()!=a&&t.LogUtils.error("回退打牌 桌面上的牌值与打的牌值不相等");var o=this.getDiscardNum(e);this.outCardNode[e].splice(o-1,1),this.OutCardGroupSet[e].removeChild(n)}else t.LogUtils.error("回退打牌 桌面上的牌不存在")},e.prototype.discard=function(e,a,i){void 0===i&&(i=!1),t.LogUtils.info("出牌");var n=this.getHandCardByIdx(e,a);if(!this.checkCanDiscardCard(e,a))return n.resetPosition(a),this.clearSelectCard(),void t.CommonView.showToast(Strings.outCardError);var o=n.getCardValue();SoundUtils.playEffectSoundNameBindPlayer(e,o),this.clearSelectCard(),GlobalData.gameData.clearTingPaiInfo(),this.clearTingFlag();var s=this.handCardNode[e],r=this.getDrawCardIndex(e),l=s[r],c=s[a];if(this.HandCardGroupSet[e].removeChild(c),s.splice(a,1),r==a);else{var h,u,d;if(null==l)h=a,u=s.length-1;else{if(d=this.calcCardInsertIndex(e,l.getCardValue()),s.splice(r-1,1),s.splice(d,0,l),d>=a?(h=a,u=r-1):(h=d+1,u=r-1),e==GameConst.PLAY_DIR.right)for(var m=s.length,p=0;m>p;p++)this.HandCardGroupSet[e].setChildIndex(s[p],0);else if(e==GameConst.PLAY_DIR.left)for(var m=s.length,p=0;m>p;p++)this.HandCardGroupSet[e].setChildIndex(s[p],p);d==s.length-1?l.resetPosition(d,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL):l.resetPosition(d,GameConst.HAND_CARD_ACTION_TYPE.INSERT_DRAW_CARD)}if(t.LogUtils.info("startIndex:"+h),t.LogUtils.info("endIndex:"+u),u>=h)for(var p=h;u>=p;p++)s[p].resetPosition(p,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL)}this.addOutCard(e,o),t.EAppFacade.getInstance().sendNotification(t.GameCmd.REPLAYER_ACTION_FINISH),i||t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_DISCARD,{tileId:o}),e==GameConst.ME_DIR&&Utils.sendGameEvent(t.GameCmd.DIR_ARROW_CHANGE,{clientId:GlobalData.gameData.changeIndexToClientId(GameConst.ME_DIR%GameConst.maxPlayerNum)})},e.prototype.otherDiscard=function(t,e){SoundUtils.playEffectSoundNameBindPlayer(t,e);var a=GameConst.perPlayerTotalCardNum-this.getPongKongTotalCardNum(t)-1,i=this.getHandCardByIdx(t,a);if(null!=i){this.HandCardGroupSet[t].removeChild(i);var n=this.handCardNode[t];n.splice(a,1)}this.addOutCard(t,e)},e.prototype.drawBackCard=function(e,a){var i=a.length;if(i>1){for(var n=this.huaCardNode[e],o=0;i-1>o;o++){var s=n.length-1,r=n[s];n.splice(s,1),this.HuaCardGroupSet[e].removeChild(r)}var l=n.length;Utils.sendGameEvent(t.GameCmd.PLAYER_HUA_NUM_CHANGED,{clientId:e,huaNum:l})}var c=a[i-1],h=this.getDrawCardIndex(e),u=this.getHandCardByIdx(e,h),d=this.handCardNode[e];if(u.getCardValue()==c)return d.splice(h,1),void this.HandCardGroupSet[e].removeChild(u);d.splice(h,1);var m=this.getHandCardIdxByValue(e,c),p=d[m];d.splice(m,1),this.HandCardGroupSet[e].removeChild(p);var g=this.calcCardInsertIndex(e,u.getCardValue());d.splice(g,0,u);for(var o=(d.length,0);o<d.length;o++){var C=d[o];e==GameConst.PLAY_DIR.right?this.HandCardGroupSet[e].addChildAt(C,0):e==GameConst.PLAY_DIR.left&&this.HandCardGroupSet[e].addChild(C),C.resetPosition(o,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL)}},e.prototype.drawCard=function(e,a){var i=this,n=a.length,o=0;if(n>1){for(var s=[],r=0;n-1>r;r++)s.push(a[r]);var l=this.drawManyHuaCard(e,s);o+=l}var c=this.getDrawCardIndex(e),h=GameConst.HAND_CARD_ACTION_TYPE.DRAW_CARD_ME;e!=GameConst.ME_DIR&&(h=GameConst.HAND_CARD_ACTION_TYPE.DRAW_CARD_OTHER),this.addSchedulerFunc(function(){i.checkHuaNum(e),i.createHandCard(e,a[n-1],c,h),i._isBuHuaing=!1,i.gs.getGameUILayer().operateCome(),t.EAppFacade.getInstance().sendNotification(t.GameCmd.REPLAYER_ACTION_FINISH),e==GameConst.ME_DIR&&i.checkShowTingInfo()},o)},e.prototype.checkHuaNum=function(e){if(!GlobalData.gameData.isPlayBack()&&e==GameConst.ME_DIR){var a=this.getHuaNum(e),i=GlobalData.gameData.getCardData(e).getHuaNum();if(i&&i!=a){GlobalData.gameData.changeClientIdToChairId(e);t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_getFlowerIds)}}},e.prototype.drawManyHuaCard=function(t,e){var a=this,i=0,n=e.length,o=GlobalData.gameData.isAutoDelay(GameConst.ME_DIR);if(n>=1){this._isBuHuaing=!0;for(var s=1==n,r=0;n>r;r++){o||(i+=600);var l=e[r];this.addSchedulerFunc(function(e){s?a.drawHuaCard(t,e):a.drawHuaCard(t,e,1)},i,[l])}}return i},e.prototype.drawHuaCard=function(t,e,a){void 0===a&&(a=-1),-1==a?this.gs.getEffectLayer().playBuHua(t):this.gs.getEffectLayer().playBuHua(t,a);var i=this.getHuaNum(t);this.createHuaCard(t,e,i)},e.prototype.addOutCard=function(e,a){var i=this.getDiscardNum(e);t.SoundService.getInstance().playAudio("cardTodesk_mp3"),this.createOutCard(e,a,i),this.playDiscardArrow(e)},e.prototype.flagSameValueCardForSelectedCard=function(t){this.flagValue=t;for(var e=0;e<GameConst.maxPlayerNum;e++){var a=GlobalData.gameData.changeIndexToClientId(e);if(-1!=a){for(var i=this.outCardNode[a],n=0;n<i.length;n++)i[n].getCardValue()==t&&i[n].flagSameValueCard();for(var o=this.pongKongNode[a],n=0;n<o.length;n++)if(o[n].getCardValue()==t){o[n].flagSameValueCard()}}}},e.prototype.clearSameValueCardFlag=function(){for(var t=0;t<GameConst.maxPlayerNum;t++){var e=GlobalData.gameData.changeIndexToClientId(t);if(-1!=e){for(var a=this.outCardNode[e],i=0;i<a.length;i++)a[i].clearFlagSameValueCard();for(var n=this.pongKongNode[e],i=0;i<n.length;i++)n[i].clearFlagSameValueCard()}}},e.prototype.clearTingFlag=function(){for(var t=this.handCardNode[GameConst.ME_DIR],e=0;e<t.length;e++)null!=t[e]&&t[e].setTingFlagVisible(!1)},e.prototype.clearSelectCard=function(){if(-1!=this.selectIndex){var t=this.getHandCardByIdx(GameConst.ME_DIR,this.selectIndex);null!=t&&t.setSelect(!1)}this.selectIndex=-1,this.clearSameValueCardFlag(),null!=this.tingTint&&(this.tingTint.visible=!1)},e.prototype.checkCanDiscardCard=function(t,e){var a=!0;if(GlobalData.gameData.isPlayBack())a=!0;else if(GameConfig.gameID==Constants.GAME_ID_SET.nanjing&&t==GameConst.ME_DIR){var i=GlobalData.gameData.getPlayerByClientId(GameConst.ME_DIR).getCardData().isTing();i&&e!=this.getDrawCardIndex(GameConst.ME_DIR)&&(a=!1)}return a},e.prototype.isGestureDiscardEnable=function(){return this.status!=GameConst.GAME_STATUS_TYPE.playing||GlobalData.gameData.isPlayBack()?!1:!0},e.prototype.isMeGestureDiscard=function(){var t=GlobalData.gameData.isMyOutCardTurn(),e=GlobalData.gameData.needOperate(),a=!1;return t&&!e&&(a=this.cardNumberIsMax(GameConst.ME_DIR)),t&&!e&&a},e.prototype.cardNumberIsMax=function(t){var e=!1,a=this.getHandCardsNum(t),i=this.getDrawCardIndex(t)+1;return i==a&&(e=!0),e},e.prototype.resetAllHandCardPosition=function(t){for(var e=this.handCardNode[t].length,a=0;e>a;a++)this.handCardNode[t][a].resetPosition(a,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL)
},e.prototype.removePongKongProvideCard=function(t,e){if(t!=e){var a=this.getDiscardNum(e),i=a-1,n=this.outCardNode[e][i];null!=n&&this.flagValue==n.getCardValue()&&(this.clearSameValueCardFlag(),this.flagSameValueCardForSelectedCard(this.flagValue)),null!=n&&this.OutCardGroupSet[e].removeChild(n),this.outCardNode[e].splice(i,1)}},e.prototype.getPongKongNum=function(t){return this.pongKongNode[t].length},e.prototype.getPongCardIndex=function(t,e){if(t!=GameConst.ME_DIR&&!GlobalData.gameData.isPlayBack())return 0;for(var a,i=this.getHandCardsNum(t),n=0;i>n;n++)if(this.handCardNode[t][n].getCardValue()==e){a=n;break}return a},e.prototype.getHandCardByIdx=function(t,e){var a=this.handCardNode[t],i=a.length;return 0>e||e>i?void 0:a[e]},e.prototype.getHandCardIdxByValue=function(t,e){for(var a=0,i=0;i<this.handCardNode[t].length;i++){var n=this.handCardNode[t][i].getCardValue();if(n==e){a=i;break}}return a},e.prototype.getLastOutCard=function(t){var e=this.getDiscardNum(t);return e>0?this.outCardNode[t][e-1]:null},e.prototype.getHandCardsNum=function(t){return this.handCardNode[t].length},e.prototype.getDiscardNum=function(t){return this.outCardNode[t].length},e.prototype.getDrawCardIndex=function(t){return GameConst.perPlayerTotalCardNum-this.getPongKongTotalCardNum(t)-1},e.prototype.getPongKongTotalCardNum=function(t){return 3*this.pongKongNode[t].length},e.prototype.clearPongKongCard=function(t){this.PongKongCardGroupSet[t].removeChildren(),this.pongKongNode[t]=[]},e.prototype.getHuaNum=function(t){return this.huaCardNode[t].length},e.prototype.clearAllCard=function(){this.clearSameValueCardFlag(),this.clearAllHandCard(),this.clearAllPongKongCard(),this.clearAllHuaCard(),this.clearAllOutCard()},e.prototype.clearAllHandCard=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.clearHandCard(t)},e.prototype.clearAllHuaCard=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.clearHuaCard(t)},e.prototype.clearAllPongKongCard=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.clearPongKongCard(t)},e.prototype.clearAllOutCard=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.clearOutCard(t)},e.prototype.clearHuaCard=function(t){this.HuaCardGroupSet[t].removeChildren(),this.huaCardNode[t]=[]},e.prototype.clearHandCard=function(t){this.HandCardGroupSet[t].removeChildren(),this.handCardNode[t]=[]},e.prototype.clearOutCard=function(t){this.OutCardGroupSet[t].removeChildren(),this.outCardNode[t]=[]},e.prototype.addSchedulerFunc=function(t,e,a){var i=this;void 0===a&&(a=null);var n=egret.Tween.get(this.cardGroup);n.wait(e),n.call(function(){i.allScheduler.splice(i.allScheduler.indexOf(t),1),t.call(i,a)}),this.allScheduler.push(t)},e.prototype.clearAllScheduler=function(){for(egret.Tween.removeTweens(this.cardGroup);this.allScheduler.length>0;){var t=this.allScheduler.pop();t.call(this)}this.allScheduler=[]},e.prototype.kongBack=function(t,e){var a=e.getValue(),i=e.getType(),n=e.getProvideClientId(),o=this.findPongKongIndex(t,a),s=this.pongKongNode[t][o],r=this.handCardNode[t];if(i==GameConst.GAIN_TYPE.ConcealedKong){this.pongKongNode[t].splice(o,1),this.PongKongCardGroupSet[t].removeChild(s);for(var l=0;4>l;l++){var c=this.calcCardInsertIndex(t,a);this.createHandCard(t,a,c)}}else if(i==GameConst.GAIN_TYPE.PongKong){var e=s.getData();e.setType(GameConst.GAIN_TYPE.PONG),s.setData(e);var c=this.calcCardInsertIndex(t,a);this.createHandCard(t,a,c)}else if(i==GameConst.GAIN_TYPE.Exposed){this.pongKongNode[t].splice(o,1),this.PongKongCardGroupSet[t].removeChild(s);for(var l=0;3>l;l++){var c=this.calcCardInsertIndex(t,a);this.createHandCard(t,a,c)}var h=this.getDiscardNum(n)+1;this.createOutCard(n,a,h)}for(var u=this.getHandCardsNum(t),l=0;u>l;l++){var d=r[l];t==GameConst.PLAY_DIR.right?this.HandCardGroupSet[t].addChildAt(d,0):t==GameConst.PLAY_DIR.left&&this.HandCardGroupSet[t].addChild(d),d.resetPosition(l,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL)}},e.prototype.findPongKongIndex=function(t,e){for(var a=0,i=0;i<this.pongKongNode[t].length;i++){var n=this.pongKongNode[t][i];if(n.getCardValue()==e){a=i;break}}return a},e.prototype.kong=function(e,a){for(var i,n,o=this,s=e==GameConst.ME_DIR||GlobalData.gameData.isPlayBack(),r=a.getValue(),l=a.getProvideClientId(),c=a.getType(),h=!1,u=this.pongKongNode[e],d=this.getPongKongNum(e),m=0;d>m;m++){var p=u[m].getData().getValue(),c=u[m].getData().getType();if(c==GameConst.GAIN_TYPE.PONG&&p==r){h=!0,i=m,n=u[m].getData().getProvideClientId();break}}var g=GameConst.perPlayerTotalCardNum-this.getPongKongTotalCardNum(e),C=s;g!=this.getHandCardsNum(e)&&(C=!1);for(var _=this.getKongCardIndex(e,r,l,h),m=0;m<_.length;m++)if(m==g){C=!1;break}for(var f=_.length,D=this.handCardNode[e],I=0,m=0;f>m;m++){var b=_[m]-I,y=D[b];if(s){var E=this.getUpOffData(e),v=E.moveOffX,T=E.moveOffY,S=egret.Tween.get(y);S.to({x:y.x+v,y:y.y+T},200),S.wait(200),S.call(function(){this.parent.removeChild(this)})}else this.HandCardGroupSet[e].removeChild(y);D.splice(b,1),I+=1}var A=-1;if(C){var M=D.length-1,R=D[M];A=this.calcCardInsertIndex(e,R.getCardValue()),D.splice(M,1),D.splice(A,0,R);for(var G=D.length,m=0;G>m;m++)e==GameConst.PLAY_DIR.right?this.HandCardGroupSet[e].setChildIndex(D[m],0):e==GameConst.PLAY_DIR.left&&this.HandCardGroupSet[e].setChildIndex(D[m],m)}var N=400;if(e!=GameConst.ME_DIR&&(N=200),h?this.addSchedulerFunc(function(){a.setProvideClientId(n),o.pongKongNode[e][i].setData(a),t.EAppFacade.getInstance().sendNotification(t.GameCmd.REPLAYER_ACTION_FINISH)},N):this.createPongKongNode(e,a,this.getPongKongNum(e),N),c==GameConst.GAIN_TYPE.Exposed){var l=a.getProvideClientId();this.removePongKongProvideCard(e,l)}a.getStutre()?this.addTwoOrThreeCardFlag(e):this.clearTwoOrThreeCardFlag(e),this.addSchedulerFunc(function(){for(var t=D.length,e=0;t>e;e++)null!=D[e]&&(e!=A?D[e].resetPosition(e,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL):D[e].resetPosition(e,GameConst.HAND_CARD_ACTION_TYPE.INSERT_DRAW_CARD))},200)},e.prototype.getKongCardIndex=function(t,e,a,i){var n=[];if(t==GameConst.ME_DIR||GlobalData.gameData.isPlayBack())for(var o=this.getHandCardsNum(t),s=0;o>s&&!(this.handCardNode[t][s].getCardValue()==e&&(n.push(s),n.length>=4));s++);else{var r=this.getPongKongTotalCardNum(t),o=GameConst.perPlayerTotalCardNum-r;i||(o-=3);for(var l=this.getHandCardsNum(t),c=l-o,s=0;c>s;s++)n.push(s)}return n},e.prototype.isBuhuaing=function(){return this._isBuHuaing},e.prototype.release=function(){this.clearAllCard(),this.clearAllScheduler(),this.allScheduler=null,this.tingTint=null},e}();t.GameCardLayer=e,__reflect(e.prototype,"game.GameCardLayer")}(game||(game={}));var GameCenter3dNode=function(t){function e(){return t.call(this,"resource/skins/game/gameCenterNode3dSkin.exml")||this}return __extends(e,t),e.prototype.initCenterNode=function(){t.prototype.initCenterNode.call(this)},e.prototype.updateCenterNode=function(){t.prototype.updateCenterNode.call(this)},e.prototype.updateDirArrow=function(e){t.prototype.updateDirArrow.call(this,e)},e.prototype.playEffect=function(t){this.gs.getEffectLayer().play3dDirArrow(t,this.center_dir_effect)},e.prototype.updateDir=function(){t.prototype.updateDir.call(this);for(var e=GlobalData.gameData.getEastChairId(),a=GlobalData.gameData.changeChairIdToClientId(e),i=0;i<GameConst.maxPlayerNum;i++){var n=(i-a+GameConst.maxPlayerNum)%GameConst.maxPlayerNum+1,o="3d_feng"+n+"_png",s="3d_nowFeng"+n+"_png";this.fengNode[i].source=s,this.darkFengNode[i].source=o,this.darkFengNode[i].visible=!0}},e}(GameCenterBaseNode);__reflect(GameCenter3dNode.prototype,"GameCenter3dNode"),window.GameCenter3dNode=GameCenter3dNode;var EScroller=function(t){function e(){var e=t.call(this)||this;return e.elementSize=10,e.disOfElement=0,e.scrollerHeight=0,e.hasSetData=!1,e.bInited=!1,e.firstViewIndex=0,e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.release,e),e}return __extends(e,t),e.prototype.setScrollerHeight=function(t){this.scrollerHeight=t},e.prototype.setElementViewInfo=function(t,e){this.elementSize=t,this.disOfElement=e},e.prototype.init=function(){this.viewElementSize=this.elementSize+this.disOfElement;var t=this.getViewSize();this.maxShowCount=Math.round(t/this.viewElementSize)+1,this.bInited=!0,this.viewElementList=[],this.viewport=this.viewContentGroup,this.firstViewIndex=0,this.setViewPortHeight(),this.viewContentGroup.addChild(this.sizeRect),this.needOptimize()&&this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},e.prototype.setViewPortHeight=function(){this.sizeRect.height=this.getContentSize()},e.prototype.getMaxViewPortHeight=function(){return this.sizeRect.height},e.prototype.needOptimize=function(){return this.getElementCount()>=this.maxShowCount},e.prototype.getViewSize=function(){return 0==this.scrollerHeight&&(this.scrollerHeight=this.height,0==this.scrollerHeight&&(this.scrollerHeight=400)),this.scrollerHeight},e.prototype.getContentSize=function(){return this.getElementCount()*this.viewElementSize-this.disOfElement},e.prototype.getElementCount=function(){return this.dataContent?this.dataContent.length:0},e.prototype.addScrollerElement=function(t){this.bInited||this.init();var e=this.viewElementList.length;if(e<this.maxShowCount){var a=this.createElement(t),i=this.getPos(e);this.setPos(a,i),this.viewElementList.push(a),this.viewContentGroup.addChild(a)}},e.prototype.removeScrollerElement=function(){this.bInited||this.init();var t=this.viewElementList.length,e=this.dataContent.length;if(t>0)for(var a=t-1;a>=e;a--){var i=this.viewElementList[a],n=this.getPos(t);this.setPos(i,n),this.viewElementList.splice(a,1),this.viewContentGroup.removeChild(i)}},e.prototype.getPos=function(t){return this.viewElementSize*t},e.prototype.setPos=function(t,e){t.y=e},e.prototype.clearContent=function(){null!=this.viewport&&(this.viewport.scrollV=0),this.bInited=!1,this.viewContentGroup?this.viewContentGroup.removeChildren():(this.viewContentGroup=new eui.Group,this.sizeRect=new eui.Rect,this.sizeRect.visible=!1,this.viewContentGroup.addChild(this.sizeRect)),this.needOptimize()&&this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},e.prototype.release=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.release,this),this.clearContent()},e.prototype.setScrollerContent=function(t,e){if(this.dataContent=t,this.hasSetData)this.updateUI();else{this.hasSetData=!0,this.clearContent();for(var a=0;a<t.length;a++)this.addScrollerElement(t[a])}},e.prototype.setElementCreateFunction=function(t){this.elementCreate=t},e.prototype.createElement=function(t){if(this.elementCreate){var e=this.elementCreate.call(null,t);return this.needOptimize()||this.onElementShown(e),e}return null},e.prototype.setElementUpdateDataFun=function(t){this.updateElement=t},e.prototype.updateElementData=function(t,e){this.updateElement&&this.updateElement.call(null,t,e)},e.prototype.setElementUpdateUIFun=function(t){this.updateElementUIFun=t},e.prototype.updateElementUI=function(t){this.updateElementUIFun&&this.updateElementUIFun.call(null,t)},e.prototype.setElementOnShowFun=function(t){this.onShowElementFun=t},e.prototype.onElementShown=function(t){this.onShowElementFun&&this.onShowElementFun.call(null,t)},e.prototype.onEnterFrame=function(){if(this.visible&&this.bInited){var t=this.localToGlobal().y-this.viewContentGroup.localToGlobal().y,e=this.getCurrentFirstIndexView(t);if(e!=this.firstViewIndex){for(var a=Math.abs(e-this.firstViewIndex),i=0;a>i;i++){var n=0,o=null;e>=this.firstViewIndex?(n=e+this.maxShowCount-1-(a-i-1),o=this.viewElementList.shift(),this.viewElementList.push(o)):(n=e+(a-i-1),o=this.viewElementList.pop(),this.viewElementList.unshift(o));var s=this.getPos(n),r=this.dataContent[n];this.setPos(o,s),this.updateElementData(o,r)}this.firstViewIndex=e}for(var i=0;i<this.viewElementList.length;i++){var l=this.viewElementList[i],c=this.getElementTop(l)-t<this.height;l.visible=c,c&&this.onElementShown(l)}}},e.prototype.getElementTop=function(t){return t.y-t.anchorOffsetY},e.prototype.updateViewItem=function(){var t=this.localToGlobal().y-this.viewContentGroup.localToGlobal().y,e=this.getCurrentFirstIndexView(t),a=this.viewElementList.length;this.firstViewIndex=e;for(var i=0;a>i;i++){var n=this.viewElementList[i],o=this.dataContent[i+e],s=this.getPos(i+e);this.setPos(n,s),this.updateElementData(n,o)}},e.prototype.updateUI=function(){this.bInited||this.init();var t=this.dataContent.length;if(t>0)for(var e=this.viewElementList.length,a=Math.min(t,this.maxShowCount),i=e;a>i;i++){var n=this.dataContent[i];this.addScrollerElement(n)}this.removeScrollerElement(),this.setViewPortHeight();var o=this.getMaxViewPortHeight()-this.height;this.viewport.scrollV>o&&(this.viewport.scrollV=o,this.viewport.scrollV<0&&(this.viewport.scrollV=0)),this.updateViewItem()},e.prototype.getCurrentFirstIndexView=function(t){var e=Math.floor(t/this.viewElementSize);if(0>e)e=0;else{var a=this.getElementCount()-this.maxShowCount;e>a&&(e=a)}return 0>e&&(e=0),e},e}(eui.Scroller);__reflect(EScroller.prototype,"EScroller"),window.EScroller=EScroller;var GameCenterNode=function(t){function e(){return t.call(this,"resource/skins/game/gameCenterNodeSkin.exml")||this}return __extends(e,t),e.prototype.initCenterNode=function(){t.prototype.initCenterNode.call(this),this.lineNode=[this.center_line_1,this.center_line_2,this.center_line_3,this.center_line_4]},e.prototype.updateCenterNode=function(){if(t.prototype.updateCenterNode.call(this),this.status==GameConst.GAME_STATUS_TYPE.waiting)for(var e=0;e<GameConst.maxPlayerNum;e++)this.lineNode[e].visible=!0},e.prototype.updateDirArrow=function(e){t.prototype.updateDirArrow.call(this,e);for(var a=0;a<GameConst.maxPlayerNum;a++)this.lineNode[a].visible=a!=e},e.prototype.playEffect=function(t){this.gs.getEffectLayer().playDirArrow(t,this.center_dir_effect)},e.prototype.updateDir=function(){t.prototype.updateDir.call(this);for(var e=GlobalData.gameData.getEastChairId(),a=GlobalData.gameData.changeChairIdToClientId(e),i=0;i<GameConst.maxPlayerNum;i++){var n=(i-a+GameConst.maxPlayerNum)%GameConst.maxPlayerNum+1,o="feng"+n+"_png",s="nowFeng"+n+"_png";this.fengNode[i].source=s,this.darkFengNode[i].source=o,this.darkFengNode[i].visible=!0}},e}(GameCenterBaseNode);__reflect(GameCenterNode.prototype,"GameCenterNode"),window.GameCenterNode=GameCenterNode;var game;!function(t){var e=function(t){function e(e,a){var i=t.call(this)||this;return i.dir=e,i.info=a,i.skinName="resource/skins/game/gameChatTextSkin.exml",i}return __extends(e,t),e.prototype.onCreateViewComplete=function(){var e=this;t.prototype.onCreateViewComplete.call(this),this.Text_info.text=this.info;var a=this.Text_info.width;this.Image_bg.width=a;var i=GameConst.ACTION_POSITION.CHAT_MSG.TEXT[this.dir].x-this.width/2,n=GameConst.ACTION_POSITION.CHAT_MSG.TEXT[this.dir].y-this.height/2;this.x=i,this.y=n;var o=egret.Tween.get(this);o.wait(2e3),o.call(function(){e.parent.removeChild(e)})},e}(t.EComponent);t.GameChatText=e,__reflect(e.prototype,"game.GameChatText")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getCmdFromNet=function(t){return t+""},t.onResume="onResume",t.onPause="onPause",t.GAME_STATUS_CHANGED="GAME_STATUS_CHANGED",t.DIR_ARROW_CHANGE="DIR_ARROW_CHANGE",t.GOLD_NUMBER_CHANGE="GOLD_NUMBER_CHANGE",t.DIAMOND_NUMBER_CHANGE="DIAMOND_NUMBER_CHANGE",t.REPLAYER_ACTION_FINISH="REPLAYER_ACTION_FINISH",t.PLAYER_HUA_NUM_CHANGED="PLAYER_HUA_NUM_CHANGED",t.DRAW_CARD="DRAW_CARD",t.DRAW_CARD_BACK="DRAW_CARD_BACK",t.LEFT_CARD_NUM_CHANGED="LEFT_CARD_NUM_CHANGED",t.OPERATE_PONG="OPERATE_PONG",t.OPERATE_PONG_BACK="OPERATE_PONG_BACK",t.OPERATE_KONG="OPERATE_KONG",t.OPERATE_KONG_BACK="OPERATE_KONG_BACK",t.DISCARD="DISCARD",t.DISCARD_BACK="DISCARD_BACK",t.UPDATE_DISCARD_ARROW="UPDATE_DISCARD_ARROW",t.UPDATE_HUA="UPDATE_HUA",t.AUTO_DISCARD_INFO="AUTO_DISCARD_INFO",t.CHANGE_CARD_BACK="CHANGE_CARD_BACK",t.CHANGE_CARD_FACE="CHANGE_CARD_FACE",t.CHANGE_VIEW_MODE="CHANGE_VIEW_MODE",t.AUTO_DISCARD_TIME_STATUS_CHANGED="AUTO_DISCARD_TIME_STATUS_CHANGED",t.FLOWER_VISIBLE="FLOWER_VISIBLE",t.PLAYER_STATUS_CHANGED="PLAYER_STATUS_CHANGED",t.PLAYER_SCORE_FAFEN="PLAYER_SCORE_FAFEN",t.PLAYER_SCORE_FAFEN_BACK="PLAYER_SCORE_FAFEN_BACK",t.OPERATE="OPERATE",t.OPERATE_BACK="OPERATE_BACK",t.OPERATE_READY="OPERATE_READY",t.OPERATE_READY_BACK="OPERATE_READY_BACK",t.GET_MY_TING_INFO="GET_MY_TING_INFO",t.OTHER_PLAYER_IN="OTHER_PLAYER_IN",t.PLAYER_LEAVE="PLAYER_LEAVE",t.OTHER_PLAYER_LEAVE="OTHER_PLAYER_LEAVE",t.PLAYER_SCORE_NUM_CHANGED="PLAYER_SCORE_NUM_CHANGED",t.OPERATE_PASS="OPERATE_PASS",t.BATTERY_CHANGED="BATTERY_CHANGED",t.APP_NET_SINGAL_CHANGED="APP_NET_SINGAL_CHANGED",t.WIN_OVER="WIN_OVER",t.PLAYER_BEGIN_JIA_PAI="PLAYER_BEGIN_JIA_PAI",t.PLAYER_CANCEL_JIA_PAI="PLAYER_CANCEL_JIA_PAI",t.CHAT_MSG="CHAT_MSG",t.START_PLAY_VOICE="START_PLAY_VOICE",t.VOICE_OVER="VOICE_OVER",t.POINT_EMOTION="POINT_EMOTION",t.START_AUTO_OF_DEALY="START_AUTO_OF_DEALY",t.CANCEL_AUTO_OF_DEALY="CANCEL_AUTO_OF_DEALY",t.AUTO_DISCARD_TIME="AUTO_DISCARD_TIME",t.NOTICE_KICK_LEFT_TIME="NOTICE_KICK_LEFT_TIME",t.CANCEL_KICK_LEFT_TIME="CANCEL_KICK_LEFT_TIME",t.PREVENT_CHEAT_INFO="PREVENT_CHEAT_INFO",t.CLOSE_APPLY_QUIT_PANEL="CLOSE_APPLY_QUIT_PANEL",t.CLOSE_CHEAT_INFO_BOX="CLOSE_CHEAT_INFO_BOX",t.CHECK_CHEAT_STATUS="CHECK_CHEAT_STATUS",t.CLOSE_GAME_SETTLE_PANEL="CLOSE_GAME_SETTLE_PANEL",t.GameSettleInfo_1="GameSettleInfo_1",t.GameSettleInfo_over="GameSettleInfo_over",t.APPLY_QUIT_INFO="APPLY_QUIT_INFO",t.APPLY_QUIT_REJECT="APPLY_QUIT_REJECT",t.DISSOLVE_ROOM="DISSOLVE_ROOM",t.CLOSE_CHEAT_STATUS_BOX="CLOSE_CHEAT_STATUS_BOX",t.PLAY_SINGLE_MESSAGE="PLAY_SINGLE_MESSAGE",t.PLAY_TOTAL_MESSAGE="PLAY_TOTAL_MESSAGE",t.CHANGE_PLAYER_NUM_REJECT="CHANGE_PLAYER_NUM_REJECT",t.CHANGE_PLAYER_NUM_INFO="CHANGE_PLAYER_NUM_INFO",t.CHANGE_PLAYER_NUM_CANCEL="CHANGE_PLAYER_NUM_CANCEL",t.CLOSE_CHANGE_PLAYERNUM_PANEL="CLOSE_CHANGE_PLAYERNUM_PANEL",t.UPDATE_GAEMSCORE_BOARD="UPDATE_GAEMSCORE_BOARD",t.CHANGE_GAME_BG="CHANGE_GAME_BG",t.CHANGE_GAME_BG_FRAME="CHANGE_GAME_BG_FRAME",t.CLOSE_CHAT_BOX_PANEL="CLOSE_CHAT_BOX_PANEL",t.UPDATE_PLAYER_POSITION="UPDATE_PLAYER_POSITION",t.SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE="SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE",t.UPDATE_AUTODISCARD_Text_Visible="UPDATE_AUTODISCARD_Text_Visible",t.REPLAY_OPERATE_CLICK="REPLAY_OPERATE_CLICK",t.REPLAY_OPERATE_CLICK_BACK="REPLAY_OPERATE_CLICK_BACK",t.USER_BINDPHONENUMBER="USER_BINDPHONENUMBER",t.USER_GETBINDSMSCODE="USER_GETBINDSMSCODE",t.USER_BIND_ID="USER_BIND_ID",t.CLICK_CLUB_ITEM="clickClubItem",t.CLICK_CLUB_Rooms="clickClubRooms",t.CLICK_CLUB_Members="clickClubMembers",t.CLICK_CLUB_ApplyJoins="clickApplyJoins",t.CLICK_CLUB_Bless="clickClubBless",t.CLICK_CLUB_UpdateRedTip="club_UpdateRedTip",t.CLICK_CLUB_MODIFY_BLESS_RECORDS_ITEM="CLICK_CLUB_MODIFY_BLESS_RECORDS_ITEM",t.CLICK_CLUB_DIVIDE_TAB_ITEM="CLICK_CLUB_DIVIDE_TAB_ITEM",t.CLUB_UPDATE_BLESS_VALUE="CLUB_UPDATE_BLESS_VALUE",t.CLUB_REFRESH_BLESS_LIST="CLUB_REFRESH_BLESS_LIST",t.CLUB_REFRESH_BLESS_INFO_LIST="CLUB_REFRESH_BLESS_INFO_LIST",t.CLUB_REMOVE_DIVIDE_MEMBER="CLUB_REMOVE_DIVIDE_MEMBER",t.CLUB_ADD_DIVIDE_GROUP="CLUB_ADD_DIVIDE_GROUP",t.CLUB_MODIFY_DIVIDE_GROUP_NAME="CLUB_MODIFY_DIVIDE_GROUP_NAME",t.ZHANJI_HAS="ZHANJI_HAS",t.MODIFY_HAS_VIEW_STATUS="MODIFY_HAS_VIEW_STATUS",t.CLICK_activity_ITEM="clickActivityItem",t.CLICK_MAIL_ITEM="CLICK_MAIL_ITEM",t.UPDATE_MAIL_TIP="UPDATE_MAIL_TIP",t.UPDATE_TASK_TIP="UPDATE_TASK_TIP",t.SOCKET_STATUS_CHANGE="socketStatusChange",t.USER_LOGIN_SUCCESS="user_login_success",t}();t.GameCmd=e,__reflect(e.prototype,"game.GameCmd")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.isGameOverTimeOut=!1}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.gameReconect=function(e){e.code==t.MsgResultStatus.SUCCESS&&(GlobalData.gameData.parse(e.data),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED))},e.prototype.startGame=function(e){e.code==t.MsgResultStatus.SUCCESS&&this.realParseStartGame(e.data)},e.prototype.realParseStartGame=function(e){GlobalData.gameData.setNeedPlayStartStatus(!0),GlobalData.gameData.parse(e),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED)},e.prototype.drawCard=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.chairId;t.LogUtils.info("parseDrawCard chairId "+i),GlobalData.gameData.changeDirArrow(i),GlobalData.gameData.setDiscardChairId(i);var n=a.flowerNum;t.LogUtils.info("HuaNum "+n);var o=GlobalData.gameData.changeChairIdToClientId(i),s=GlobalData.gameData.getCardData(o);null!=n&&null!=s&&s.setHuaNum(n);var r={chairId:i,cardValues:a.tileIds};GlobalData.gameData.isFirstDrawCard()&&GlobalData.gameData.setFirstDrawCardData(r),Utils.sendGameEvent(t.GameCmd.DRAW_CARD,r);var l=a.stackTileNum;GlobalData.gameData.setLeftCardNum(l);var c=a.stackFlowerNum;GlobalData.gameData.setLeftFlowerNum(c),Utils.sendGameEvent(t.GameCmd.LEFT_CARD_NUM_CHANGED,{leftCardNum:l,leftFlowerNum:c});var h=a.tingInfos;GlobalData.gameData.setTingPaiInfo(h)}},e.prototype.otherDiscard=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i={cardValue:a.tileId,chairId:a.chairId};Utils.sendGameEvent(t.GameCmd.DISCARD,i)}},e.prototype.playerStatusChanged=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.userId,n=a.chairId,o=a.userStatus,s=a.readyStatus,r=GlobalData.gameData.changeChairIdToClientId(n),l=GlobalData.gameData.getPlayer(n);if(null==l)return void t.LogUtils.error("玩家状态改变出错，玩家信息为空");l.getUserId()!=i&&t.LogUtils.error("移除玩家头像出错，头像id："+l.getUserId()+"和用户id: "+i+" 不匹配"),l.setStatus(o),l.setReadyStatus(s);var c={clientId:r,status:o};Utils.sendGameEvent(t.GameCmd.PLAYER_STATUS_CHANGED,c)}},e.prototype.faFenOperation=function(e){if(e.code==t.MsgResultStatus.SUCCESS){for(var a=e.data,i=a.faFenUserInfos,n=0;n<i.length;n++){var o=i[n],s=o.chairId,r=o.score;GlobalData.gameData.getPlayer(s).setScore(r)}Utils.sendGameEvent(t.GameCmd.PLAYER_SCORE_FAFEN,a)}},e.prototype.operationCome=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;null!=a.operateDatas?GlobalData.gameData.setOperateData(a.operateDatas):GlobalData.gameData.setOperateTypes(a.operateTypes),Utils.sendGameEvent(t.GameCmd.OPERATE)}},e.prototype.pong=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.operationChairId,n=a.gainTileInfo,o=n.discardChairId,s=GlobalData.gameData.changeChairIdToClientId(o),r={type:n.gainType,provideClientId:s,value:n.tileIds[1]},l=new t.PongKongData(r),c=GlobalData.gameData.changeChairIdToClientId(i);GlobalData.gameData.changeDirArrow(i),GlobalData.gameData.setDiscardChairId(i);var h=a.tingInfos;GlobalData.gameData.setTingPaiInfo(h);var u={clientId:c,pongData:l};Utils.sendGameEvent(t.GameCmd.OPERATE_PONG,u)}},e.prototype.kong=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.operationChairId,n=a.gainTileInfo,o=n.discardChairId,s=GlobalData.gameData.changeChairIdToClientId(o),r={type:n.gainType,provideClientId:s,value:n.tileIds[1]},l=new t.PongKongData(r),c=GlobalData.gameData.changeChairIdToClientId(i),h={clientId:c,kongData:l};Utils.sendGameEvent(t.GameCmd.OPERATE_KONG,h)}},e.prototype.ready=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.chairId;GlobalData.gameData.getPlayer(i).getCardData().setTing(!0);var n={chairId:i};Utils.sendGameEvent(t.GameCmd.OPERATE_READY,n)}},e.prototype.discard=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.tingInfos;null!=i&&i.length>0?(GlobalData.gameData.setMyTingInfo(i),Utils.sendGameEvent(t.GameCmd.GET_MY_TING_INFO,{tingValue:!0})):Utils.sendGameEvent(t.GameCmd.GET_MY_TING_INFO,{tingValue:!1})}},e.prototype.pass=function(e){e.code==t.MsgResultStatus.SUCCESS&&Utils.sendGameEvent(t.GameCmd.OPERATE_PASS,{clientId:GameConst.ME_DIR})},e.prototype.autoPass=function(e){e.code==t.MsgResultStatus.SUCCESS&&Utils.sendGameEvent(t.GameCmd.OPERATE_PASS,{clientId:GameConst.ME_DIR})},e.prototype.xjsData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;this.realParseXjsData(a)}},e.prototype.realParseXjsData=function(e){this.isGameOverTimeOut=!1,GlobalData.gameData.setAllOverData(null),GlobalData.gameData.setOverData(e);var a=e.roomStatus;GlobalData.gameData.setGameStatus(a),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED),Utils.sendGameEvent(t.GameCmd.GameSettleInfo_1)},e.prototype.djsData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setAllOverData(a),this.isGameOverTimeOut&&Utils.sendGameEvent(t.GameCmd.GameSettleInfo_over)}},e.prototype.dissolveRoom=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setApplyQuitInfo(a),Utils.sendGameEvent(t.GameCmd.APPLY_QUIT_INFO)}},e.prototype.cancelRoom=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.diamond,n=a.cancelType;GlobalData.userData.setDiamondNum(i),Utils.sendGameEvent(t.GameCmd.DISSOLVE_ROOM,{dissolveType:n})}},e.prototype.playerLeaveRoom=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.diamond;GlobalData.userData.setDiamondNum(i),Utils.sendGameEvent(t.GameCmd.PLAYER_LEAVE)}},e.prototype.otherPlayerLeaveRoom=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.userId,n=a.chairId,o=GlobalData.gameData.changeChairIdToClientId(n),s=GlobalData.gameData.getPlayer(n);null==s?t.LogUtils.error("移除玩家头像出错，玩家信息为空"):s.getUserId()!=i&&t.LogUtils.error("移除玩家头像出错，头像id："+s.getUserId()+" 和用户id: "+i+" 不匹配"),GlobalData.gameData.removePlayer(n);var r={clientId:o};Utils.sendGameEvent(t.GameCmd.OTHER_PLAYER_LEAVE,r)}},e.prototype.otherPlayerJoinRoom=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=new t.PlayerInfo;i.parse(a);var n=i.getChairId();GlobalData.gameData.addPlayer(n,i),Utils.sendGameEvent(t.GameCmd.OTHER_PLAYER_IN,i)}},e.prototype.preventCheatInfo=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setNeedCheckCheat(!0),GlobalData.gameData.setPreventCheatInfo(a),Utils.sendGameEvent(t.GameCmd.PREVENT_CHEAT_INFO)}},e.prototype.autoDiscard=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setAutoDiscardInfo(a),Utils.sendGameEvent(t.GameCmd.AUTO_DISCARD_INFO,a)}},e.prototype.startAutoOfDelay=function(e){e.code==t.MsgResultStatus.SUCCESS&&(this.parseStartAutoOfDelay(e.data),Utils.sendGameEvent(t.GameCmd.START_AUTO_OF_DEALY))},e.prototype.parseStartAutoOfDelay=function(t){var e=t.chairId,a=GlobalData.gameData.changeChairIdToClientId(e),i=GlobalData.gameData.getPlayer(e);null!=i&&i.setAutoDiscardOfDelay(!0);var n={clientId:a};return n},e.prototype.cancelAutoOfDelay=function(e){e.code==t.MsgResultStatus.SUCCESS&&(this.parseCancelAutoOfDelay(e.data),Utils.sendGameEvent(t.GameCmd.CANCEL_AUTO_OF_DEALY))},e.prototype.parseCancelAutoOfDelay=function(t){var e=t.chairId,a=GlobalData.gameData.changeChairIdToClientId(e),i=GlobalData.gameData.getPlayer(e);null!=i&&i.setAutoDiscardOfDelay(!1);var n={clientId:a};return n},e.prototype.noticeKickLeftTime=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.kickLeftTime;GlobalData.gameData.setKickOfflineTime(Math.floor(i/1e3)),Utils.sendGameEvent(t.GameCmd.NOTICE_KICK_LEFT_TIME)}},e.prototype.cancelKickLeftTime=function(e){if(e.code==t.MsgResultStatus.SUCCESS){e.data;GlobalData.gameData.setKickOfflineTime(0),Utils.sendGameEvent(t.GameCmd.CANCEL_KICK_LEFT_TIME)}},e.prototype.startAutoDiscardTimer=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setAutoDelayTimeNum(Math.floor(a.leftTime/1e3)),Utils.sendGameEvent(t.GameCmd.AUTO_DISCARD_TIME,a)}},e.prototype.parseCanAutoHost=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setCanAutoHost(a.canAutoHost),Utils.sendGameEvent(t.GameCmd.AUTO_DISCARD_TIME_STATUS_CHANGED)}},e.prototype.myAgainstData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setAutoDelayTimeNum(Math.floor(a.leftTime/1e3)),Utils.sendPanelEvent(t.GameCmd.PLAY_SINGLE_MESSAGE,a)}},e.prototype.totalAgainstData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;Utils.sendPanelEvent(t.GameCmd.PLAY_TOTAL_MESSAGE,a)}},e.prototype.rejectChangePlayerNum=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;Utils.sendGameEvent(t.GameCmd.CHANGE_PLAYER_NUM_REJECT,a)}},e.prototype.agreeChangePlayerNum=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setChangePlayerNumInfo(a),Utils.sendGameEvent(t.GameCmd.CHANGE_PLAYER_NUM_INFO)}},e.prototype.cancelChangePlayerNum=function(e){if(e.code==t.MsgResultStatus.SUCCESS){e.data;Utils.sendGameEvent(t.GameCmd.CHANGE_PLAYER_NUM_CANCEL)}},e.prototype.parseScoreBoardData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;Utils.sendPanelEvent(t.GameCmd.UPDATE_GAEMSCORE_BOARD,a)}},e.prototype.parseChatData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;a.type==GameConst.CHAT_MSG_TYPE.VOICE||Utils.sendGameEvent(t.GameCmd.CHAT_MSG,a)}},e.prototype.parseReplayData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;a.playBack=!0,a.curSceneIndex=t.SceneManager.getInstance().curScene.getIndex(),t.SceneSkip.skipToGameScene(a,!0)}},e.prototype.parseDiamond=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.diamond;GlobalData.userData.setDiamondNum(i)}},e.prototype.parseGold=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,i=a.gold;GlobalData.userData.setGoldNum(i)}},e.prototype.parsePointEmotion=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;Utils.sendGameEvent(t.GameCmd.POINT_EMOTION,a)}else{var i=e.errorCode;i==t.MsgConstant.ERROR_Gold_not_enough&&t.CommonView.showToast(Strings.goldNotEnough)}},e.prototype.parseReconnect=function(e){if(e.code==t.MsgResultStatus.SUCCESS);else{var a=e.errorCode;if(a==t.MsgConstant.ERROR_room_over){var i=e.data;if(null!=i){var n=i.roomStatus,o="";o=4==n?Strings.dismissRoom_gameOver:5==n?Strings.dismissRoom_master:6==n?Strings.dismissRoom_xieshang:7==n?Strings.dismissRoom_timeOut:1==n?Strings.dismissRoom_leave:Strings.dismissRoom_other}else o=Strings.dismissRoom_other;var s=function(){t.SceneManager.getInstance().isInGame()&&(GlobalData.gameData.getRoomInfo().isClubRoom()?t.SceneSkip.skipToClubScene():t.SceneSkip.skipToHallScene())};t.DialogManager.getInstance().popUp1(o,s)}}},e.prototype.beginJiapai=function(e){if(e.code=t.MsgResultStatus.SUCCESS){var a=e.data,i=a.chairId,n=GlobalData.gameData.changeChairIdToClientId(i);Utils.sendGameEvent(t.GameCmd.PLAYER_BEGIN_JIA_PAI,{clientId:n,value:a.jiaTileId})}},e.prototype.cancelJiapai=function(e){if(e.code=t.MsgResultStatus.SUCCESS){var a=e.data,i=a.chairId,n=GlobalData.gameData.changeChairIdToClientId(i);Utils.sendGameEvent(t.GameCmd.PLAYER_CANCEL_JIA_PAI,{clientId:n})}},e.prototype.parseAddress=function(e){if(e.code=t.MsgResultStatus.SUCCESS){var a=e.data,i=a.chairId,n=a.detailAddress,o=GlobalData.gameData.getPlayer(i);null!=o&&o.setDetailAddress(n),Utils.sendPanelEvent(t.GameCmd.UPDATE_PLAYER_POSITION)}},e.prototype.forceUpdateHuaCards=function(e){if(e.code=t.MsgResultStatus.SUCCESS){var a=e.data;Utils.sendGameEvent(t.GameCmd.UPDATE_HUA,a)}},e}();t.GameDataService=e,__reflect(e.prototype,"game.GameDataService")}(game||(game={}));var game;!function(t){var e=function(){function e(t){this.effectGroup=t,this.init()}return e.prototype.init=function(){},e.prototype.playFireWorks=function(t){var e=GameConst.ACTION_DATA.FIREWORKS.index,a=GameConst.ACTION_DATA.FIREWORKS.data;this.playOperateEffect(t,e,a)},e.prototype.playWin=function(t,e){var a=this;e==GameConst.ACTION_WIN_ACTINDEX.gangkai?SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.kongWin):e==GameConst.ACTION_WIN_ACTINDEX.dihu?SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.diHu):e==GameConst.ACTION_WIN_ACTINDEX.hu?SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.win):e==GameConst.ACTION_WIN_ACTINDEX.zimo?SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.ziMo):e==GameConst.ACTION_WIN_ACTINDEX.tianhu&&SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.tianHu);var i=GameConst.ACTION_POSITION.OPERATE[t].x,n=GameConst.ACTION_POSITION.OPERATE[t].y,o=GameConst.ACTION_DATA.OPERATE.WIN.data;
this.playEffect(o,function(t){t.x=i,t.y=n,t.animation.play(e,1),a.effectGroup.addChild(t)})},e.prototype.playPong=function(e){SoundUtils.playEffectSoundNameBindPlayer(e,CardCost.other.pong),t.SoundService.getInstance().playAudio("pen_s_mp3");var a=GameConst.ACTION_DATA.OPERATE.PONG.index,i=GameConst.ACTION_DATA.OPERATE.PONG.data;this.playOperateEffect(e,a,i)},e.prototype.playHuaKong=function(t){SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.kong);var e=GameConst.ACTION_DATA.OPERATE.HUA_KONG.index,a=GameConst.ACTION_DATA.OPERATE.HUA_KONG.data;this.playOperateEffect(t,e,a)},e.prototype.playSiFeng=function(t){var e=GameConst.ACTION_DATA.OPERATE.SIFENG.index,a=GameConst.ACTION_DATA.OPERATE.SIFENG.data;this.playOperateEffect(t,e,a)},e.prototype.playBuHua=function(t,e){SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.buHua,e);var a=GameConst.ACTION_DATA.OPERATE.BUHUA.index,i=GameConst.ACTION_DATA.OPERATE.BUHUA.data;this.playOperateEffect(t,a,i)},e.prototype.playKong=function(e){SoundUtils.playEffectSoundNameBindPlayer(e,CardCost.other.kong),t.SoundService.getInstance().playAudio("gang_s_mp3");var a=GameConst.ACTION_DATA.OPERATE.KONG.index,i=GameConst.ACTION_DATA.OPERATE.KONG.data;this.playOperateEffect(e,a,i)},e.prototype.playPass=function(t){var e=GameConst.ACTION_DATA.OPERATE.PASS.index,a=GameConst.ACTION_DATA.OPERATE.PASS.data;this.playOperateEffect(t,e,a)},e.prototype.playOperateEffect=function(e,a,i,n){var o=this;void 0===n&&(n=null),this.playEffect(i,function(a){o.effectGroup.addChild(a);var i=GameConst.ACTION_POSITION.OPERATE[e].x,s=GameConst.ACTION_POSITION.OPERATE[e].y;a.visible=!0,a.x=i,a.y=s,a.addEventListener(dragonBones.EventObject.COMPLETE,function(){t.LogUtils.info("播放完成"),o.effectGroup.removeChild(a)},o),a.animation.play(n,1)})},e.prototype.playEffect=function(t,e){var a=this,i=RES.getRes(t.dragonbonesData),n=RES.getRes(t.textureData),o=RES.getRes(t.texture);if(null==i)return console.log("dbdata null"),void RES.getResAsync(t.dragonbonesData,function(i){a.playEffect(t,e)},this);if(null==n)return console.log("texturedata null"),void RES.getResAsync(t.textureData,function(i){a.playEffect(t,e)},this);if(null==o)return console.log("texture null"),void RES.getResAsync(t.texture,function(i){a.playEffect(t,e)},this);var s=dragonBones.EgretFactory.factory;null==s.getDragonBonesData(t.name)&&(s.parseDragonBonesData(i),s.parseTextureAtlasData(n,o));var r=s.buildArmatureDisplay(t.name);null!=r&&null!=e&&e(r)},e.prototype.playDiscardEffect=function(e,a){var i=new t.OutCardEffect(e,a);this.effectGroup.addChild(i)},e.prototype.playShaiZi=function(e){var a=this;t.SoundService.getInstance().playAudio("saizi_mp3");var i=RES.getRes("shezi_json"),n=RES.getRes("shezi_png");if(null==i)return void RES.getResAsync("shezi_json",function(t){a.playShaiZi(e)},this);if(null==n)return void RES.getResAsync("shezi_png",function(t){a.playShaiZi(e)},this);var o=new egret.MovieClipDataFactory(i,n),s=new egret.MovieClip(o.generateMovieClipData("shezi"));s.x=640-s.width/2,s.y=320-s.height/2,this.effectGroup.addChild(s),s.gotoAndPlay("run",1),s.addEventListener(egret.Event.COMPLETE,function(t){console.log(t.type),a.effectGroup.removeChild(s),null!=e&&e()},this)},e.prototype.showScoreEffect=function(e,a){if(null!=a&&0!=a){var i=new t.GameScoreEffect(a),n=GameConst.ACTION_POSITION.FA_FEN[e].x,o=GameConst.ACTION_POSITION.FA_FEN[e].y;i.x=n,i.y=o,this.effectGroup.addChild(i)}},e.prototype.playCurDiscardArrow=function(e){var a=this,i=function(){e.y=e.y-30;var t=a.markOutCardEffect;t.x=e.x,t.y=e.y,t.animation.play(null,0)},n=(GameConst.ACTION_DATA.ARROW.index,GameConst.ACTION_DATA.ARROW.data);return null==this.markOutCardEffect?void this.playEffect(n,function(e){null==a.markOutCardEffect&&(a.markOutCardEffect=e,t.LogUtils.info("playCurDiscardArrow addChild"),a.effectGroup.addChild(a.markOutCardEffect)),i()}):void i()},e.prototype.hideCurDiscardArrow=function(){if(null!=this.markOutCardEffect){GameConst.ACTION_DATA.ARROW.index;this.markOutCardEffect.visible=!1}},e.prototype.playChatMsg=function(e,a,i){var n,o,s=this;if(a==GameConst.CHAT_MSG_TYPE.EMOTION){n=GameConst.ACTION_POSITION.CHAT_MSG.EMOTION[e].x,o=GameConst.ACTION_POSITION.CHAT_MSG.EMOTION[e].y;var r=GameConst.CHAT_EMOTION_NAME[i],l={name:r,dragonbonesData:r+"_ske_json",textureData:r+"_tex_json",texture:r+"_tex_png"};this.playEffect(l,function(e){e.x=n,e.y=o,e.animation.play(null,1),e.addEventListener(dragonBones.EventObject.COMPLETE,function(){t.LogUtils.info("播放完成"),s.effectGroup.removeChild(e)},s),s.effectGroup.addChild(e)})}else if(a==GameConst.CHAT_MSG_TYPE.TEXT){var c=Strings.chatText;GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.standard&&(c=Strings.chatText_standard),SoundUtils.playChatMsgEffectSoundNameBindPlayer(e,i+1);var h=new t.GameChatText(e,c[i]);this.effectGroup.addChild(h)}},e.prototype.playVoiceEffect=function(t){},e.prototype.stopVoiceEffect=function(){},e.prototype.playPointEmotion=function(e,a,i){var n=this;t.SoundService.getInstance().playAudio("pesound_send_mp3");var o=GameConst.PLAYER_HEAD_POSITION[e],s=GameConst.PLAYER_HEAD_POSITION[a],r=new eui.Image("img_personal_item_"+i+"_png");r.width=80,r.height=80,r.x=o.x-r.width/2,r.y=o.y-r.height/2-20,this.effectGroup.addChild(r);var l=Math.sqrt(Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2))/2.5,c=egret.Tween.get(r);c.to({x:s.x-r.width/2,y:s.y-r.height/2},l,egret.Ease.getPowIn(3)),c.call(function(){n.effectGroup.removeChild(r);var e=GameConst.POINT_EMOTION_NAME[i-1],a={name:e,dragonbonesData:e+"_ske_json",textureData:e+"_tex_json",texture:e+"_tex_png"};n.playEffect(a,function(e){e.x=s.x,e.y=s.y,e.animation.play(null,1),e.addEventListener(dragonBones.EventObject.COMPLETE,function(){t.LogUtils.info("播放完成"),n.effectGroup.removeChild(e)},n),n.effectGroup.addChild(e),t.SoundService.getInstance().playAudio("pesound_"+i+"_mp3")})})},e.prototype.playPointEmotionGold=function(t,e){},e.prototype.playBixihuaEffect=function(){var t=this,e=new eui.Group,a=new eui.Image("bg_gameUI_bixiahu_png");a.width=460,a.height=200;var i=new eui.Image("text_gameUI_bixiahu_png");i.width=294,i.height=112,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,e.addChild(a),e.addChild(i),e.width=a.width,e.height=a.height,i.x=(e.width-i.width)/2+i.anchorOffsetX,i.y=(e.height-i.height)/2+i.anchorOffsetY;var n=(GameConfig.ScreenW-e.width)/2,o=(GameConfig.ScreenH-e.height)/2-35;e.x=n,e.y=o,this.effectGroup.addChild(e);var s=egret.Tween.get(i);i.scaleX=4,i.scaleY=4,i.alpha=0,s.to({alpha:1,scaleX:1,scaleY:1},400,egret.Ease.getPowIn(2)),s.wait(1e3),s.call(function(){t.effectGroup.removeChild(e)})},e.prototype.playChuchongEffect=function(t){var e=this,a=new eui.Group,i=new eui.Image("bg_gameUI_chuchong_png");i.width=310,i.height=170;var n=new eui.Image("text_gameUI_chuchong_png");n.width=175,n.height=100,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,a.addChild(i),a.addChild(n),a.width=i.width,a.height=i.height,n.x=(a.width-n.width)/2+n.anchorOffsetX,n.y=(a.height-n.height)/2+n.anchorOffsetY;var o=GameConst.ACTION_POSITION.OPERATE[t].x-a.width/2,s=GameConst.ACTION_POSITION.OPERATE[t].y-a.height/2;a.x=o,a.y=s,this.effectGroup.addChild(a);var r=egret.Tween.get(n);n.scaleX=3,n.scaleY=3,n.alpha=0,r.to({alpha:1,scaleX:1,scaleY:1},400,egret.Ease.getPowIn(5)),r.wait(500),r.call(function(){e.effectGroup.removeChild(a)})},e.prototype.playDirArrow=function(e,a){var i=this,n=function(){var t=GameConst.ACTION_DIR_ARROW_DATA[e].offx,a=GameConst.ACTION_DIR_ARROW_DATA[e].offy,n=i.dirArrowEffect;n.x=t,n.y=a,n.animation.play("fengxiang_"+(e+1),0)};return null==this.dirArrowEffect?(t.LogUtils.info("创建动画"),void this.playEffect(GameConst.ACTION_DATA.FENGXIANG.data,function(e){null==i.dirArrowEffect&&(t.LogUtils.info("playDirArrow addChild "),i.dirArrowEffect=e,a.addChild(i.dirArrowEffect)),n()})):void n()},e.prototype.play3dDirArrow=function(e,a){var i=this,n=function(){var t=GameConst.ACTION_DIR_ARROW_DATA_3D[e],a=t.offx,n=t.offy,o=i.dirArrow3dEffect;o.x=a,o.y=n,o.animation.play("fengxiang_"+(e+1),0)};return null==this.dirArrow3dEffect?(t.LogUtils.info("创建动画"),void this.playEffect(GameConst.ACTION_DATA.FENGXIANG_3D.data,function(e){null==i.dirArrow3dEffect&&(t.LogUtils.info("playDirArrow addChild "),i.dirArrow3dEffect=e,a.addChild(i.dirArrow3dEffect)),n()})):void n()},e}();t.GameEffect=e,__reflect(e.prototype,"game.GameEffect")}(game||(game={}));var GamePlayerHead=function(t){function e(){var e=t.call(this)||this;return e.leaveStatus=!1,e.skinName="resource/skins/game/gamePlayerHeadSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.init()},e.prototype.init=function(){this.headGroup.visible=!0,this.Text_leave.visible=!1,this.Text_autoDelay.visible=!1,this.bankImg.visible=!1,this.scoreGroup.visible=!1,this.huaGroup.visible=!1,this.readyImg.visible=!1,this.tingImg.visible=!1,this.jyzImg.visible=!1,this.jiapaiGroup.visible=!1,this.Image_mask.visible=!1,GlobalData.gameData.isPlayBack()||(this.addTapEvent(this.huaGroup,this.clickHuaEvet),this.addTapEvent(this.headGroup,this.clickHeadEvent))},e.prototype.clickHeadEvent=function(){var t=GlobalData.gameData.getRoomInfo().needHideGameUserInfo();this.playerInfo.getUserId()!=GlobalData.userData.getUserId()?t||game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.personInfoOther.index,this.playerInfo):game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.personInfo.index,GlobalData.userData)},e.prototype.clickHuaEvet=function(){var t=GlobalData.gameData.getFlowerCardVisible();GlobalData.gameData.setFlowerCardVisible(!t),Utils.sendGameEvent(game.GameCmd.FLOWER_VISIBLE)},e.prototype.setDir=function(t){this.dir=t,this.dir==GameConst.PLAY_DIR.right?(this.tingImg.x=170,this.readyImg.x=0,this.jyzImg.x=10,this.jiapaiGroup.x=16):(this.dir!=GameConst.PLAY_DIR.up?this.readyImg.x=186:this.readyImg.x=0,this.tingImg.x=62,this.jyzImg.x=170,this.jiapaiGroup.x=176)},e.prototype.resetPosition=function(t,e){this.x=t-this.width/2,this.y=e-this.height/2},e.prototype.setData=function(t){this.playerInfo=t,this.updateUI()},e.prototype.updateUI_=function(){var e=this;t.prototype.updateUI_.call(this);var a=GlobalData.gameData.getGameStatus();this.updateGameStatus(a);var i=this.playerInfo.getStatus();this.updateStatus(i),this.updateScore(this.playerInfo.getScore()),this.updateAutoStatus();var n=!1;null!=this.playerInfo.getCardData()&&(n=this.playerInfo.getCardData().isTing()),this.updateTingStatus(n);var o=this.playerInfo.isBanker();this.bankImg.visible=o;var s=this.playerInfo.getUserName();this.nameLabel.text=s;var r=this.playerInfo.getHeadIMGUrl();game.ResManager.loadWebImage(r,function(t){e.headImg.texture=t,e.headImg.addEventListener(eui.UIEvent.COMPLETE,function(){e.headImg.texture=t},e)},this)},e.prototype.updateGameStatus=function(t){t==GameConst.GAME_STATUS_TYPE.ready?(this.scoreGroup.visible=!1,this.huaGroup.visible=!1):t==GameConst.GAME_STATUS_TYPE.playing?(this.scoreGroup.visible=!0,this.huaGroup.visible=!0):t==GameConst.GAME_STATUS_TYPE.waiting&&(this.huaGroup.visible=!1)},e.prototype.updateTingStatus=function(t){this.tingImg.visible=t},e.prototype.updateAutoStatus=function(){var t=GlobalData.gameData.isAutoDelay(this.dir);this.Text_autoDelay.visible=t,this.Image_mask.visible=t||this.leaveStatus},e.prototype.updateScore=function(t){if(GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.ready&&0==t&&GlobalData.gameData.getRoomInfo().getRoomType()==Constants.ROOM_TYPE.jinYuanZi){if(!this.jyzImg.visible){this.jyzImg.visible=!0,this.jyzImg.scaleX=7,this.jyzImg.scaleY=7,this.jyzImg.alpha=0;var e=egret.Tween.get(this.jyzImg);e.to({scaleX:1,scaleY:1,alpha:1},400,egret.Ease.getPowIn(3))}}else this.jyzImg.visible=!1;this.scoreLabel.text=""+t},e.prototype.updateStatus=function(t){if(this.readyImg.visible=!1,this.Text_leave.visible=!1,this.Image_mask.visible=!1,this.leaveStatus=t==GameConst.PLAYER_STATUS.OFFLINE||t==GameConst.PLAYER_STATUS.LEAVE,Utils.removeGrayEffect(this.headImg),t==GameConst.PLAYER_STATUS.NULL?this.visible=!1:this.leaveStatus&&(Utils.addGrayEffect(this.headImg),this.Text_leave.visible=!0),this.updateAutoStatus(),null!=this.playerInfo){var e=this.playerInfo.getReadyStatus();1==e&&GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.playing&&(this.readyImg.visible=!0)}},e.prototype.updateHuaNum=function(t){var e=Utils.RGBA2Color(231,83,83,255);t>=4&&(e=Utils.RGBA2Color(72,191,11,255)),this.huaLabel.textColor=e,this.huaLabel.text="x"+t},e.prototype.setJiapaiData=function(t){this.jiaPaiValue=t,this.jiapaiGroup.visible=!0,this.changeCardFace()},e.prototype.cancelJiapaiData=function(){this.jiapaiGroup.visible=!1},e.prototype.changeCardBack=function(){this.jiaPaiBack.source=GameUtils.getCardBack("2dmj_card_top_face{0}_png")},e.prototype.changeCardFace=function(){this.jiaPaiFace.source=Utils.format("2dmj_cardnum_mahjong_{0}_png",Utils.getNumberFormatStr(this.jiaPaiValue))},e}(game.EComponent);__reflect(GamePlayerHead.prototype,"GamePlayerHead"),window.GamePlayerHead=GamePlayerHead;var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.replayData=null,i.overData=null,i.curReplayIdx=0,i.replaySchedulerId=null,i.curDuration=0,i.speedDuration=0,i.curDurationIndex=0,i.uiActionFinished=!0,i._isPause=!1,i._isOver=!1,i._speed=1,i.quitToSceneIndex=-1,i.gs=t,i.params=a,null!=a&&a.curSceneIndex?i.quitToSceneIndex=a.curSceneIndex:i.quitToSceneIndex=Constants.SCENE_INDEX.MAIN,i.skinName="resource/skins/game/gameReplayerBarSkin.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.initData(this.params)},a.prototype.init=function(){this.initUI(),this.replayData=null,this.curReplayIdx=0,this.replaySchedulerId=null,this.curDuration=0,this.speedDuration=0,this.curDurationIndex=0,this.uiActionFinished=!0,this._isPause=!1,this._isOver=!1,this.hideRoomInfo(),this.setSpeed(1)},a.prototype.startReplayer=function(){var t=this;null!=this.replayData&&(this.replaySchedulerId=setInterval(function(){t.update()},100))},a.prototype.update=function(){if(!this.isPause()&&!this._isOver&&(this.curDuration=this.curDuration+100,!(this.curDuration<this.speedDuration)&&this.uiActionFinished)){if(this.curReplayIdx>=this.replayData.length)return this._isOver=!0,t.CommonView.showToast(Strings.replayOver),t.LogUtils.info("回放结束"),this.stopScheduler(),void this.playOver();var e=this.replayData[this.curReplayIdx];this.uiActionFinished=!1,t.LogUtils.info("replayer running"),this.sendReplayUnitData(e,!1),this.curReplayIdx=this.curReplayIdx+1,this.updateNextDuration(this.curReplayIdx),this.curDuration=0}},a.prototype.initData=function(e){var a=e.startData;this.overData=e.overData,t.GameDataService.getInstance().realParseStartGame(a),this.replayData=e.processData,t.EAppFacade.getInstance().registerCommand(t.GameCmd.REPLAYER_ACTION_FINISH,this.oneStepFinishFinish,this),this.updateNextDuration(1),this.updateUI()},a.prototype.oneStepFinishFinish=function(){this.setUIActionsFinished(!0)},a.prototype.setUIActionsFinished=function(t){this.uiActionFinished=t},a.prototype.initUI=function(){this.Button_roomInfo.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.showRoomInfo,this),this.Button_roomInfo.addEventListener(egret.TouchEvent.TOUCH_END,this.hideRoomInfo,this),this.Button_roomInfo.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.hideRoomInfo,this),this.Button_roomInfo.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.hideRoomInfo,this),this.addTapEvent(this.Button_back,this.backEvent.bind(this)),this.addTapEvent(this.Button_play,this.play.bind(this)),this.addTapEvent(this.Button_pause,this.pause.bind(this)),this.addTapEvent(this.Button_speed,this.addSpeedEvent.bind(this)),this.addTapEvent(this.Button_quit,this.quitEvent.bind(this)),this.updatePlayBtn()},a.prototype.quitEvent=function(){var e=this;t.DialogManager.getInstance().popUp2(Strings.quitReplayerInfo,function(){t.SceneManager.getInstance().popScene()},function(){e.setPause(!0)})},a.prototype.addSpeedEvent=function(){var t=this._speed%4+1;this.setSpeed(t)},a.prototype.setSpeed=function(t){this._speed=t,this.updateSpeed(),this.updateCurDuration()},a.prototype.updateCurDuration=function(){this.updateNextDuration(this.curDurationIndex)},a.prototype.updateSpeed=function(){this.Text_speed.text="x"+this._speed},a.prototype.play=function(){this.setPause(!1)},a.prototype.pause=function(){this.setPause(!0)},a.prototype.updatePlayBtn=function(){this.isPause()?(this.Button_pause.visible=!1,this.Button_play.visible=!0):(this.Button_pause.visible=!0,this.Button_play.visible=!1)},a.prototype.showRoomInfo=function(){this.Group_rules.visible=!0},a.prototype.hideRoomInfo=function(){this.Group_rules.visible=!1},a.prototype.backEvent=function(){if(this._isOver&&t.CommonView.showToast(Strings.replayOver),!(this.curReplayIdx<=0)){this.uiActionFinished=!0,this.setPause(!0),this.curDuration=0,this.gs.getCardLayer().clearAllScheduler(),this.curReplayIdx=this.curReplayIdx-1;var e=this.replayData[this.curReplayIdx];this.updateNextDuration(this.curReplayIdx),this.sendReplayUnitData(e,!0)}},a.prototype.sendReplayUnitData=function(e,a){var i=e.replayType,n=e.jsonData,o=0;if(i==GameConst.REPLAY_TYPE.DISCARD){var s=n.chairId;o=s;var r=GlobalData.gameData.changeChairIdToClientId(s),l=n.tileId,c=t.GameCmd.DISCARD;a?(c=t.GameCmd.DISCARD_BACK,t.LogUtils.info("replayer 出牌回退")):t.LogUtils.info("replayer 出牌"),Utils.sendGameEvent(c,{chairId:s,cardValue:l})}else if(i==GameConst.REPLAY_TYPE.DRAW){var s=n.chairId;o=s;var h=n.tileIds;GlobalData.gameData.changeDirArrow(s);var c=t.GameCmd.DRAW_CARD;a?(t.LogUtils.info("replayer 抓牌回退"),c=t.GameCmd.DRAW_CARD_BACK):t.LogUtils.info("replayer 抓牌"),Utils.sendGameEvent(c,{chairId:s,cardValues:h});var u=n.stackTileNum;Utils.sendGameEvent(t.GameCmd.LEFT_CARD_NUM_CHANGED,{leftCardNum:u})}else if(i==GameConst.REPLAY_TYPE.PONG){var s=n.operationChairId;o=s;var d=n.gainTileInfo,m=d.discardChairId,p=GlobalData.gameData.changeChairIdToClientId(m),g={type:d.gainType,provideClientId:p,value:d.tileIds[1]},C=new t.PongKongData(g);GlobalData.gameData.changeDirArrow(s);var r=GlobalData.gameData.changeChairIdToClientId(s),c=t.GameCmd.OPERATE_PONG;a?(c=t.GameCmd.OPERATE_PONG_BACK,t.LogUtils.info("replayer 碰牌回退")):t.LogUtils.info("replayer 碰牌"),Utils.sendGameEvent(c,{clientId:r,pongData:C}),r==GameConst.ME_DIR&&Utils.sendGameEvent(t.GameCmd.OPERATE_BACK)}else if(i==GameConst.REPLAY_TYPE.KONG){var s=n.operationChairId;o=s;var d=n.gainTileInfo,m=d.discardChairId,p=GlobalData.gameData.changeChairIdToClientId(m),g={type:d.gainType,provideClientId:p,value:d.tileIds[1]},C=new t.PongKongData(g),r=GlobalData.gameData.changeChairIdToClientId(s),c=t.GameCmd.OPERATE_KONG;a?(c=t.GameCmd.OPERATE_KONG_BACK,t.LogUtils.info("replayer 杠牌回退")):t.LogUtils.info("replayer 杠牌"),Utils.sendGameEvent(c,{clientId:r,kongData:C}),r==GameConst.ME_DIR&&Utils.sendGameEvent(t.GameCmd.OPERATE_BACK)}else if(i==GameConst.REPLAY_TYPE.FAFEN){for(var _=n.faFenUserInfos,f=0;f<_.lenght;f++){var D=_[f],s=D.chairId,I=D.score;GlobalData.gameData.getPlayer(s).setScore(I)}var c=t.GameCmd.PLAYER_SCORE_FAFEN;a?(c=t.GameCmd.PLAYER_SCORE_FAFEN_BACK,t.LogUtils.info("replayer 罚分回退")):t.LogUtils.info("replayer 罚分"),Utils.sendGameEvent(c,n)}else if(i==GameConst.REPLAY_TYPE.JIAPAI){var s=n.chairId;o=s;var r=GlobalData.gameData.changeChairIdToClientId(s),c=t.GameCmd.PLAYER_BEGIN_JIA_PAI;a?(c=t.GameCmd.PLAYER_CANCEL_JIA_PAI,t.LogUtils.info("replayer 架牌回退")):t.LogUtils.info("replayer 架牌"),Utils.sendGameEvent(c,{clientId:r,value:n.jiaTileId})}else if(i==GameConst.REPLAY_TYPE.CANCELJIPAI){var s=n.chairId;o=s;var r=GlobalData.gameData.changeChairIdToClientId(s),c=t.GameCmd.PLAYER_CANCEL_JIA_PAI;a?(c=t.GameCmd.PLAYER_BEGIN_JIA_PAI,t.LogUtils.info("replayer 取消架牌回退")):t.LogUtils.info("replayer 取消架牌"),Utils.sendGameEvent(c,{clientId:r,value:n.jiaTileId})}else if(i==GameConst.REPLAY_TYPE.TING){var s=n.chairId,c=t.GameCmd.OPERATE_READY;a?(c=t.GameCmd.OPERATE_READY_BACK,t.LogUtils.info("replayer 听牌回退")):t.LogUtils.info("replayer 听牌"),Utils.sendGameEvent(c,{chairId:s})}else if(i==GameConst.REPLAY_TYPE.OPERATE){var c=t.GameCmd.OPERATE;a?(c=t.GameCmd.OPERATE_BACK,t.LogUtils.info("replayer 操作展示回退")):t.LogUtils.info("replayer 操作展示"),Utils.sendGameEvent(c,n)}else if(i==GameConst.REPLAY_TYPE.PASS){if(!a){t.LogUtils.info("replayer 过");var s=n.chairId;Utils.sendGameEvent(t.GameCmd.OPERATE_PASS,{clientId:GlobalData.gameData.changeChairIdToClientId(s)})}}else if(i==GameConst.REPLAY_TYPE.PLAY_STATUS){var s=n.chairId,r=GlobalData.gameData.changeChairIdToClientId(s),b=n.curOnline,y=GameConst.PLAYER_STATUS.LEAVE;a?b?(t.LogUtils.info("replayer 玩家离开"),y=GameConst.PLAYER_STATUS.LEAVE):(t.LogUtils.info("replayer 玩家回来"),y=GameConst.PLAYER_STATUS.PLAYING):b?(t.LogUtils.info("replayer 玩家回来"),y=GameConst.PLAYER_STATUS.PLAYING):(t.LogUtils.info("replayer 玩家离开"),y=GameConst.PLAYER_STATUS.LEAVE),Utils.sendGameEvent(t.GameCmd.PLAYER_STATUS_CHANGED,{clientId:r,status:y})}else if(i==GameConst.REPLAY_TYPE.AUTO_HOST){var E=n.hostStatus,v=null,T=null;a?1==E?(t.LogUtils.info("replayer 取消托管"),v=t.GameDataService.getInstance().parseCancelAutoOfDelay(n),T=t.GameCmd.CANCEL_AUTO_OF_DEALY):(t.LogUtils.info("replayer 开始托管"),v=t.GameDataService.getInstance().parseStartAutoOfDelay(n),T=t.GameCmd.START_AUTO_OF_DEALY):1==E?(t.LogUtils.info("replayer 开始托管"),v=t.GameDataService.getInstance().parseStartAutoOfDelay(n),T=t.GameCmd.START_AUTO_OF_DEALY):(t.LogUtils.info("replayer 取消托管"),v=t.GameDataService.getInstance().parseCancelAutoOfDelay(n),T=t.GameCmd.CANCEL_AUTO_OF_DEALY),Utils.sendGameEvent(T,v)}else if(i==GameConst.REPLAY_TYPE.OPERATE_CLICK){var T=null;a?(t.LogUtils.info("replayer 回放点击操作回退"),T=t.GameCmd.REPLAY_OPERATE_CLICK_BACK):(t.LogUtils.info("replayer 回放点击操作"),T=t.GameCmd.REPLAY_OPERATE_CLICK),Utils.sendGameEvent(T,n)}if(a){0!=o&&GlobalData.gameData.curDirArrow()!=o&&GlobalData.gameData.changeDirArrow(o);var S=this.curReplayIdx-1;if(S>0){var A=this.replayData[S],M=A.replayType,R=A.jsonData;if(M==GameConst.REPLAY_TYPE.DISCARD){var s=R.chairId,r=GlobalData.gameData.changeChairIdToClientId(s),l=R.tileId;t.LogUtils.info("刷新打牌箭头 clientId "+r),Utils.sendGameEvent(t.GameCmd.UPDATE_DISCARD_ARROW,{clientId:r,value:l})}}}},a.prototype.updateNextDuration=function(t){this.curDurationIndex=t;var e=0;if(0==t||t>=this.replayData.length)e=1.5;else{var a=this.replayData[t].replayType;a==GameConst.REPLAY_TYPE.DRAW?e=1:a==GameConst.REPLAY_TYPE.DISCARD?e=2:a==GameConst.REPLAY_TYPE.PONG?e=1:a==GameConst.REPLAY_TYPE.KONG?e=1:a==GameConst.REPLAY_TYPE.FAFEN?e=.5:a==GameConst.REPLAY_TYPE.JIAPAI?e=.5:a==GameConst.REPLAY_TYPE.CANCELJIPAI?e=.5:a==GameConst.REPLAY_TYPE.TING?e=.5:a==GameConst.REPLAY_TYPE.OPERATE?e=1:a==GameConst.REPLAY_TYPE.PASS?e=1:a==GameConst.REPLAY_TYPE.PLAY_STATUS?e=.1:a==GameConst.REPLAY_TYPE.AUTO_HOST?e=.1:a==GameConst.REPLAY_TYPE.OPERATE_CLICK&&(e=.5),this.speedDuration=1e3*e/this._speed}},a.prototype.isPause=function(){return this._isPause},a.prototype.setPause=function(t){this._isPause=t,this.updatePlayBtn()},a.prototype.stopScheduler=function(){null!=this.replaySchedulerId&&(clearInterval(this.replaySchedulerId),this.replaySchedulerId=null)},a.prototype.playOver=function(){t.GameDataService.getInstance().realParseXjsData(this.overData),Utils.sendGameEvent(t.GameCmd.OPERATE_BACK)},a.prototype.updateUI_=function(){this.Text_roomRulesDesc.text=GlobalData.gameData.getRoomInfo().getShareRoomInfo()},a.prototype.release=function(){this.stopScheduler(),t.EAppFacade.getInstance().removeCommand(t.GameCmd.REPLAYER_ACTION_FINISH,this.oneStepFinishFinish,this),this.parent.removeChild(this)},a}(t.EComponent);t.GameReplayBar=e,__reflect(e.prototype,"game.GameReplayBar")}(game||(game={}));var GameReplayOperateTint=function(t){function e(e){var a=t.call(this)||this;return a.boundW=20,a.perUnitW=40,a.perGap=40,a.params=e,a.skinName="resource/skins/game/gameReplayOperateNode.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.init()},e.prototype.init=function(){this.unitNodeSet=[],this.originalP=this.params.position,this.dir=this.params.dir,this.dir==GameConst.PLAY_DIR.down||this.dir==GameConst.PLAY_DIR.left?this.originalP.x=this.originalP.x+50:this.originalP.x=this.originalP.x-50,this.x=this.originalP.x,this.y=this.originalP.y+60},e.prototype.setData=function(t){for(var e=0;e<this.unitNodeSet.length;e++){var a=this.unitNodeSet[e];a.visible=!1}this.data=t;for(var i=0,n=t.length+1,e=0;n>e;e++){var a=this.unitNodeSet[e],o=0;if(o=e<t.length?t[e]:GameConst.OPERATE_TYPE.pass,null==a){var a=new GameReplayOperateTintNode;this.unitNodeSet[e]=a,this.addChild(a)}a.setData(o),a.visible=!0,a.x=this.boundW+i,a.y=-5,i+=this.perUnitW,n>e&&(i+=this.perGap)}i+=2*this.boundW,this.width=i,(this.dir==GameConst.PLAY_DIR.up||this.dir==GameConst.PLAY_DIR.right)&&(this.x=this.originalP.x-i)},e.prototype.runClickFunc=function(t){for(var e=-1,a=0;a<this.data.length;a++)if(this.data[a]==t){e=a;break}t==GameConst.OPERATE_TYPE.pass&&(e=this.data.length),-1!=e&&this.unitNodeSet[e].runClickAction()},e}(game.EComponent);__reflect(GameReplayOperateTint.prototype,"GameReplayOperateTint");var GameReplayOperateTintNode=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/gameReplayOperateUnit.exml",e}return __extends(e,t),e.prototype.setData=function(t){this.operateType=t,this.Image_type.source="img_replay_operate_"+this.operateType+"_png"},e.prototype.onCreateViewComplete=function(){this.Image_effect.visible=!1},e.prototype.runClickAction=function(){egret.Tween.removeTweens(this.Image_type),egret.Tween.removeTweens(this.Image_effect);var t=egret.Tween.get(this.Image_type,{loop:!1});t.to({scaleX:1.5,scaleY:1.5},200),t.to({scaleX:1,scaleY:1},200);var e=this,a=egret.Tween.get(this.Image_effect,{loop:!1});this.Image_effect.alpha=0,this.Image_effect.visible=!0,a.to({scaleX:2,scaleY:2,alpha:1},200),a.to({scaleX:1,scaleY:1,alpha:0},200),a.call(function(){game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH),e.parent.visible=!1,e.Image_effect.visible=!1})},e}(game.EComponent);__reflect(GameReplayOperateTintNode.prototype,"GameReplayOperateTintNode");var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.SCENE_INDEX.GAME)||this;return a.needReconnectBeforeGameStart=!1,a.lastForegroundTime=0,a.timeIndex=-1,a.params=t,a.initData(),a.skinName="resource/skins/game/gameSceneSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){if(GameConfig.localVersion){var e=t.Mock.getInstance();e.initMockData();var a=e.getMockGameData();GlobalData.gameData.parse(a)}this.initTouch(),this.changeCenterNode(),this.gameEffect=new t.GameEffect(this.effectLayer),this.cardLayer=new t.GameCardLayer(this,this.touchErea,this.CardGroup),this.gameUILayer.setGameScene(this),this.gameCenter.setGameScene(this),this.gameCenter3d.setGameScene(this),this.changeBg(),this.setBgFrameVisible(),GlobalData.gameData.isPlayBack()&&(this.Replayer=new t.GameReplayBar(this,this.params),this.Replayer.x=(GameConfig.ScreenW-this.Replayer.width)/2,this.Replayer.y=GameConfig.ScreenH-200-this.Replayer.height,Main.instance.toastLayer.addChild(this.Replayer)),this.test(),t.EAppFacade.getInstance().registerCommand("gameScene",this.onEventHandler,this),this.checkCheatInfo(),this.checkGameStatus(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.userloginComplete,this)},a.prototype.onSizeChanged=function(){this.gameUILayer.onSizeChanged()},a.prototype.userloginComplete=function(){if(GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.allOver&&!GlobalData.gameData.isPlayBack()){var e=!0,a=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.GameSettle_auto1.index);null!=a&&(e=!1),e&&this.cardLayer.clearAllScheduler(),t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_USER_RECONNECTION,{needStartGame:e,roomId:GlobalData.gameData.getRoomInfo().getRoomId()})}},a.prototype.initData=function(){GameConst.card_back_index=parseInt(DataStorage.readLocalData(LocalStorage.setting.Card_back_index,"0")),GameConst.card_face_index=parseInt(DataStorage.readLocalData(LocalStorage.setting.Card_face_index,"0")),GameConst.game_bg_index=parseInt(DataStorage.readLocalData(LocalStorage.setting.Game_bg_index,"0")),GameConst.sound_type=parseInt(DataStorage.readLocalData(LocalStorage.setting.Sound_type,""+GameConst.SOUND_TYPE_ENUM.nanjing)),GameConst.card_mode_index=parseInt(DataStorage.readLocalData(LocalStorage.setting.View_mode,""+GameConst.CARD_MODE.mode_2d)),GameConst.forbid_voice=1==parseInt(DataStorage.readLocalData(LocalStorage.setting.forbid_voice,"0")),GameConst.forbid_emotion=1==parseInt(DataStorage.readLocalData(LocalStorage.setting.forbid_emotion,"0"));var t=parseInt(DataStorage.readLocalData(LocalStorage.setting.GameDoubleClickType,""+GameConst.CLICK_CARD_TYPE.doubleClick));GlobalData.gameData.setClickType(t);var e=1==parseInt(DataStorage.readLocalData(LocalStorage.setting.Flower_card_Visible,"1"));if(GlobalData.gameData.setFlowerCardVisible(e),null!=this.params){var a=!1;this.params.playBack&&(a=this.params.playBack),GlobalData.gameData.setPlayBack(a)}},a.prototype.checkGameStatus=function(){t.LogUtils.info("checkGameStatus "+GlobalData.gameData.getGameStatus()),this.setStatus(GlobalData.gameData.getGameStatus()),this.showApplyQuit(),this.showChangePlayerNum()},a.prototype.showChangePlayerNum=function(){var e=GlobalData.gameData.getChangePlayerNumInfo(),a=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.changePlayerNumBox.index);return null==e?void Utils.sendPanelEvent(t.GameCmd.CLOSE_CHANGE_PLAYERNUM_PANEL):void(null==a?t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.changePlayerNumBox.index,e):a.setData(e))},a.prototype.showApplyQuit=function(){var e=GlobalData.gameData.getApplyQuitInfo(),a=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.applyQuit.index);if(null==e)return void(null!=a&&a.close());if(null==a)t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.applyQuit.index,e);else{var i=a;i.setData(e)}},a.prototype.onEventHandler=function(e){var a=e.data,i=a.cmd,n=a.data;if(i==t.GameCmd.GAME_STATUS_CHANGED)this.statusChanged();else if(i==t.GameCmd.PREVENT_CHEAT_INFO){var o=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.preventCheat.index);null!=o&&o.close(),GlobalData.gameData.setCheatStatus(!0),t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.checkCheat.index)}else if(i==t.GameCmd.CHECK_CHEAT_STATUS)this.checkCheatStatus();else if(i==t.GameCmd.GameSettleInfo_1)this.timeIndex=setTimeout(function(){var e=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.GameSettle_auto1.index);null!=e&&t.DialogManager.getInstance().close(e);var a=GlobalData.gameData.getOverData();t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.GameSettle_auto1.index,a),this.timeIndex=-1},1e3);else if(i==t.GameCmd.GameSettleInfo_over)t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.gameOverBox.index);else if(i==t.GameCmd.APPLY_QUIT_INFO)this.showApplyQuit();else if(i==t.GameCmd.APPLY_QUIT_REJECT){var s=n.rejectUserName;t.CommonView.showToast(Utils.format("玩家[{0}]不同意退出",s));var r=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.applyQuit.index);null!=r&&r.close()}else if(i==t.GameCmd.DISSOLVE_ROOM)if(null!=n){var l=n.dissolveType,c=null;l==GameConst.DissolveRoomType.TIMEOUT?c=Strings.dismissRoom_timeOut:l==GameConst.DissolveRoomType.DAIKAI?c=Strings.dismissRoom_daikai:l==GameConst.DissolveRoomType.MASTER&&(GlobalData.gameData.isMeCreator()||(c=Strings.dismissRoom_master)),null!=c?t.DialogManager.getInstance().popUp1(c,function(){GlobalData.gameData.getRoomInfo().isClubRoom()?t.SceneSkip.skipToClubScene():t.SceneSkip.skipToHallScene()}):GlobalData.gameData.getRoomInfo().isClubRoom()?t.SceneSkip.skipToClubScene():t.SceneSkip.skipToHallScene()
}else GlobalData.gameData.getRoomInfo().isClubRoom()?t.SceneSkip.skipToClubScene():t.SceneSkip.skipToHallScene();else if(i==t.GameCmd.CHANGE_PLAYER_NUM_INFO)this.showChangePlayerNum();else if(i==t.GameCmd.CHANGE_PLAYER_NUM_REJECT){var s=n.rejectUserName;t.CommonView.showToast(Utils.format("玩家[{0}]不同意",s)),Utils.sendPanelEvent(t.GameCmd.CLOSE_CHANGE_PLAYERNUM_PANEL)}else i==t.GameCmd.CHANGE_PLAYER_NUM_CANCEL?Utils.sendPanelEvent(t.GameCmd.CLOSE_CHANGE_PLAYERNUM_PANEL):i==t.GameCmd.CHANGE_GAME_BG?this.changeBg():i==t.GameCmd.CHANGE_GAME_BG_FRAME?this.setBgFrameVisible():i==t.GameCmd.CHANGE_VIEW_MODE&&this.changeViewMode();this.cardLayer.onEventHandler(e),this.gameUILayer.onEventHandler(e),this.curGameCenter.onEventHandler(e)},a.prototype.changeViewMode=function(){this.changeCenterNode(),this.gameUILayer.changeViewMode(),this.setBgFrameVisible(),this.changeBg(),t.ConnectService.getInstance().connect(!0)},a.prototype.changeCenterNode=function(){this.gameCenter3d.visible=!1,this.gameCenter.visible=!1,GameUtils.is3dMode()?this.curGameCenter=this.gameCenter3d:this.curGameCenter=this.gameCenter,this.curGameCenter.visible=!0},a.prototype.setBgFrameVisible=function(){var t=DataStorage.readLocalData(LocalStorage.setting.Game_bg_frame,"0");this.Image_frame.visible="1"==t},a.prototype.changeBg=function(){var t=GlobalData.gameData.isBiXiaHu();GameUtils.is3dMode()?GlobalData.gameData.getRoomInfo().getBxhColorSwitch()&&t&&GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.playing?this.Image_bg.source="img_GameUI_BgNEW_3d_bixiahu_png":0==GameConst.game_bg_index?this.Image_bg.source="img_GameUI_BgNEW_3d_png":this.Image_bg.source=Utils.format("img_GameUI_BgNEW_3d_{0}_png",GameConst.game_bg_index):GlobalData.gameData.getRoomInfo().getBxhColorSwitch()&&t&&GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.playing?this.Image_bg.source="img_GameUI_BgNEW_bixiahu_png":0==GameConst.game_bg_index?this.Image_bg.source="img_GameUI_BgNEW_png":this.Image_bg.source=Utils.format("img_GameUI_BgNEW_{0}_png",GameConst.game_bg_index)},a.prototype.statusChanged=function(){var e=GlobalData.gameData.getGameStatus();t.LogUtils.info("游戏状态改变 "+e),this.setStatus(e)},a.prototype.setStatus=function(t){var e=this;if(t==GameConst.GAME_STATUS_TYPE.playing&&GlobalData.gameData.isNeedPlayStartStatus()){if(GlobalData.gameData.isNeedCheckCheat())return;this.needReconnectBeforeGameStart=!0;var a=(new Date).getTime();a-this.lastForegroundTime<=500?(this.needReconnectBeforeGameStart=!1,this.lastForegroundTime=0):(t=GameConst.GAME_STATUS_TYPE.before_playing,this.getEffectLayer().playShaiZi(function(){e.gameUILayer.setStatus(GameConst.GAME_STATUS_TYPE.playing),e.cardLayer.setStatus(GameConst.GAME_STATUS_TYPE.playing,!0),e.curGameCenter.setStatus(GameConst.GAME_STATUS_TYPE.playing),GlobalData.gameData.isPlayBack()&&e.Replayer&&e.Replayer.startReplayer()}))}GlobalData.gameData.setNeedPlayStartStatus(!1),this.gameUILayer.setStatus(t),this.cardLayer.setStatus(t),this.curGameCenter.setStatus(t),(t==GameConst.GAME_STATUS_TYPE.before_playing||t==GameConst.GAME_STATUS_TYPE.playing)&&GlobalData.gameData.setCheatStatus(!1),this.checkCheatStatus()},a.prototype.checkCheatInfo=function(){GlobalData.gameData.isNeedCheckCheat()&&(GlobalData.gameData.setCheatStatus(!0),t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.checkCheat.index))},a.prototype.checkCheatStatus=function(){var e=GlobalData.gameData.isCheatStatus();if(e)null==t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.checkCheat.index)&&null==t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.preventCheat.index)&&t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.preventCheatStatusBox.index);else{var a=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.preventCheatStatusBox.index);null!=a&&a.close()}},a.prototype.test=function(){GameConfig.localVersion?this.testBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.testFunc,this):this.testBtn.visible=!1},a.prototype.testFunc=function(){t.Mock.getInstance().mockJiaPai()},a.prototype.initTouch=function(){GlobalData.gameData.isPlayBack()},a.prototype.resetClickEvent=function(){null!=this.gameUILayer&&this.gameUILayer.setMoreInfo(!1),null!=this.cardLayer&&this.cardLayer.clearSelectCard()},a.prototype.getEffectLayer=function(){return this.gameEffect},a.prototype.getCardLayer=function(){return this.cardLayer},a.prototype.getGameUILayer=function(){return this.gameUILayer},a.prototype.getGameCenter=function(){return this.curGameCenter},a.prototype.getReplayer=function(){return this.Replayer},a.prototype.onPause=function(){e.prototype.onPause.call(this),GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.allOver&&t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_APP_Background)},a.prototype.onResume=function(){e.prototype.onResume.call(this),GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.allOver&&t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_APP_Foreground)},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand("gameScene",this.onEventHandler,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.userloginComplete,this),this.gameUILayer.release(),this.cardLayer.release(),this.gameCenter.release(),this.gameCenter3d.release(),GlobalData.gameData.clearData(),GlobalData.gameData.setPlayBack(!1),null!=this.Replayer&&(this.Replayer.release(),this.Replayer=null),this.lastForegroundTime=0,this.needReconnectBeforeGameStart=!1,-1!=this.timeIndex&&clearTimeout(this.timeIndex)},a}(t.SceneBase);t.GameScene=e,__reflect(e.prototype,"game.GameScene")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.scoreNumber=e,a.skinName="resource/skins/game/gameScoreEffectSkin.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){var e=this;t.prototype.onCreateViewComplete.call(this),this.scoreNumber>0?(this.Text_score.text="+"+this.scoreNumber,this.Text_score.textColor=16757262):(this.Text_score.text=""+this.scoreNumber,this.Text_score.textColor=7968960);var a=egret.Tween.get(this);a.to({x:this.x+20,y:this.y-20},1e3),a.to({alpha:0},300),a.call(function(){e.parent.removeChild(e)})},e}(t.EComponent);t.GameScoreEffect=e,__reflect(e.prototype,"game.GameScoreEffect")}(game||(game={}));var GameUILayer=function(t){function e(){var e=t.call(this)||this;return e.needCheckPlayerNum=!1,e.systemTimeSchedulerId=null,e.otherSystemInfoSchedulerId=null,e.isMoreInfoOpen=!1,e.kickOfflineTime=0,e.schedulerKickOfflineId=0,e.tempDataType={FAFEN:1},e.skinName="resource/skins/game/gameUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.init()},e.prototype.onSizeChanged=function(){game.FixUIManager.getInstance().setBoarderNode(this.systemInfoNode),game.FixUIManager.getInstance().setBoarderNode(this.Button_quit),game.FixUIManager.getInstance().setBoarderNode(this.Button_bxh),game.FixUIManager.getInstance().setBoarderNode(this.Text_autoDiscard),game.FixUIManager.getInstance().setBoarderNode(this.Button_scoreBoard),game.FixUIManager.getInstance().setBoarderNode(this.roomNumberLabel),game.FixUIManager.getInstance().setBoarderNode(this.moreInfoNode),game.FixUIManager.getInstance().setBoarderNode(this.Button_refresh),GameUtils.is3dMode()&&(game.FixUIManager.getInstance().setBoarderNode(this.Button_chat),game.FixUIManager.getInstance().setBoarderNode(this.Button_voice),game.FixUIManager.getInstance().setBoarderNode(this.Button_tint)),this.resetPlayerHeadPosition(),this.checkPlayerNum()},e.prototype.init=function(){this.initData(),this.Text_RoomNumber.text=""+GlobalData.gameData.getRoomInfo().getRoomNum(),this.initHeadNode(),this.initOperateNode(),this.initInviteNode(),this.initTingTint(),this.initDelayAuto(),this.initMoreInfo(),this.initBackBtn(),this.initOtherUI(),this.initSystemInfo(),this.initOtherTime(),this.changeCardBack(),this.resetUIPosition(),this.onSizeChanged()},e.prototype.initOtherTime=function(){this.Node_auto_host.visible=!1},e.prototype.initSystemInfo=function(){var t=this;GlobalData.gameData.isPlayBack()&&(this.systemInfoNode.visible=!1),this.systemInfoNode.visible=!1,this.systemTimeSchedulerId=setInterval(function(){t.updateSystemTime()},3e4),this.otherSystemInfoSchedulerId=setInterval(function(){t.updateOtherSystemInfo()},15e3)},e.prototype.updateSystemTime=function(){var t=new Date,e=t.getHours(),a=t.getMinutes(),i=""+a;10>a&&(i="0"+a),this.Text_time.text=Utils.format("{0}:{1}",e,i)},e.prototype.updateOtherSystemInfo=function(){return __awaiter(this,void 0,void 0,function(){var t,e,a;return __generator(this,function(i){switch(i.label){case 0:return GameConfig.platform!=GameConfig.PLATFORM_SET.weChat?[2]:[4,platform.getSystemInfo()];case 1:return t=i.sent(),e=t.batteryLevel,void 0!=e&&this.updateBattery(e),a=t.wifiSignal,void 0!=a&&this.updateSingalLevel(a),[2]}})})},e.prototype.initOtherUI=function(){this.Button_bxh.visible=!1,this.Text_autoDiscard.visible=!1,this.addTapEvent(this.ChangePlayerNumBtn,this.changePlayerNumEvent),this.checkPlayerNum(),this.Button_voice.visible=!1,this.addTapEvent(this.Button_chat,this.showChatBox),this.addTapEvent(this.Button_bxh,this.showBxhDes),GlobalData.gameData.isPlayBack()&&(this.Button_chat.visible=!1),this.addTapEvent(this.Button_scoreBoard,this.showScoreBoardBox),this.addTapEvent(this.Button_tint,this.showMyTingInfoView),this.addTapEvent(this.Button_refresh,function(){game.CommonView.showWaiting(),game.ConnectService.getInstance().connect(!0)}),GlobalData.gameData.isPlayBack()&&(this.Button_refresh.visible=!1)},e.prototype.showScoreBoardBox=function(){game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.GameScoreBoard.index)},e.prototype.showBxhDes=function(){game.DialogManager.getInstance().popUp1(GlobalData.gameData.getBiXiaHuDesc())},e.prototype.showChatBox=function(){game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.chatBox.index)},e.prototype.changePlayerNumEvent=function(){game.DialogManager.getInstance().popUp2(Strings.applyThreePlayer,function(){game.SocketManager.getInstance().sendMsg(game.MsgConstant.HALL,game.MsgConstant.CMD_switch_player_num)})},e.prototype.initBackBtn=function(){this.addTapEvent(this.Button_quit,this.backEvent)},e.prototype.initMoreInfo=function(){var t=this;this.setPopBtnStatus(1),GlobalData.gameData.isPlayBack()&&(this.moreInfoNode.visible=!1,this.Button_more.visible=!1),this.setMoreInfo(!1),this.addTapEvent(this.Button_setting,this.showSetting),this.addTapEvent(this.Button_more,function(){t.setMoreInfo(!t.isMoreInfoOpen)}),this.addTapEvent(this.Button_applyQuit,this.applyQuitEvent),this.addTapEvent(this.Button_help,this.showHelp)},e.prototype.showHelp=function(){this.setMoreInfo(!1),game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.roomInfoBox.index)},e.prototype.backEvent=function(){var t=GlobalData.gameData.getRoomInfo().getPayMode()==Constants.ROOM_PAY_MODE.other;if(GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.ready){var e=function(){GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.ready&&(!GlobalData.gameData.isMeCreator()||t||GlobalData.gameData.getRoomInfo().isClubRoom()?game.SocketManager.getInstance().sendMsg(game.MsgConstant.HALL,game.MsgConstant.CMD_LEAVE_ROOM):game.SocketManager.getInstance().sendMsg(game.MsgConstant.HALL,game.MsgConstant.CMD_CANCEL_ROOM))},a=null;!GlobalData.gameData.isMeCreator()||t||GlobalData.gameData.getRoomInfo().isClubRoom()?a=Strings.exitRoom:(a=Strings.dismissRoom,"0"==GlobalData.clientConfigs.showCreateRoom&&GameConfig.platform==GameConfig.PLATFORM_SET.weChat&&(a="是否确认解散房间?")),game.DialogManager.getInstance().popUp2(a,e)}else game.SocketManager.getInstance().sendMsg(game.MsgConstant.HALL,game.MsgConstant.CMD_DISMISS_ROOM)},e.prototype.applyQuitEvent=function(){this.setMoreInfo(!1),this.backEvent()},e.prototype.showSetting=function(){game.LogUtils.info("设置框"),game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.gameSetting.index)},e.prototype.initInviteNode=function(){this.addTapEvent(this.Button_weChat,this.share),this.addTapEvent(this.Button_dismissRoom,this.dissolveRoom)},e.prototype.setPopBtnStatus=function(t){var e=2==t;this.Button_setting.visible=e,this.Button_help.visible=e},e.prototype.dissolveRoom=function(){game.LogUtils.info("解散房间");var t=function(){game.SocketManager.getInstance().sendMsg(game.MsgConstant.HALL,game.MsgConstant.CMD_CANCEL_ROOM)},e=Strings.dismissRoom;"0"==GlobalData.clientConfigs.showCreateRoom&&GameConfig.platform==GameConfig.PLATFORM_SET.weChat&&(e="是否确认解散房间?"),game.DialogManager.getInstance().popUp2(e,t)},e.prototype.share=function(){if(GlobalData.gameData.getRoomInfo().isClubRoom()){var t=GlobalData.gameData.getRoomInfo().getRoomNum();Utils.copyToClipboard(GlobalData.getShareJoinRoomUrlWithShareCode(t)),game.DialogManager.getInstance().popUp2("复制成功，是否打开微信粘贴？",function(){Utils.callWxApp()})}else{var t=GlobalData.gameData.getRoomInfo().getRoomNum();Utils.copyToClipboard(GlobalData.getShareJoinRoomUrlWithShareCode(t)),game.DialogManager.getInstance().popUp2("复制成功，是否打开微信粘贴？",function(){Utils.callWxApp()})}},e.prototype.initDelayAuto=function(){this.autoDelayNode.visible=!1,this.addTapEvent(this.cancelAutoBtn,function(){game.SocketManager.getInstance().sendMsg(game.MsgConstant.GAME,game.MsgConstant.CMD_Notice_AutoHost_cancel)})},e.prototype.initTingTint=function(){var t=this;null!=this.tingTint||GlobalData.gameData.isPlayBack()||(this.tinyMask=new eui.Rect,this.tinyMask.alpha=0,this.tinyMask.width=1280,this.tinyMask.height=720,this.addChild(this.tinyMask),this.addTapEvent(this.tinyMask,function(){t.hideMyTingInfoView()}),this.tingTint=new game.TingTint,this.addChild(this.tingTint),this.hideMyTingInfoView())},e.prototype.initHeadNode=function(){this.headGroup=[this.headDown,this.headRight,this.headTop,this.headLeft];for(var t=0;t<this.headGroup.length;t++)this.headGroup[t].setDir(t);this.resetPlayerHeadPosition()},e.prototype.resetPlayerHeadPosition=function(){if(GameConst.PLAYER_HEAD_POSITION=[],GameUtils.is3dMode())for(var t=0;t<GameConst.PLAYER_HEAD_POSITION_DATA[GameConst.CARD_MODE.mode_3d].length;t++)if(t!=GameConst.PLAY_DIR.up){var e=GameConst.PLAYER_HEAD_POSITION_DATA[GameConst.CARD_MODE.mode_3d][t].x,a=GameConst.PLAYER_HEAD_POSITION_DATA[GameConst.CARD_MODE.mode_3d][t].y;GameConst.PLAYER_HEAD_POSITION[t]=game.FixUIManager.getInstance().convertBoarderPos(e,a)}else GameConst.PLAYER_HEAD_POSITION[t]=GameConst.PLAYER_HEAD_POSITION_DATA[GameConst.CARD_MODE.mode_3d][t];else for(var t=0;t<GameConst.PLAYER_HEAD_POSITION_DATA[GameConst.CARD_MODE.mode_2d].length;t++)if(t!=GameConst.PLAY_DIR.up){var e=GameConst.PLAYER_HEAD_POSITION_DATA[GameConst.CARD_MODE.mode_2d][t].x,a=GameConst.PLAYER_HEAD_POSITION_DATA[GameConst.CARD_MODE.mode_2d][t].y;GameConst.PLAYER_HEAD_POSITION[t]=game.FixUIManager.getInstance().convertBoarderPos(e,a)}else GameConst.PLAYER_HEAD_POSITION[t]=GameConst.PLAYER_HEAD_POSITION_DATA[GameConst.CARD_MODE.mode_2d][t];for(var t=0;t<GameConst.maxPlayerNum;t++){var i=this.headGroup[t],n=GameConst.PLAYER_HEAD_POSITION[t];i.resetPosition(n.x,n.y)}},e.prototype.updatePlayerHead=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.headGroup[t].visible=!1;game.LogUtils.info("initPlayerHead");for(var t=0;t<GameConst.maxPlayerNum;t++){var e=GlobalData.gameData.changeIndexToClientId(t);if(-1!=e){game.LogUtils.info("getPlayerInfo clientId "+e);var a=GlobalData.gameData.getPlayerByClientId(e);if(null==a)this.headGroup[e].visible=!1;else if(this.headGroup[e].visible=!0,this.headGroup[e].setData(a),this.headGroup[e].updateGameStatus(this.status),null!=a.getCardData()){var i=a.getCardData().getJiaPaiValue();0!=i?this.headGroup[t].setJiapaiData(i):this.headGroup[t].cancelJiapaiData()}}}for(var t=0;t<GameConst.maxPlayerNum;t++){var e=GlobalData.gameData.changeIndexToClientId(t);-1!=e&&this.headGroup[e].updateGameStatus(this.status)}if(this.status==GameConst.GAME_STATUS_TYPE.playing)for(var t=0;t<GameConst.maxPlayerNum;t++){var e=GlobalData.gameData.changeIndexToClientId(t);-1!=e&&this.headGroup[e].updateHuaNum(this.gs.getCardLayer().getHuaNum(e))}else if(this.status==GameConst.GAME_STATUS_TYPE.over||this.status==GameConst.GAME_STATUS_TYPE.allOver)for(var t=0;t<GameConst.maxPlayerNum;t++)this.headGroup[t].updateTingStatus(!1),this.headGroup[t].cancelJiapaiData()},e.prototype.initData=function(){this.status=GameConst.GAME_STATUS_TYPE.ready,this.needCheckPlayerNum=!0,this.systemTimeSchedulerId=null,this.allScheduler=[],this.tempDataBeforeGameStart=[],this.replayerOperateNodes=[]},e.prototype.onEventHandler=function(t){var e=t.data,a=e.cmd,i=e.data;if(a==game.GameCmd.OPERATE||a==game.GameCmd.OPERATE_BACK){if(a==game.GameCmd.OPERATE){var n=!0;if(this.status==GameConst.GAME_STATUS_TYPE.playing&&this.gs.getCardLayer().isBuhuaing()&&(n=!1),n)if(GlobalData.gameData.isPlayBack())for(var o=0;o<i.length;o++){var s=i[o],r=s.chairId,l=GlobalData.gameData.changeChairIdToClientId(r);this.replayerOperateNodes[l].setData(s.operateTypes),this.replayerOperateNodes[l].visible=!0}else this.operateCome();game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)}else if(a==game.GameCmd.OPERATE_BACK)if(GlobalData.gameData.isPlayBack())for(var o=0;o<this.replayerOperateNodes.length;o++)this.replayerOperateNodes[o].visible=!1;else this.OperateGroup.visible=!1}else if(a==game.GameCmd.OTHER_PLAYER_IN){var c=i,h=c.getChairId(),l=GlobalData.gameData.changeChairIdToClientId(h);game.LogUtils.info("加入玩家的clientId "+l),this.headGroup[l].visible=!0,this.headGroup[l].setData(c),this.checkPlayerNum()}else if(a==game.GameCmd.PLAYER_LEAVE)GlobalData.gameData.getRoomInfo().isClubRoom()?game.SceneSkip.skipToClubScene():game.SceneSkip.skipToHallScene();else if(a==game.GameCmd.OTHER_PLAYER_LEAVE){var l=i.clientId;this.headGroup[l].updateStatus(GameConst.PLAYER_STATUS.NULL),this.checkPlayerNum()}else if(a==game.GameCmd.PLAYER_STATUS_CHANGED){var l=i.clientId,u=i.status;this.headGroup[l].updateStatus(u),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)}else if(a==game.GameCmd.PLAYER_HUA_NUM_CHANGED){var l=i.clientId,d=i.huaNum;this.headGroup[l].updateHuaNum(d)}else if(a==game.GameCmd.PLAYER_SCORE_FAFEN||a==game.GameCmd.PLAYER_SCORE_FAFEN_BACK)a==game.GameCmd.PLAYER_SCORE_FAFEN?this.status==GameConst.GAME_STATUS_TYPE.before_playing?this.tempDataBeforeGameStart.push({type:this.tempDataType.FAFEN,data:i}):this.playFaFenEffect(i):a==game.GameCmd.PLAYER_SCORE_FAFEN_BACK&&this.playFaFenEffectBack(i);else if(a==game.GameCmd.PLAYER_SCORE_NUM_CHANGED){game.LogUtils.info("玩家分数改变");var l=i.clientId,d=i.score;this.headGroup[l].updateScore(d)}else if(a==game.GameCmd.OPERATE_PONG){var l=i.clientId;this.gs.getEffectLayer().playPong(l),l==GameConst.ME_DIR&&(this.Button_tint.visible=!1,this.hideMyTingInfoView())}else if(a==game.GameCmd.OPERATE_KONG){var l=i.clientId;this.gs.getEffectLayer().playKong(l),l==GameConst.ME_DIR&&(this.Button_tint.visible=!1,this.hideMyTingInfoView())}else if(a==game.GameCmd.OPERATE_READY||a==game.GameCmd.OPERATE_READY_BACK){var r=i.chairId,l=GlobalData.gameData.changeChairIdToClientId(r);a==game.GameCmd.OPERATE_READY?(this.headGroup[l].updateTingStatus(!0),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)):a==game.GameCmd.OPERATE_READY_BACK&&this.headGroup[l].updateTingStatus(!1)}else if(a==game.GameCmd.OPERATE_PASS){var l=i.clientId;GlobalData.gameData.isPlayBack()?(this.gs.getEffectLayer().playPass(l),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)):l==GameConst.ME_DIR&&(this.OperateGroup.visible=!1,GlobalData.gameData.resetOperateTypes())}else if(a==game.GameCmd.BATTERY_CHANGED){var m=i.battery;this.updateBattery(m)}else if(a==game.GameCmd.APP_NET_SINGAL_CHANGED){var p=i.singalLevel;this.updateSingalLevel(p)}else if(a==game.GameCmd.WIN_OVER){for(var l=i.clientId,g=i.actionIndex,o=0;o<l.length;o++)this.gs.getEffectLayer().playWin(l[o],g[o]);var C=i.chuchongIndex;null!=C&&C>0&&this.gs.getEffectLayer().playChuchongEffect(C)}else if(a==game.GameCmd.PLAYER_BEGIN_JIA_PAI){var l=i.clientId,_=i.value;this.startJiaPai(l,_)}else if(a==game.GameCmd.PLAYER_CANCEL_JIA_PAI){var l=i.clientId;this.cancelJiapai(l)}else if(a==game.GameCmd.CHAT_MSG){var r=i.chairId,l=GlobalData.gameData.changeChairIdToClientId(r),f=i.type,D=parseInt(i.msgId)-1;this.gs.getEffectLayer().playChatMsg(l,f,D)}else if(a==game.GameCmd.START_PLAY_VOICE){var l=i.clientId;this.gs.getEffectLayer().playVoiceEffect(l)}else if(a==game.GameCmd.VOICE_OVER)this.gs.getEffectLayer().stopVoiceEffect();else if(a==game.GameCmd.POINT_EMOTION){if(GameConst.forbid_emotion)return;var r=i.chairId,I=i.toChairId,l=GlobalData.gameData.changeChairIdToClientId(r),b=GlobalData.gameData.changeChairIdToClientId(I),D=parseInt(i.msgId);this.gs.getEffectLayer().playPointEmotion(l,b,D)}else if(a==game.GameCmd.GET_MY_TING_INFO){var y=i.tingValue;this.Button_tint.visible=y}else if(a==game.GameCmd.DRAW_CARD){var r=i.chairId;r==GlobalData.gameData.getMyChairId()&&(this.Button_tint.visible=!1,this.hideMyTingInfoView())}else if(a==game.GameCmd.START_AUTO_OF_DEALY||a==game.GameCmd.CANCEL_AUTO_OF_DEALY)this.updateAutoDelay(),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH);else if(a==game.GameCmd.AUTO_DISCARD_TIME_STATUS_CHANGED)this.changeAutoHostStatus();else if(a==game.GameCmd.NOTICE_KICK_LEFT_TIME)this.updateOtherTime();else if(a==game.GameCmd.CANCEL_KICK_LEFT_TIME)this.updateOtherTime();else if(a==game.GameCmd.CHANGE_CARD_BACK)this.changeCardBack();else if(a==game.GameCmd.UPDATE_AUTODISCARD_Text_Visible){var E=i.visible;this.Text_autoDiscard.visible=E}else if(a==game.GameCmd.REPLAY_OPERATE_CLICK||a==game.GameCmd.REPLAY_OPERATE_CLICK_BACK)if(a==game.GameCmd.REPLAY_OPERATE_CLICK){var r=i.chairId,l=GlobalData.gameData.changeChairIdToClientId(r);this.replayerOperateNodes[l].runClickFunc(i.operateType)}else game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH);else a==game.GameCmd.CHANGE_CARD_FACE&&this.changeCardFace()},e.prototype.resetClock=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1)},e.prototype.changeAutoHostStatus=function(){this.updateOtherTime()},e.prototype.resetUIPosition=function(){GameUtils.is3dMode()?(this.Button_chat.x=1019,this.Button_chat.y=498,this.Button_voice.x=1107,this.Button_voice.y=498,this.Button_tint.x=1198,this.Button_tint.y=498):(this.Button_chat.x=1199,this.Button_chat.y=392,this.Button_voice.x=1199,this.Button_voice.y=474,this.Button_tint.x=1199,this.Button_tint.y=554,game.FixUIManager.getInstance().addPosData(this.Button_chat.hashCode,{x:this.Button_chat.x,y:this.Button_chat.y}),game.FixUIManager.getInstance().addPosData(this.Button_voice.hashCode,{x:this.Button_voice.x,y:this.Button_voice.y}),game.FixUIManager.getInstance().addPosData(this.Button_tint.hashCode,{x:this.Button_tint.x,y:this.Button_tint.y}))},e.prototype.changeViewMode=function(){this.resetUIPosition(),this.resetPlayerHeadPosition()},e.prototype.changeCardFace=function(){for(var t=0;t<this.headGroup.length;t++){var e=this.headGroup[t];e.changeCardFace()}},e.prototype.changeCardBack=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.headGroup[t].changeCardBack()},e.prototype.updateOtherTime=function(){this.stopOtherTimer(),this.otherTimeGroup.visible=!1,this.Node_auto_host.visible=!1,this.status==GameConst.GAME_STATUS_TYPE.ready||this.status==GameConst.GAME_STATUS_TYPE.waiting?this.startKickOfflineTimer():this.status==GameConst.GAME_STATUS_TYPE.playing&&this.showAutoHost()},e.prototype.showAutoHost=function(){var t=GlobalData.gameData.getCanAutoHost();t||GlobalData.gameData.isPlayBack()?this.Node_auto_host.visible=!1:this.Node_auto_host.visible=!0},e.prototype.stopOtherTimer=function(){0!=this.schedulerKickOfflineId&&(clearInterval(this.schedulerKickOfflineId),this.schedulerKickOfflineId=0)},e.prototype.startKickOfflineTimer=function(){var t=this;this.kickOfflineTime=GlobalData.gameData.getKickOfflineTime(),this.kickOfflineTime>0&&(this.otherTimeGroup.visible=!0,this.Text_otherTime.textFlow=this.getKickOfflineTimeInfo(this.kickOfflineTime),this.schedulerKickOfflineId=setInterval(function(){t.kickOfflineTime=Math.max(t.kickOfflineTime-1,0),t.Text_otherTime.textFlow=t.getKickOfflineTimeInfo(t.kickOfflineTime),t.kickOfflineTime<=0&&t.stopOtherTimer()},1e3))},e.prototype.getKickOfflineTimeInfo=function(t){return[{text:"系统将在",style:{textColor:15592941}},{text:""+t,style:{textColor:16711680}},{text:"秒后踢出离线玩家",style:{textColor:15592941}}]},e.prototype.updateInviteNode=function(){if(this.status!=GameConst.GAME_STATUS_TYPE.ready)this.inviteNode.visible=!1;else{this.inviteNode.visible=!0,this.Text_roomType.text=GlobalData.gameData.getRoomInfo().getRoomTypeDesc(),this.Text_RoomNumber.text=""+GlobalData.gameData.getRoomInfo().getRoomNum();var t=GlobalData.gameData.getRoomInfo().getPayMode()==Constants.ROOM_PAY_MODE.other;this.Button_dismissRoom.visible=GlobalData.gameData.isMeCreator()&&!t,GlobalData.gameData.getRoomInfo().isClubRoom()&&(this.Button_dismissRoom.visible=!1),this.Button_dismissRoom.visible?(this.Button_dismissRoom.x=0,this.Button_weChat.x=352):this.Button_weChat.x=176;var e=GlobalData.gameData.getRoomInfo().getGameUIRulesDesc();this.Text_rules.text=e}},e.prototype.updateAutoDelay=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)if(this.status==GameConst.GAME_STATUS_TYPE.playing){var e=GlobalData.gameData.isAutoDelay(t);this.headGroup[t].updateAutoStatus(),t==GameConst.ME_DIR&&(this.autoDelayNode.visible=e)}else this.autoDelayNode.visible=!1},e.prototype.cancelJiapai=function(t){this.headGroup[t].cancelJiapaiData(),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)},e.prototype.startJiaPai=function(t,e){this.headGroup[t].setJiapaiData(e),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)},e.prototype.showMyTingInfoView=function(){var t=GlobalData.gameData.getMyTingInfo();null!=this.tingTint&&(this.tingTint.initData(t,1280),this.tingTint.visible=!0),this.tinyMask&&(this.tinyMask.visible=!0,this.tinyMask.touchEnabled=!0)},e.prototype.hideMyTingInfoView=function(){null!=this.tingTint&&(this.tingTint.visible=!1),null!=this.tinyMask&&(this.tinyMask.visible=!1,this.tinyMask.touchEnabled=!1)},e.prototype.updateSingalLevel=function(t){1>t&&(t=1),t>4&&(t=4),this.Image_singnal.source="system_wifi_"+t+"_png"},e.prototype.updateBattery=function(t){this.batteryProgressBar.value=t},e.prototype.playFaFenEffectBack=function(t){var e=t.faFenType,a=t.faFenUserInfos;if(null!=e&&null!=a)for(var i=0;i<a.length;i++){var n=a[i],o=n.chairId,s=parseInt(n.faScore),r=(parseInt(n.score),n.score-s),l=GlobalData.gameData.changeChairIdToClientId(o);this.headGroup[l].updateScore(r)}},e.prototype.playFaFenEffect=function(t){var e=t.faFenType,a=t.faFenUserInfos;if(null!=e&&null!=a)for(var i=0;i<a.length;i++){var n=a[i],o=n.chairId,s=n.faScore,r=n.score,l=GlobalData.gameData.changeChairIdToClientId(o);this.gs.getEffectLayer().showScoreEffect(l,s),this.headGroup[l].updateScore(r),e==GameConst.FaFenType.FLOWER_KONG&&s>0&&this.gs.getEffectLayer().playHuaKong(l),e==GameConst.FaFenType.DNXB&&s>0&&this.gs.getEffectLayer().playSiFeng(l),GlobalData.gameData.isPlayBack()?0==i&&this.addSchedulerFunc(function(){game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)},.5):s>0&&this.addSchedulerFunc(function(){game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)},.5)}},e.prototype.checkPlayerNum=function(){var t=GlobalData.gameData.getCurPlayerNum(),e=this.ChangePlayerNumGroup.width;if(egret.Tween.removeTweens(this.ChangePlayerNumGroup),3==t&&GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.ready&&this.needCheckPlayerNum){var a=egret.Tween.get(this.ChangePlayerNumGroup);a.to({x:game.FixUIManager.getInstance().convertX(0)},200)}else this.ChangePlayerNumGroup.x=game.FixUIManager.getInstance().convertX(-e);GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.playing&&(this.needCheckPlayerNum=!1)},e.prototype.setGameScene=function(t){this.gs=t},e.prototype.setStatus=function(t){this.status=t,this.updatePlayerHead(),this.updateInviteNode(),this.updateOtherUI(),this.updateOperateNode(),this.updateBackBtn(),this.updateMoreInfo(),this.updateSystemInfo(),this.excuteTempDataWhenGameBegin(),this.checkPlayerNum(),this.updateAutoDelay(),this.updateOtherTime(),this.status==GameConst.GAME_STATUS_TYPE.before_playing&&GlobalData.gameData.isBiXiaHu()&&this.gs.getEffectLayer().playBixihuaEffect()},e.prototype.updateSystemInfo=function(){this.status==GameConst.GAME_STATUS_TYPE.ready?this.systemInfoNode.x=67:this.systemInfoNode.x=5,this.updateSystemTime(),this.updateOtherSystemInfo()},e.prototype.excuteTempDataWhenGameBegin=function(){if(this.status==GameConst.GAME_STATUS_TYPE.playing){for(var t=0;t<this.tempDataBeforeGameStart.length;t++){var e=this.tempDataBeforeGameStart[t],a=e.type;a==this.tempDataType.FAFEN&&this.playFaFenEffect(e.data)}this.tempDataBeforeGameStart=[]}},e.prototype.updateOperateNode=function(){this.status==GameConst.GAME_STATUS_TYPE.playing?this.operateCome():this.OperateGroup.visible=!1},e.prototype.showJiaPai=function(){for(var t=0;t<GameConst.maxPlayerNum;t++){var e=GlobalData.gameData.changeIndexToClientId(t);if(-1!=e){var a=GlobalData.gameData.getCardData(e);if(null==a)return void game.LogUtils.error("initJiaPai cardData is null dir "+e);var i=a.getJiaPaiValue();game.LogUtils.info("jiaPaiValue "+i),null!=i&&i>0&&this.startJiaPai(e,i)}}},e.prototype.checkTingStatus=function(){for(var t=0;t<GameConst.maxPlayerNum;t++){var e=GlobalData.gameData.getCardData(t);if(null==e)return void game.LogUtils.error("initJiaPai cardData is null dir "+t);var a=e.isTing();game.LogUtils.info("isTing "+a),this.headGroup[t].updateTingStatus(a)}},e.prototype.checkMyTingInfoBtn=function(){if(null!=GlobalData.gameData.getMyTingInfo()){var t=this.gs.getCardLayer().getHandCardsNum(GameConst.ME_DIR),e=this.gs.getCardLayer().getDrawCardIndex(GameConst.ME_DIR)+1;t!=e?this.Button_tint.visible=!0:(this.Button_tint.visible=!1,this.hideMyTingInfoView())}},e.prototype.updateOtherUI=function(){if(this.roomNumberLabel.text="房间号:"+GlobalData.gameData.getRoomInfo().getRoomNum(),this.Button_tint.visible=!1,this.hideMyTingInfoView(),this.status==GameConst.GAME_STATUS_TYPE.ready)this.Button_bxh.visible=!1,this.Button_scoreBoard.visible=!1;else if(this.status==GameConst.GAME_STATUS_TYPE.before_playing);else if(this.status==GameConst.GAME_STATUS_TYPE.playing)GlobalData.gameData.isPlayBack()?this.Button_scoreBoard.visible=!1:this.Button_scoreBoard.visible=!0,this.Button_bxh.visible=GlobalData.gameData.isBiXiaHu(),this.showJiaPai(),this.checkTingStatus(),this.checkMyTingInfoBtn();else if(this.status==GameConst.GAME_STATUS_TYPE.waiting)for(var t=0;t<GameConst.maxPlayerNum;t++)this.headGroup[t].cancelJiapaiData()},e.prototype.updateBackBtn=function(){if(this.status==GameConst.GAME_STATUS_TYPE.ready){GlobalData.gameData.isMeCreator(),GlobalData.gameData.getRoomInfo().getPayMode()==Constants.ROOM_PAY_MODE.other;game.LogUtils.info("是否俱乐部房间:"+GlobalData.gameData.getRoomInfo().isClubRoom()),this.Button_quit.visible=!0}else this.Button_quit.visible=!1},e.prototype.updateMoreInfo=function(){this.status!=GameConst.GAME_STATUS_TYPE.ready?(this.Image_moreInfo_bg.height=260,this.Button_applyQuit.visible=this.isMoreInfoOpen):(this.Image_moreInfo_bg.height=200,this.Button_applyQuit.visible=!1),this.isMoreInfoOpen||(this.Image_moreInfo_bg.height=75)},e.prototype.initOperateNode=function(){if(GlobalData.gameData.isPlayBack())for(var t=0;4>t;t++){var e=GameConst.PLAYER_HEAD_POSITION[t],a={dir:t,position:new egret.Point(e.x,e.y)},i=new GameReplayOperateTint(a);i.visible=!1,this.replayerOperateNodes[t]=i,this.addChild(i)
}this.operateBtns=[],this.operateBtns[GameConst.OPERATE_TYPE.pass-1]=this.Btn_Pass,this.operateBtns[GameConst.OPERATE_TYPE.ready-1]=this.Btn_Ready,this.operateBtns[GameConst.OPERATE_TYPE.win-1]=this.Btn_Win,this.operateBtns[GameConst.OPERATE_TYPE.kong-1]=this.Btn_Kong,this.operateBtns[GameConst.OPERATE_TYPE.pong-1]=this.Btn_Pong,this.tingPosX=this.Btn_Pass.x,GlobalData.gameData.isPlayBack()?this.OperateGroup.touchChildren=!1:(this.addTapEvent(this.Btn_Pong,this.sendPong),this.addTapEvent(this.Btn_Kong,this.sendKong),this.addTapEvent(this.Btn_Pass,this.clickPass),this.addTapEvent(this.Btn_Win,this.sendWin),this.addTapEvent(this.Btn_Ready,this.sendReady)),this.OperateGroup.visible=!1},e.prototype.operateCome=function(){if(this.status==GameConst.GAME_STATUS_TYPE.playing){game.LogUtils.info("operateCome");for(var t=GlobalData.gameData.getOperateTypes(),e=t.length,a=!1,i=0;5>i;i++)this.operateBtns[i].visible=!1;if(e>0){this.gs.getGameCenter().updateDirArrow(GameConst.ME_DIR),game.LogUtils.info("玩家有操作");for(var i=0;e>i;i++)this.operateBtns[t[i]-1].visible=!0,t[i]==GameConst.OPERATE_TYPE.win&&(a=!0);this.Btn_Pass.visible=!0,a?this.Btn_Pass.x=this.tingPosX-667:this.Btn_Pass.x=this.tingPosX,this.OperateGroup.visible=!0}}},e.prototype.sendOperateType=function(t,e){GlobalData.gameData.isAutoDelay(GameConst.ME_DIR)||(this.gs.getCardLayer().clearSelectCard(),this.OperateGroup.visible=!1,game.LogUtils.info("operate type "+e),GlobalData.gameData.resetOperateTypes(),game.SocketManager.getInstance().sendMsg(game.MsgConstant.GAME,t,{operateType:e}))},e.prototype.sendPong=function(){var t=game.MsgConstant.CMD_PONG,e=GameConst.OPERATE_TYPE.pong;this.sendOperateType(t,e)},e.prototype.sendKong=function(){var t=game.MsgConstant.CMD_KONG,e=GameConst.OPERATE_TYPE.kong;this.sendOperateType(t,e)},e.prototype.sendPass=function(){var t=game.MsgConstant.CMD_PASS,e=GameConst.OPERATE_TYPE.pass;this.sendOperateType(t,e)},e.prototype.sendWin=function(){var t=game.MsgConstant.CMD_WIN,e=GameConst.OPERATE_TYPE.win;this.sendOperateType(t,e)},e.prototype.clickPass=function(){if(this.isZiMo()){var t={confirmFunc:this.sendWin.bind(this),cancelFun:this.sendPass.bind(this)};return void game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.discardWinConfirmBox.index,t)}this.sendPass()},e.prototype.sendReady=function(){var t=game.MsgConstant.CMD_READY,e=GameConst.OPERATE_TYPE.win;this.sendOperateType(t,e)},e.prototype.isZiMo=function(){for(var t=GlobalData.gameData.getOperateTypes(),e=t.length,a=!1,i=0;e>i;i++)if(t[i]==GameConst.OPERATE_TYPE.win){a=!0;break}if(!a)return!1;var n=this.gs.getCardLayer().cardNumberIsMax(GameConst.ME_DIR);return n},e.prototype.setMoreInfo=function(t){this.isMoreInfoOpen=t,t?(this.Button_setting.visible=!0,this.Button_help.visible=!0,this.Button_applyQuit.visible=this.status!=GameConst.GAME_STATUS_TYPE.ready,this.Button_refresh.visible=!1):(this.Button_setting.visible=!1,this.Button_help.visible=!1,this.Button_applyQuit.visible=!1,GlobalData.gameData.isPlayBack()||(this.Button_refresh.visible=!0)),this.updateMoreInfo()},e.prototype.addSchedulerFunc=function(t,e){var a=this,i=egret.Tween.get(this);i.wait(e),i.call(function(){a.allScheduler.splice(a.allScheduler.indexOf(t),1),t()}),this.allScheduler.push(t)},e.prototype.clearAllScheduler=function(){for(egret.Tween.removeTweens(this);this.allScheduler.length>0;){var t=this.allScheduler.pop();t.call(this)}this.allScheduler=[]},e.prototype.release=function(){null!=this.systemTimeSchedulerId&&clearInterval(this.systemTimeSchedulerId),null!=this.otherSystemInfoSchedulerId&&clearInterval(this.otherSystemInfoSchedulerId),this.clearAllScheduler()},e}(game.EComponent);__reflect(GameUILayer.prototype,"GameUILayer"),window.GameUILayer=GameUILayer;var GameUtils;!function(t){function e(){return GameConst.card_mode_index==GameConst.CARD_MODE.mode_3d}function a(t){var e="";if(t.gameId==Constants.MINI_GAME_ID_SET.mahjong){var a=new game.RoomInfo;a.parse(t),t.mjRoomInfo=a,e=t.mjRoomInfo.getShareRoomInfo()}else if(t.gameId==Constants.MINI_GAME_ID_SET.biji){var i="";i+=t.hasTwoWang?"带双王、":"不带双王、",i+=t.hasPierSort?"墩位从小到大、":"不指定墩位大小、",i+=t.canThrowTile?"可以弃牌、":"不可以弃牌、",t.hasFirstShunQing&&(i+="顺清打头、"),t.hasSanQing&&(i+="三清、"),t.multiple&&(i=i+t.multiple+"倍、");var n=i.substr(1,-4);game.LogUtils.info(Utils.format("sub string : {0}, {1}",n,i));var o=t.turnNumber,s="对局数:"+o+"把  ";e="付费方式:"+this.getPayModeDesc(t)+s+i,game.LogUtils.info(Utils.format("微信分享内容 {0}",e))}else if(t.gameId==Constants.MINI_GAME_ID_SET.zhuandan){var o=t.turnNumber,s="对局数:"+o+"把";e=" 付费方式:"+this.getPayModeDesc(t)+s,game.LogUtils.info(Utils.format("微信分享内容 {0}",e))}else if(t.gameId==Constants.MINI_GAME_ID_SET.fightThree){var o=t.turnNumber,s="对局数:"+o+"把  ",r="";0==t.playType?r="去掉2-5牌、":1==t.playType?r="散牌235大于AAA、":2==t.playType&&(r="散牌235大于豹子、");var l=(Utils.format("底分{0}、",t.pot),Utils.format("{0}轮、",t.round)),c="";c=0==t.stuffyNum?"无必闷、":Utils.format("闷{0}圈、",t.stuffyNum);var h="";h=t.hasShowCards?"结算展示手牌、":"结算不展示手牌、";var i="";i=l+h+r+c;var n=i.substr(1,-4);e="付费方式:"+this.getPayModeDesc(t)+s+n,game.LogUtils.info(Utils.format("微信分享内容 {0}",e))}return e}function i(t){var e="";return t.payMode==Constants.ROOM_PAY_MODE.AA?e="AA付费 ":t.payMode==Constants.ROOM_PAY_MODE.creator?e="房主付费 ":t.payMode==Constants.ROOM_PAY_MODE.other&&(e="会长付费 "),e}function n(t){var e="";return t.gameId==Constants.MINI_GAME_ID_SET.mahjong?e=t.mjRoomInfo.getTemplateMainInfo():t.gameId==Constants.MINI_GAME_ID_SET.biji?e=GlobalData.getMiniGameName(Constants.MINI_GAME_ID_SET.biji):t.gameId==Constants.MINI_GAME_ID_SET.zhuandan?e=GlobalData.getMiniGameName(Constants.MINI_GAME_ID_SET.zhuandan):t.gameId==Constants.MINI_GAME_ID_SET.fightThree&&(e=GlobalData.getMiniGameName(Constants.MINI_GAME_ID_SET.fightThree)),e}function o(t){var e="";return t.gameId==Constants.MINI_GAME_ID_SET.mahjong?e=t.mjRoomInfo.getRulesDesc():t.gameId==Constants.MINI_GAME_ID_SET.biji?e=this.getShareRoomInfo(t):t.gameId==Constants.MINI_GAME_ID_SET.zhuandan?e=this.getShareRoomInfo(t):t.gameId==Constants.MINI_GAME_ID_SET.fightThree&&(e=this.getShareRoomInfo(t)),e}function s(t){var e="";1==GameConst.card_back_index?e="_y":2==GameConst.card_back_index&&(e="_b");var a=Utils.format(t,e);return a}function r(t){var e="";1==GameConst.card_face_index&&(e="1_");var a=Utils.format("{0}"+t,e);return a}function l(t,e,a,i){void 0===i&&(i="...");var n=e.length;for(t.text=e;t.textWidth>a;)t.text=e.substring(0,n)+i,n--}function c(t,e){var a=t.width-10,i=t.height-10,n=qr.QRCode.create(e,a,i,qr.QRErrorCorrectLevel.M,10);n.anchorOffsetX=a/2,n.anchorOffsetY=i/2,n.x=t.x+t.width/2,n.y=t.y+t.height/2,t.parent.addChild(n)}t.is3dMode=e,t.getShareRoomInfo=a,t.getPayModeDesc=i,t.getTemplateMainInfo=n,t.getTemplateRulesInfo=o,t.getCardBack=s,t.getCardFace=r,t.sub=l,t.createQrcode=c}(GameUtils||(GameUtils={}));var game;!function(t){var e=function(){function e(){this.canHeart=!1,this.lastHeartTime=0,this.lastSendTime=0,t.EAppFacade.getInstance().registerCommand(t.GameCmd.SOCKET_STATUS_CHANGE,this.socketStatusChange,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_HEAR_THROB),this.heartCmdCallback,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.USER_LOGIN_SUCCESS,this.userloginSuccessNotice,this)}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.sendHeartCmd=function(){if(this.canHeart){var e=(new Date).getTime();e-this.lastHeartTime>15e3?(t.LogUtils.info("heart timeout close socket."),t.ConnectService.getInstance().close()):e-this.lastSendTime>=5e3&&(this.sendHeartCmd_(),this.lastSendTime=e)}},e.prototype.sendHeartCmd_=function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.GAME,t.MsgConstant.CMD_HEAR_THROB,null);t.SocketManager.getInstance().send(e)},e.prototype.heartCmdCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.lastHeartTime=(new Date).getTime())},e.prototype.userloginSuccessNotice=function(e){t.ConnectService.getInstance().startTimer(),this.startHeart()},e.prototype.startHeart=function(){this.lastHeartTime=(new Date).getTime(),this.lastSendTime=0,this.canHeart=!0},e.prototype.reConnect=function(){t.ConnectService.getInstance().getStatus()==ConnectConst.ConnectStatus.ConnectClose&&(t.CommonView.showWaiting(),t.LogUtils.info("Socket 连接已断开，自动重连"),t.ConnectService.getInstance().connect(!0))},e.prototype.socketStatusChange=function(t){if(null!=t.data){var e=t.data.status;e==ConnectConst.ConnectStatus.Connected||e==ConnectConst.ConnectStatus.ConnectClose&&(this.canHeart=!1)}},e.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.SOCKET_STATUS_CHANGE,this.socketStatusChange,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_HEAR_THROB),this.heartCmdCallback,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.USER_LOGIN_SUCCESS,this.userloginSuccessNotice,this)},e}();t.HeartBeatService=e,__reflect(e.prototype,"game.HeartBeatService")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.startX=193,t.cardW=109,t.cardGap=10,t.originalWidth=0,t.originalHeight=0,t.curWidth=0,t.curHeight=0,t.cardNodeList=[],t.skinName="resource/skins/game/gameTingTintSkin.exml",t.init(),t}return __extends(a,e),a.prototype.on=function(){e.prototype.onCreateViewComplete.call(this),this.init()},a.prototype.init=function(){this.startX=145,this.cardW=109,this.cardGap=10,this.originalWidth=this.width,this.originalHeight=this.height,this.curWidth=this.originalWidth,this.curHeight=this.originalHeight,this.cardNodeList=[]},a.prototype.initData=function(e,a){this.curWidth=this.originalWidth;for(var i=0;i<this.cardNodeList.length;i++)this.cardNodeList[i].visible=!1;for(var n=e.length,o=this.cardW+this.cardGap,i=0;n>i;i++){var s=e[i],r=this.cardNodeList[i];null==r?(r=new t.TingTintCard,this.cardNodeList.push(r),this.addChild(r)):r.visible=!0,r.setData(s),r.x=this.startX+i*o,r.y=23,this.curWidth=this.curWidth+o}this.Image_bg.width=this.curWidth,this.Image_bg.height=this.curHeight;var l=a-75;10>l&&(l=10),l+this.curWidth>GameConfig.ScreenW-10&&(l=GameConfig.ScreenW-10-this.curWidth),this.x=l,this.y=400},a}(t.EComponent);t.TingTint=e,__reflect(e.prototype,"game.TingTint")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/gameTingTintCardSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this)},e.prototype.setData=function(t){this.back.source=GameUtils.getCardBack("2dmj_card_me_stand_1{0}_png"),this.face.source=Utils.format("2dmj_cardnum_mahjong_{0}_png",Utils.getNumberFormatStr(t.tileId)),this.Text_num.text=t.num},e}(t.EComponent);t.TingTintCard=e,__reflect(e.prototype,"game.TingTintCard")}(game||(game={}));var EToggleButton=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.buttonReleased=function(){game.LogUtils.info("点击按钮----"),game.SoundService.getInstance().playAudio("game_button_click_mp3")},e}(eui.ToggleButton);__reflect(EToggleButton.prototype,"EToggleButton"),window.EToggleButton=EToggleButton;var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this,a.dir,a.cardValue,a.idx)||this;return i._canSelect=!0,i._beSelected=!1,i.cardLayer=t,i.params=a,i.skinName=a.nodePath,i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.changeCardBack(),this.resetPosition(this.idx,this.params.actionType,!0)},a.prototype.setCardValue=function(a){if(e.prototype.setCardValue.call(this,a),this._value=a,0==this._value&&(this.dir==GameConst.ME_DIR||GlobalData.gameData.isPlayBack()))return void t.LogUtils.error("手牌数据错误 value:"+this._value);if(0!=this._value&&(this.dir==GameConst.ME_DIR||GlobalData.gameData.isPlayBack())){var i=this.getCardFaceImgName(this._value);this.face.source=i}if(GameUtils.is3dMode()&&GlobalData.gameData.isPlayBack()&&this.dir==GameConst.PLAY_DIR.up&&null!=this.face){var n=Math.min(15,this.idx+1+5)+this.cardLayer.getPongKongTotalCardNum(this.dir);this.face.rotation=0,this.face.skewX=GameConst.card_face_data_3d_up_down[20-n],this.dir==GameConst.PLAY_DIR.up&&(this.face.rotation=180)}},a.prototype.init=function(){this.setTingFlagVisible(!1)},a.prototype.setTingFlagVisible=function(t){this.dir==GameConst.ME_DIR&&(this.tingFlag.visible=t)},a.prototype.changeCardBack=function(){var e="";if(GameUtils.is3dMode())if(GlobalData.gameData.isPlayBack())if(this.dir==GameConst.PLAY_DIR.right)e=GameUtils.getCardBack("3d_left_pair_1{0}_png");else if(this.dir==GameConst.PLAY_DIR.left)e=GameUtils.getCardBack("3d_left_pair_1{0}_png");else if(this.dir==GameConst.PLAY_DIR.up){var a=1,i=this.cardLayer.getPongKongTotalCardNum(this.dir)+this.idx+1;a=5>=i?i:Math.max(1,10-i+1);var n=1;e=GameUtils.getCardBack("3d_me_showcard_flower_"+a+"{0}_png"),t.LogUtils.info(Utils.format("dir {0} name: {1}",this.idx,e)),5>i&&(n=-1),this.back.scaleX=n}else this.dir==GameConst.PLAY_DIR.down&&(e=GameUtils.getCardBack("3d_me_hand{0}_png"));else this.dir==GameConst.PLAY_DIR.down?e=GameUtils.getCardBack("3d_me_hand{0}_png"):this.dir==GameConst.PLAY_DIR.left?e=GameUtils.getCardBack("3d_left_hand_1{0}_png"):this.dir==GameConst.PLAY_DIR.right?e=GameUtils.getCardBack("3d_left_hand_1{0}_png"):this.dir==GameConst.PLAY_DIR.up&&(e=GameUtils.getCardBack("3d_up_hand{0}_png"));else GlobalData.gameData.isPlayBack()?this.dir==GameConst.PLAY_DIR.right?e=GameUtils.getCardBack("2dmj_card_side_face{0}_png"):this.dir==GameConst.PLAY_DIR.left?e=GameUtils.getCardBack("2dmj_card_side_face{0}_png"):this.dir==GameConst.PLAY_DIR.up?e=GameUtils.getCardBack("2dmj_card_top_face{0}_png"):this.dir==GameConst.PLAY_DIR.down&&(e=GameUtils.getCardBack("2dmj_card_me_stand_1{0}_png")):this.dir==GameConst.PLAY_DIR.down?e=GameUtils.getCardBack("2dmj_card_me_stand_1{0}_png"):this.dir==GameConst.PLAY_DIR.left?e=GameUtils.getCardBack("2dmj_card_side_stand{0}_png"):this.dir==GameConst.PLAY_DIR.right?e=GameUtils.getCardBack("2dmj_card_side_stand{0}_png"):this.dir==GameConst.PLAY_DIR.up&&(e=GameUtils.getCardBack("2dmj_card_top_stand{0}_png"));this.back.source=e},a.prototype.isSelected=function(){return this._beSelected},a.prototype.setSelect=function(t){this._beSelected=t,this._beSelected?this.y=GameConst.GAME_ALL_CARD_NODE_POSITION.HAND_CARD[this.dir].y-this.height/2-30:this.y=GameConst.GAME_ALL_CARD_NODE_POSITION.HAND_CARD[this.dir].y-this.height/2},a.prototype.canSelect=function(){return this._canSelect},a.prototype.getHandCardPosition=function(t,e){var a=GameConst.CARD_DATA,i=0,n=0;GameUtils.is3dMode()&&(a=GameConst.CARD_3D_DATA,i=GameConst.CARD_3D_DATA.HAND_CARD[t].offScaleOffy,n=GameConst.CARD_3D_DATA.HAND_CARD[t].offScaleOffx);var o=a.HAND_CARD[t].offx,s=a.HAND_CARD[t].offy,r=a.HAND_CARD[t].gapLastX,l=a.HAND_CARD[t].gapLastY;GlobalData.gameData.isPlayBack()&&(o=a.HAND_CARD[t].playBackOffx,s=a.HAND_CARD[t].playBackOffy,r=a.HAND_CARD[t].gapPlayBackLastX,l=a.HAND_CARD[t].gapPlayBackLastY,GameUtils.is3dMode()&&(i=GameConst.CARD_3D_DATA.HAND_CARD[t].offPlayBackScaleOffy,n=GameConst.CARD_3D_DATA.HAND_CARD[t].offPlayBackScaleOffx)),e=this.cardLayer.getPongKongTotalCardNum(t)+e;var c=o*e,h=s*e;t==GameConst.PLAY_DIR.left&&(s+=GameConst.perPlayerTotalCardNum*-i,h=e*s),e>0&&(h+=e*(e-2)*i/2,c+=e*(e-2)*n/2),GameConst.perPlayerTotalCardNum==e+1&&(c+=r,h+=l);var u=GameConst.GAME_ALL_CARD_NODE_POSITION.HAND_CARD[t].x,d=GameConst.GAME_ALL_CARD_NODE_POSITION.HAND_CARD[t].y;return GameUtils.is3dMode()&&(u=GameConst.GAME_ALL_CARD_NODE_POSITION_3D.HAND_CARD[t].x,d=GameConst.GAME_ALL_CARD_NODE_POSITION_3D.HAND_CARD[t].y),{x:c+u-this.width/2,y:h+d-this.height/2}},a.prototype.showSideCardEffect=function(t){},a.prototype.resetSize=function(t,e){if(GameUtils.is3dMode()){var a=GameConst.CARD_3D_DATA,i=a.HAND_CARD[t].offScale,n=1;GlobalData.gameData.isPlayBack()&&(i=a.HAND_CARD[t].offPlayBackScale,(t==GameConst.PLAY_DIR.left||t==GameConst.PLAY_DIR.right)&&(n=1.16),t==GameConst.PLAY_DIR.right?this.skewX=2:t==GameConst.PLAY_DIR.left&&(this.skewX=-2)),e=this.cardLayer.getPongKongTotalCardNum(t)+e;var o=n;t==GameConst.PLAY_DIR.right?o+=(e-1)*i:t==GameConst.PLAY_DIR.left?o+=(GameConst.perPlayerTotalCardNum-(e-1))*i:t==GameConst.PLAY_DIR.up&&(o+=i),this.scaleX=this.scaleY=o}},a.prototype.resetPosition=function(t,e,a){if(void 0===e&&(e=0),void 0===a&&(a=!1),this.idx=t,GameUtils.is3dMode()&&!a&&GlobalData.gameData.isPlayBack()&&this.dir==GameConst.PLAY_DIR.up){var i=Constants.UI_GAME_CSB_PATH+GameConst.CARD_3D_DATA.HAND_CARD[this.dir].playBackPath,n=this.cardLayer.getPongKongTotalCardNum(this.dir)+t;n=Math.min(n,10),i=Utils.format(i,n),this.skinName=i,this.setCardValue(this.getCardValue()),this.changeCardBack()}this.resetSize(this.dir,t),this.resetLocalZorder(a);var o=this.getHandCardPosition(this.dir,t),s=this.cardLayer.getDrawCardIndex(this.dir);if(t==s?this.showSideCardEffect(!0):this.showSideCardEffect(!1),e>0&&(this._canSelect=!1,this.alpha=1,egret.Tween.removeTweens(this)),e==GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL){var r=egret.Tween.get(this,{loop:!1});r.to({x:o.x,y:o.y},100),r.call(function(){this._canSelect=!0})}else if(e==GameConst.HAND_CARD_ACTION_TYPE.INSERT_DRAW_CARD){var l=0,c=0;GlobalData.gameData.isPlayBack()?this.dir==GameConst.ME_DIR?c=-GameConst.CARD_SIZE.HAND_CARD[this.dir].height_playBack:this.dir==GameConst.PLAY_DIR.up?c=GameConst.CARD_SIZE.HAND_CARD[this.dir].height_playBack:this.dir==GameConst.PLAY_DIR.left?l=GameConst.CARD_SIZE.HAND_CARD[this.dir].width_playBack:this.dir==GameConst.PLAY_DIR.right&&(l=-GameConst.CARD_SIZE.HAND_CARD[this.dir].width_playBack):this.dir==GameConst.ME_DIR?c=-GameConst.CARD_SIZE.HAND_CARD[this.dir].height:this.dir==GameConst.PLAY_DIR.up?c=GameConst.CARD_SIZE.HAND_CARD[this.dir].height:this.dir==GameConst.PLAY_DIR.left?l=GameConst.CARD_SIZE.HAND_CARD[this.dir].width:this.dir==GameConst.PLAY_DIR.right&&(l=-GameConst.CARD_SIZE.HAND_CARD[this.dir].width);var r=egret.Tween.get(this,{loop:!1});r.to({x:this.x+l,y:this.y+c},100),r.to({x:o.x+l,y:o.y+c},100),r.to({x:o.x,y:o.y},100),r.call(function(){this._canSelect=!0})}else if(e==GameConst.HAND_CARD_ACTION_TYPE.DRAW_CARD_ME){this.x=o.x,this.y=o.y-30,this.alpha=.1;var r=egret.Tween.get(this,{loop:!1});r.to({alpha:1,x:o.x,y:o.y},10,egret.Ease.getPowIn(5)),r.call(function(){this._canSelect=!0})}else if(e==GameConst.HAND_CARD_ACTION_TYPE.DRAW_CARD_OTHER){this.x=o.x,this.y=o.y,this.alpha=.1;var r=egret.Tween.get(this,{loop:!1});r.to({alpha:1,x:o.x,y:o.y},50),r.call(function(){this._canSelect=!0})}else this.x=o.x,this.y=o.y},a.prototype.resetLocalZorder=function(t){void 0===t&&(t=!1);var e=this.dir,a=this.idx,i=GameConst.perPlayerTotalCardNum-this.cardLayer.getPongKongTotalCardNum(e),n=this.idx;if(e==GameConst.PLAY_DIR.right)n=i-a,(GlobalData.gameData.isPlayBack()||t)&&(n=0);else if(e==GameConst.PLAY_DIR.up&&GlobalData.gameData.isPlayBack()){var o=this.cardLayer.getPongKongTotalCardNum(e)+a;o>=GameConst.perPlayerTotalCardNum/2&&(n=i-o)}this.parent.setChildIndex(this,n)},a.prototype.resetIdx=function(t){this.idx=t,this.resetLocalZorder()},a.prototype.changeCardFace=function(){this.setCardValue(this.getCardValue())},a}(t.BaseCardNode);t.HandCardNode=e,__reflect(e.prototype,"game.HandCardNode")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this,e.dir,e.cardValue,e.idx)||this;return a.params=e,a.skinName=e.nodePath,a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this);var e=this.getPosition(this.dir,this.idx);this.x=e.x,this.y=e.y,this.resetSize(this.dir,this.params.idx),this.resetLocalZorder(),this.changeCardBack()},e.prototype.getPosition=function(t,e){var a=GameConst.CARD_DATA,i=0,n=0,o=0;GameUtils.is3dMode()?(a=GameConst.CARD_3D_DATA,o=GameConst.CARD_3D_DATA.HUA_CARD[t].offScale,n=GameConst.CARD_3D_DATA.HUA_CARD[t].offScaleOffx,i=GameConst.CARD_3D_DATA.HUA_CARD[t].offScaleOffy):a=GameConst.CARD_DATA;var s=a.HUA_CARD[t].offx,r=a.HUA_CARD[t].offy,l=s*e,c=r*e;e>0&&(c+=e*(e-1)*i/2,l+=e*(e-1)*n/2);var h=GameConst.GAME_ALL_CARD_NODE_POSITION.HUA_CARD[t].x,u=GameConst.GAME_ALL_CARD_NODE_POSITION.HUA_CARD[t].y;return GameUtils.is3dMode()&&(h=GameConst.GAME_ALL_CARD_NODE_POSITION_3D.HUA_CARD[t].x,u=GameConst.GAME_ALL_CARD_NODE_POSITION_3D.HUA_CARD[t].y),{x:l+h-this.width/2,y:c+u-this.height/2}},e.prototype.changeCardFace=function(){if(0!=this._value){var t=this.getCardFaceImgName(this._value);this.face.source=t}},e.prototype.changeCardBack=function(){var t="";if(GameUtils.is3dMode()){var e="";if(this.dir==GameConst.PLAY_DIR.right)e="3d_left_showcard_1{0}_png";else if(this.dir==GameConst.PLAY_DIR.left)e="3d_left_showcard_1{0}_png";else if(this.dir==GameConst.PLAY_DIR.up){var a=1;a=this.idx<=5?this.idx:Math.max(1,10-this.idx+1),e="3d_me_showcard_flower_"+a+"{0}_png"}else if(this.dir==GameConst.PLAY_DIR.down){var a=1;a=this.idx<=5?this.idx:Math.max(1,10-this.idx+1),e="3d_me_showcard_flower_"+a+"{0}_png"}t=GameUtils.getCardBack(e)}else{var e="";this.dir==GameConst.PLAY_DIR.right?e="2dmj_card_side_face{0}_png":this.dir==GameConst.PLAY_DIR.left?e="2dmj_card_side_face{0}_png":this.dir==GameConst.PLAY_DIR.up?e="2dmj_card_top_face{0}_png":this.dir==GameConst.PLAY_DIR.down&&(e="2dmj_card_top_face{0}_png"),t=GameUtils.getCardBack(e)}this.back.source=t},e.prototype.setCardValue=function(e){if(t.prototype.setCardValue.call(this,e),this.changeCardFace(),GameUtils.is3dMode()&&(this.dir==GameConst.PLAY_DIR.up||this.dir==GameConst.PLAY_DIR.down)&&null!=this.face){var a=this.idx+5;this.dir==GameConst.PLAY_DIR.up&&(a=20-a),this.face.rotation=0,this.face.skewX=GameConst.card_face_data_3d_up_down[a],this.dir==GameConst.PLAY_DIR.up&&(this.face.rotation=180)}},e.prototype.resetSize=function(t,e){if(GameUtils.is3dMode()){var a=GameConst.CARD_DATA,i=0;GameUtils.is3dMode()&&(a=GameConst.CARD_3D_DATA,i=GameConst.CARD_3D_DATA.HUA_CARD[t].offScale);var n=1;t==GameConst.PLAY_DIR.right?(this.skewX=-3,n=Math.min(1,1+e*i)):t==GameConst.PLAY_DIR.left?(n=Math.min(1,1+(10-e)*i),this.skewX=3):t==GameConst.PLAY_DIR.up&&(n=i),this.scaleX=this.scaleY=n}},e.prototype.resetLocalZorder=function(){var t=this.dir,e=this.idx;t==GameConst.PLAY_DIR.right?this.parent.setChildIndex(this,0):!GameUtils.is3dMode()||t!=GameConst.PLAY_DIR.down&&t!=GameConst.PLAY_DIR.up||e>=5&&this.parent.setChildIndex(this,0)},e}(t.BaseCardNode);t.HuaCardNode=e,__reflect(e.prototype,"game.HuaCardNode")}(game||(game={}));var game;!function(t){var e=function(t){function e(e,a){var i=t.call(this)||this;return i.dir=e,i.value=a,i.skinName="resource/skins/game/card/OutCardEffectSkin.exml",i}return __extends(e,t),e.prototype.onCreateViewComplete=function(){var e=this;t.prototype.onCreateViewComplete.call(this),this.back.source=GameUtils.getCardBack("2dmj_card_me_stand_1{0}_png"),this.face.source=Utils.format("2dmj_cardnum_mahjong_{0}_png",Utils.getNumberFormatStr(this.value)),this.x=GameConst.CARD_DATA.EFFECT_OUT_CARD[this.dir].x-this.width/2,this.y=GameConst.CARD_DATA.EFFECT_OUT_CARD[this.dir].y-this.height/2;var a=egret.Tween.get(this);a.wait(300),a.to({alpha:0},100),a.call(function(){e.parent.removeChild(e)})},e}(t.EComponent);t.OutCardEffect=e,__reflect(e.prototype,"game.OutCardEffect")}(game||(game={}));var game;!function(t){var e=function(e){function a(a,i,n,o,s){void 0===s&&(s=null);var r=e.call(this,n,i,o)||this;return r.pos=null,r.two_player_back_data=[6,7,8,9,0,1,2,3,4,5,5,4,3,2,1,0,9,8,7,6],r.perLineNum=0,r.maxLine=0,r.floorMaxNum=0,r.idxInLine=0,r.lineIdx=0,r.floorIdx=0,r.skinName=a,t.LogUtils.info("OutCardNode skinName"+r.skinName),r.pos=s,r}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.initData();var t=this.pos;null==this.pos&&(t=this.getOutCardPosition(this.dir,this.idx)),this.x=t.x,this.y=t.y,this.resetSize(this.dir,this.idx),this.resetLocalZorder(),this.changeCardBack(),this.resetCardFace()},a.prototype.resetCardFace=function(){if(GameUtils.is3dMode()&&(this.dir==GameConst.PLAY_DIR.up||this.dir==GameConst.PLAY_DIR.down)&&null!=this.face){var t=GlobalData.gameData.getCurPlayerNum(),e=this.idxInLine;2!=t&&(e=this.idxInLine+5),this.dir==GameConst.PLAY_DIR.up&&(e=GameConst.card_face_data_3d_up_down.length-e),this.face.skewX=GameConst.card_face_data_3d_up_down[e],this.dir==GameConst.PLAY_DIR.up&&(this.face.rotation=180)}},a.prototype.initData=function(){var e=GameConst.CARD_DATA;GameUtils.is3dMode()&&(e=GameConst.CARD_3D_DATA);var a=GlobalData.gameData.getCurPlayerNum();this.perLineNum=e.OUT_CARD[this.dir].perlineNum,this.maxLine=e.OUT_CARD[this.dir].maxLine,2==a&&(this.perLineNum=20,this.maxLine=2),this.floorMaxNum=this.perLineNum*this.maxLine,t.LogUtils.info(Utils.format("getOutCardPosition dir {0},idx {1}",this.dir,this.idx)),this.idxInLine=this.idx%this.perLineNum+1,this.lineIdx=Math.floor(this.idx/this.perLineNum),this.floorIdx=Math.floor(this.lineIdx/this.maxLine),this.lineIdx=this.lineIdx-this.floorIdx*this.maxLine},a.prototype.setCardValue=function(t){e.prototype.setCardValue.call(this,t),this.changeCardFace()},a.prototype.changeCardFace=function(){var t=this.getCardFaceImgName(this._value);this.face.source=t},a.prototype.resetSize=function(t,e){if(GameUtils.is3dMode()){var a=GameConst.CARD_3D_DATA,i=a.OUT_CARD[t].offScale,n=GlobalData.gameData.getCurPlayerNum();GameUtils.is3dMode()&&2==n&&(i=a.OUT_CARD[t].offScale_2_PLAYER);var o=1;t==GameConst.PLAY_DIR.right?o=1+(this.idxInLine-1)*i[0]:t==GameConst.PLAY_DIR.left?o=1+(this.perLineNum-this.idxInLine)*i[0]:t==GameConst.PLAY_DIR.down?o=i[this.lineIdx%this.maxLine]:t==GameConst.PLAY_DIR.up&&(o=i[this.lineIdx%this.maxLine]),this.scaleX=this.scaleY=o}},a.prototype.getOutCardPosition=function(t,e){var a=GameConst.CARD_DATA,i=1,n=0,o=0,s=GlobalData.gameData.getCurPlayerNum();if(GameUtils.is3dMode()){a=GameConst.CARD_3D_DATA;var r=this.lineIdx,l=GameConst.CARD_3D_DATA.OUT_CARD[t].offScale;(t==GameConst.PLAY_DIR.down||t==GameConst.PLAY_DIR.up)&&(2==s&&(l=GameConst.CARD_3D_DATA.OUT_CARD[t].offScale_2_PLAYER),i=l[r%this.maxLine]),n=GameConst.CARD_3D_DATA.OUT_CARD[t].offScaleOffy,o=GameConst.CARD_3D_DATA.OUT_CARD[t].offScaleOffx}var c=a.OUT_CARD[t].secondLineXOff,h=a.OUT_CARD[t].secondLineYOff;2==s&&GameUtils.is3dMode()&&(c=GameConst.CARD_3D_DATA.OUT_CARD[t].secondLineXOff_2_PLAYER,h=GameConst.CARD_3D_DATA.OUT_CARD[t].secondLineYOff_2_PLAYER);var u=a.OUT_CARD[t].offx,d=a.OUT_CARD[t].offy;(t==GameConst.PLAY_DIR.down||t==GameConst.PLAY_DIR.up)&&(u*=i);var m=a.OUT_CARD[t].multiLineXOff,p=a.OUT_CARD[t].multiLineYOff,g=0,C=0,_=0,f=0;this.floorIdx>0&&(g=m*this.floorIdx,C=p*this.floorIdx),this.lineIdx>=1&&(_=c,f=h,GameUtils.is3dMode()&&(this.dir==GameConst.PLAY_DIR.right?(u=-5.5,o=.18):this.dir==GameConst.PLAY_DIR.left&&(u=-5,o=-.12)));var D=0,I=0;D=u*(this.idxInLine-1),I=d*(this.idxInLine-1),D=D+g+_,I=I+C+f,this.idxInLine-1>0&&(I+=(this.idxInLine-1)*(this.idxInLine-2)*n/2,D+=(this.idxInLine-1)*(this.idxInLine-2)*o/2);var b=0,y=0,s=GlobalData.gameData.getCurPlayerNum();return 2==s?(b=GameConst.GAME_ALL_CARD_NODE_POSITION.OUT_CARD_2PLAYERS[t].x,y=GameConst.GAME_ALL_CARD_NODE_POSITION.OUT_CARD_2PLAYERS[t].y,GameUtils.is3dMode()&&(b=GameConst.GAME_ALL_CARD_NODE_POSITION_3D.OUT_CARD_2PLAYERS[t].x,y=GameConst.GAME_ALL_CARD_NODE_POSITION_3D.OUT_CARD_2PLAYERS[t].y)):(b=GameConst.GAME_ALL_CARD_NODE_POSITION.OUT_CARD[t].x,y=GameConst.GAME_ALL_CARD_NODE_POSITION.OUT_CARD[t].y,GameUtils.is3dMode()&&(b=GameConst.GAME_ALL_CARD_NODE_POSITION_3D.OUT_CARD[t].x,y=GameConst.GAME_ALL_CARD_NODE_POSITION_3D.OUT_CARD[t].y)),{x:D+b-this.width/2,y:I+y-this.height/2}},a.prototype.changeCardBack=function(){var e="",a="";if(this.back.scaleX=1,GameUtils.is3dMode()){if(this.dir==GameConst.PLAY_DIR.right)e="3d_left_showcard_1{0}_png",this.back.scaleX=-1;else if(this.dir==GameConst.PLAY_DIR.left)e="3d_left_showcard_1{0}_png";else if(this.dir==GameConst.PLAY_DIR.up){var i=GlobalData.gameData.getCurPlayerNum(),n=this.idxInLine;n=2==i?this.idxInLine:this.idxInLine-1+5,e="3d_me_showcard_flower_"+this.two_player_back_data[20-n]+"{0}_png",t.LogUtils.info("up oriBackName "+e),this.idxInLine<this.perLineNum/2&&(this.back.scaleX=-1)}else if(this.dir==GameConst.PLAY_DIR.down){var i=GlobalData.gameData.getCurPlayerNum(),n=this.idxInLine;n=2==i?this.idxInLine:this.idxInLine-1+5,e="3d_me_showcard_flower_"+this.two_player_back_data[n]+"{0}_png",t.LogUtils.info("down oriBackName "+e),this.idxInLine>=this.perLineNum/2&&(this.back.scaleX=-1)}a=GameUtils.getCardBack(e)}else this.dir==GameConst.PLAY_DIR.right?e="2dmj_card_side_face{0}_png":this.dir==GameConst.PLAY_DIR.left?e="2dmj_card_side_face{0}_png":this.dir==GameConst.PLAY_DIR.up?e="2dmj_card_top_face{0}_png":this.dir==GameConst.PLAY_DIR.down&&(e="2dmj_card_top_face{0}_png"),a=GameUtils.getCardBack(e);this.back.source=a},a.prototype.flagSameValueCard=function(){Utils.setObjColor(this,8842214)},a.prototype.clearFlagSameValueCard=function(){Utils.clearObjColor(this)},a.prototype.resetLocalZorder=function(){var e=this.idx,a=this.dir,i=this.floorIdx;GameUtils.is3dMode()?a==GameConst.PLAY_DIR.right?(e=0,this.lineIdx>0&&(e+=this.perLineNum*this.lineIdx)):(a==GameConst.PLAY_DIR.down||a==GameConst.PLAY_DIR.up)&&(e=this.idxInLine,a==GameConst.PLAY_DIR.down?(e+=this.perLineNum*(this.maxLine-this.lineIdx-1),t.LogUtils.info(Utils.format("idx {0} zorder{1} ",this.idx,e)),this.idxInLine>this.perLineNum/2&&(e=0)):(this.idxInLine>this.perLineNum/2&&(e=0),e+=this.perLineNum*this.lineIdx)):(a==GameConst.PLAY_DIR.down||a==GameConst.PLAY_DIR.right)&&(e=(this.floorMaxNum-i)%this.floorMaxNum),this.idx>=this.floorMaxNum&&(a==GameConst.PLAY_DIR.right?e=this.floorMaxNum:e+=this.floorMaxNum),this.parent.setChildIndex(this,e)},a}(t.BaseCardNode);t.OutCardNode=e,__reflect(e.prototype,"game.OutCardNode")}(game||(game={}));var game;!function(t){var e=function(t){function e(e,a,i,n,o){void 0===o&&(o=null);var s=t.call(this,i,0,n)||this;return s.scale_ori=1,s.skinName=e,s.pongKongData=a,s.pos=o,s}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.childCardNodes=[this.Node1,this.Node2,this.Node3,this.Node4,this.Node5,this.Node6],this.backs=[this.back1,this.back2,this.back3,this.back4,this.back5,this.back6],this.anGangFaces=[this.anGangFace1,this.anGangFace2,this.anGangFace3,this.anGangFace4];for(var e=0;e<this.anGangFaces.length;e++)this.anGangFaces[e].visible=!1;if(this.faces=[this.face1,this.face2,this.face3,this.face4,this.face5,this.face6],this.dir==GameConst.PLAY_DIR.up&&GameUtils.is3dMode())for(var e=0;e<this.faces.length;e++)this.faces[e].rotation=GameConst.top_pongKong_face_rotation[e];var a=this.pos;null==a&&(a=this.getPosition(this.dir,this.idx,this.pongKongData.getProvideClientId())),this.x=a.x,this.y=a.y,this.dir!=GameConst.PLAY_DIR.up&&(this.scale_ori=.9,this.scaleX=this.scaleY=this.scale_ori),this.setData(this.pongKongData),this.pongKongData.getStutre()&&this.flagTwoOrThreeCard(),this.resetSize(this.dir,this.idx),this.resetLocalZorder()},e.prototype.resetSize=function(t,e){if(GameUtils.is3dMode()){var a=GameConst.CARD_3D_DATA,i=a.PONG_KONG_CARD[t].offScale;GlobalData.gameData.isPlayBack()&&(i=a.PONG_KONG_CARD[t].offScale);var n=1;t==GameConst.PLAY_DIR.up?n=i:t==GameConst.PLAY_DIR.left?n=1+(4-e)*i:t==GameConst.PLAY_DIR.right&&(n=1+e*i),this.scaleX=this.scaleY=n*this.scale_ori}},e.prototype.setData=function(t){this.pongKongData=t;var e=t.getType(),a=t.getProvideClientId(),i=t.getValue(),n=[0],o=[],s=(this.dir-a+4)%4;0==s||2==s?(n.push(1),n.push(2),o.push(4),o.push(5)):3==s?(n.push(1),n.push(5),o.push(4),o.push(2)):1==s&&(n.push(4),n.push(2),o.push(1),o.push(5));for(var r=0;r<this.faces.length;r++)this.faces[r].source=this.getCardFaceImgName(i);if(e==GameConst.GAIN_TYPE.PONG){o.push(3);for(var r=0;r<this.anGangFaces.length;r++)this.anGangFaces[r].visible=!1}else if(e==GameConst.GAIN_TYPE.Exposed||e==GameConst.GAIN_TYPE.PongKong||e==GameConst.GAIN_TYPE.ConcealedKong)if(e==GameConst.GAIN_TYPE.ConcealedKong?(n=[0,1,2,3],o=[4,5]):n.push(3),e==GameConst.GAIN_TYPE.ConcealedKong)for(var r=0;r<this.anGangFaces.length;r++)r<this.anGangFaces.length-1?this.anGangFaces[r].visible=!0:this.anGangFaces[r].visible=!1;
else for(var r=0;r<this.anGangFaces.length;r++)this.anGangFaces[r].visible=!1;for(var r=0;r<n.length;r++)this.childCardNodes[n[r]].visible=!0;for(var r=0;r<o.length;r++)this.childCardNodes[o[r]].visible=!1},e.prototype.changeCardFace=function(){this.setData(this.pongKongData)},e.prototype.changeCardBack=function(){if(GameUtils.is3dMode())if(this.dir==GameConst.PLAY_DIR.down||this.dir==GameConst.PLAY_DIR.up)for(var t=0;t<this.childCardNodes.length;t++){var e=GameConst.pongKong_back_img_data[this.dir][this.idx][t];null!=this.backs[t]&&null!=e[0]&&(this.backs[t].source=GameUtils.getCardBack(e[0])),null!=this.anGangFaces[t]&&null!=e[1]&&(this.anGangFaces[t].source=GameUtils.getCardBack(e[1]))}else for(var a="3d_left_pair_1{0}_png",i="3d_left_pair_reverseside_1{0}_png",n="3d_left_pair_dao_1{0}_png",t=0;t<this.childCardNodes.length;t++)null!=this.backs[t]&&(4==t||5==t?this.backs[t].source=GameUtils.getCardBack(n):(this.backs[t].source=GameUtils.getCardBack(a),null!=this.anGangFaces[t]&&(this.anGangFaces[t].source=GameUtils.getCardBack(i))));else{var a="",i="",n="";this.dir==GameConst.PLAY_DIR.right?(a="2dmj_card_side_face{0}_png",i="2dmj_card_side_back{0}_png",n="2dmj_card_top_face{0}_png"):this.dir==GameConst.PLAY_DIR.left?(a="2dmj_card_side_face{0}_png",i="2dmj_card_side_back{0}_png",n="2dmj_card_top_face{0}_png"):this.dir==GameConst.PLAY_DIR.up?(a="2dmj_card_top_face{0}_png",i="2dmj_card_top_back{0}_png",n="2dmj_card_side_face{0}_png"):this.dir==GameConst.PLAY_DIR.down&&(a="2dmj_card_me_face_2{0}_png",i="2dmj_card_me_back_2{0}_png",n="2dmj_card_me_face_dao{0}_png");for(var t=0;t<this.childCardNodes.length;t++)4==t||5==t?this.backs[t].source=GameUtils.getCardBack(n):(this.backs[t].source=GameUtils.getCardBack(a),null!=this.anGangFaces[t]&&(this.anGangFaces[t].source=GameUtils.getCardBack(i)))}},e.prototype.getPosition=function(t,e,a){var i=GameConst.CARD_DATA,n=0,o=0;GameUtils.is3dMode()&&(i=GameConst.CARD_3D_DATA,n=GameConst.CARD_3D_DATA.PONG_KONG_CARD[t].offScaleOffy,o=GameConst.CARD_3D_DATA.PONG_KONG_CARD[t].offScaleOffx);var s=i.PONG_KONG_CARD[t].offx,r=i.PONG_KONG_CARD[t].offy,l=s*e,c=r*e;e>0&&(c+=e*(e-1)*n/2,l+=e*(e-1)*o/2);var h=(this.dir-a)%4;0==h||2==h||(1==h?(l+=i.PONG_KONG_CARD[t].dirOffx,c+=i.PONG_KONG_CARD[t].dirOffy):3==h&&(l-=i.PONG_KONG_CARD[t].dirOffx,c-=i.PONG_KONG_CARD[t].dirOffy));var u=GameConst.GAME_ALL_CARD_NODE_POSITION.PONG_KONG_NODE[t].x,d=GameConst.GAME_ALL_CARD_NODE_POSITION.PONG_KONG_NODE[t].y;return GameUtils.is3dMode()&&(u=GameConst.GAME_ALL_CARD_NODE_POSITION_3D.PONG_KONG_NODE[t].x,d=GameConst.GAME_ALL_CARD_NODE_POSITION_3D.PONG_KONG_NODE[t].y),{x:l+u-this.width/2,y:c+d-this.height/2}},e.prototype.getData=function(){return this.pongKongData},e.prototype.getCardValue=function(){return this.pongKongData.getValue()},e.prototype.flagSameValueCard=function(){for(var t=0;t<this.childCardNodes.length;t++)(this.pongKongData.getType()!=GameConst.GAIN_TYPE.ConcealedKong||5==t)&&Utils.setObjColor(this.childCardNodes[t],8842214)},e.prototype.clearFlagSameValueCard=function(){for(var t=0;t<this.childCardNodes.length;t++)(this.pongKongData.getType()!=GameConst.GAIN_TYPE.ConcealedKong||5==t)&&(this.pongKongData.getStutre()?Utils.setObjColor(this.childCardNodes[t],15312297):Utils.clearObjColor(this.childCardNodes[t]))},e.prototype.flagTwoOrThreeCard=function(){for(var t=0;t<this.childCardNodes.length;t++)(this.pongKongData.getType()!=GameConst.GAIN_TYPE.ConcealedKong||5==t)&&Utils.setObjColor(this.childCardNodes[t],15312297)},e.prototype.ClearTwoOrThreeCard=function(){for(var t=0;t<this.childCardNodes.length;t++)(this.pongKongData.getType()!=GameConst.GAIN_TYPE.ConcealedKong||5==t)&&Utils.clearObjColor(this.childCardNodes[t])},e.prototype.resetLocalZorder=function(){this.dir==GameConst.PLAY_DIR.right&&this.parent.setChildIndex(this,5-this.idx)},e}(t.BaseCardNode);t.PongKongCardNode=e,__reflect(e.prototype,"game.PongKongCardNode")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.value=t,i.x=a.x,i.y=a.y,i.skinName="resource/skins/game/card/PongKongPerNodeSkin.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this);var a=this.getCardFaceImgName(this.value);t.LogUtils.info("faceImgName "+a),this.face.source=a,this.back.source=GameUtils.getCardBack("2dmj_card_me_face_2{0}_png")},a.prototype.getCardFaceImgName=function(e){var a=Utils.format("2dmj_cardnum_mahjong_{0}_png",Utils.getNumberFormatStr(e));return t.LogUtils.info(Utils.format("imgName {0}",a)),GameUtils.getCardFace(a)},a}(t.EComponent);t.PongKongPerNode=e,__reflect(e.prototype,"game.PongKongPerNode")}(game||(game={}));var UploadImg=function(t){function e(){var e=t.call(this)||this;return e.showDelete=!1,e.skinName="resource/skins/game/other/uploadImgSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.imgUpload,this.clickImgUpload),this.addTapEvent(this.imgDefault,this.clickImg),this.addTapEvent(this.btnDelete,this.clickDelete),this.updateUI()},e.prototype.setData=function(t){this.imgData=t,null==t?(this.imgUrl=null,this.imgId=null):(this.imgUrl=this.imgData.img_url,this.imgId=this.imgData.img_id),this.updateUI()},e.prototype.updateUI_=function(){var t=!1;if(this.imgUrl&&this.imgUrl.length>0&&(t=!0),this.imgDefault.visible=t,this.btnDelete.visible=this.showDelete,this.addGroup.visible=!t,t){var e=this;game.ResManager.loadWebImage(this.imgUrl,function(t){e.imgDefault.texture=t,e.imgDefault.addEventListener(eui.UIEvent.COMPLETE,function(){e.imgDefault.texture=t},this)},this)}},e.prototype.clickImgUpload=function(t){this.doSelect(t)},e.prototype.clickImg=function(){this.showDelete=!this.showDelete,this.updateUI()},e.prototype.clickDelete=function(t){this.removeImgReview(t)},e.prototype.doSelect=function(t){selectImage(this.selectedHandler,this)},e.prototype.selectedHandler=function(t,e,a){RES.getResByUrl(e,t.compFunc,t,RES.ResourceItem.TYPE_IMAGE),getImageData(a,t.bytesHandler,t)},e.prototype.bytesHandler=function(t,e){console.log("大图数据:"+e),t.updateLoadImg(e)},e.prototype.compFunc=function(t){this.addGroup.visible=!1,this.imgDefault.visible=!0,this.imgDefault.texture=t},e.prototype.removeImgReview=function(t){game.DialogManager.getInstance().popUp2("确认要删除么?",this.deleteImgHandler.bind(this))},e.prototype.deleteImgHandler=function(){game.GameHttpManager.request(game.GameHttpConst.url_delete_head_img,{user_id:GlobalData.userData.getUserId(),img_id:this.imgId},this.deleteImgHandlerCallBack.bind(this),game.GameHttpConst.SIGNKEY_SOCIAL)},e.prototype.deleteImgHandlerCallBack=function(t){t.status==game.CmdResultType.SUCCESS&&(game.CommonView.showToast("删除成功"),this.showDelete=!1,this.setData(null))},e.prototype.updateLoadImg=function(t){var e=this,a=game.GameHttpConst.SIGNKEY_SOCIAL,i=new game.md5,n=i.hex_md5(GlobalData.userData.getUserId()+a),o=new egret.HttpRequest;o.responseType=egret.HttpResponseType.TEXT,o.setRequestHeader("sign",n),o.setRequestHeader("Content-Type","text/plain"),o.setRequestHeader("user-id",""+GlobalData.userData.getUserId()),o.setRequestHeader("ext","png"),o.addEventListener(egret.Event.COMPLETE,function(t){var a=t.currentTarget;if(null!=a&&null!=a.response){var i=a.response,n=JSON.parse(i);e.imgId=n.img_id,e.imgUrl=n.img_url}},this),o.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){},this),o.addEventListener(egret.ProgressEvent.PROGRESS,function(t){egret.log("post progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")},this),o.open(game.GameHttpConst.url_upload_head_img_in_app,egret.HttpMethod.POST),o.send(t)},e}(game.EComponent);__reflect(UploadImg.prototype,"UploadImg"),window.UploadImg=UploadImg;var game;!function(t){var e=function(t){function e(e){var a=t.call(this,Constants.UI_PANEL_DATA_SET.discardWinConfirmBox.index,!1)||this;return a.params=e,a.skinName="resource/skins/game/panel/AbandomWinConfirm.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.Button_cancel,this.cancelEvent.bind(this)),this.addTapEvent(this.Button_win,this.winEvent.bind(this)),this.updateUI()},e.prototype.cancelEvent=function(){null!=this.params&&this.params.cancelFun&&this.params.cancelFun(),this.close()},e.prototype.winEvent=function(){null!=this.params&&this.params.confirmFunc&&this.params.confirmFunc(),this.close()},e}(t.EDialog);t.AbandomWinConfirmBox=e,__reflect(e.prototype,"game.AbandomWinConfirmBox")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.serverTimeDelta=0,this.eventDispatcher=new egret.EventDispatcher}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.sendNotification=function(t,e){void 0===e&&(e=null),this.notificationAll(t,e)},t.prototype.registerCommand=function(t,e,a){this.eventDispatcher.addEventListener(t,e,a)},t.prototype.removeCommand=function(t,e,a){this.eventDispatcher.removeEventListener(t,e,a)},t.prototype.notificationAll=function(t,e){this.eventDispatcher.dispatchEvent(new egret.Event(t,!1,!1,e))},t.prototype.getNowTime=function(){return(new Date).getTime()+this.serverTimeDelta},t.prototype.updateServerTime=function(t){this.serverTimeDelta=t-(new Date).getTime()},t.prototype.needUpdateServerTime=function(){return 0==this.serverTimeDelta},t.prototype.startUp=function(){},t}();t.EAppFacade=e,__reflect(e.prototype,"game.EAppFacade");var a=function(){function t(t,e){this.fun=t,this.thisObject=e}return t}();__reflect(a.prototype,"valueObject")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.applyQuit.index,!1)||this;return a.leftSeconds=0,a.data=t,a.skinName="resource/skins/game/panel/applyQuitRoom.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.addTapEvent(this.Button_oppose,this.opposeEvent),this.addTapEvent(this.Button_agree,this.agreeEvent),this.updateUI()},a.prototype.init=function(){this.PlayerNodeSet=[this.Player1,this.Player2,this.Player3,this.Player4],this.playerStatus=[this.Text_playerStatus_1,this.Text_playerStatus_2,this.Text_playerStatus_3,this.Text_playerStatus_4],this.playerNames=[this.Text_playerName_1,this.Text_playerName_2,this.Text_playerName_3,this.Text_playerName_4]},a.prototype.setData=function(t){this.data=t,this.updateUI()},a.prototype.updateTimeLabel=function(){var t="";if(this.leftSeconds>59){var e=Math.floor(this.leftSeconds/60),a=this.leftSeconds%60;t=e+"分"+a+"秒"}else t=this.leftSeconds+"秒";this.Text_time.text=Utils.format("倒计时:{0}",t)},a.prototype.startTime=function(){this.stopTimer(),this.timerId=t.TimerItemManager.getInstance().startTimer(t.TimerItem.TimerType.perSec,1e3*this.leftSeconds,this.timerEvent.bind(this),this)},a.prototype.stopTimer=function(){null!=this.timerId&&(t.TimerItemManager.getInstance().stopTimer(this.timerId),this.timerId=null)},a.prototype.timerEvent=function(){this.leftSeconds=Math.max(0,this.leftSeconds-1),this.updateTimeLabel()},a.prototype.updateUI_=function(){var t=this.data;this.leftSeconds=Math.floor(t.leftTime/1e3),this.updateTimeLabel(),this.startTime(),t.statusList.sort(function(t,e){return t.chairId-e.chairId});for(var e=t.statusList,a=0,i=0;i<GameConst.maxPlayerNum;i++)if(i>=e.length)this.PlayerNodeSet[i].visible=!1;else{this.PlayerNodeSet[i].visible=!0;var n=e[i],o=n.chairId,s=n.userName;this.playerNames[i].text=s;var r=n.agree,l=GameConst.APPLY_QUIT_STATUS.unchosen;r&&(l=GameConst.APPLY_QUIT_STATUS.agree,a+=1),this.setStatus(i,o,l)}a>=e.length&&this.close()},a.prototype.setStatus=function(t,e,a){var i=GlobalData.getCurGameData();e==i.getMyChairId()&&(a==GameConst.APPLY_QUIT_STATUS.apply||a==GameConst.APPLY_QUIT_STATUS.agree?this.Button_agree.enabled=!1:this.Button_agree.enabled=!0);var n=this.playerStatus[t];a==GameConst.APPLY_QUIT_STATUS.unchosen?(n.textColor=Utils.RGBA2Color(152,19,19),n.text="未选择"):a==GameConst.APPLY_QUIT_STATUS.apply||a==GameConst.APPLY_QUIT_STATUS.agree?(n.textColor=Utils.RGBA2Color(45,206,64),n.text="同意"):a==GameConst.APPLY_QUIT_STATUS.reject&&(n.textColor=Utils.RGBA2Color(45,206,64),n.text="不同意")},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.CLOSE_APPLY_QUIT_PANEL&&this.close()},a.prototype.agreeEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_DISMISS_ROOM)},a.prototype.opposeEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_REJECT_DISMISS_ROOM)},a.prototype.close=function(){this.stopTimer(),e.prototype.close.call(this)},a}(t.EDialog);t.ApplyQuitBox=e,__reflect(e.prototype,"game.ApplyQuitBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.changePlayerNumBox.index,!1)||this;return a.params=t,a.skinName="resource/skins/game/panel/changePlayerNum.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.Button_reject,this.rejectEvent.bind(this)),this.addTapEvent(this.Button_agree,this.agreeEvent.bind(this)),"0"==GlobalData.clientConfigs.showCreateRoom&&GameConfig.platform==GameConfig.PLATFORM_SET.weChat&&(this.Text_info.visible=!1),this.updateUI()},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.CLOSE_CHANGE_PLAYERNUM_PANEL&&this.close()},a.prototype.updateUI_=function(){var e=this.params,a=e.statusList;a.sort(function(t,e){return t.chairId-e.chairId});for(var i=a.length,n=0,o=0;i>o;o++){var s=this.getChildByName("playHead"+o);null==s&&(s=new t.ChangePlayerNumNode,s.name="playHead"+o,this.Group_head.addChild(s));var r=207*o,l=0;s.x=r,s.y=l;var c=a[o];s.setData(c);var h=c.agree,u=GameConst.CHANGE_PALYER_NUM_STATUS.unchosen;h&&(n+=1,u=GameConst.CHANGE_PALYER_NUM_STATUS.agree);var d=c.chairId;d==GlobalData.gameData.getMyChairId()&&(u==GameConst.CHANGE_PALYER_NUM_STATUS.apply||u==GameConst.CHANGE_PALYER_NUM_STATUS.agree?this.Button_agree.enabled=!1:this.Button_agree.enabled=!0)}n>=i&&this.close()},a.prototype.setData=function(t){this.params=t,this.updateUI_()},a.prototype.rejectEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_switch_reject)},a.prototype.agreeEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_switch_player_num)},a}(t.EDialog);t.ChangePlayerNumBox=e,__reflect(e.prototype,"game.ChangePlayerNumBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.skinName="resource/skins/game/panel/changePlayerNumInfoNode.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init()},a.prototype.init=function(){this.Image_selected.visible=!1},a.prototype.setData=function(t){this.data=t,this.updateUI_()},a.prototype.updateUI_=function(){var e=this,a=this.data,i=(a.chairId,a.userName);this.Text_userName.text=i;var n=a.headImgUrl;t.ResManager.loadWebImage(n,function(t){e.Image_head.texture=t,e.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){e.Image_head.texture=t},e)},this);var o=a.agree,s=GameConst.CHANGE_PALYER_NUM_STATUS.unchosen;o&&(s=GameConst.CHANGE_PALYER_NUM_STATUS.agree),s==GameConst.CHANGE_PALYER_NUM_STATUS.unchosen||s==GameConst.CHANGE_PALYER_NUM_STATUS.reject?this.Image_selected.visible=!1:(s==GameConst.CHANGE_PALYER_NUM_STATUS.apply||s==GameConst.CHANGE_PALYER_NUM_STATUS.agree)&&(this.Image_selected.visible=!0)},a}(t.EComponent);t.ChangePlayerNumNode=e,__reflect(e.prototype,"game.ChangePlayerNumNode")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.checkCheat.index,!1)||this;return t.skinName="resource/skins/game/panel/checkCheatBox.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),Utils.sendPanelEvent(t.GameCmd.CLOSE_CHEAT_STATUS_BOX),this.Image_rotate.rotation=-45;var i=egret.Tween.get(this.Image_rotate);i.to({rotation:675},2e3),i.call(function(){a.checkFinish()})},a.prototype.checkFinish=function(){this.Text_info.text="防作弊扫描检测完成";var t=egret.Tween.get(this);t.wait(1e3),t.call(this.finishFuc)},a.prototype.finishFuc=function(){this.close();var e=GlobalData.getCurGameData();e.setNeedCheckCheat(!1);var a=e.getPreventInfo();null!=a?t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.preventCheat.index,a):Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED)},a}(t.EDialog);t.CheckCheatBox=e,__reflect(e.prototype,"game.CheckCheatBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.chatBox.index)||this;return t.skinName="resource/skins/game/panel/GameChatBoxSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI()},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.CLOSE_CHAT_BOX_PANEL&&this.close()},a.prototype.updateUI_=function(){this.listLeft.clearContent(),this.leftListData=[];for(var t=0;t<GameConst.CHAT_EMOTION_NAME.length;t++){var e=Math.floor(t/3);null==this.leftListData[e]&&(this.leftListData[e]=[]),this.leftListData[e].push({index:t,emotionName:GameConst.CHAT_EMOTION_NAME[t]})}this.listLeft.setScrollerContent(this.leftListData),this.listRight.clearContent();var a=Strings.chatText;GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.standard&&(a=Strings.chatText_standard),this.rightListData=[];for(var t=0;t<a.length;t++)this.rightListData.push({index:t,text:a[t]});this.listRight.setScrollerContent(this.rightListData)},a.prototype.init=function(){this.initLeftScroller(),this.initRightScroller()},a.prototype.initLeftScroller=function(){this.listLeft.setElementViewInfo(114,0),this.listLeft.setElementCreateFunction(this.createLeftElement.bind(this)),this.listLeft.setElementUpdateDataFun(this.updateLeftElement.bind(this)),this.listLeft.setElementUpdateUIFun(this.updateLeftElementUI.bind(this))},a.prototype.createLeftElement=function(e){var a=new t.GameChatEmotionItem(e);return a},a.prototype.updateLeftElement=function(t,e){t.setData(e)},a.prototype.updateLeftElementUI=function(t){t.updateUI()},a.prototype.initRightScroller=function(){this.listRight.setElementViewInfo(60,0),this.listRight.setElementCreateFunction(this.createRightElement.bind(this)),this.listRight.setElementUpdateDataFun(this.updateRightElement.bind(this)),this.listRight.setElementUpdateUIFun(this.updateRightElementUI.bind(this))},a.prototype.createRightElement=function(e){var a=new t.GameChatTextItem(e);return a},a.prototype.updateRightElement=function(t,e){t.setData(e)},a.prototype.updateRightElementUI=function(t){t.updateUI()},a.sendChatMsg=function(e,a){var i=GlobalData.getCurGameData();i.canSendChatMsg()?(i.getGameStatus()!=GameConst.GAME_STATUS_TYPE.allOver&&(i.updateSendChatTime(),t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_SEND_MSG,{type:e,msgId:a})),Utils.sendPanelEvent(t.GameCmd.CLOSE_CHAT_BOX_PANEL)):t.CommonView.showToast(Strings.tooShortTime)},a}(t.EDialog);t.GameChatBox=e,__reflect(e.prototype,"game.GameChatBox")}(game||(game={}));var GameChatEmotion=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/GameChatBoxEmotionSkin.exml",e}return __extends(e,t),e.prototype.setData=function(t){this.data=t,this.setSelected(!1),this.updateUI()},e.prototype.updateUI_=function(){this.Image_emotion.source=this.data.emotionName+"_png"},e.prototype.setSelected=function(t){this.Image_bg.visible=t},e.prototype.sendMsg=function(){game.LogUtils.info("发送表情"+this.data.index),game.GameChatBox.sendChatMsg(GameConst.CHAT_MSG_TYPE.EMOTION,this.data.index+1)},e}(game.EComponent);__reflect(GameChatEmotion.prototype,"GameChatEmotion"),window.GameChatEmotion=GameChatEmotion;var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.itemData=e,a.skinName="resource/skins/game/panel/GameChatBoxEmotionItemSkin.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.emotionSet=[this.emotion1,this.emotion2,this.emotion3];for(var e=0;e<this.emotionSet.length;e++)this.emotionSet[e].addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginEvent,this),this.emotionSet[e].addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchEndEvent,this),this.emotionSet[e].addEventListener(egret.TouchEvent.TOUCH_END,this.touchEndEvent,this),this.emotionSet[e].addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEndEvent,this),this.emotionSet[e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMsg,this);this.updateUI()},e.prototype.sendMsg=function(t){var e=t.currentTarget;e instanceof GameChatEmotion&&e.sendMsg()},e.prototype.touchBeginEvent=function(t){var e=t.currentTarget;e instanceof GameChatEmotion&&e.setSelected(!0)},e.prototype.touchEndEvent=function(t){var e=t.currentTarget;e instanceof GameChatEmotion&&e.setSelected(!1)},e.prototype.setData=function(t){this.itemData=t,this.updateUI()},e.prototype.updateUI_=function(){for(var t=0;t<this.emotionSet.length;t++){var e=this.itemData[t];null==e?this.emotionSet[t].visible=!1:this.emotionSet[t].setData(e)}},e}(t.EComponent);t.GameChatEmotionItem=e,__reflect(e.prototype,"game.GameChatEmotionItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.itemData=t,a.skinName="resource/skins/game/panel/GameChatTextItemSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.setSelected(!1),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchEndEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEndEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEndEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMsg,this),this.updateUI()},a.prototype.sendMsg=function(){t.LogUtils.info("发送文字"+this.itemData.index),t.GameChatBox.sendChatMsg(GameConst.CHAT_MSG_TYPE.TEXT,this.itemData.index+1)},a.prototype.touchBeginEvent=function(){this.setSelected(!0)},a.prototype.touchEndEvent=function(){this.setSelected(!1)},a.prototype.setData=function(t){this.itemData=t,this.updateUI()},a.prototype.updateUI_=function(){this.Text_info.text=this.itemData.text},a.prototype.setSelected=function(t){this.Image_bg.visible=t},a}(t.EComponent);t.GameChatTextItem=e,__reflect(e.prototype,"game.GameChatTextItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){void 0===t&&(t=null);var a=e.call(this,Constants.UI_PANEL_DATA_SET.gameOverBox.index,!1)||this;return a.params=t,a.skinName="resource/skins/game/panel/GameOverResultSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.UserSet=[this.User1,this.User2,this.User3,this.User4],t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_BLESS_SCORE_ONLY),this.getMyBlessCallBack,this),this.addTapEvent(this.Button_back,this.backEvent),this.addTapEvent(this.Button_copyRecord,this.clickedCopyInfo),this.addTapEvent(this.Button_saveImage,this.clickedSaveImage),this.addTapEvent(this.Button_saveUrl,this.clickedCopyURL),this.updateUI()},a.prototype.needShowLuckScore=function(){return(null==this.params||!this.params.isFromReplay)&&GlobalData.gameData.getRoomInfo().isClubRoom()&&"undefined"!=typeof GlobalData.gameData.getAllOverData().showCalNum&&null!=GlobalData.gameData.getAllOverData().showCalNum&&GlobalData.gameData.getRoomInfo().isBlessSwitch()},a.prototype.clickedCopyInfo=function(){for(var e=GlobalData.gameData.getAllOverData(),a="【{0}】{1}\n\n",i=e.clubName,n="",o=e.msgRoom.roomType==Constants.ROOM_TYPE.jinYuanZi?"进园子":"敞开头",s=e.showCalNum,r=0;r<e.userInfoList.length;r++){var l=e.userInfoList[r],c=l.waibaoFen,h="";h="undefined"!=typeof c&&null!=c?s?Utils.format("{0}(ID{1}):\n分数【{2}】外包【{3}】\n记分【{4}】\n",l.userName,l.userId,l.score,l.waibaoFen,l.calNum):Utils.format("{0}(ID{1}):\n分数【{2}】外包【{3}】\n",l.userName,l.userId,l.score,l.waibaoFen):s?Utils.format("{0}(ID{1}):\n分数【{2}】\n记分【{4}】\n",l.userName,l.userID,l.score,l.calNum):Utils.format("{0}(ID{1}):\n分数【{2}】\n",l.userName,l.userID,l.score),n+=h,r<e.userInfoList.length-1&&(n+="--------------------------\n")}a=Utils.format(a,o,e.msgRoom.roomNumber);var u="";u="undefined"!=typeof i&&null!=i?Utils.format("{0}{1}\n{2} {3}",a,n,i,t.DateUtils.dateFormat1(e.time,!1)):Utils.format("{0}{1}\n{2}",a,n,t.DateUtils.dateFormat1(e.time,!1)),Utils.copyToClipboard(u)},a.prototype.clickedSaveImage=function(){var t=this;this.Text_fufen.visible=!1,Utils.captureScreen().then(function(e){t.Text_fufen.visible=t.needShowLuckScore()})},a.prototype.clickedCopyURL=function(){var t=GlobalData.getSettleInfoUrl(GlobalData.gameData.getAllOverData().msgRoom.roomId);Utils.copyToClipboard(t)},a.prototype.share2FriendEvent=function(){var e=new t.ShareOverResultView(GlobalData.gameData.getAllOverData());t.DialogManager.getInstance().show(e)},a.prototype.share2AllEvent=function(){},a.prototype.updateUI_=function(){if(this.Text_fufen.visible=!1,this.needShowLuckScore()){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_BLESS_SCORE_ONLY,{clubId:GlobalData.gameData.getRoomInfo().getClubID()});t.SocketManager.getInstance().send(e)}this.Button_direct2App.visible=!1;var a=GlobalData.gameData.getAllOverData(),i=GlobalData.getSettleInfoUrl(GlobalData.gameData.getAllOverData().msgRoom.roomId);GameUtils.createQrcode(this.Image_qrcode,i),null!=a.clubName?(this.Text_club.visible=!0,this.Text_club.text="俱乐部名称："+a.clubName):this.Text_club.visible=!1,this.Text_roomNumber.text="房间号："+a.msgRoom.roomNumber,this.Text_data.text=t.DateUtils.dateFormat(a.time),a.msgRoom.roomType==Constants.ROOM_TYPE.jinYuanZi?this.text_roomType.text="进园子":a.msgRoom.roomType==Constants.ROOM_TYPE.changKaiTou&&(this.text_roomType.text="敞开头"),a.msgRoom.turnMode==Constants.ROOM_TIME_MODE.ba?this.Text_turnNumber.text=Utils.format("把数：{0}/{1}",a.curTurnNum,a.msgRoom.turnNumber):a.msgRoom.turnMode==Constants.ROOM_TIME_MODE.quan&&(null==a.curTurnDirection?this.Text_turnNumber.text=Utils.format("圈数:{0}/{0}",a.curTurnNum,a.msgRoom.turnNumber):this.Text_turnNumber.text=Utils.format("圈数:{1}/{2} {0}",GameConst.DIRECT_DESC[a.curTurnDirection],a.curTurnNum,a.msgRoom.turnNumber));var n=a.userInfoList;this.title_jifen.visible=a.showCalNum;for(var o=0;o<this.UserSet.length;o++)o>=n.length?(this.UserSet[o].visible=!1,this.UserSet[o].setData(o+1,null,a)):(a.showCalNum?n[o].showCalNum=!0:n[o].showCalNum=!1,this.UserSet[o].visible=!0,n[o].index=o+1,this.UserSet[o].setData(o+1,n[o],a));3==a.liuJuType?this.Text_liujuType.text="协商解散":4==a.liuJuType?this.Text_liujuType.text="超时解散":5==a.liuJuType?this.Text_liujuType.text="会长解散":this.Text_liujuType.text=""},a.prototype.getMyBlessCallBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data;i.clubId==GlobalData.gameData.getRoomInfo().getClubID()&&(this.Text_fufen.visible=!0,this.Text_fufen.text="我的体力："+i.blessNum)}},a.prototype.backEvent=function(){return null!=this.params&&this.params.isFromReplay?void this.close():(this.close(),void(GlobalData.gameData.getRoomInfo().isClubRoom()?t.SceneSkip.skipToClubScene():t.SceneSkip.skipToHallScene()))},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_BLESS_SCORE_ONLY),this.getMyBlessCallBack,this)},a}(t.EDialog);t.GameOverBox=e,__reflect(e.prototype,"game.GameOverBox")}(game||(game={}));var GameOverUserItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/GameOverUserItemSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){var e=this;t.prototype.onCreateViewComplete.call(this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_SIGN_HASVIEW),this.signHasViewCallBack,this),this.addTapEvent(this.btn,function(){var t=game.DomainUtils.getRequestDomain(game.MsgConstant.HALL,game.MsgConstant.CMD_SIGN_HASVIEW,{roomId:e.roomInfo.roomId,userId:e.data.userId,index:e.data.index,clubId:e.roomInfo.clubId});game.SocketManager.getInstance().send(t)})},e.prototype.signHasViewCallBack=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){if(null==this.data)return;var a=e.data,i=a.index,n=a.roomId;if(i==this.data.index){if(n!=this.roomInfo.roomId)return;var o=a.hasView,s=a.hasAllView;this.flagRecord(o),game.EAppFacade.getInstance().sendNotification(game.GameCmd.MODIFY_HAS_VIEW_STATUS,{roomId:n,hasAllView:s})}}},e.prototype.setData=function(t,e,a){this.orderNumner=t,this.data=e,this.allData=a,this.roomInfo=a.msgRoom,null!=this.data&&this.updateUI()},e.prototype.clean=function(){t.prototype.clean.call(this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_SIGN_HASVIEW),this.signHasViewCallBack,this)},e.prototype.flagRecord=function(t){this.allData.canSignHasView?(this.btn.visible=!0,this.Image_flag_record.visible=!t):(this.btn.visible=!1,this.Image_flag_record.visible=!1)},e.prototype.updateUI_=function(){var t=this;this.flagRecord(this.data.hasView),this.Image_applyQuit.visible=!1,this.Image_type.visible=!1,this.Image_applyQuit.source="gameOver_json.over_djs_dismiss_"+this.orderNumner+"_png",1==this.data.dismissStatus?(this.Image_applyQuit.visible=!0,this.Image_type.visible=!0,this.Image_type.source="gameOver_json.over_img_nj_settle_dissolve_agree_png"):2==this.data.dismissStatus&&(this.Image_applyQuit.visible=!0,this.Image_type.visible=!0,this.Image_type.source="gameOver_json.over_img_nj_settle_dissolver_png"),this.Image_bg.source="btn_nj_settle_rankbg_"+this.orderNumner+"_png",this.Image_baomi.visible=this.data.baoMi,this.Image_homer.visible=this.data.master,this.Image_myself.visible=this.data.userId==GlobalData.userData.getUserId(),game.ResManager.loadWebImage(this.data.headImgUrl,function(e){t.Image_head.texture=e,t.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){t.Image_head.texture=e},t)},this),this.Text_userName.text=this.data.userName,this.Text_userId.text="ID:"+this.data.userId,this.data.score>0?(this.Text_score.text="+"+this.data.score,this.Text_score.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_score.text=this.data.score,this.Text_score.textColor=Utils.RGBA2Color(136,180,243)),this.data.waibaoFen>0?(this.Text_score_wb.text="+"+this.data.waibaoFen,this.Text_score_wb.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_score_wb.text=this.data.waibaoFen,this.Text_score_wb.textColor=Utils.RGBA2Color(136,180,243)),null!=this.data.showCalNum&&this.data.showCalNum?(this.Text_count.visible=!0,this.data.calNum>0?(this.Text_count.text="+"+this.data.calNum,this.Text_count.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_count.text=this.data.calNum,this.Text_count.textColor=Utils.RGBA2Color(136,180,243))):this.Text_count.visible=!1},e}(game.EComponent);__reflect(GameOverUserItem.prototype,"GameOverUserItem"),window.GameOverUserItem=GameOverUserItem;var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.GameScoreBoard.index,!1)||this;return t.skinName="resource/skins/game/panel/gameScoreBoard.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.Button_close,this.close.bind(this)),this.initUI(),this.initScroller(),t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_GET_SCORECARD_INFOS)},a.prototype.onEventHandler=function(a){if(e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.UPDATE_GAEMSCORE_BOARD){if(this.scoreBoardData=this.eventData,this.itemListData=[],this.scoreBoardData.length>0)for(var i=0;i<this.scoreBoardData[0].scoreInfos.length;i++){null==this.itemListData[i]&&(this.itemListData[i]={}),this.itemListData[i].order=i+1;
for(var n=0;n<this.scoreBoardData.length;n++){var o=this.scoreBoardData[n].scoreInfos;null==this.itemListData[i].infos&&(this.itemListData[i].infos=[]),null==this.itemListData[i].infos[n]&&(this.itemListData[i].infos[n]={}),this.itemListData[i].infos[n].score=o[i].score,this.itemListData[i].infos[n].waibaoScore=o[i].waibaoScore}}this.updateUI()}},a.prototype.initUI=function(){this.PlayerNameSet=[this.PlayerName1,this.PlayerName2,this.PlayerName3,this.PlayerName4];for(var t in this.PlayerNameSet)this.PlayerNameSet[t].visible=!1;this.totalScoreSet=[this.totalScore1,this.totalScore2,this.totalScore3,this.totalScore4];for(var t in this.totalScoreSet)this.totalScoreSet[t].visible=!1},a.prototype.updateUI_=function(){for(var t in this.scoreBoardData){var e=this.scoreBoardData[t];this.PlayerNameSet[t].visible=!0,this.totalScoreSet[t].visible=!0,this.PlayerNameSet[t].text=e.nickNames,this.totalScoreSet[t].setData(e.totalScores,e.waibaoTotalScores)}this.itemList.clearContent(),this.itemList.setScrollerContent(this.itemListData)},a.prototype.initScroller=function(){this.itemList.setElementViewInfo(72,0),this.itemList.setElementCreateFunction(this.createElement.bind(this)),this.itemList.setElementUpdateDataFun(this.updateElement.bind(this)),this.itemList.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(t){var e=new GameScoreBoardItem(t);return e},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a}(t.EDialog);t.GameScoreBoardBox=e,__reflect(e.prototype,"game.GameScoreBoardBox")}(game||(game={}));var GameScoreBoardItem=function(t){function e(e){var a=t.call(this)||this;return a.itemData=e,a.skinName="resource/skins/game/panel/gameScoreBoardItem.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.scoreSet=[this.score1,this.score2,this.score3,this.score4];for(var e in this.scoreSet)this.scoreSet[parseInt(e)].visible=!1;this.updateUI()},e.prototype.setData=function(t){this.itemData=t,this.updateUI()},e.prototype.updateUI_=function(){this.Text_order.text=this.itemData.order;for(var t in this.itemData.infos){var e=parseInt(t),a=this.itemData.infos[e];this.scoreSet[e].visible=!0,this.scoreSet[e].setData(a.score,a.waibaoScore)}},e}(game.EComponent);__reflect(GameScoreBoardItem.prototype,"GameScoreBoardItem");var GameScoreBoardScoreUnit=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/gameScoreBoardScoreUnit.exml",e}return __extends(e,t),e.prototype.setData=function(t,e){void 0===e&&(e=0),this.score=t,this.score_wb=e,this.updateUI()},e.prototype.updateUI_=function(){this.score>0?(this.Text_score.textColor=Utils.RGBA2Color(255,94,0),this.Text_score.text="+"+this.score):(this.Text_score.textColor=Utils.RGBA2Color(51,102,174),this.Text_score.text=""+this.score),null==this.score_wb||0==this.score_wb?this.Group_wb.visible=!1:(this.Group_wb.visible=!0,this.score_wb>0?this.Text_score_wb.text="+"+this.score_wb:this.Text_score_wb.text=""+this.score_wb)},e}(game.EComponent);__reflect(GameScoreBoardScoreUnit.prototype,"GameScoreBoardScoreUnit"),window.GameScoreBoardScoreUnit=GameScoreBoardScoreUnit;var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.gameSetting.index)||this;return t.skinName="resource/skins/game/panel/GameSettingBox.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI()},a.prototype.init=function(){var e=this;this.addTapEvent(this.Button_close,this.close),this.addTapEvent(this.Button_music_status,function(){var a=t.SoundService.getInstance().getBgMusicSwitch();e.Button_music_status.selected=a,t.SoundService.getInstance().setBgMusicSwitch(!a),a?t.SoundService.getInstance().pauseBgMusic():t.SoundService.getInstance().playMusic(),e.updateMusic()}),this.addTapEvent(this.Button_sound_status,function(){var a=t.SoundService.getInstance().getAudioSwitch();t.SoundService.getInstance().setAudioSwitch(!a),e.updateSound()}),this.addTapEvent(this.Button_flower_status,function(){var a=GlobalData.gameData.getFlowerCardVisible();GlobalData.gameData.setFlowerCardVisible(!a),Utils.sendGameEvent(t.GameCmd.FLOWER_VISIBLE),e.updateFlower()}),this.addTapEvent(this.Button_clickType_status,function(){var t=GlobalData.gameData.getClickCardType();t==GameConst.CLICK_CARD_TYPE.click?t=GameConst.CLICK_CARD_TYPE.doubleClick:t==GameConst.CLICK_CARD_TYPE.doubleClick&&(t=GameConst.CLICK_CARD_TYPE.click),GlobalData.gameData.setClickType(t),e.updateClickCardType()}),this.addTapEvent(this.Group_local,function(){GameConst.sound_type=GameConst.SOUND_TYPE_ENUM.nanjing,DataStorage.writeLocalData(LocalStorage.setting.Sound_type,""+GameConst.sound_type),e.updateLocalLanguage()}),this.addTapEvent(this.Group_standrad,function(){GameConst.sound_type=GameConst.SOUND_TYPE_ENUM.standard,DataStorage.writeLocalData(LocalStorage.setting.Sound_type,""+GameConst.sound_type),e.updateLocalLanguage()}),this.addTapEvent(this.Group_CardBg1,function(){GameConst.card_back_index=0,DataStorage.writeLocalData(LocalStorage.setting.Card_back_index,""+GameConst.card_back_index),Utils.sendGameEvent(t.GameCmd.CHANGE_CARD_BACK),e.updateCardBg()}),this.addTapEvent(this.Group_CardBg2,function(){GameConst.card_back_index=1,DataStorage.writeLocalData(LocalStorage.setting.Card_back_index,""+GameConst.card_back_index),Utils.sendGameEvent(t.GameCmd.CHANGE_CARD_BACK),e.updateCardBg()}),this.addTapEvent(this.Group_CardBg3,function(){GameConst.card_back_index=2,DataStorage.writeLocalData(LocalStorage.setting.Card_back_index,""+GameConst.card_back_index),Utils.sendGameEvent(t.GameCmd.CHANGE_CARD_BACK),e.updateCardBg()}),this.addTapEvent(this.Group_CardFace0,function(){GameConst.card_face_index=0,DataStorage.writeLocalData(LocalStorage.setting.Card_face_index,""+GameConst.card_face_index),Utils.sendGameEvent(t.GameCmd.CHANGE_CARD_FACE),e.updateCardFace()}),this.addTapEvent(this.Group_CardFace1,function(){GameConst.card_face_index=1,DataStorage.writeLocalData(LocalStorage.setting.Card_face_index,""+GameConst.card_face_index),Utils.sendGameEvent(t.GameCmd.CHANGE_CARD_FACE),e.updateCardFace()}),this.addTapEvent(this.Group_Card_mode_0,function(){GameConst.card_mode_index=GameConst.CARD_MODE.mode_2d,DataStorage.writeLocalData(LocalStorage.setting.View_mode,""+GameConst.card_mode_index),Utils.sendGameEvent(t.GameCmd.CHANGE_VIEW_MODE),e.updateViewModeType()}),this.addTapEvent(this.Group_Card_mode_1,function(){GameConst.card_mode_index=GameConst.CARD_MODE.mode_3d,DataStorage.writeLocalData(LocalStorage.setting.View_mode,""+GameConst.card_mode_index),Utils.sendGameEvent(t.GameCmd.CHANGE_VIEW_MODE),e.updateViewModeType()}),this.addTapEvent(this.Group_deskFrame,function(){var a=DataStorage.readLocalData(LocalStorage.setting.Game_bg_frame,"1");"1"==a?DataStorage.writeLocalData(LocalStorage.setting.Game_bg_frame,"0"):DataStorage.writeLocalData(LocalStorage.setting.Game_bg_frame,"1"),Utils.sendGameEvent(t.GameCmd.CHANGE_GAME_BG_FRAME),e.updateDeskFrame()}),this.addTapEvent(this.Group_deskBg1,function(){GameConst.game_bg_index=0,DataStorage.writeLocalData(LocalStorage.setting.Game_bg_index,""+GameConst.game_bg_index),Utils.sendGameEvent(t.GameCmd.CHANGE_GAME_BG),e.updateDeskBg()}),this.addTapEvent(this.Group_deskBg2,function(){GameConst.game_bg_index=1,DataStorage.writeLocalData(LocalStorage.setting.Game_bg_index,""+GameConst.game_bg_index),Utils.sendGameEvent(t.GameCmd.CHANGE_GAME_BG),e.updateDeskBg()}),this.addTapEvent(this.Group_deskBg3,function(){GameConst.game_bg_index=2,DataStorage.writeLocalData(LocalStorage.setting.Game_bg_index,""+GameConst.game_bg_index),Utils.sendGameEvent(t.GameCmd.CHANGE_GAME_BG),e.updateDeskBg()}),this.addTapEvent(this.Group_forbid_emotion,function(){GameConst.forbid_emotion=!GameConst.forbid_emotion,GameConst.forbid_emotion?DataStorage.writeLocalData(LocalStorage.setting.forbid_emotion,"1"):DataStorage.writeLocalData(LocalStorage.setting.forbid_emotion,"0"),e.CheckBox_forbid_emotion.selected=GameConst.forbid_emotion}),this.addTapEvent(this.Group_forbid_voice,function(){GameConst.forbid_voice=!GameConst.forbid_voice,GameConst.forbid_voice?DataStorage.writeLocalData(LocalStorage.setting.forbid_voice,"1"):DataStorage.writeLocalData(LocalStorage.setting.forbid_voice,"0"),e.CheckBox_forbid_voice.selected=GameConst.forbid_voice})},a.prototype.updateUI_=function(){this.updateMusic(),this.updateSound(),this.updateFlower(),this.updateClickCardType(),this.updateLocalLanguage(),this.updateCardBg(),this.updateCardFace(),this.updateDeskFrame(),this.updateDeskBg(),this.updateViewModeType(),this.CheckBox_forbid_emotion.selected=GameConst.forbid_emotion,this.CheckBox_forbid_voice.selected=GameConst.forbid_voice},a.prototype.updateMusic=function(){var e=t.SoundService.getInstance().getBgMusicSwitch();e?this.Button_music_status.selected=!0:this.Button_music_status.selected=!1},a.prototype.updateSound=function(){var e=t.SoundService.getInstance().getAudioSwitch();e?this.Button_sound_status.selected=!0:this.Button_sound_status.selected=!1},a.prototype.updateFlower=function(){var t=GlobalData.gameData.getFlowerCardVisible();t?this.Button_flower_status.selected=!0:this.Button_flower_status.selected=!1},a.prototype.updateClickCardType=function(){var t=GlobalData.gameData.getClickCardType();t==GameConst.CLICK_CARD_TYPE.click?this.Button_clickType_status.selected=!0:t==GameConst.CLICK_CARD_TYPE.doubleClick&&(this.Button_clickType_status.selected=!1)},a.prototype.updateLocalLanguage=function(){GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.nanjing?(this.CheckBox_local.selected=!0,this.CheckBox_standrad.selected=!1):GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.standard&&(this.CheckBox_standrad.selected=!0,this.CheckBox_local.selected=!1)},a.prototype.updateCardBg=function(){this.CheckBox_cardBg_1.selected=0==GameConst.card_back_index,this.CheckBox_cardBg_2.selected=1==GameConst.card_back_index,this.CheckBox_cardBg_3.selected=2==GameConst.card_back_index},a.prototype.updateCardFace=function(){this.CheckBox_cardFace_0.selected=0==GameConst.card_face_index,this.CheckBox_cardFace_1.selected=1==GameConst.card_face_index},a.prototype.updateViewModeType=function(){this.CheckBox_cardMode_0.selected=GameConst.card_mode_index==GameConst.CARD_MODE.mode_2d,this.CheckBox_cardMode_1.selected=GameConst.card_mode_index==GameConst.CARD_MODE.mode_3d,this.Group_deskFrame.visible=GameConst.card_mode_index==GameConst.CARD_MODE.mode_2d},a.prototype.updateDeskFrame=function(){var t=DataStorage.readLocalData(LocalStorage.setting.Game_bg_frame,"1");this.CheckBox_deskFrame.selected="1"==t},a.prototype.updateDeskBg=function(){this.CheckBox_deskBg1.selected=0==GameConst.game_bg_index,this.CheckBox_deskBg2.selected=1==GameConst.game_bg_index,this.CheckBox_deskBg3.selected=2==GameConst.game_bg_index},a}(t.EDialog);t.GameSettingBox=e,__reflect(e.prototype,"game.GameSettingBox")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.data=e,a.skinName="resource/skins/game/panel/GameSettleWinnerFanItemSkin.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.Text_fanSet=[this.Text_fan1,this.Text_fan2,this.Text_fan3],this.Group_fanSet=[this.Group_fan1,this.Group_fan2,this.Group_fan3],this.updateUI()},e.prototype.setData=function(t){this.data=t,this.updateUI()},e.prototype.updateUI_=function(){for(var t=0;t<this.Group_fanSet.length;t++)null==this.data[t]?this.Group_fanSet[t].visible=!1:(this.Group_fanSet[t].visible=!0,this.Text_fanSet[t].text=this.data[t])},e}(t.EComponent);t.GameSettleFanItem=e,__reflect(e.prototype,"game.GameSettleFanItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.GameSettle_auto1.index,!1)||this;if(a.totalCountdownTimeNumber=10,a.curCountdownTime=10,a.overType=-1,a.isWin=!1,a.overData=t,a.overType=-1,a.isWin=!1,0==parseInt(t.winPlayerNum))a.overType=-2;else for(var i=0;i<t.xJSUserInfos.length;i++)if(t.xJSUserInfos[i].msgUser.userId==GlobalData.userData.getUserId()&&(a.isWin=t.xJSUserInfos[i].win,t.xJSUserInfos[i].superPointType>0&&t.xJSUserInfos[i].superPointType<=15)){a.overType=i;break}return-1==a.overType?a.skinName="resource/skins/game/panel/GameSettle_auto1.exml":-2==a.overType?a.skinName="resource/skins/game/panel/GameSettle_auto2.exml":a.overType>=0&&(a.skinName="resource/skins/game/panel/GameSettle_auto3.exml"),a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI()},a.prototype.init=function(){this.UserInfoSet=[this.UserInfo1,this.UserInfo2,this.UserInfo3,this.UserInfo4],this.addTapEvent(this.Button_continue,this.continueEvent),this.addTapEvent(this.Button_quicklook,this.quickLookEvent),this.addTapEvent(this.Button_share,this.shareEvent),this.addTapEvent(this.Button_copyReplayId,this.copyReplayIdEvent.bind(this)),this.curCountdownTime=this.totalCountdownTimeNumber;var t=GlobalData.getShareUrlWithShareCode();GameUtils.createQrcode(this.Image_qrcode,t)},a.prototype.copyReplayIdEvent=function(){console.log("拷贝回放码"+this.overData.replayId),Utils.copyToClipboard(""+this.overData.replayId),console.log("拷贝成功")},a.prototype.timerEventHandler=function(t){var e=t.data;this.curCountdownTime=Math.floor(e.leftTime/1e3),this.updateCountdownTime(),this.curCountdownTime<=0&&(this.overData.roomStatus==GameConst.GAME_STATUS_TYPE.over?this.continueEvent():this.overData.roomStatus==GameConst.GAME_STATUS_TYPE.allOver&&this.quickLookEvent())},a.prototype.updateCountdownTime=function(){this.Text_continue_countdown.text=Utils.format("{0}",this.curCountdownTime),this.Text_quicklook_countdown.text=Utils.format("{0}",this.curCountdownTime)},a.prototype.updateUI_=function(){this.updateCountdownTime();var e=this.overData;if(GlobalData.gameData.isPlayBack())this.Group_quick.visible=!1,this.Group_continue.visible=!1;else{this.startTimer(),this.Group_quick.visible=!1,this.Group_continue.visible=!1;var a=e.roomStatus;a==GameConst.GAME_STATUS_TYPE.over?this.Group_continue.visible=!0:a==GameConst.GAME_STATUS_TYPE.allOver&&(this.Group_quick.visible=!0)}var i=this.isWin;if(null!=this.Image_huType){var n="";-1==this.overType?i?1==e.winType?n="img_nj_settle_wordtitle_zimo_1_png":2==e.winType?n="img_nj_settle_wordtitle_dianhu_1_png":3==e.winType&&(n="img_nj_settle_wordtitle_qianggang_1_png"):1==e.winType?n="img_nj_settle_wordtitle_zimo_2_png":2==e.winType?n="img_nj_settle_wordtitle_dianhu_2_png":3==e.winType&&(n="img_nj_settle_wordtitle_qianggang_2_png"):-2==this.overType&&(n="img_nj_settle_wordtitle_liuju_png"),n.length>0&&(this.Image_huType.source=n)}if(this.overType>=0)this.winnerInfo.setData(e.xJSUserInfos[0],e.bankerChairId),this.Image_title.source=Utils.format("img_nj_settle_wordtitle_{0}_png",e.xJSUserInfos[this.overType].superPointType),this.showWinnerCard(e.xJSUserInfos[0].heapInfos),this.showWinnerScore(e.xJSUserInfos[0]);else if(-1==this.overType){this.showWinnerCard(e.xJSUserInfos[0].heapInfos),this.winnerInfo.setData(e.xJSUserInfos[0],e.bankerChairId),this.showWinnerScore(e.xJSUserInfos[0]);for(var o=1;o<this.UserInfoSet.length;o++){var s=o-1;if(o>=e.xJSUserInfos.length)this.UserInfoSet[s].visible=!1;else{this.UserInfoSet[s].visible=!0;var r=this.getHeadFlagValue(s,e.xJSUserInfos[o].win);this.UserInfoSet[s].setData(e.xJSUserInfos[o],r)}}}else if(-2==this.overType){var l=e.liuJuType;4==l&&(l=1),this.Image_title.source=Utils.format("img_nj_settle_liujutitle_{0}_png",l);for(var o=0;o<this.UserInfoSet.length;o++)if(o>=e.xJSUserInfos.length)this.UserInfoSet[o].visible=!1;else{this.UserInfoSet[o].visible=!0;var r=this.getHeadFlagValue(o,e.xJSUserInfos[o].win);this.UserInfoSet[o].setData(e.xJSUserInfos[o],r)}}this.Text_date.text=t.DateUtils.dateFormat(e.time),this.Text_replayId.text=""+e.replayId,null!=e.msgRoom&&null!=e.msgRoom.clubName?(this.Text_clubName.visible=!0,this.Text_clubName.text=Utils.format("俱乐部名称：{0}",e.msgRoom.clubName)):this.Text_clubName.visible=!1},a.prototype.showWinnerCard=function(e){if(null!=e){var a=0,i=.7;this.Group_winner_card.scaleX=i,this.Group_winner_card.scaleY=i;for(var n=!1,o=0;o<e.length;o++){var s=e[o],r=s.gain;if(r){var l=GameConst.GAIN_TYPE.PONG;4==s.tileIds.length&&(l=0==s.direction?GameConst.GAIN_TYPE.ConcealedKong:GameConst.GAIN_TYPE.Exposed);var c={type:l,provideClientId:s.direction,value:s.tileIds[0]},h=new t.PongKongData(c),u=Constants.UI_GAME_CSB_PATH+GameConst.CARD_DATA.PONG_KONG_CARD[GameConst.ME_DIR].path,d=240;(s.direction==GameConst.ME_DIR||s.direction==GameConst.PLAY_DIR.up)&&(d=230,a-=10),s.direction==GameConst.PLAY_DIR.right?(d=240,a-=10):s.direction==GameConst.PLAY_DIR.left&&(d=230);var m={x:a,y:0},p=new t.PongKongCardNode(u,h,GameConst.ME_DIR,0,m);this.Group_winner_card.addChild(p),a+=d,a+=5,n=!0}else{for(var g=0;g<s.tileIds.length;g++){var u=Constants.UI_GAME_CSB_PATH+GameConst.CARD_DATA.OUT_CARD[GameConst.ME_DIR].path;n&&(n=!1,a+=10);var m={x:a,y:0},C=new t.PongKongPerNode(s.tileIds[g],m);this.Group_winner_card.addChild(C),a+=74}a+=5}}}},a.prototype.showWinnerScore=function(t){this.Text_winner_score.text="+"+t.curScore;var e=t.faScore;0!=e?(this.Group_winner_fafen.visible=!0,t.faScore>0?this.Text_winner_fafen.text="+"+t.faScore:this.Text_winner_fafen.text=""+t.faScore):this.Group_winner_fafen.visible=!1;var a=t.waibaoScore;0!=a?(this.Group_winner_wb.visible=!0,t.waibaoScore>0?this.Text_winner_wb.text="+"+t.waibaoScore:this.Text_winner_wb.text=""+t.waibaoScore):this.Group_winner_wb.visible=!1},a.prototype.getHeadFlagValue=function(t,e){var a={genhu:!1,sanbao:!1,doublekill:!1,bankerChairId:this.overData.bankerChairId};1!=t&&this.overData.winPlayerNum>1&&e&&(a.genhu=!0);var i=this.overData.xJSUserInfos[t].curScore;return 1!=t&&0>i&&this.overData.baoPai&&(a.sanbao=!0),1!=t&&this.overData.winPlayerNum>1&&0>i&&(a.doublekill=!0),a},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.CLOSE_GAME_SETTLE_PANEL&&(this.close(),GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.playing&&(GlobalData.gameData.setGameStatus(GameConst.GAME_STATUS_TYPE.waiting),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED)))},a.prototype.quickLookEvent=function(){this.close();var e=GlobalData.gameData.getAllOverData();null!=e&&(t.GameDataService.getInstance().isGameOverTimeOut=!0,t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.gameOverBox.index))},a.prototype.continueEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_READY_FOR_NEXT)},a.prototype.shareEvent=function(){Utils.captureScreen()},a.prototype.startTimer=function(){this.stopTimer(),this.tickScheduler=t.TimerItemManager.getInstance().startTimer(t.TimerItem.TimerType.perSec,1e3*this.totalCountdownTimeNumber,this.timerEventHandler,this)},a.prototype.stopTimer=function(){null!=this.tickScheduler&&(t.TimerItemManager.getInstance().stopTimer(this.tickScheduler),this.tickScheduler=null)},a.prototype.close=function(){this.stopTimer(),e.prototype.close.call(this)},a}(t.EDialog);t.GameSettleNormal=e,__reflect(e.prototype,"game.GameSettleNormal")}(game||(game={}));var GameSettleUserInfo=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/GameSette_UserInfoSkin.exml",e}return __extends(e,t),e.prototype.setData=function(t,e){this.data=t,this.bankerChairId=e.bankerChairId,this.sanbao=e.sanbao,this.doublekill=e.doublekill,this.genhu=e.genhu,this.updateUI()},e.prototype.updateUI_=function(){var t=this;game.ResManager.loadWebImage(this.data.msgUser.headImgUrl,function(e){t.Image_head.texture=e,t.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){t.Image_head.texture=e},t)},this),this.Image_myself.visible=GlobalData.userData.getUserId()==this.data.msgUser.userId,this.Image_homer.visible=!1,this.Image_banker.visible=this.bankerChairId==this.data.userChairId,this.Text_userName.text=this.data.msgUser.nickName,this.data.curScore>0?(this.Text_score.text="+"+this.data.curScore,this.Text_score.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_score.text=this.data.curScore,this.Text_score.textColor=Utils.RGBA2Color(136,180,243)),this.data.faScore>0?(this.Text_fafen.text="+"+this.data.faScore,this.Text_fafen.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_fafen.text=this.data.faScore,this.Text_fafen.textColor=Utils.RGBA2Color(136,180,243)),this.data.waibaoScore>0?(this.Text_wb.text="+"+this.data.waibaoScore,this.Text_wb.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_wb.text=this.data.waibaoScore,this.Text_wb.textColor=Utils.RGBA2Color(136,180,243)),this.Image_sanbao.visible=this.sanbao,this.Image_yipaoduoxiang.visible=this.doublekill,this.Image_genhu.visible=this.genhu,this.showCard(this.data.heapInfos)},e.prototype.showCard=function(t){if(null!=t){var e=0,a=.6;this.cardGroup.scaleX=a,this.cardGroup.scaleY=a;for(var i=!1,n=0;n<t.length;n++){var o=t[n],s=o.gain;if(s){var r=GameConst.GAIN_TYPE.PONG;4==o.tileIds.length&&(r=0==o.direction?GameConst.GAIN_TYPE.ConcealedKong:GameConst.GAIN_TYPE.Exposed);var l={type:r,provideClientId:o.direction,value:o.tileIds[0]},c=new game.PongKongData(l),h=Constants.UI_GAME_CSB_PATH+GameConst.CARD_DATA.PONG_KONG_CARD[GameConst.ME_DIR].path,u=240;(o.direction==GameConst.ME_DIR||o.direction==GameConst.PLAY_DIR.up)&&(u=230,e-=10),o.direction==GameConst.PLAY_DIR.right?(u=240,e-=10):o.direction==GameConst.PLAY_DIR.left&&(u=230);var d={x:e,y:0},m=new game.PongKongCardNode(h,c,GameConst.ME_DIR,0,d);this.cardGroup.addChild(m),e+=u,e+=5,i=!0}else{for(var p=0;p<o.tileIds.length;p++){var h=Constants.UI_GAME_CSB_PATH+GameConst.CARD_DATA.OUT_CARD[GameConst.ME_DIR].path;i&&(i=!1,e+=10);var d={x:e,y:0},g=new game.PongKongPerNode(o.tileIds[p],d);this.cardGroup.addChild(g),e+=74}e+=5}}}},e}(game.EComponent);__reflect(GameSettleUserInfo.prototype,"GameSettleUserInfo"),window.GameSettleUserInfo=GameSettleUserInfo;var GameSettleWinerInfo=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/GameSettleWinerInfoSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.initScroller()},e.prototype.initScroller=function(){this.FanList.setElementViewInfo(33,2),this.FanList.setElementCreateFunction(this.createElement.bind(this)),this.FanList.setElementUpdateDataFun(this.updateElement.bind(this)),this.FanList.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.GameSettleFanItem(t);return e},e.prototype.updateElement=function(t,e){t.setData(e)},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.setData=function(t,e){if(this.data=t,this.bankerChairId=e,this.fanListData=[],null!=this.data.winTypeInfos)for(var a=0;a<this.data.winTypeInfos.length;a++){var i=Math.floor(a/3);null==this.fanListData[i]&&(this.fanListData[i]=[]);var n=this.data.winTypeInfos[a],o=n.name+" "+n.desc;this.fanListData[i].push(o)}this.updateUI()},e.prototype.updateUI_=function(){var t=this;game.ResManager.loadWebImage(this.data.msgUser.headImgUrl,function(e){t.Image_head.texture=e,t.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){t.Image_head.texture=e},t)},this),this.Image_myself.visible=GlobalData.userData.getUserId()==this.data.msgUser.userId,this.Image_homer.visible=!1,this.Image_banker.visible=this.bankerChairId==this.data.userChairId,this.Text_userName.text=this.data.msgUser.nickName,this.FanList.clearContent(),this.FanList.setScrollerContent(this.fanListData)},e}(game.EComponent);__reflect(GameSettleWinerInfo.prototype,"GameSettleWinerInfo"),window.GameSettleWinerInfo=GameSettleWinerInfo;var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.params=t,a.skinName="resource/skins/game/panel/personInfo.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI(),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnChargeRecord,this.getChargeRecord),this.addTapEvent(this.btn_bind_phone,this.btnBindPhoneClicked),this.addTapEvent(this.btn_bind_identity,this.btnBindIdClicked),t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_PERSON_AGAINS),t.EAppFacade.getInstance().registerCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this),this.rqsData()},a.prototype.rqsData=function(){t.GameHttpManager.request(t.GameHttpConst.url_get_head_img_data,{user_id:GlobalData.userData.getUserId()},this.rqsDataCallBack.bind(this),t.GameHttpConst.SIGNKEY_SOCIAL)},a.prototype.rqsDataCallBack=function(e){var a=e;if(a.code==t.CmdResultType.SUCCESS){var e=a.data;this.imgData=e,this.updateAllHeadImg()}},a.prototype.updateAllHeadImg=function(){this.socialImg1.setData(this.imgData[0]),this.socialImg2.setData(this.imgData[1])},a.prototype.updateDiamondNum=function(){this.Text_diamond.text=""+this.params.getDiamondNum()},a.prototype.updateGoldNum=function(){this.Text_gold.text=""+this.params.getGoldNum()},a.prototype.onEventHandler=function(a){if(e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.PLAY_SINGLE_MESSAGE){var i=this.eventData;this.Text_yestodayNum.text=i.yesterday.gameTotal,this.Text_yestoday_ratio.text=i.yesterday.successRate+"%",this.Text_todayNum.text=i.today.gameTotal,this.Text_today_ratio.text=i.today.successRate+"%"}},a.prototype.init=function(){this.addTapEvent(this.Button_history,this.showHistoryBox.bind(this))},a.prototype.showHistoryBox=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.todayRecords.index)},a.prototype.updateUI_=function(){var e=this;this.updateDiamondNum(),this.updateGoldNum(),this.Text_userName.text=this.params.getUserName(),this.Text_userId.text="ID:"+this.params.getUserId(),this.Text_ip.text="IP:"+this.params.getIP(),this.Text_phone.text=egret.Capabilities.os;var a=this.params.getGender()==Constants.GENDER.man;a?this.Image_gender.source="item_male_png":this.Image_gender.source="item_female_png",t.ResManager.loadWebImage(this.params.getHeadIMGUrl(),function(t){e.Image_head.texture=t,e.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){e.Image_head.texture=t},e)},this)},a.prototype.getChargeRecord=function(){var e=new t.ChargeRecordDialog;t.DialogManager.getInstance().show(e)},a.prototype.btnBindPhoneClicked=function(){var e=new t.BindPhoneBox(GlobalData.userData.getBindPhoneNumber());t.DialogManager.getInstance().show(e)},a.prototype.btnBindIdClicked=function(){var e=new t.BindIdentityBox(GlobalData.userData.getIdentityCardNumber());t.DialogManager.getInstance().show(e)},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this),e.prototype.clean.call(this)},a}(t.EDialog);t.PersonalInfoBox=e,__reflect(e.prototype,"game.PersonalInfoBox")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.index=e,a.skinName="resource/skins/game/panel/personalInfoPointEmotion.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.init()},e.prototype.init=function(){this.Image_emotion.source="img_personal_item_"+this.index+"_png",this.Text_gold.text=""+GameConst.POINT_EMOTION_PRICE[this.index-1]},e.prototype.getIndex=function(){return this.index},e.prototype.setSelected=function(t){},e}(t.EComponent);t.PersonalInfoEmotion=e,__reflect(e.prototype,"game.PersonalInfoEmotion")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.params=t,a.skinName="resource/skins/game/panel/personInfoOtherSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI()},a.prototype.onEventHandler=function(a){if(e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.UPDATE_PLAYER_POSITION){if(null==this.params)return;var i,n=this.params.getChairId(),o=GlobalData.getCurGameData();if(i=o.getPlayer(n),null!=i){var s=i.getDetailAddress();this.updateAddress(s)}}},a.prototype.init=function(){for(var e=0;8>e;e++){var a=new t.PersonalInfoEmotion(e+1),i=135*(e%5),n=122*Math.floor(e/5);a.x=i,a.y=n,this.emotionGroup.addChild(a),a.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),a.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),a.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchCancel,this),a.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchCancel,this)}this.addTapEvent(this.btnClose,this.close)},a.prototype.touchBegin=function(t){var e=t.currentTarget;e.getIndex();e.setSelected(!0)},a.prototype.touchCancel=function(t){var e=t.currentTarget;e.setSelected(!1)},a.prototype.touchEnd=function(e){var a=e.currentTarget,i=a.getIndex();a.setSelected(!1);var n=!1;t.SceneManager.getInstance().isInGame()&&(n=this.sendData(i)),n&&this.close()},a.prototype.sendData=function(e){var a=GameConst.POINT_EMOTION_PRICE[e-1];return a>GlobalData.userData.getGoldNum()?(t.CommonView.showToast(Strings.goldNotEnough),!1):GameConst.forbid_emotion?(t.DialogManager.getInstance().popUp1("您已屏蔽道具功能，可在右上角设置里重新启用。"),!1):(GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.allOver&&t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_SEND_MSG_ANI,{toChairId:this.params.getChairId(),msgId:e}),!0)},a.prototype.updateUI_=function(){var e=this;this.Text_userName.text=this.params.getUserName(),this.Text_userId.text="ID:"+this.params.getUserId(),this.Text_ip.text="IP:"+this.params.getIP();var a=this.params.getGender()==Constants.GENDER.man;a?this.Image_gender.source="item_male_png":this.Image_gender.source="item_female_png";var i=this.params.getDetailAddress();this.updateAddress(i),t.ResManager.loadWebImage(this.params.getHeadIMGUrl(),function(t){e.Image_head.texture=t,e.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){e.Image_head.texture=t},e)},this)},a.prototype.updateAddress=function(t){(null==t||0==t.length)&&(t="无法获取定位"),this.Text_location.text=t},a}(t.EDialog);t.PersonalInfoOtherBox=e,__reflect(e.prototype,"game.PersonalInfoOtherBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.preventCheat.index,!1,.3)||this;return a.params=t,a.skinName="resource/skins/game/panel/preventCheatSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),Utils.sendPanelEvent(t.GameCmd.CLOSE_CHEAT_STATUS_BOX),this.addTapEvent(this.Button_quit,this.clickQuitEvent),this.addTapEvent(this.Button_continue,this.clickContinueEvent),this.addTapEvent(this.Button_dissolve,this.clickDissolveEvent),this.userSet=[this.user1,this.user2,this.user3];var a=GlobalData.getCurGameData(),i=a.getRoomInfo().isClubRoom(),n=a.getRoomInfo().getPayMode()==Constants.ROOM_PAY_MODE.other,o=a.isMeCreator();!o||n||i?(this.Button_dissolve.visible=!1,this.Button_quit.visible=!0):(this.Button_dissolve.visible=!0,this.Button_quit.visible=!1),this.updateUI()},a.prototype.updateUI_=function(){for(var t=this.params,e=t.juliUserInfo,a=0;a<this.userSet.length;a++){var i=e[a],n=this.userSet[a];null!=i?(n.visible=!0,n.setData(i)):n.visible=!1}var o=e.length;if(2==o){var s=144;this.userSet[0].x=GameConfig.ScreenW/2-s/2-80,this.userSet[1].x=GameConfig.ScreenW/2-s/2+80}},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.CLOSE_CHEAT_INFO_BOX&&(this.close(),Utils.sendGameEvent(t.GameCmd.CHECK_CHEAT_STATUS))},a.prototype.clickDissolveEvent=function(){var e=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_CANCEL_ROOM)
},a=Strings.dismissRoom;"0"==GlobalData.clientConfigs.showCreateRoom&&GameConfig.platform==GameConfig.PLATFORM_SET.weChat&&(a="是否确认解散房间?"),t.DialogManager.getInstance().popUp2(a,e)},a.prototype.clickQuitEvent=function(){var e=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_LEAVE_ROOM)},a=Strings.exitRoom;t.DialogManager.getInstance().popUp2(a,e)},a.prototype.clickContinueEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_IGNORE_CHEAT)},a}(t.EDialog);t.PreventCheatBox=e,__reflect(e.prototype,"game.PreventCheatBox")}(game||(game={}));var preventCheatNode=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/preventCheatNodeSkin.exml",e}return __extends(e,t),e.prototype.setData=function(t){this.data=t,this.updateUI()},e.prototype.updateUI_=function(){var t=this;this.Text_userName.text=this.data.nickName,game.ResManager.loadWebImage(this.data.headImgUrl,function(e){t.Image_head.texture=e,t.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){t.Image_head.texture=e},t)},this)},e}(game.EComponent);__reflect(preventCheatNode.prototype,"preventCheatNode"),window.preventCheatNode=preventCheatNode;var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.preventCheatStatusBox.index,!1)||this;return t.skinName="resource/skins/game/panel/PreventCheatStatusBox.exml",t}return __extends(a,e),a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),(this.eventId==t.GameCmd.CLOSE_CHEAT_INFO_BOX||this.eventId==t.GameCmd.CLOSE_CHEAT_STATUS_BOX)&&this.close()},a}(t.EDialog);t.PreventCheatStatusBox=e,__reflect(e.prototype,"game.PreventCheatStatusBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.roomInfoBox.index)||this;return t.skinName="resource/skins/game/panel/RoomInfoBoxSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI()},a.prototype.init=function(){"0"==GlobalData.clientConfigs.showCreateRoom&&GameConfig.platform==GameConfig.PLATFORM_SET.weChat&&(this.Text_payModeTitle.visible=!1,this.Text_payMode.visible=!1),this.addTapEvent(this.Button_close,this.close),this.addTapEvent(this.Button_rules,this.showRulesBox)},a.prototype.showRulesBox=function(){var e=new t.RuleDialog;t.DialogManager.getInstance().show(e)},a.prototype.updateUI_=function(){var t=GlobalData.gameData.getRoomInfo();this.Text_roomNumber.text=""+t.getRoomNum(),this.Text_turnNumber.text=t.getTurnNumber()+t.getTurnModeDesc(),this.Text_payMode.text=t.getPayModeDesc(),this.Text_roomType.text=t.getRoomTypeDesc(),this.Text_rules.text=t.getRulesDesc(),this.Text_bixiahu.text="庄家连庄，接庄比，流局，包牌，大胡（清一色，混一色，对对胡，全球独钓，七对，杠后开花，天胡，地胡、压绝、无花果）、花杠、罚分、一炮多响"},a}(t.EDialog);t.RoomInfoBox=e,__reflect(e.prototype,"game.RoomInfoBox")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this,Constants.UI_PANEL_DATA_SET.wechatShare.index)||this;return e.skinName="resource/skins/game/panel/ShareBoxSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.init()},e.prototype.init=function(){this.addTapEvent(this.Button_close,this.close.bind(this)),this.addTapEvent(this.Button_share2friend,this.share2FriendEvent.bind(this)),this.addTapEvent(this.Button_share2Group,this.share2GroupEvent.bind(this))},e.prototype.share2FriendEvent=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return t="测试",[2]})})},e.prototype.share2GroupEvent=function(){},e}(t.EDialog);t.ShareBox=e,__reflect(e.prototype,"game.ShareBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.skinName="resource/skins/game/panel/todayRecords.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_PERSON_TOTAL_AGAINS)},a.prototype.onEventHandler=function(a){if(e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.PLAY_TOTAL_MESSAGE){var i=this.eventData;if(i.length<=0)return void(this.emptyGroup.visible=!0);this.emptyGroup.visible=!1,this.listData=i.userAgainsRecord,this.totalData=i.totalAgainsRecord,this.updateUI()}},a.prototype.updateUI_=function(){this.recordList.clearContent(),this.recordList.setScrollerContent(this.listData),this.Text_allGameDraw.text=this.totalData.gameDraw,this.Text_mvpTimes.text=this.totalData.winHome,this.Text_allGameFail.text=this.totalData.gameFail,this.Text_allGameWin.text=this.totalData.gameWin,this.Text_allGameTotal.text=this.totalData.gameTotal},a.prototype.init=function(){this.addTapEvent(this.Button_close,this.close.bind(this)),this.initScroller()},a.prototype.initScroller=function(){this.recordList.setElementViewInfo(60,2),this.recordList.setElementCreateFunction(this.createElement.bind(this)),this.recordList.setElementUpdateDataFun(this.updateElement.bind(this)),this.recordList.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(e){var a=new t.TodayRecordsItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a}(t.EDialog);t.TodayRecordsBox=e,__reflect(e.prototype,"game.TodayRecordsBox")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.itemData=e,a.skinName="resource/skins/game/panel/todayRecordsItem.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.setData=function(t){this.itemData=t,this.updateUI()},e.prototype.updateUI_=function(){this.Text_time.text=this.itemData.playTime,this.Text_today_num.text=this.itemData.gameTotal,this.Text_winNum.text=this.itemData.gameWin,this.Text_lose.text=this.itemData.gameFail,this.Text_draw.text=this.itemData.gameDraw,this.Text_winner.text=this.itemData.winHome},e}(t.EComponent);t.TodayRecordsItem=e,__reflect(e.prototype,"game.TodayRecordsItem")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this,Constants.UI_PANEL_DATA_SET.advert.index)||this;return a.params=e,a.skinName="resource/skins/hall/advertBoxSkin.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.tab(this.params.type),this.addTapEvent(this.Button_close,this.close.bind(this))},e.prototype.tab=function(t){this.Group_advert.visible=!1,this.Group_public.visible=!1,1==t?(this.Group_advert.visible=!0,this.Text_wx.text=GlobalData.clientConfigs.investment_info,this.addTapEvent(this.Button_copy,this.copyInvestment.bind(this))):2==t&&(this.Group_public.visible=!0,this.Text_public_name.text=GlobalData.clientConfigs.weixin_mp_name,this.addTapEvent(this.Button_copy_public,this.copyPublic.bind(this)))},e.prototype.copyInvestment=function(){Utils.copyToClipboard(this.Text_wx.text)},e.prototype.copyPublic=function(){Utils.copyToClipboard(this.Text_public_name.text)},e}(t.EDialog);t.AdvertBox=e,__reflect(e.prototype,"game.AdvertBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.BindIdentityBox.index)||this;return a.m_IdNumber=t,a.skinName="resource/skins/hall/BindIdentityBox.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),this.input_id.maxChars=18,this.input.visible=""==this.m_IdNumber,this.disable.visible=""!=this.m_IdNumber,this.addTapEvent(this.btn_confirm,this.onConfirmClicked),this.addTapEvent(this.btn_close,function(){t.EAppFacade.getInstance().removeCommand("panel",a.onEventHandler,a),t.DialogManager.getInstance().close(a)})},a.prototype.onConfirmClicked=function(){var e=this.input_name.text;if(0==e.length)return void t.CommonView.showToast("请输入您的姓名");var a=this.input_id.text;return 0==a.length?void t.CommonView.showToast("请输入18位身份证号码"):void t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_USER_BINDIDENTITY,{userName:e,idCardNo:a})},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.USER_BIND_ID&&(t.CommonView.showToast("绑定成功"),GlobalData.userData.setIdentityCardNumber(a.data.data.idCardNo),t.EAppFacade.getInstance().removeCommand("panel",this.onEventHandler,this),t.DialogManager.getInstance().close(this))},a}(t.EDialog);t.BindIdentityBox=e,__reflect(e.prototype,"game.BindIdentityBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.bindPhoneBox.index)||this;return a.currentTime=60,a.m_bPhoneNum=t,a.skinName="resource/skins/hall/BindPhoneBox.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;if(e.prototype.onCreateViewComplete.call(this),this.input_phoneNumber.restrict="0-9",this.input_phoneNumber.maxChars=11,this.input.visible="undefined"==typeof this.m_bPhoneNum||null==this.m_bPhoneNum,this.change.visible=!("undefined"==typeof this.m_bPhoneNum)&&null!=this.m_bPhoneNum,"undefined"!=typeof this.m_bPhoneNum){var i=this.m_bPhoneNum,n=i.length,o=i.substr(0,3)+"*****"+i.substr(n-3,3);this.phoneNumber.text="手机号："+o}this.addTapEvent(this.btn_getCode,this.onGetCodeClicked),this.addTapEvent(this.btn_confirm,this.onConfirmClicked),this.addTapEvent(this.btn_changeBind,this.onChangeBindClicked),this.addTapEvent(this.btn_close,function(){t.EAppFacade.getInstance().removeCommand("panel",a.onEventHandler,a),t.DialogManager.getInstance().close(a)})},a.prototype.onGetCodeClicked=function(){var e=this.input_phoneNumber.text;return 0==e.length?void t.CommonView.showToast("请输入手机号"):void t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_USER_GETBINDSMSCODE,{phoneNumber:e})},a.prototype.onConfirmClicked=function(){var e=this.input_phoneNumber.text;if(0==e.length)return void t.CommonView.showToast("请输入手机号");var a=this.input_code.text;return 0==a.length?void t.CommonView.showToast("请输入验证码"):void t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_USER_BINDPHONENUMBER,{phoneNumber:e,code:a})},a.prototype.onChangeBindClicked=function(){this.m_bPhoneNum=null,this.input.visible="undefined"==typeof this.m_bPhoneNum||null==this.m_bPhoneNum,this.change.visible=!("undefined"==typeof this.m_bPhoneNum)&&null!=this.m_bPhoneNum},a.prototype.onEventHandler=function(a){var i=this;e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.USER_BINDPHONENUMBER?(t.CommonView.showToast("绑定成功"),GlobalData.userData.setPhoneNumber(a.data.data.phoneNumber),t.EAppFacade.getInstance().removeCommand("panel",this.onEventHandler,this),t.DialogManager.getInstance().close(this)):this.eventId==t.GameCmd.USER_GETBINDSMSCODE&&(this.btn_getCode.enabled=!1,this.timer.text="60",this.timerTrigger=new egret.Timer(1e3,0),this.timerTrigger.addEventListener(egret.TimerEvent.TIMER,function(){i.currentTime--,i.timer.text=""+i.currentTime,i.currentTime<=0&&(i.btn_getCode.enabled=!0,i.timer.text="",i.timerTrigger.stop())},this),this.timerTrigger.start())},a}(t.EDialog);t.BindPhoneBox=e,__reflect(e.prototype,"game.BindPhoneBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.contentType=0,t.skinName="resource/skins/hall/feedbackDialogSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.editPhoneNumber.inputType=egret.TextFieldInputType.TEL,this.editPhoneNumber.restrict="0-9",this.addTapEvent(this.btnFeedback,this.feedback),this.addTapEvent(this.radio1,this.clickRadio1),this.addTapEvent(this.radio2,this.clickRadio2),this.addTapEvent(this.radio3,this.clickRadio3),this.radio1.setText("建议"),this.radio2.setText("问题"),this.radio3.setText("其它"),this.updateUI()},a.prototype.updateUI_=function(){this.radio1.setSelected(0==this.contentType),this.radio2.setSelected(1==this.contentType),this.radio3.setSelected(2==this.contentType)},a.prototype.clickRadio1=function(){this.contentType=0,this.updateUI()},a.prototype.clickRadio2=function(){this.contentType=1,this.updateUI()},a.prototype.clickRadio3=function(){this.contentType=2,this.updateUI()},a.prototype.feedback=function(){var e=this.editContent.text.trim();if(e.length<=0)return void t.CommonView.showToast("请输入您宝贵的意见或者建议");var a=this.editPhoneNumber.text.trim();return a.length>0&&11!=a.length?void t.CommonView.showToast("请输入11位数字的手机号码"):void t.GameHttpManager.feeback(GlobalData.userData.getUserId(),this.contentType,e,a,this.feedbackBack.bind(this))},a.prototype.feedbackBack=function(e){var a=e,i=a;i.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("信息反馈成功，非常感谢~"),this.close())},a}(t.EDialog);t.FeedbackDialog=e,__reflect(e.prototype,"game.FeedbackDialog")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.SCENE_INDEX.MAIN)||this;return t.skinName="resource/skins/hall/hallSceneSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClub,this.clickClub),this.addTapEvent(this.btnCreateRoom,this.clickCreateRoom),this.addTapEvent(this.btnJoinRoom,this.clickJoinRoom),this.addTapEvent(this.btnZhanJi,this.clickZhanji),this.addTapEvent(this.btnStore,this.clickStore),this.addTapEvent(this.btnWanFa,this.clickWanFa),this.addTapEvent(this.btnTask,this.clickTask),this.addTapEvent(this.btnActive,this.clickActive),this.addTapEvent(this.btnSetting,this.clickSetting),this.addTapEvent(this.btnMail,this.clickMail),this.addTapEvent(this.Group_head,this.showPersonInfoEvent),this.addTapEvent(this.btnBuyDiamond,this.showDiamondShopBox),this.addTapEvent(this.btnBuyGold,this.showGoldShopBox),this.addTapEvent(this.Button_share,this.showShareBoxEvent),"0"==GlobalData.clientConfigs.showCreateRoom&&GameConfig.platform==GameConfig.PLATFORM_SET.weChat?(this.Button_agent.visible=!1,this.Button_public.visible=!1):(this.addTapEvent(this.Button_agent,this.showAdvertAgent.bind(this)),this.addTapEvent(this.Button_public,this.showAdvertPublic.bind(this))),this.updateUI(),this.checkAutoInGame(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.UPDATE_MAIL_TIP,this.updateMailTip,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.UPDATE_TASK_TIP,this.updateTaskTip,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_Activity_ShowType),this.getActivityShowTypeBack,this),t.GlobalService.getInstance().activityHasShow||(t.GlobalService.getInstance().activityHasShow=!0,t.ActivityService.getInstance().getActivityShowType()),this.createStaticAnimation(),t.CommonView.showBroadcast(),t.SoundService.getInstance().playMusic("bg_mp3")},a.prototype.onShow=function(){e.prototype.onShow.call(this),t.CommonView.showBroadcast()},a.prototype.createStaticAnimation=function(){var t=RES.getRes("golen_ske_json"),e=RES.getRes("golen_tex_json"),a=RES.getRes("golen_tex_png"),i=dragonBones.EgretFactory.factory;null==i.getDragonBonesData("golden")&&(i.parseDragonBonesData(t),i.parseTextureAtlasData(e,a));var n=i.buildArmatureDisplay("golden");n.x=770,n.scaleX=1.2,n.scaleY=1.2,n.y=39,n.animation.play(),this.addChild(n),t=RES.getRes("diamond_ske_json"),e=RES.getRes("diamond_tex_json"),a=RES.getRes("diamond_tex_png"),i=dragonBones.EgretFactory.factory,null==i.getDragonBonesData("diamond")&&(i.parseDragonBonesData(t),i.parseTextureAtlasData(e,a)),n=i.buildArmatureDisplay("diamond"),n.x=516,n.scaleX=1.2,n.scaleY=1.2,n.y=39,n.animation.play(),this.addChild(n)},a.prototype.showDiamondShopBox=function(){var e=new t.ShopScene(1);t.DialogManager.getInstance().show(e)},a.prototype.showGoldShopBox=function(){var e=new t.ShopScene(2);t.DialogManager.getInstance().show(e)},a.prototype.showShareBoxEvent=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return platform.shareWithImg("新华网出品，南京名嘴秦岭、查老倾情献声，邀您来组局了！","index.html","https://res.qixiyx.cn/file/share.jpg","key1=1&key2=2"),[2]})})},a.prototype.showAdvertAgent=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.advert.index,{type:1})},a.prototype.showAdvertPublic=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.advert.index,{type:2})},a.prototype.showPersonInfoEvent=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.personInfo.index,GlobalData.userData)},a.prototype.updateDiamondNum=function(){this.labelDiamond.text=""+GlobalData.userData.getDiamondNum()},a.prototype.updateGoldNum=function(){this.labelGold.text=""+GlobalData.userData.getGoldNum()},a.prototype.updateMailTip=function(){this.imgMailTip.visible=t.GlobalService.getInstance().mailTip},a.prototype.updateTaskTip=function(){this.imgTaskTip.visible=t.GlobalService.getInstance().hasTaskTip()},a.prototype.checkAutoInGame=function(){var e=GlobalData.userData.getRoomNumber();if(0!=e){var a={roomNumber:e};t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,a)}else if(0!=GlobalData.platformRoomNumber){var a={roomNumber:GlobalData.platformRoomNumber};t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,a)}GlobalData.userData.setRoomNumber(0),GlobalData.platformRoomNumber=0},a.prototype.updateUI_=function(){var e=t.UserInfoService.getInstance().getUserInfo();this.updateDiamondNum(),this.updateGoldNum(),this.labelNickName.text=e.getUserName(),this.labelUserId.text="ID:"+e.getUserId(),this.headLoadComplete(),this.updateMailTip()},a.prototype.headLoadComplete=function(){var e=this,a=GlobalData.userData.getHeadIMGUrl();t.ResManager.loadWebImage(a,function(t){e.imgPerson.texture=t,e.imgPerson.addEventListener(eui.UIEvent.COMPLETE,function(){e.imgPerson.texture=t},e)},this)},a.prototype.clickClub=function(){GameConfig.platform==GameConfig.PLATFORM_SET.H5?t.SceneSkip.skipToClubScene():"0"==GlobalData.clientConfigs.showClubRoom?t.DialogManager.getInstance().popUp1("更多功能下载app体验"):t.SceneSkip.skipToClubScene()},a.prototype.clickCreateRoom=function(){if("0"==GlobalData.clientConfigs.showCreateRoom&&GameConfig.platform==GameConfig.PLATFORM_SET.weChat){var e={};e.roomType=Constants.ROOM_TYPE.jinYuanZi,e.roomScore=100,e.turnMode=0,e.turnNumber=8,e.payMode=Constants.ROOM_PAY_MODE.AA,e.huaZa=!0,e.faFen=!0,e.jieZhuangBi=!0,e.calNum=0,e.autoHost=!0,e.baoMi=!1,e.free=!0,t.RoomService.getInstance().createRoom(e)}else{var a=DataStorage.readLocalData(DataStorageConst.DATA_KEY_DECLARE_CREATE_ROOM),i=new t.CreateRoomDialog(null);if(t.DialogManager.getInstance().show(i,t.EDialog.show_ani_type_null),""==a||"undefined"==a||"true"!=a){var n=new t.CreateRoomDeclareView;t.DialogManager.getInstance().show(n)}}},a.prototype.clickJoinRoom=function(){var e=new t.JoinRoomDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickZhanji=function(){var e=new t.ZhanJiDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickStore=function(){var e=new t.ShopScene(null);t.DialogManager.getInstance().show(e)},a.prototype.clickWanFa=function(){var e=new t.RuleDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickTask=function(){var e=new t.TaskDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickActive=function(){var e=new t.ActivityDialog(t.GlobalService.getInstance().activityShowType);t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickSetting=function(){var e=new t.SettingDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickMail=function(){var e=new t.MailDialog;t.DialogManager.getInstance().show(e)},a.prototype.getActivityShowTypeBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=i.showType;if(t.GlobalService.getInstance().activityShowType=n,n>0){var o=new t.ActivityDialog(n);t.DialogManager.getInstance().show(o)}}},a.prototype.clean=function(){t.CommonView.hideBroadcast(),t.EAppFacade.getInstance().removeCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.UPDATE_MAIL_TIP,this.updateMailTip,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.UPDATE_TASK_TIP,this.updateTaskTip,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_Activity_ShowType),this.getActivityShowTypeBack,this),e.prototype.clean.call(this)},a}(t.SceneBase);t.HallScene=e,__reflect(e.prototype,"game.HallScene")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.setting.index)||this;return t.skinName="resource/skins/hall/settingDialogSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.versionCode.text="当前版本:"+GameConfig.version,this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.toggleMusic,this.switchBgMusic),this.addTapEvent(this.toggleSound,this.switchSound),this.addTapEvent(this.btnChangeAccount,this.switchAccount),this.addTapEvent(this.btnFeedback,this.clickFeedback),this.updateUI()},a.prototype.updateUI_=function(){this.labelNickName.text=t.UserInfoService.getInstance().getUserInfo().getUserName();var e=t.UserInfoService.getInstance().getUserInfo().getHeadIMGUrl(),a=this;t.ResManager.loadWebImage(e,function(t){a.imgPerson.texture=t,a.imgPerson.addEventListener(eui.UIEvent.COMPLETE,function(){a.imgPerson.texture=t},this)},this),this.updateUI_BgMusic(),this.updateUI_Sound()},a.prototype.updateUI_BgMusic=function(){var e=t.SoundService.getInstance().getBgMusicSwitch();this.toggleMusic.selected=e},a.prototype.updateUI_Sound=function(){var e=t.SoundService.getInstance().getAudioSwitch();this.toggleSound.selected=e},a.prototype.switchBgMusic=function(){t.SoundService.getInstance().setBgMusicSwitch(!t.SoundService.getInstance().getBgMusicSwitch()),this.updateUI_BgMusic(),t.SoundService.getInstance().getBgMusicSwitch()?t.SoundService.getInstance().playMusic():t.SoundService.getInstance().pauseBgMusic()},a.prototype.switchSound=function(){t.SoundService.getInstance().setAudioSwitch(!t.SoundService.getInstance().getAudioSwitch()),this.updateUI_Sound(),t.SoundService.getInstance().getAudioSwitch()||t.SoundService.getInstance().stopAllAudio()},a.prototype.switchAccount=function(){t.DialogManager.getInstance().popUp2("是否注销当前账号",function(){null!=t.CommonView.broadcast&&t.CommonView.broadcast.clearAllData(),DataStorage.removeLocalData(DataStorageConst.DATA_KEY_UnionId),t.ConnectService.getInstance().stopTimer(),t.ConnectService.getInstance().close(),GlobalData.userData.cleanUser(),t.SceneSkip.skipToLoginScene(),t.GlobalService.init()})},a.prototype.clickFeedback=function(){var e=new t.FeedbackDialog;t.DialogManager.getInstance().show(e)},a}(t.EDialog);t.SettingDialog=e,__reflect(e.prototype,"game.SettingDialog")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.gameActivity.index)||this;return a.noticeList=[],a.activityList=[],a.curDataList=[],a.showType=1,a.showType=t,a.skinName="resource/skins/hall/activity/gameActivitySkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLICK_activity_ITEM,this.clickActivityItem,this),this.addTapEvent(this.imgTab1,this.changeTab1),this.addTapEvent(this.imgTab2,this.changeTab2),this.initScroller(),this.getContentList(),this.changeTab1()},a.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(58,10),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.getContentList=function(){t.GameHttpManager.getActivityList(this.getContentListBack.bind(this))},a.prototype.updateUI_=function(){var e=0==this.showType;if(this.imgTab1.alpha=e?1:0,this.imgTab2.alpha=e?0:1,this.curDataList&&this.scrollerTables.setScrollerContent(this.curDataList),this.selectItemData)if(this.contentRect.visible=!0,this.labelEmpty.text="",0==this.selectItemData.contentDetailType){this.groupText.visible=!1,this.imgContent.visible=!0;var a=this;t.ResManager.loadWebImage(this.selectItemData.content,function(t){a.imgContent.texture=t,a.imgContent.addEventListener(eui.UIEvent.COMPLETE,function(){a.imgContent.texture=t},this)},this)}else this.groupText.visible=!0,this.imgContent.visible=!1,this.labelContentTitle.text=this.selectItemData.contentTitle,this.labelContent.text=this.selectItemData.content;else this.labelContentTitle.text="",this.contentRect.visible=!1,this.labelContent.text="",this.labelEmpty.text=0==this.showType?"暂无公告消息哦~":"暂无活动哦~"},a.prototype.clickActivityItem=function(t){this.selectItemData=t.data,this.updateCurTabItems(),this.updateUI()},a.prototype.updateCurTabItems=function(){for(var t=this.curDataList.length,e=0;t>e;e++)this.curDataList[e].selected=this.curDataList[e]==this.selectItemData},a.prototype.getContentListBack=function(e){this.labelEmpty;var a=e,i=a;if(i.code==t.CmdResultType.SUCCESS){var n=i.data,o=n.contentItems;this.noticeList=[],this.activityList=[];for(var s in o){var r=o[s],l=new t.ActivityItemData(r);0==l.contentType?this.noticeList.push(l):this.activityList.push(l)}this.changeTab(this.showType)}},a.prototype.changeTab1=function(){this.changeTab(0)},a.prototype.changeTab2=function(){this.changeTab(1)},a.prototype.changeTab=function(t){this.showType=t,0==t?this.curDataList=this.noticeList:this.curDataList=this.activityList,this.selectItemData=null,this.curDataList.length>0&&(this.selectItemData=this.curDataList[0],this.updateCurTabItems()),this.updateUI()},a.prototype.createElement=function(e){var a=new t.ActivityItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLICK_activity_ITEM,this.clickActivityItem,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ActivityDialog=e,__reflect(e.prototype,"game.ActivityDialog")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.activityItemData=t,a.skinName="resource/skins/hall/activity/activityItemSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.tab1,this.clickItem),this.updateUI()},a.prototype.setData=function(t){this.activityItemData=t,this.updateUI()},a.prototype.clickItem=function(){t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_activity_ITEM,this.activityItemData)},a.prototype.updateUI_=function(){null!=this.activityItemData&&(this.tab1.selected=this.activityItemData.selected,this.labelTab1.text=this.activityItemData.title,this.tab1.selected?(this.labelTab1.strokeColor=12279105,this.labelTab1.textColor=16777215):(this.labelTab1.strokeColor=16045731,this.labelTab1.textColor=8412465))},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.ActivityItem=e,__reflect(e.prototype,"game.ActivityItem")}(game||(game={}));var game;!function(t){var e=function(){function t(t){this.selected=!1,this.json=t,this.parse()}return t.prototype.parse=function(){this.title=this.json.title,this.contentTitle=this.json.contentTitle,this.content=this.json.content,this.contentDetailType=this.json.contentDetailType,this.contentType=this.json.contentType,this.openGameType=this.json.openGameType,this.startDateTime=this.json.startDateTime,this.endDateTime=this.json.endDateTime,this.functionName=this.json.functionName,this.eventContent=this.json.eventContent},t}();t.ActivityItemData=e,__reflect(e.prototype,"game.ActivityItemData")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getActivityShowType=function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_Activity_ShowType,null);t.SocketManager.getInstance().send(e)},e}();t.ActivityService=e,__reflect(e.prototype,"game.ActivityService")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.mailAttachData=t,a.skinName="resource/skins/hall/mail/mailAttachItemSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.updateUI()},a.prototype.updateUI_=function(){null!=this.mailAttachData&&(this.labelNum.text="x"+this.mailAttachData.itemNum,this.imgIcon.source=t.ConstantUtils.getItemIconName(this.mailAttachData.itemType))},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.MailAttachItem=e,__reflect(e.prototype,"game.MailAttachItem")}(game||(game={}));var game;!function(t){var e=function(){function t(t){this.selected=!1,this.json=t,this.parse()}return t.prototype.parse=function(){this.emailId=this.json.emailId,this.emailTitle=this.json.emailTitle,this.emailContent=this.json.emailContent,this.emailStatus=this.json.emailStatus,this.emailType=this.json.emailType,this.emailTypeName=this.json.emailTypeName,this.createTime=this.json.createTime,this.emailTypeName=this.json.emailTypeName,this.attachStatus=this.json.attachStatus,this.attachInfos=this.json.attachInfos,this.validSec=this.json.validSec},t.prototype.getAttachItems=function(){if(this.attachInfos){var t=JSON.parse(this.attachInfos);return t}return[]},t}();t.MailData=e,__reflect(e.prototype,"game.MailData")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.selectTabIndex=1,t.skinName="resource/skins/hall/mail/mailDialogSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnGet,this.getMailAttach),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_EMAIL_LIST),this.getMailListBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_DRAW_EMAIL_ATTACH),this.getMailAttachBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_VIEW_EMAIL),this.viewMailBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLICK_MAIL_ITEM,this.clickMailItem,this),this.initScroller(),this.getMailList()},a.prototype.updateUI_=function(){if(this.groupMailDetail.visible=!1,this.labelNoSelected.visible=!1,this.mailList&&this.mailList.length>0){this.scrollerTables.setScrollerContent(this.mailList,!1);var e=this.selectItemData;if(this.selectItemData){this.groupMailDetail.visible=!0,this.labelMailTitle.text=this.selectItemData.emailTitle,this.labelMailTime.text=this.selectItemData.validSec,this.labelMailContent.text=this.selectItemData.emailContent;var a=this.selectItemData.getAttachItems();if(a&&a.length>0){this.btnGet.visible=0==e.attachStatus,this.labelHasGeted.visible=!this.btnGet.visible,this.groupAttach.visible=!0,this.groupAttachItems.removeChildren();for(var i=a.length,n=0;i>n;n++){var o=new t.MailAttachItem(a[n]);
o.x=o.width*n+10*n,this.groupAttachItems.addChild(o)}}else this.groupAttach.visible=!1}else this.labelNoSelected.visible=!0,this.labelNoSelected.text="请选择一封邮件"}else this.labelNoSelected.text="暂无任何邮件哦~",this.labelNoSelected.visible=!0},a.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(104,8),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(e){var a=new t.MailItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.getMailList=function(){t.MailService.getInstance().getMailList()},a.prototype.getMailListBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=i.emailInfos;i.needTip;this.mailList=[];for(var o in n){var s=n[o],r=new t.MailData(s);this.mailList.push(r)}this.updateUI()}},a.prototype.clickMailItem=function(t){this.selectItemData=t.data,this.selectItemData.emailStatus=1,this.updateCurTabItems(),this.updateUI()},a.prototype.updateCurTabItems=function(){for(var t=this.mailList.length,e=0;t>e;e++)this.mailList[e].selected=this.mailList[e]==this.selectItemData},a.prototype.getMailAttach=function(){this.selectItemData&&t.MailService.getInstance().getMailAttach(this.selectItemData.emailId)},a.prototype.getMailAttachBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=i.needTip;t.GlobalService.getInstance().setMailTip(n);var o=i.emailId,s=i.attachInfos;this.updateMailAttachInfo(o,s),this.updateUI(),t.CommonView.showToast("领取成功")}},a.prototype.updateMailAttachInfo=function(t,e){for(var a=this.mailList.length,i=0;a>i;i++)if(this.mailList[i].emailId==t){this.mailList[i].attachInfos=e,this.mailList[i].attachStatus=1;break}},a.prototype.viewMailBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=i.needTip;t.GlobalService.getInstance().setMailTip(n)}},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_EMAIL_LIST),this.getMailListBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_DRAW_EMAIL_ATTACH),this.getMailAttachBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_VIEW_EMAIL),this.viewMailBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLICK_MAIL_ITEM,this.clickMailItem,this),e.prototype.clean.call(this)},a}(t.EDialog);t.MailDialog=e,__reflect(e.prototype,"game.MailDialog")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.mailData=t,a.skinName="resource/skins/hall/mail/mailItemSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.rect,this.clickItem),this.updateUI()},a.prototype.setData=function(t){this.mailData=t,this.updateUI()},a.prototype.updateUI_=function(){if(null!=this.mailData){this.labelTitle.text=this.mailData.emailTypeName,this.labelTime.text=t.DateUtils.dateFormat1(this.mailData.createTime,!1),this.imgBg.source=this.mailData.selected?"bg_mail_selected_png":"bg_mail_png";var e=this.mailData.emailStatus,a=this.mailData.attachStatus;this.imgStatus.visible=!1,this.mailData.attachInfos?0==e?(this.imgStatus.visible=!0,this.imgStatus.source="img_not-read_png"):0==a&&(this.imgStatus.visible=!0,this.imgStatus.source="img_not-receive_png"):0==e?(this.imgStatus.visible=!0,this.imgStatus.source="img_not-read_png"):this.imgStatus.visible=!1}},a.prototype.clickItem=function(){t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_MAIL_ITEM,this.mailData),t.MailService.getInstance().viewMail(this.mailData.emailId)},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EComponent);t.MailItem=e,__reflect(e.prototype,"game.MailItem")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.Mail_Type={NULL:0,System:1,Activity:2}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getMailList=function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_EMAIL_LIST,null);t.SocketManager.getInstance().send(e)},e.prototype.getMailAttach=function(e){var a={emailId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_DRAW_EMAIL_ATTACH,a);t.SocketManager.getInstance().send(i)},e.prototype.viewMail=function(e){var a={emailId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_VIEW_EMAIL,a);t.SocketManager.getInstance().send(i)},e}();t.MailService=e,__reflect(e.prototype,"game.MailService")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getDiamondCostNum=function(e,a,i,n,o){var s=t.getKey(a,i,n,o);return e[s]},t.getDiamondCostNums=function(){var e={};return e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,4)]=10,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,8)]=10,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,12)]=20,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,16)]=20,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,1)]=10,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,2)]=10,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,3)]=20,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,4)]=20,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,4)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,8)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,12)]=80,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,16)]=80,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,1)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,2)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,3)]=80,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,4)]=80,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,4)]=25,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,8)]=35,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,12)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,16)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,1)]=35,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,2)]=45,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,3)]=60,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,4)]=60,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,4)]=10,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,8)]=10,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,12)]=20,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,16)]=20,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,1)]=10,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,2)]=10,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,3)]=20,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,4)]=20,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,4)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,8)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,12)]=80,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,16)]=80,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,1)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,2)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,3)]=80,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,4)]=80,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,4)]=25,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,8)]=35,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,12)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,16)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,1)]=35,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,2)]=45,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,3)]=60,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,4)]=60,e},t.getKey=function(t,e,a,i){return"key_"+t+"_"+e+"_"+a+"_"+i},t}();t.CreateRoomCost=e,__reflect(e.prototype,"game.CreateRoomCost")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this,null,!1)||this;return e.skinName="resource/skins/hall/room/createRoomDeclareView.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){var e=this;t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,function(){DataStorage.writeLocalData(DataStorageConst.DATA_KEY_DECLARE_CREATE_ROOM,"true"),e.close()}),this.updateUI()},e.prototype.updateUI_=function(){},e.prototype.clean=function(){t.prototype.clean.call(this)},e}(t.EDialog);t.CreateRoomDeclareView=e,__reflect(e.prototype,"game.CreateRoomDeclareView")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.create_room.index)||this;return a.clubId=null,a.clubId=t,a.skinName="resource/skins/hall/room/createRoomDialogSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnCreate,this.clickCreateRoom),this.panelMahjong.setClubId(this.clubId),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CREATE_ROOM),this.createRoomCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_createTemplate),this.addRuleCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.diamondChange,this),this.updateUI()},a.prototype.updateUI_=function(){this.labelDiamond.text=""+GlobalData.userData.getDiamondNum()},a.prototype.clickCreateRoom=function(){var e=this.panelMahjong.getAdjustRoomInfo();this.clubId?t.ClubRuleService.getInstance().addRule(this.clubId,e):t.RoomService.getInstance().createRoom(e)},a.prototype.createRoomCallBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS?(this.panelMahjong.saveLocalRoomInfo(),this.close()):a.errorCode==t.MsgConstant.ERROR_diamondNoEnough&&t.CommonView.showToast("创建房间钻石不够了")},a.prototype.addRuleCallBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS?this.close():a.errorCode==t.MsgConstant.ERROR_template_top_limit&&t.CommonView.showToast("房间规则已达到上限，不能再增加")},a.prototype.diamondChange=function(){var t=GlobalData.userData.getDiamondNum();this.labelDiamond.text=""+t},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CREATE_ROOM),this.createRoomCallBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.diamondChange,this),e.prototype.clean.call(this)},a}(t.EDialog);t.CreateRoomDialog=e,__reflect(e.prototype,"game.CreateRoomDialog")}(game||(game={}));var CreateRoomMahjong=function(t){function e(){var e=t.call(this)||this;return e.clubId=null,e.hasInited=!1,e.skinName="resource/skins/hall/room/createRoomMahjongSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.payModeAA,this.clickPayModeAA),this.addTapEvent(this.payModeMaster,this.clickPayModeMaster),this.addTapEvent(this.payModeDaiKai,this.clickPayModeDaiKai),this.addTapEvent(this.roomTypeJYZ,this.clickRoomTypeJYZ),this.addTapEvent(this.roomTypeCKT,this.clickRoomTypeCKT),this.addTapEvent(this.jieSuanNoLimit,this.clickJieSuanNoLimit),this.addTapEvent(this.jieSuan300,this.clickjieSuan300),this.addTapEvent(this.turnModeBa,this.clickTurnModeBa),this.addTapEvent(this.turnModeQuan,this.clickTurnModeQuan),this.addTapEvent(this.turn1,this.clickTurn1),this.addTapEvent(this.turn2,this.clickTurn2),this.addTapEvent(this.turn3,this.clickTurn3),this.addTapEvent(this.turn4,this.clickTurn4),this.addTapEvent(this.modeFaZa2,this.clickTurnmodeFaZa2),this.addTapEvent(this.modeSiFeng,this.clickModeSiFeng),this.addTapEvent(this.modeJieZhuang,this.clickModeJieZhuang),this.addTapEvent(this.modeBaoMi,this.clickModeBaoMi),this.addTapEvent(this.modeAutoHost,this.clickModeAutoHost),this.updateUI()},e.prototype.updateUI_=function(){if(this.hasInited){null!=this.clubId?(this.jinyuanzi_club.visible=!0,this.changkaitou_club.visible=!0):(this.jinyuanzi_club.visible=!1,this.changkaitou_club.visible=!1),this.modeFaZa2.setText("花砸2"),this.modeSiFeng.setText("东南西北罚分"),this.modeJieZhuang.setText("接庄比"),this.modeBaoMi.setText("保米"),this.modeAutoHost.setText("自动托管"),this.payModeAA.setText("AA付费"),this.payModeMaster.setText("房主付费"),this.payModeDaiKai.setText("会长付费"),this.roomTypeJYZ.setText("进园子"),this.roomTypeCKT.setText("敞开头"),this.turnModeBa.setText("按把付费"),this.turnModeQuan.setText("按圈付费"),this.jieSuan300.setText("300"),this.jieSuanNoLimit.setText("无限制");var t=this.getRoomInfo();this.payModeMaster.visible=null==this.clubId,this.payModeDaiKai.visible=null!=this.clubId,this.resetRadioFalse();var e=t.roomType;e==Constants.ROOM_TYPE.jinYuanZi?(this.roomTypeJYZ.setSelected(!0),this.labelJieSuanScore.text="携带积分：",this.jieSuanNoLimit.visible=!1,this.jieSuan300.setText("100"),this.jieSuan300.setSelected(!0),this.groupMainMode_JYZ.visible=!0,this.labelMainMode_CKT.visible=!this.groupMainMode_JYZ.visible,this.groupJieSuan.visible=!1,this.groupTurnNum.y=140,this.modeAutoHost.x=140,this.modeAutoHost.y=80,this.groupMainMode.y=310):(this.roomTypeCKT.setSelected(!0),this.labelJieSuanScore.text="单把上限：",this.jieSuanNoLimit.visible=!0,this.jieSuan300.setText(""),this.groupMainMode_JYZ.visible=!1,this.labelMainMode_CKT.visible=!this.groupMainMode_JYZ.visible,this.groupJieSuan.visible=!0,this.groupTurnNum.y=210,this.modeAutoHost.x=550,this.modeAutoHost.y=10,this.groupMainMode.y=380),null!=this.clubId?this.modeAutoHost.visible=!1:this.modeAutoHost.visible=!0;var a=t.payMode;a==Constants.ROOM_PAY_MODE.AA?this.payModeAA.setSelected(!0):a==Constants.ROOM_PAY_MODE.creator?this.payModeMaster.setSelected(!0):this.payModeDaiKai.setSelected(!0);var i=t.turnMode;i==Constants.ROOM_TIME_MODE.ba?this.turnModeBa.setSelected(!0):this.turnModeQuan.setSelected(!0);t.roomScore;this.isNoLimit?(this.jieSuanNoLimit.setSelected(!0),this.jieSuan300.setSelected(!1)):(this.jieSuanNoLimit.setSelected(!1),this.jieSuan300.setSelected(!0));var n=t.turnNumber;i==Constants.ROOM_TIME_MODE.ba?4==n?this.turn1.setSelected(!0):12==n?this.turn3.setSelected(!0):16==n?this.turn4.setSelected(!0):this.turn2.setSelected(!0):1==n?this.turn1.setSelected(!0):3==n?this.turn3.setSelected(!0):4==n?this.turn4.setSelected(!0):this.turn2.setSelected(!0),this.modeFaZa2.setSelected(t.huaZa),this.modeSiFeng.setSelected(t.faFen),this.modeJieZhuang.setSelected(t.jieZhuangBi),this.modeBaoMi.setSelected(t.baoMi),this.modeAutoHost.setSelected(t.autoHost);var o=game.CreateRoomCost.getDiamondCostNums(),s=1,r="圈";i==Constants.ROOM_TIME_MODE.ba&&(s=4,r="把"),this.turn1.setText(1*s+r,game.CreateRoomCost.getDiamondCostNum(o,e,a,i,1*s)),this.turn2.setText(2*s+r,game.CreateRoomCost.getDiamondCostNum(o,e,a,i,2*s)),this.turn3.setText(3*s+r,game.CreateRoomCost.getDiamondCostNum(o,e,a,i,3*s)),this.turn4.setText(4*s+r,game.CreateRoomCost.getDiamondCostNum(o,e,a,i,4*s))}},e.prototype.resetRadioFalse=function(){this.payModeAA.setSelected(!1),this.payModeMaster.setSelected(!1),this.payModeDaiKai.setSelected(!1),this.roomTypeJYZ.setSelected(!1),this.roomTypeCKT.setSelected(!1),this.jieSuanNoLimit.setSelected(!1),this.jieSuan300.setSelected(!1),this.turnModeBa.setSelected(!1),this.turnModeQuan.setSelected(!1),this.turn1.setSelected(!1),this.turn2.setSelected(!1),this.turn3.setSelected(!1),this.turn4.setSelected(!1),this.modeFaZa2.setSelected(!1),this.modeSiFeng.setSelected(!1),this.modeJieZhuang.setSelected(!1),this.modeBaoMi.setSelected(!1),this.modeAutoHost.setSelected(!1)},e.prototype.clickPayModeAA=function(){var t=this.getRoomInfo();t.payMode=Constants.ROOM_PAY_MODE.AA,this.updateUI()},e.prototype.clickPayModeMaster=function(){var t=this.getRoomInfo();t.payMode=Constants.ROOM_PAY_MODE.creator,this.updateUI()},e.prototype.clickPayModeDaiKai=function(){var t=this.getRoomInfo();t.payMode=Constants.ROOM_PAY_MODE.other,this.updateUI()},e.prototype.clickRoomTypeJYZ=function(){var t=this.getRoomInfo();t.roomType=Constants.ROOM_TYPE.jinYuanZi,t.roomScore=100,this.updateUI()},e.prototype.clickRoomTypeCKT=function(){var t=this.getRoomInfo();t.roomType=Constants.ROOM_TYPE.changKaiTou,t.roomScore=100,this.updateUI()},e.prototype.clickJieSuanNoLimit=function(){this.getRoomInfo();this.isNoLimit=!0,this.updateUI()},e.prototype.clickjieSuan300=function(){this.getRoomInfo();this.isNoLimit=!1,this.updateUI()},e.prototype.clickTurnModeBa=function(){var t=this.getRoomInfo();t.turnMode=Constants.ROOM_TIME_MODE.ba,t.turnNumber=8,this.updateUI()},e.prototype.clickTurnModeQuan=function(){var t=this.getRoomInfo();t.turnMode=Constants.ROOM_TIME_MODE.quan,t.turnNumber=2,this.updateUI()},e.prototype.clickTurn1=function(){var t=this.getRoomInfo(),e=1;t.turnMode==Constants.ROOM_TIME_MODE.ba&&(e=4),t.turnNumber=1*e,this.updateUI()},e.prototype.clickTurn2=function(){var t=this.getRoomInfo(),e=1;t.turnMode==Constants.ROOM_TIME_MODE.ba&&(e=4),t.turnNumber=2*e,this.updateUI()},e.prototype.clickTurn3=function(){var t=this.getRoomInfo(),e=1;t.turnMode==Constants.ROOM_TIME_MODE.ba&&(e=4),t.turnNumber=3*e,this.updateUI()},e.prototype.clickTurn4=function(){var t=this.getRoomInfo(),e=1;t.turnMode==Constants.ROOM_TIME_MODE.ba&&(e=4),t.turnNumber=4*e,this.updateUI()},e.prototype.clickTurnmodeFaZa2=function(){var t=this.getRoomInfo();t.huaZa=this.modeFaZa2.isSelected(),this.updateUI()},e.prototype.clickModeSiFeng=function(){var t=this.getRoomInfo();t.faFen=this.modeSiFeng.isSelected(),this.updateUI()},e.prototype.clickModeJieZhuang=function(){var t=this.getRoomInfo();t.jieZhuangBi=this.modeJieZhuang.isSelected(),this.updateUI()},e.prototype.clickModeBaoMi=function(){var t=this.getRoomInfo();t.baoMi=this.modeBaoMi.isSelected(),this.updateUI()},e.prototype.clickModeAutoHost=function(){var t=this.getRoomInfo();t.autoHost=this.modeAutoHost.isSelected(),this.updateUI()},e.prototype.getRoomInfo=function(){if(!this.hasInited)return null;if(null==this.roomInfo){var t=this.getLocalRoomInfo();if(null!=t)this.roomInfo=t;else{var e={};e.roomType=Constants.ROOM_TYPE.jinYuanZi,e.roomScore=100,e.turnMode=0,e.turnNumber=8,e.payMode=Constants.ROOM_PAY_MODE.AA,e.huaZa=!0,e.faFen=!0,e.jieZhuangBi=!0,null!=this.clubId&&(e.clubId=this.clubId),e.calNum=0,e.autoHost=!0,e.baoMi=!1,this.roomInfo=e}}return this.roomInfo},e.prototype.getAdjustRoomInfo=function(){var t=this.getRoomInfo();if(t.roomType==Constants.ROOM_TYPE.changKaiTou){if(t.huaZa=!0,t.faFen=!0,t.jieZhuangBi=!0,t.baoMi=!1,this.isNoLimit?t.roomScore=0:t.roomScore=Number(this.scoreInput.text),null!=this.clubId){var e=this.changkaitouScoreInput.text.trim();if(isNaN(Number(e)))return void game.DialogManager.getInstance().popUp1("初始分数只能为数字");if(t.initScore=Number(e)||0,t.rv=1,t.calNum=1,t.autoHost=!0,t.initScore<-10||t.initScore>0)return void game.DialogManager.getInstance().popUp1("初始分数不符合要求")}}else if(t.roomType==Constants.ROOM_TYPE.jinYuanZi&&(t.roomScore=100,null!=this.clubId)){var a=this.jinyuanziScoreInput.text.trim();if(isNaN(Number(a)))return void game.DialogManager.getInstance().popUp1("初始分数只能为数字");if(t.roomScore=Number(a),t.rv=1,t.calNum=1,t.autoHost=!0,t.roomScore<90||t.roomScore>100)return void game.DialogManager.getInstance().popUp1("初始分数不符合要求")}return t},e.prototype.getLocalRoomInfo=function(){var t=null==this.clubId?"0":this.clubId,e=DataStorage.readLocalData("roomInfo_clubId+"+t);return e.length>0?JSON.parse(e):null},e.prototype.saveLocalRoomInfo=function(){var t=this.getRoomInfo(),e=null==this.clubId?"0":this.clubId;DataStorage.writeLocalData("roomInfo_clubId+"+e,JSON.stringify(t))},e.prototype.setClubId=function(t){this.clubId=t;this.getRoomInfo();this.hasInited=!0,this.updateUI()},e}(game.EComponent);__reflect(CreateRoomMahjong.prototype,"CreateRoomMahjong"),window.CreateRoomMahjong=CreateRoomMahjong;var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.join_room.index)||this;return t.skinName="resource/skins/hall/room/joinRoomSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.inputNumberUI.setNumberFullFunc(this.numberFullFunc.bind(this)),this.updateUI()},a.prototype.numberFullFunc=function(e){if(this.inputNumberUI.checkInput()){var a={roomNumber:parseInt(this.inputNumberUI.getInpuNumbers())};t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,a)}},a.prototype.updateUI_=function(){},a}(t.EDialog);t.JoinRoomDialog=e,__reflect(e.prototype,"game.JoinRoomDialog")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.intstance&&(e.intstance=new e),e.intstance},e.prototype.createRoom=function(e){var a={};a.msgRoom=e;var i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CREATE_ROOM,a);t.SocketManager.getInstance().send(i)},e.prototype.createRoomCallBack=function(e){if(e.code==t.CmdResultType.SUCCESS){var a=e.data,i=a.fromClub;if(null==i||!i){if(null!=a.diamond&&GlobalData.userData.setDiamondNum(a.diamond),Constants.ROOM_PAY_MODE.other==a.msgRoom.payMode){a.useDiamond,a.msgRoom;return}var n={roomNumber:a.msgRoom.roomNumber};t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,n)}}else{var o=e.errorCode;if(o==t.MsgConstant.ERROR_diamondNoEnough)t.DialogManager.getInstance().popUp2(Strings.noRoomCard,function(){var e=new t.ShopScene(1);t.DialogManager.getInstance().show(e)});else if(o==t.MsgConstant.ERROR_creamRoom_paramError)t.DialogManager.getInstance().popUp1(Strings.createRoomParamsError);else if(o==t.MsgConstant.ERROR_creamRoom_inRoom){var a=e.data,s=(a.gameId,Utils.format(Strings.hasInRoomWhenCreateRoom,"麻将"));t.DialogManager.getInstance().popUp1(s)}}},e.prototype.joinRoomCallBack=function(e){if(e.code==t.CmdResultType.SUCCESS){var a=e.data;null!=a.diamond&&GlobalData.userData.setDiamondNum(a.diamond);var i=a.roomStatus;GlobalData.gameData.setGameStatus(i),GlobalData.gameData.getRoomInfo().parse(a.msgRoom);var n=!1;null!=a.doCheat&&(n=a.doCheat),n&&GlobalData.gameData.setCheatStatus(n);var o=a.kickLeftTime;null!=o&&GlobalData.gameData.setKickOfflineTime(Math.floor(o/1e3));var s=a.userInfos;GlobalData.gameData.clearPlayerData();for(var r=0;r<s.length;r++){var l=s[r].chairId,c=GlobalData.gameData.getPlayer(l);null==c&&(c=new t.PlayerInfo,GlobalData.gameData.addPlayer(l,c)),c.parse(s[r]),c.getUserId()==GlobalData.userData.getUserId()&&(GlobalData.gameData.setMyChairId(l),t.LogUtils.info("我的椅子id "+l))}GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.ready&&GlobalData.isReconnecting&&GlobalData.setReconnecting(!1),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED),t.SceneManager.getInstance().curScene.getIndex()!=Constants.SCENE_INDEX.GAME&&t.SceneSkip.skipToGameScene()}else{var h=e.errorCode;h==t.MsgConstant.ERROR_join_ROOM_USERMAX?t.DialogManager.getInstance().popUp1(Strings.roomPlayerFull):h==t.MsgConstant.ERROR_join_inOtherRoom?t.DialogManager.getInstance().popUp1(Strings.hasInRoomWhenJoinRoom):h==t.MsgConstant.ERROR_joinRoom_roomId_error?t.DialogManager.getInstance().popUp1(Strings.roomNumberNotExist):h==t.MsgConstant.ERROR_diamondNoEnough?t.DialogManager.getInstance().popUp2(Strings.noRoomCard,function(){var e=new t.ShopScene(1);t.DialogManager.getInstance().show(e)}):h==t.MsgConstant.ERROR_bless_score_limit?t.DialogManager.getInstance().popUp1(Strings.club_error_bless_score_limit):h==t.MsgConstant.ERROR_club_black_list&&t.DialogManager.getInstance().popUp1(Strings.club_forbid_game)}},e.prototype.cancelRoom=function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CANCEL_ROOM,null);t.SocketManager.getInstance().send(e)},e.prototype.cancelDaiKaiRoom=function(e){var a={roomId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CANCEL_DAIKAI_ROOM,a);t.SocketManager.getInstance().send(i)},e.prototype.joinRoom=function(e){var a={roomNumber:e},i=GlobalData.userData.getLocation();(0!=i.longitude||0!=i.latitude)&&(a.gpsLocation=i);var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,a);t.SocketManager.getInstance().send(n)},e.intstance=null,e}();t.RoomService=e,__reflect(e.prototype,"game.RoomService")}(game||(game={}));var TurnNumberRadioButton=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/room/turnModeRadioSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.rect,this.onThisClick)},e.prototype.onThisClick=function(){this.radioButton.setSelected(!this.radioButton.isSelected())},e.prototype.setSelected=function(t){this.radioButton.setSelected(t)},e.prototype.setText=function(t,e){this.radioButton.setText(t),this.labelCostNum.text="x"+e},e}(game.EComponent);__reflect(TurnNumberRadioButton.prototype,"TurnNumberRadioButton"),window.TurnNumberRadioButton=TurnNumberRadioButton;var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/shop/shopItemSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.setData=function(t){this.shopItemData=t,this.updateUI()},e.prototype.updateUI_=function(){if(null!=this.shopItemData){var t=this.shopItemData.itemTotalNum,e=t>1e4?t/1e4+"万":t+"";this.labelItemName.text=this.shopItemData.itemName+e,this.labelItemPrice.text="¥"+this.shopItemData.price/100}},e.prototype.clean=function(){t.prototype.clean.call(this)},e}(t.EComponent);t.ShopItem=e,__reflect(e.prototype,"game.ShopItem")}(game||(game={}));var game;!function(t){var e=function(){function t(t){this.json=t,this.parse()}return t.prototype.parse=function(){this.itemTotalNum=this.json.itemTotalNum,this.itemName=this.json.itemName,this.price=this.json.price,this.itemAddNum=this.json.itemAddNum,this.itemBaseNum=this.json.itemBaseNum,this.itemGroupId=this.json.itemGroupId,this.itemId=this.json.itemId,this.itemType=this.json.itemType},t}();t.ShopItemData=e,__reflect(e.prototype,"game.ShopItemData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.selectTabIndex=1,a.selectTabIndex=t||1,a.skinName="resource/skins/hall/shop/shopSceneSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.goHallScene),this.addTapEvent(this.tab1,this.selectTab1),this.addTapEvent(this.tab2,this.selectTab2),this.labelDiamond.text=""+GlobalData.userData.getDiamondNum(),this.labelGold.text=""+GlobalData.userData.getGoldNum(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_DIAMOND_CHANGE),this.refreshDiamondNumber,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_GOLD_CHANGE),this.refreshGoldNumber,this),this.addItemsEvent(),1==this.selectTabIndex?this.selectTab1():this.selectTab2(),this.getItemInfos()},a.prototype.refreshDiamondNumber=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=i.diamond;this.labelDiamond.text=""+n}},a.prototype.refreshGoldNumber=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=i.gold;this.labelGold.text=""+n}},a.prototype.updateUI_=function(){this.tab1.selected=!1,this.tab2.selected=!1,1==this.selectTabIndex?(this.tab1.selected=!0,this.updateItems(!0,this.diamondList)):2==this.selectTabIndex&&(this.tab2.selected=!0,this.updateItems(!1,this.goldList))},a.prototype.addItemsEvent=function(){for(var t=this.getDiamondItems(),e=t.length,a=0;e>a;a++)this.addTapEvent(t[a],this.clickBuy);for(var i=this.getGoldItems(),n=i.length,a=0;n>a;a++)this.addTapEvent(i[a],this.clickBuy)},a.prototype.clickBuy=function(e){var a=e.currentTarget,i=1==this.selectTabIndex?this.getItemBtnIndex(!0,a):this.getItemBtnIndex(!1,a),n=null;1==this.selectTabIndex?(n=this.diamondList[i],t.CommonView.showToast("购买"+n.itemTotalNum+n.itemName)):(n=this.goldList[i],t.CommonView.showToast("购买"+n.itemTotalNum+n.itemName)),null!=n&&this.createOrder(n)},a.prototype.createOrder=function(e){t.CommonView.showWaiting();var a=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_createOrder),i={userId:GlobalData.userData.getUserId(),itemId:e.itemId,fromApp:!1,checkVersion:!0};t.GameHttpManager.request(a,i,this.createOrderCallBack.bind(this))},a.prototype.createOrderCallBack=function(e){t.CommonView.hideWaiting();var a=e;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=0;null!=i.orderId&&(n=i.orderId);var o=t.GameHttpConst.url_pay_h5+"?order="+n;console.log("payUrl "+o),window.open(o)}else{var s=a.errorCode;s==t.MsgConstant.ERROR_WEB_need_bind_proxy&&t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.shopBindProxyBox.index)}},a.prototype.getDiamondItems=function(){return[this.btnDiamond1,this.btnDiamond2,this.btnDiamond3,this.btnDiamond4,this.btnDiamond5,this.btnDiamond6]},a.prototype.getGoldItems=function(){return[this.btnGold1,this.btnGold2,this.btnGold3,this.btnGold4,this.btnGold5,this.btnGold6]},a.prototype.getItemBtnIndex=function(t,e){for(var a=t?this.getDiamondItems():this.getGoldItems(),i=a.length,n=0;i>n;n++)if(e==a[n])return n},a.prototype.updateItemBtns=function(t){this.btnDiamond1.visible=t,this.btnDiamond2.visible=t,this.btnDiamond3.visible=t,this.btnDiamond4.visible=t,this.btnDiamond5.visible=t,this.btnDiamond6.visible=t,this.btnGold1.visible=!t,this.btnGold2.visible=!t,this.btnGold3.visible=!t,this.btnGold4.visible=!t,this.btnGold5.visible=!t,this.btnGold6.visible=!t
},a.prototype.updateItems=function(t,e){for(var a=[this.item1,this.item2,this.item3,this.item4,this.item5,this.item6],i=this.getDiamondItems(),n=this.getGoldItems(),o=a.length,s=null==e?0:e.length,r=0;o>r;r++)s>r?(a[r].visible=!0,a[r].setData(e[r]),i[r].visible=!0,n[r].visible=!0):(a[r].visible=!1,i[r].visible=!1,n[r].visible=!1),s>r?(i[r].visible=t,n[r].visible=!t):(i[r].visible=!1,n[r].visible=!1)},a.prototype.getItemInfos=function(){t.GameHttpManager.getItemInfosNew(1,10002,this.getItemInfosBack.bind(this))},a.prototype.getItemInfosBack=function(e){var a=e,i=a;if(i.code==t.CmdResultType.SUCCESS){var n=i.data,o=n.diamonds,s=n.golds;this.diamondList=[],this.goldList=[];for(var r in o){var l=o[r],c=new t.ShopItemData(l);this.diamondList.push(c)}for(var r in s){var l=s[r],c=new t.ShopItemData(l);this.goldList.push(c)}this.updateUI()}},a.prototype.selectTab1=function(){this.selectTabIndex=1,this.updateUI()},a.prototype.selectTab2=function(){this.selectTabIndex=2,this.updateUI()},a.prototype.goHallScene=function(){this.close()},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_DIAMOND_CHANGE),this.refreshDiamondNumber,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_GOLD_CHANGE),this.refreshGoldNumber,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ShopScene=e,__reflect(e.prototype,"game.ShopScene")}(game||(game={}));var DiamondItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/store/diamondItemSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this)},e.prototype.setData=function(t){this.diamondData=t,this.updateUI()},e.prototype.updateUI=function(){null!=this.diamondData&&(this.price.text=this.diamondData.price/100+"",this.num.text="x"+this.diamondData.itemTotalNum,800==this.diamondData.price?this.dmdImg.source="item_diamond_1_png":2e3==this.diamondData.price?this.dmdImg.source="item_diamond_2_png":5e3==this.diamondData.price?this.dmdImg.source="item_diamond_3_png":1e4==this.diamondData.price?this.dmdImg.source="item_diamond_4_png":3e4==this.diamondData.price?this.dmdImg.source="item_diamond_5_png":1e5==this.diamondData.price&&(this.dmdImg.source="item_diamond_6_png"))},e}(game.EComponent);__reflect(DiamondItem.prototype,"DiamondItem"),window.DiamondItem=DiamondItem;var GoldItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/store/goldItemSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this)},e.prototype.setData=function(t){this.goldData=t,this.updateUI()},e.prototype.updateUI=function(){null!=this.goldData&&(this.price.text=this.goldData.price/100+"",this.num.text="x"+this.goldData.itemTotalNum,800==this.goldData.price?this.goldImg.source="item_gold_1_png":2e3==this.goldData.price?this.goldData.source="item_gold_2_png":5e3==this.goldData.price?this.goldImg.source="item_gold_3_png":1e4==this.goldData.price?this.goldImg.source="item_gold_4_png":3e4==this.goldData.price&&(this.goldImg.source="item_gold_5_png"))},e}(game.EComponent);__reflect(GoldItem.prototype,"GoldItem"),window.GoldItem=GoldItem;var game;!function(t){var e=function(e){function a(t){var i=e.call(this,Constants.UI_PANEL_DATA_SET.shop.index)||this;return i.curTabIndex=a.STORE_TAB.DIAMOND,null!=t&&t.tabIndex&&(i.curTabIndex=t.tabIndex),i.skinName="resource/skins/hall/store/storeMainSkin.exml",i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnBack,this.clickBack),this.addTapEvent(this.tab1,this.tabToDimamond),this.addTapEvent(this.tab2,this.tabToGold),this.addTapEvent(this.tabTitle1,this.tabToDimamond),this.addTapEvent(this.tabTitle2,this.tabToGold),this.getStoreList(),this.updateDiamondNum(),this.updateGoldNum(),this.diamondItemGrp.visible=!0,this.goldItemGrp.visible=!1,this.tab1.selected=!0,t.EAppFacade.getInstance().registerCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this),this.curTabIndex==a.STORE_TAB.DIAMOND?this.tabToDimamond():this.curTabIndex==a.STORE_TAB.GOLD&&this.tabToGold()},a.prototype.updateDiamondNum=function(){this.dmdNum.text=GlobalData.userData.getDiamondNum()+""},a.prototype.updateGoldNum=function(){this.goldNum.text=GlobalData.userData.getGoldNum()+""},a.prototype.clickBack=function(){this.close()},a.prototype.tabToDimamond=function(){this.diamondItemGrp.visible=!0,this.goldItemGrp.visible=!1,this.tab1.selected=!0,this.tab2.selected=!1},a.prototype.tabToGold=function(){this.diamondItemGrp.visible=!1,this.goldItemGrp.visible=!0,this.tab1.selected=!1,this.tab2.selected=!0},a.prototype.getStoreList=function(){t.StoreService.getInstance().getStoreList(this.getStoreListBack.bind(this))},a.prototype.getStoreListBack=function(e){var a=e,i=a;if(i.code==t.CmdResultType.SUCCESS){var n=i.data;this.diaMondItemData=n.diamonds,this.goldItemData=n.golds;for(var o=[this.dmdItem0,this.dmdItem1,this.dmdItem2,this.dmdItem3,this.dmdItem4,this.dmdItem5],s=[this.goldItem0,this.goldItem1,this.goldItem2,this.goldItem3,this.goldItem4],r=this.diaMondItemData.length,l=0;r>l;l++){var c=null;r>l&&(c=this.diaMondItemData[l]),o[l].setData(c)}for(var h=this.goldItemData.length,l=0;h>l;l++){var u=null;r>l&&(u=this.goldItemData[l]),s[l].setData(u)}console.log("======>>>>>"+u)}},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this),e.prototype.clean.call(this)},a.STORE_TAB={GOLD:1,DIAMOND:2},a}(t.EDialog);t.StoreBox=e,__reflect(e.prototype,"game.StoreBox")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getStoreList=function(e){t.GameHttpManager.getStoreList(e)},e}();t.StoreService=e,__reflect(e.prototype,"game.StoreService")}(game||(game={}));var game;!function(t){var e=function(){function t(t){this.goalDesc="",this.json=t,this.parse()}return t.prototype.parse=function(){this.id=this.json.id,this.lastId=this.json.lastId,this.eventType=this.json.eventType,this.curLevel=this.json.curLevel,this.eventNum=this.json.eventNum,this.curEventNum=this.json.curEventNum,this.rewardType=this.json.rewardType,this.rewardNum=this.json.rewardNum,this.goalType=this.json.goalType,this.takeStatus=this.json.takeStatus,this.goalDesc=this.json.goalDesc,this.eventTypeDesc=this.json.eventTypeDesc},t}();t.TaskData=e,__reflect(e.prototype,"game.TaskData")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.taskBox.index)||this;return t.selectTabIndex=1,t.skinName="resource/skins/hall/task/taskDialogSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.tab1,this.selectTab1),this.addTapEvent(this.tab2,this.selectTab2),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_GET_TASK_LIST),this.getTaskListBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.UPDATE_TASK_TIP,this.updateTaskTip,this),this.selectTab1(),this.initScroller(),this.getTaskList()},a.prototype.updateUI_=function(){this.tab1.selected=!1,this.tab2.selected=!1,this.labelTab1.textColor=8864264,this.labelTab2.textColor=8864264,this.labelTab1.stroke=0,this.labelTab2.stroke=0,1==this.selectTabIndex?(this.labelTab1.textColor=16777215,this.tab1.selected=!0,this.labelTab1.stroke=2,this.everydayTaskList&&this.scrollerTables.setScrollerContent(this.everydayTaskList,!1)):2==this.selectTabIndex&&(this.labelTab2.textColor=16777215,this.tab2.selected=!0,this.labelTab2.stroke=2,this.growthTaskList&&this.scrollerTables.setScrollerContent(this.growthTaskList,!1)),this.updateTaskTip()},a.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(114,8),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(e){var a=new t.TaskItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.getTaskList=function(){t.TaskService.getInstance().getTaskList()},a.prototype.getTaskListBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data,n=i.everydayTask,o=i.growthTask,s=i.redPointTip_day,r=i.redPointTip_grow;this.everydayTaskList=[],this.growthTaskList=[];for(var l in n){var c=n[l],h=new t.TaskData(c);this.everydayTaskList.push(h)}for(var l in o){var c=o[l],h=new t.TaskData(c);this.growthTaskList.push(h)}t.GlobalService.getInstance().setTaskTip(s,r),this.updateUI()}},a.prototype.selectTab1=function(){this.selectTabIndex=1,this.updateUI()},a.prototype.selectTab2=function(){this.selectTabIndex=2,this.updateUI()},a.prototype.updateTaskTip=function(){this.imgRed1.visible=t.GlobalService.getInstance().hasDayTaskTip(),this.imgRed2.visible=t.GlobalService.getInstance().hasGrowTaskTip()},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_GET_TASK_LIST),this.getTaskListBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.UPDATE_TASK_TIP,this.updateTaskTip,this),e.prototype.clean.call(this)},a}(t.EDialog);t.TaskDialog=e,__reflect(e.prototype,"game.TaskDialog")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.taskData=t,a.skinName="resource/skins/hall/task/taskItemSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnGet,this.clickGetReward),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_GET_TASK_REWARD),this.getTaskRewardBack,this),this.updateUI()},a.prototype.setData=function(t){this.taskData=t,this.updateUI()},a.prototype.clickGetReward=function(){t.TaskService.getInstance().getTaskReward(this.taskData.goalType,this.taskData.id)},a.prototype.getTaskRewardBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var i=a.data;i.id==this.taskData.id&&(this.taskData=i,this.updateUI())}},a.prototype.updateUI_=function(){if(this.btnProgressing.visible=!1,this.btnGoDo.visible=!1,this.btnGet.visible=!1,this.btnGeted.visible=!1,null!=this.taskData){this.labelTaskTitle.text=this.taskData.goalDesc;var e=this.taskData.rewardType;this.itemIcon.source=t.ConstantUtils.getItemIconName(e);var a=this.taskData.rewardNum;e==Constants.Item_Type.RMB?(a/=100,this.labelItemNum.text="¥"+a):this.labelItemNum.text=a+"";var i=this.taskData.takeStatus;0==i?this.btnProgressing.visible=!0:1==i?this.btnGet.visible=!0:2==i&&(this.btnGeted.visible=!0);var n=Math.min(this.taskData.curEventNum,this.taskData.eventNum);this.labelProgress.text=n+"/"+this.taskData.eventNum,this.taskData.eventTypeDesc&&this.taskData.eventTypeDesc.trim().length>0?(this.btnInfo.visible=!0,this.labelTaskTitle.x=159):(this.btnInfo.visible=!1,this.labelTaskTitle.x=117);var o=this.imgProgress.width,s=this.imgProgress.height;this.imgProgress.mask=new egret.Rectangle(0,0,o*n/this.taskData.eventNum,s)}},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_GET_TASK_REWARD),this.getTaskRewardBack,this),e.prototype.clean.call(this)},a}(t.EComponent);t.TaskItem=e,__reflect(e.prototype,"game.TaskItem")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getTaskList=function(){var e={newTask:!0},a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_GET_TASK_LIST,e);t.SocketManager.getInstance().send(a)},e.prototype.getTaskReward=function(e,a){var i={goalType:e,goalId:a},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_GET_TASK_REWARD,i);t.SocketManager.getInstance().send(n)},e}();t.TaskService=e,__reflect(e.prototype,"game.TaskService")}(game||(game={}));var game;!function(t){var e=function(){function t(t){this.json=t,this.parse()}return t.prototype.parse=function(){this.userId=this.json.userId,this.nickName=this.json.nickName,this.itemNum=this.json.itemNum,this.itemType=this.json.itemType,this.info=this.json.info,this.curNum=this.json.curNum,this.chgType=this.json.chgType,this.recordTime=this.json.recordTime},t}();t.ChargeRecordData=e,__reflect(e.prototype,"game.ChargeRecordData")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.selectTabIndex=1,t.skinName="resource/skins/hall/user/chargeRecordDialogSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.tab1,this.selectTab1),this.addTapEvent(this.tab2,this.selectTab2),this.initScroller(),this.selectTab1()},a.prototype.updateUI_=function(){this.tab1.selected=!1,this.tab2.selected=!1,this.labelTab1.textColor=8864264,this.labelTab2.textColor=8864264,this.labelTab1.stroke=0,this.labelTab2.stroke=0,1==this.selectTabIndex?(this.labelTab1.textColor=16777215,this.tab1.selected=!0,this.labelTab1.stroke=2,this.labelItemName.text="钻石"):2==this.selectTabIndex&&(this.labelTab2.textColor=16777215,this.tab2.selected=!0,this.labelTab2.stroke=2,this.labelItemName.text="金币"),this.recordDataList&&this.scrollerTables.setScrollerContent(this.recordDataList,!1)},a.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(58,8),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(e){var a=new t.ChargeRecordItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.getRecordListBack=function(e){var a=e,i=a;i.code==t.CmdResultType.SUCCESS&&(this.recordDataList=i.data,this.updateUI())},a.prototype.selectTab1=function(){this.selectTabIndex=1,t.GameHttpManager.getDiamondRecord(GlobalData.userData.getUserId(),this.getRecordListBack.bind(this))},a.prototype.selectTab2=function(){this.selectTabIndex=2,t.GameHttpManager.getGoldRecord(GlobalData.userData.getUserId(),this.getRecordListBack.bind(this))},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EDialog);t.ChargeRecordDialog=e,__reflect(e.prototype,"game.ChargeRecordDialog")}(game||(game={}));var game;!function(t){var e=function(e){function o(t){var a=e.call(this)||this;return a.chargeRecordData=t,a.skinName="resource/skins/hall/user/chargeRecordItemSkin.exml",a}return __extends(o,e),o.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.updateUI()},o.prototype.setData=function(t){this.chargeRecordData=t,this.updateUI()},o.prototype.updateUI_=function(){if(null!=this.chargeRecordData){this.labelTime.text=t.DateUtils.dateFormat1(this.chargeRecordData.recordTime,!1);var e=this.chargeRecordData.itemNum;this.labelNum.text=e>0?"+"+e:""+e,this.labelInfo.text=this.getChangeInfo(this.chargeRecordData.itemType,this.chargeRecordData.chgType)}},o.prototype.getChangeInfo=function(t,e){var a=this.getChangeInfo_common(e);return a?a:t==Constants.Item_Type.DIAMOND?e==i.BIND_PROXY_TYPE?"绑定代理奖励":e==i.BACK_TYPE?"房间返还":e==i.CREATE_ROOM_TYPE?"创建房间":e==i.JOIN_ROOM_TYPE?"加入房间":"其它":t==Constants.Item_Type.GOLD&&e==n.ANI_COST_TYPE?"道具消耗":"其它"},o.prototype.getChangeInfo_common=function(t){return t==a.OTHER_TYPE?"其它":t==a.EMAIL_TYPE?"通过邮件领取":t==a.TASK_TYPE?"任务奖励":t==a.ACTIVITY_TYPE?"活动奖励":t==a.PROXY_GRANT_ADD_TYPE?"代理赠送":t==a.PROXY_GRANT_REDUCE_TYPE?"赠送他人":t==a.SYS_ADMIN_REDUCE_TYPE?"系统扣除":t==a.SHOP_BUY_TYPE?"商城购买":t==a.LUCKY_DRAW_TYPE?"转盘奖励":null},o.prototype.clean=function(){e.prototype.clean.call(this)},o}(t.EComponent);t.ChargeRecordItem=e,__reflect(e.prototype,"game.ChargeRecordItem");var a={OTHER_TYPE:0,EMAIL_TYPE:1,TASK_TYPE:2,ACTIVITY_TYPE:3,PROXY_GRANT_ADD_TYPE:4,PROXY_GRANT_REDUCE_TYPE:5,SYS_ADMIN_ADD_TYPE:6,SYS_ADMIN_REDUCE_TYPE:7,SHOP_BUY_TYPE:8,LUCKY_DRAW_TYPE:9},i={BIND_PROXY_TYPE:101,BACK_TYPE:102,CREATE_ROOM_TYPE:103,JOIN_ROOM_TYPE:104},n={ANI_COST_TYPE:201}}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},t}();t.UserOtherService=e,__reflect(e.prototype,"game.UserOtherService")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this,Constants.UI_PANEL_DATA_SET.rulesBox.index)||this;return e.selectTabIndex=1,e.skinName="resource/skins/hall/wanfa/ruleDescSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.tab1,this.showJYZ),this.addTapEvent(this.tab2,this.showCKT),this.showJYZ(),this.updateUI()},e.prototype.initRuleData1=function(){var t="一．简介\n进园子是“门一跑一”和“两家干”的游戏规则，增加“花砸2”和“接庄比”两种玩法。\n\n二．基本规则\n1．“花砸2”：硬花、软花的总数*2。\n2．门一跑一：成牌后门清，加10个花，俗称“门一”；在成牌后加底花10个花，俗称“跑一”。\n3．两家干：当有两家积分为0时，游戏立即结束。\n4．胡牌结算规则：\nA．南京麻将成牌后，输赢额度由成牌花的多少来决定。\nB．牌型花数：混一色：20个花；对对胡：20个花；压绝：20个花；无花果20个花；清一色：加30个花；全球独钓：加30个花。普通七对：加30个花。双七对：加80个花。豪华双七对：加120个花。超豪华双七对：成牌后算做160个花。\nC．杠后开花：小杠开花：加10个花。大杠开花：加20个花。\nD．天胡：庄家摸到牌后直接成牌，另外三家直接干。\nE．地胡：天听后不碰不杠直接成牌，另加30个花。\nF．海底捞月：最后2墩（小于等于4张）时自摸胡牌，加20个花。\n5．比下胡规则：胡牌的总花数*2。\n比下胡条件：\n庄家连庄，接庄比，流局，包牌，大胡（清一色，混一色，对对胡，全球独钓，七对，杠后开花，天胡，地胡、压绝、无花果）、花杠、罚分、一炮多响。\n\n三．进园子包牌规则\n1．大杠开花和抢杠算自摸\n2．外包规则：a.全球独钓，b.三打四包，c.清一色外包。\n\n四．其他规则\n南京麻将现场汇：分别是“杠”和“罚分”。\n超时托管：勾选此规则后，每个玩家整局牌局中总共拥有300秒超时时间。该时间用完后，该局游戏内，玩家再次超时未操作，将进行系统托管。托管将由系统自动摸牌打牌，有操作提示时自动选择“过”。\n\n五．结算\n结算页面显示的输赢=玩家携带积分-100。";this.ruleLabel.text=t},e.prototype.initRuleData2=function(){var t="一．简介\n南京麻将敞开头沿用了现实“门一跑一”的游戏规则。\n\n二．基本规则\n1．“花砸2”：硬花、软花的总数乘2。\n2．门一跑一：成牌后门清，加10个花，俗称“门一”；在成牌后加底花10个花，俗称“跑一”。\n3．胡牌结算规则：\nA．南京麻将成牌后，输赢额度由成牌花的多少来决定。\nB．牌型花数：混一色：20个花；对对胡：20个花；压绝：20个花；无花果20个花；清一色：加30个花；全球独钓：加30个花。七对：加30个花。双七对：加80个花。豪华双七对：加120个花。超豪华双七对：成牌后算做160个花。\nC．杠后开花：小杠开花：加10个花。大杠开花：加20个花。\nD．天胡：加200个花。地胡：天听后不碰不杠直接成牌，加30个花。海底捞月：最后2墩（小于等于4张）时自摸胡牌，加20个花。\n4. 比下胡规则：胡牌的总花数*2。\n比下胡条件：\n庄家连庄，接庄比，流局，包牌，大胡（清一色，混一色，对对胡，全球独钓，七对，杠后开花，天胡，地胡、压绝、无花果）、花杠、罚分、一炮多响。\n\n三．敞开头包牌规则\n1．大杠开花和抢杠算自摸。2.三打四包。3.清一色包牌。\n\n四．其他规则\n南京麻将现场汇：“杠”和“罚分”。\n超时托管：勾选此规则后，每个玩家整局牌局中总共拥有300秒超时时间。该时间用完后，该局游戏内，玩家再次超时未操作，将进行系统托管。托管将由系统自动摸牌打牌，有操作提示时自动选择“过”。";this.ruleLabel.text=t},e.prototype.updateUI_=function(){this.tab1.selected=!1,this.tab2.selected=!1,this.labelTab1.textColor=8864264,this.labelTab2.textColor=8864264,this.labelTab1.stroke=0,this.labelTab2.stroke=0,1==this.selectTabIndex?(this.labelTab1.textColor=16777215,this.tab1.selected=!0,this.labelTab1.stroke=2):2==this.selectTabIndex&&(this.labelTab2.textColor=16777215,this.tab2.selected=!0,this.labelTab2.stroke=2)},e.prototype.showJYZ=function(){this.selectTabIndex=1,this.initRuleData1(),this.updateUI()},e.prototype.showCKT=function(){this.selectTabIndex=2,this.initRuleData2(),this.updateUI()},e.prototype.clean=function(){t.prototype.clean.call(this)},e}(t.EDialog);t.RuleDialog=e,__reflect(e.prototype,"game.RuleDialog")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.parse=function(e){this.gameId=e.gameId,this.calNum=e.calNum,this.roomId=e.roomId,this.endTime=e.endTime,this.curTurnDirection=e.curTurnDirection,this.curTurnNum=e.curTurnNum,this.turnNumber=e.turnNumber,this.roomNumber=e.roomNumber,this.masterUserId=e.masterUserId,this.roomType=e.roomType,this.turnMode=e.turnMode,this.hasView=e.hasView,this.userList=[];var a=e.userList;for(var i in a){var n=a[i],o=new t.CombatUserData;o.parse(n),this.userList.push(o)}this.templateName=e.templateName},e}();t.CombatData=e,__reflect(e.prototype,"game.CombatData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var i=e.call(this)||this;return i.fromClub=!1,i.skinName="resource/skins/hall/zhanji/combatItemSkin.exml",i.combatData=t,i.fromClub=a,i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnInfo,this.showGainList),this.addTapEvent(this.rectCombatData,this.getCombatReplayData),this.addTapEvent(this.btnView,this.getCombatReplayData),this.updateUI()},a.prototype.setData=function(t,e){this.combatData=t,this.fromClub=e,this.updateUI()},a.prototype.updateUI=function(){if(this.isViewCreated&&null!=this.combatData){if(this.labelRoomNumber.text="房号:"+this.combatData.roomNumber,this.labelTurnInfo.text="把数:"+this.combatData.curTurnNum+"/"+this.combatData.turnNumber,this.labelTime.text=t.DateUtils.dateFormat1(this.combatData.endTime,!1),this.labelRoomType.text=this.combatData.templateName,this.fromClub){var e=this.combatData.hasView;this.btnInfo.visible=e,this.btnView.visible=!e}else this.btnInfo.visible=!0,this.btnView.visible=!1;for(var a=[this.userItem1,this.userItem2,this.userItem3,this.userItem4],i=a.length,n=this.combatData.userList.length,o=0;i>o;o++)n>o?(a[o].visible=!0,this.combatData.calNum&&this.combatData.calNum>0&&(this.combatData.userList[o].showCalNum=!0),a[o].setData(this.combatData.masterUserId,this.combatData.userList[o],this.fromClub)):a[o].visible=!1}},a.prototype.getRulesInfo=function(){var e="房号:"+this.combatData.roomNumber+"    ";return e+="把数:"+this.combatData.curTurnNum+"/"+this.combatData.turnNumber+"    ",e+=t.DateUtils.dateFormat(this.combatData.endTime)},a.prototype.showGainList=function(){var e=new t.GainListDialog(this.combatData.roomId);t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.getCombatReplayData=function(){t.CommonView.showWaiting(),t.ZhanjiService.getInstance().getCombatReplayData(this.combatData.roomId,this.fromClub)},a}(t.EComponent);t.CombatItem=e,__reflect(e.prototype,"game.CombatItem")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.showCalNum=!1}return t.prototype.parse=function(t){this.winHome=t.winHome,this.id=t.id,this.gameId=t.gameId,this.calNum=t.calNum,this.roomId=t.roomId,this.userId=t.userId,this.nickName=t.nickName,this.headUrl=t.headUrl,this.score=t.score,this.waiBaoScore=t.waiBaoScore,this.chairId=t.chairId,this.recordTime=t.recordTime},t}();t.CombatUserData=e,__reflect(e.prototype,"game.CombatUserData")}(game||(game={}));var CombatUserItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/zhanji/combatUserItemSkin",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.setData=function(t,e,a){this.masterId=t,this.combatUserData=e,this.fromClub=a,this.updateUI()},e.prototype.updateUI_=function(){this.isViewCreated&&null!=this.combatUserData&&(this.labelNickName.text=this.combatUserData.nickName,this.labelScore.text=this.combatUserData.score+"",game.ZhanJiColorUtils.setScoreLabelFormat(this.labelScore,this.combatUserData.score),this.fromClub?(this.labelWaiBaoScore.visible=!1,this.lab2.visible=!1,this.combatUserData.showCalNum&&(this.lab2.visible=!0,this.lab2.text="记分：",this.labelWaiBaoScore.visible=!0,game.ZhanJiColorUtils.setScoreLabelFormat(this.labelWaiBaoScore,this.combatUserData.calNum))):(this.labelWaiBaoScore.text=this.combatUserData.waiBaoScore+"",game.ZhanJiColorUtils.setScoreLabelFormat(this.labelWaiBaoScore,this.combatUserData.waiBaoScore),this.labelWaiBaoScore.visible=!0,this.lab2.visible=!0),this.imgMaster.visible=this.combatUserData.userId==this.masterId)},e}(game.EComponent);__reflect(CombatUserItem.prototype,"CombatUserItem"),window.CombatUserItem=CombatUserItem;var game;!function(t){var e=function(){function e(){}return e.prototype.parse=function(e){this.turnIndex=e.turnIndex,this.replayId=e.replayId,this.bankerChairId=e.bankerChairId,this.bxh=e.bxh,this.gainUserInfos=[];var a=e.gainUserInfos;for(var i in a){var n=a[i],o=new t.GainUserData;o.parse(n),this.gainUserInfos.push(o)}},e}();t.GainData=e,__reflect(e.prototype,"game.GainData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.skinName="resource/skins/hall/zhanji/gainItemSkin.exml",a.gainData=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnCopyReplayId,this.copyReplayId),this.addTapEvent(this.btnReplay,this.rqsReplayDataEvent),this.updateUI()},a.prototype.setData=function(t){this.gainData=t,this.updateUI()},a.prototype.updateUI=function(){if(this.isViewCreated&&null!=this.gainData){this.labelTurnIndex.text="第"+this.gainData.turnIndex+"局",this.labelReplayId.text=this.gainData.replayId+"",this.imgBxh.visible=this.gainData.bxh;for(var t=[this.gainUserItem1,this.gainUserItem2,this.gainUserItem3,this.gainUserItem4],e=t.length,a=this.gainData.gainUserInfos.length,i=0;e>i;i++)a>i?(t[i].visible=!0,t[i].setData(this.gainData.bankerChairId,this.gainData.gainUserInfos[i])):t[i].visible=!1}},a.prototype.copyReplayId=function(){Utils.copyToClipboard(this.gainData.replayId+"")},a.prototype.rqsReplayDataEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_REPLAY,{replayId:this.gainData.replayId,gameId:Constants.GAME_ID_SET.nanjing})},a}(t.EComponent);t.GainItem=e,__reflect(e.prototype,"game.GainItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.clubRecordDetails.index)||this;return a.roomId=0,a.skinName="resource/skins/hall/zhanji/gainListSkin.exml",a.roomId=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.initScroller(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_ZHANJI_DES_LIST),this.getGainListBack,this),this.getGainList()},a.prototype.getGainList=function(){t.ZhanjiService.getInstance().getGainList(this.roomId)},a.prototype.getGainListBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.gainDataList=[];var i=a.data;for(var n in i){var o=i[n],s=new t.GainData;s.parse(o),this.gainDataList.push(s)}this.updateUI()}},a.prototype.initScroller=function(){this.list.setElementViewInfo(120,8),this.list.setElementCreateFunction(this.createElement.bind(this)),this.list.setElementUpdateDataFun(this.updateElement.bind(this)),this.list.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(e){var a=new t.GainItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.updateUI_=function(){this.list.clearContent(),this.list.setScrollerContent(this.gainDataList)},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_ZHANJI_DES_LIST),this.getGainListBack,this),e.prototype.clean.call(this)},a}(t.EDialog);t.GainListDialog=e,__reflect(e.prototype,"game.GainListDialog")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.curScore=0,this.waibaoScore=0,this.faScore=0}return t.prototype.parse=function(t){this.userId=t.userId,this.nickName=t.nickName,this.userChairId=t.userChairId,this.curScore=t.curScore,this.waibaoScore=t.waibaoScore,this.faScore=t.faScore},t}();t.GainUserData=e,__reflect(e.prototype,"game.GainUserData")}(game||(game={}));var GainUserItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/zhanji/gainUserItemSkin",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.setData=function(t,e){this.bankerChairId=t,this.gainUserData=e,this.updateUI()},e.prototype.updateUI_=function(){if(null!=this.gainUserData){this.labelNickName.text=this.gainUserData.nickName,game.ZhanJiColorUtils.setScoreLabelFormat(this.labelScore,this.gainUserData.curScore);var t=this.gainUserData.faScore,e=0!=t;this.labelFaScore.visible=e,e&&(t>0?this.labelFaScore.text="+"+t:this.labelFaScore.text=t+"",this.labelFaScore.textColor=game.ZhanJiColorUtils.getFaScoreColor(t)),game.ZhanJiColorUtils.setScoreLabelFormat(this.labelWaiBaoScore,this.gainUserData.waibaoScore),this.icon_banker.visible=this.gainUserData.userChairId==this.bankerChairId}},e}(game.EComponent);__reflect(GainUserItem.prototype,"GainUserItem"),window.GainUserItem=GainUserItem;var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/zhanji/combatItemSkin.exml",e}return __extends(e,t),e}(t.EComponent);t.Test=e,__reflect(e.prototype,"game.Test")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,null,!1)||this;return t.skinName="resource/skins/hall/zhanji/viewReplaySkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnCancel,this.close),this.addTapEvent(this.btnOK,this.clickOK),this.input.inputType=egret.TextFieldInputType.TEL,this.input.restrict="0-9",t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_REPLAY),this.replayCallback,this)},a.prototype.clickOK=function(){t.CommonView.showWaiting();var e=this.input.text.trim();return e.length<=0?(t.CommonView.hideWaiting(),void t.CommonView.showToast("请输入回放码")):Utils.isNumbers(e)?void t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_REPLAY,{replayId:e,gameId:Constants.GAME_ID_SET.nanjing}):(t.CommonView.hideWaiting(),void t.CommonView.showToast("回放码应该为数字"))},a.prototype.replayCallback=function(e){t.CommonView.hideWaiting();var a=e.data;a.code==t.CmdResultType.SUCCESS||a.errorCode==t.MsgConstant.ERROR_replaycode_no_exist&&t.CommonView.showToast("回放码不存在")},a}(t.EDialog);t.ViewReplayDialog=e,__reflect(e.prototype,"game.ViewReplayDialog")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getScoreColor=function(e){return t.getWaiboScoreColor(e)},t.getFaScoreColor=function(t){return 0>t?9830697:t>0?5476618:16777215},t.getWaiboScoreColor=function(t){return 0>t?8628704:t>0?16763904:16777215},t.setScoreLabelFormat=function(t,e){0>e?(t.textColor=14740211,t.stroke=2,t.strokeColor=5922987,t.text=""+e):e>0?(t.textColor=16774220,t.stroke=2,t.strokeColor=8738334,t.text="+"+e):(t.textColor=16250871,t.stroke=2,t.strokeColor=6184542,t.text=""+e)},t}();t.ZhanJiColorUtils=e,__reflect(e.prototype,"game.ZhanJiColorUtils")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.zhanjiBox.index)||this;return t.skinName="resource/skins/hall/zhanji/zhanJiSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnViewOtherReplay,this.viewReplay),t.EAppFacade.getInstance().registerCommand(t.GameCmd.ZHANJI_HAS,this.hasZhanJi,this),this.zhanjiUI.getCombatList()},a.prototype.viewReplay=function(){var e=new t.ViewReplayDialog;t.DialogManager.getInstance().show(e)},a.prototype.hasZhanJi=function(t){var e=t.data;this.labelNoRecord.visible=!e},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.ZHANJI_HAS,this.hasZhanJi,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ZhanJiDialog=e,__reflect(e.prototype,"game.ZhanJiDialog")
}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getCombatList=function(){var e={daiKai:!1},a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_ZHANJI_LIST,e);t.SocketManager.getInstance().send(a)},e.prototype.getCombatList_Club=function(e){var a={clubId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_ZHANJI_LIST,a);t.SocketManager.getInstance().send(i)},e.prototype.getGainList=function(e){var a={roomId:e},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_ZHANJI_DES_LIST,a);t.SocketManager.getInstance().send(i)},e.prototype.getCombatReplayData=function(e,a){var i={roomId:e,hasView:a},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_Combat_REPLAY_data,i);t.SocketManager.getInstance().send(n)},e.prototype.replay=function(e){var a={replayId:e,gameId:Constants.GAME_ID_SET.nanjing},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_REPLAY,a);t.SocketManager.getInstance().send(i)},e}();t.ZhanjiService=e,__reflect(e.prototype,"game.ZhanjiService")}(game||(game={}));var ZhanJiUI=function(t){function e(){var e=t.call(this)||this;return e.fromClub=!1,e.skinName="resource/skins/hall/zhanji/zhanJiUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.initScroller(),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_ZHANJI_LIST),this.getCombatListBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ZHANJI_LIST),this.getCombatListBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_Combat_REPLAY_data),this.getCombatReplayDataCallback,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.MODIFY_HAS_VIEW_STATUS,this.modifyHasViewData,this)},e.prototype.getCombatReplayDataCallback=function(t){game.CommonView.hideWaiting();var e=t.data;if(e.code==game.CmdResultType.SUCCESS){var a=e.data;GlobalData.gameData.setAllOverData(a),game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.gameOverBox.index,{isFromReplay:!0})}},e.prototype.getCombatList=function(){game.ZhanjiService.getInstance().getCombatList()},e.prototype.getCombatList_Club=function(t){game.ZhanjiService.getInstance().getCombatList_Club(t)},e.prototype.getCombatListBack=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){this.combatDataList=[];var a=e.data;for(var i in a){var n=a[i],o=new game.CombatData;o.parse(n),this.combatDataList.push(o)}this.updateUI(),game.EAppFacade.getInstance().sendNotification(game.GameCmd.ZHANJI_HAS,this.combatDataList.length>0)}},e.prototype.modifyHasViewData=function(t){var e=t.data;if(null!=e.roomId&&null!=this.combatDataList&&0!=this.combatDataList.length){for(var a=0;a<this.combatDataList.length;a++){var i=this.combatDataList[a];if(i.roomId==e.roomId){null!=e.hasAllView?i.hasView=e.hasAllView:i.hasView=!0;break}}this.updateUI()}},e.prototype.initScroller=function(){this.list.setElementViewInfo(152,8),this.list.setElementCreateFunction(this.createElement.bind(this)),this.list.setElementUpdateDataFun(this.updateElement.bind(this)),this.list.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.CombatItem(t,this.fromClub);return e},e.prototype.updateElement=function(t,e){t.setData(e,this.fromClub)},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.updateUI_=function(){this.list.clearContent(),this.list.setScrollerContent(this.combatDataList)},e.prototype.clean=function(){game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_ZHANJI_LIST),this.getCombatListBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ZHANJI_LIST),this.getCombatListBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_Combat_REPLAY_data),this.getCombatReplayDataCallback,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.MODIFY_HAS_VIEW_STATUS,this.modifyHasViewData,this),t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ZhanJiUI.prototype,"ZhanJiUI"),window.ZhanJiUI=ZhanJiUI;var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.SCENE_INDEX.HOT_UPDATE)||this;return t.Image_progress_startX=0,t.skinName="resource/skins/loading/LoadingSceneSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.Image_progress_startX=this.Image_progress.x,this.loadingBar.labelFunction=function(t,e){return"资源加载中..."+t+"/"+e},RES.setMaxRetryTimes(50),RES.setMaxLoadingThread(1),RES.createGroup("load",["loadingRes","action"]),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.loadGroup("load")},a.prototype.startLoadRes=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,RES.loadGroup("load",0,this)];case 1:return t.sent(),this.skip(),[2]}})})},a.prototype.skip=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),t.SceneSkip.skipToLoginScene()},a.prototype.onResourceLoadComplete=function(t){console.info("--onResourceLoadComplete--"),this.skip()},a.prototype.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},a.prototype.onResourceProgress=function(t){console.info("--onResourceProgress--"+t.itemsLoaded+"/"+t.itemsTotal),this.onProgress(t.itemsLoaded,t.itemsTotal)},a.prototype.onProgress=function(t,e){this.loadingBar.value=Math.floor(t/e*100),this.Image_progress.x=this.Image_progress_startX+this.loadingBar.width*this.loadingBar.value/100},a.prototype.onCancel=function(){console.log("取消资源加载")},a.prototype.onPause=function(){},a.prototype.onResume=function(){},a}(t.SceneBase);t.LoadingScene=e,__reflect(e.prototype,"game.LoadingScene",["RES.PromiseTaskReporter"])}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this,null,!1)||this;return e.skinName="resource/skins/login/bindWechatBox.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.Text_info.text=Utils.format("您还没有绑定手机账号，请在公众号\n【{0}】或APP内绑定手机号账号",GlobalData.clientConfigs.weixin_mp_name),this.addTapEvent(this.Button_copy,this.copyEvent),this.addTapEvent(this.Button_open_wechat,this.callOpenWeChatApp),this.addTapEvent(this.Button_close,this.close)},e.prototype.copyEvent=function(){Utils.copyToClipboard(GlobalData.clientConfigs.weixin_mp_name)},e.prototype.callOpenWeChatApp=function(){Utils.callWxApp()},e}(t.EDialog);t.BindWeChatBox=e,__reflect(e.prototype,"game.BindWeChatBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.SCENE_INDEX.LOGIN)||this;return t.weChatLoginBtn=null,t.connectCount=0,t.guestStartIndex=0,t.currentTime=60,t.skinName="resource/skins/login/loginSceneSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){GameConfig.platform==GameConfig.PLATFORM_SET.H5?(this.Group_test.visible=GameConfig.isDebug,this.addTapEvent(this.btnGuestLogin1,this.guestLogin),this.addTapEvent(this.btnGuestLogin2,this.guestLogin),this.addTapEvent(this.btnGuestLogin3,this.guestLogin),this.addTapEvent(this.btnGuestLogin4,this.guestLogin),this.addTapEvent(this.btnGuestLogin5,this.guestLogin)):this.Group_test.visible=!1,this.addTapEvent(this.btn_getCode,this.clickGetSmsCode),this.addTapEvent(this.btn_codeLogin,this.clickPhoneNumberLogin),t.EAppFacade.getInstance().registerCommand(t.GameCmd.SOCKET_STATUS_CHANGE,this.connectHandler,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.userloginCallback,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_phoneNumber_login),this.phoneNumberLoginCallBack,this),t.GameHttpManager.checkAppUpdate(),this.getLocation(),RES.createGroup("load",["common_json","bg_mp3","shareResult"]),RES.loadGroup("load"),GameConfig.platform==GameConfig.PLATFORM_SET.weChat&&this.initLoginBtn();var e=DataStorage.readLocalData(DataStorageConst.DATA_KEY_UnionId);if(e.length>0&&"undefined"!=e){var a=new t.MsgLoginInfo;a.unionId=e,a.loginUserType=t.LoginUserType.SMS,t.UserInfoService.getInstance().setLoginInfo(a),t.ConnectService.getInstance().getStatus()==ConnectConst.ConnectStatus.Connected?(t.CommonView.showWaiting(),t.UserInfoService.getInstance().login(a)):this.connectSocketServer(!0)}},a.prototype.initLoginBtn=function(){var e=this,a=306,i=a/GameConfig.ScreenW*GameConfig.windowWidth/GameConfig.pixelRatio,n=102,o=n/GameConfig.ScreenH*GameConfig.windowHeight/GameConfig.pixelRatio;this.weChatLoginBtn=wx.createUserInfoButton({type:"image",image:"button_login_1.png",style:{left:(GameConfig.windowWidth/GameConfig.pixelRatio-i)/2,top:444/GameConfig.ScreenH*GameConfig.windowHeight/GameConfig.pixelRatio,width:i,height:o,lineHeight:40,backgroundColor:"#ff0000",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}}),this.weChatLoginBtn.onTap(function(a){a.errMsg.indexOf("auth deny")>-1||a.errMsg.indexOf("auth denied")>-1?t.CommonView.showToast("授权失败"):e.wxLoginByWechatLoginBtnEvent(a)}),this.weChatLoginBtn.show()},a.prototype.getLocation=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(a){switch(a.label){case 0:return t=GlobalData.userData.getLocation(),0!=t.latitude||0!=t.longitude?[2]:[4,platform.getLocation()];case 1:return e=a.sent(),null!=e&&(console.log(e),GlobalData.userData.setLocation(e.longitude,e.latitude)),[2]}})})},a.prototype.wxLoginByWechatLoginBtnEvent=function(e){return __awaiter(this,void 0,void 0,function(){var a,i,n,o;return __generator(this,function(s){switch(s.label){case 0:return t.CommonView.showWaiting(),this.weChatLoginBtn&&this.weChatLoginBtn.hide(),a=e.userInfo,console.log(e),void 0==a.nickName||null==a.nickName?(t.CommonView.hideWaiting(),console.log("userInfo is null"),this.weChatLoginBtn.show(),[2]):(console.log(a),this.userInfo=e.userInfo,[4,platform.login()]);case 1:return i=s.sent(),void 0==i.code||null==i.code?(t.CommonView.hideWaiting(),console.log("loginData is null"),this.weChatLoginBtn.show(),[2]):(console.log(i),n=e.encryptedData,o=e.iv,t.GameHttpManager.getUnionId(i.code,n,o,this.getUnionIdCallBack.bind(this)),[2])}})})},a.prototype.wxLoginEvent=function(){return __awaiter(this,void 0,void 0,function(){var e,a,i,n,o,s,r;return __generator(this,function(l){switch(l.label){case 0:return[4,this.checkAuthSetting()];case 1:return(e=l.sent())?(console.log("checkAuthSetting failed"),[2]):(t.CommonView.showWaiting(),[4,platform.getUserInfo(function(){t.CommonView.hideWaiting(),t.DialogManager.getInstance().popUp1("您拒绝授权，重新授权页面的进入路径为：右上角菜单->关于（小程序名字）->右上角菜单->设置")})]);case 2:return a=l.sent(),i=a.errMsg.indexOf("auth deny"),console.log(a),a.errMsg.indexOf("auth deny")>-1||a.errMsg.indexOf("auth denied")>-1?(t.CommonView.hideWaiting(),t.DialogManager.getInstance().popUp1("您拒绝授权，重新授权页面的进入路径为：右上角菜单->关于（小程序名字）->右上角菜单->设置"),[2]):(n=a.userInfo,console.log(n),void 0==n.nickName||null==n.nickName?(t.CommonView.hideWaiting(),console.log("userInfo is null"),[2]):(console.log(n),this.userInfo=n,[4,platform.login()]));case 3:return o=l.sent(),void 0==o.code||null==o.code?(t.CommonView.hideWaiting(),console.log("loginData is null"),[2]):(console.log(o),s=a.encryptedData,r=a.iv,t.GameHttpManager.getUnionId(o.code,s,r,this.getUnionIdCallBack.bind(this)),[2])}})})},a.prototype.checkAuthSetting=function(){return __awaiter(this,void 0,void 0,function(){var e,a;return __generator(this,function(i){switch(i.label){case 0:return[4,platform.getSetting()];case 1:if(e=i.sent(),console.log(e),a=e.authSetting,a["scope.userInfo"]===!0);else if(a["scope.userInfo"]===!1)return t.DialogManager.getInstance().popUp1("您拒绝授权，重新授权页面的进入路径为：右上角菜单->关于（小程序名字）->右上角菜单->设置"),[2,!0];return[2,!1]}})})},a.prototype.getUnionIdCallBack=function(e){if(t.CommonView.hideWaiting(),e.code==t.CmdResultType.SUCCESS){console.log(e);var a=e.data,i=a.unionId,n=a.openId,o=new t.MsgLoginInfo;o.openId=n,o.channel="mina",o.platform="qinghuai",o.headImgUrl=this.userInfo.avatarUrl,o.nickName=this.userInfo.nickName,o.gender=this.userInfo.gender,o.unionId=i,o.hasRegisterInfo=!0,o.loginUserType=t.LoginUserType.WEIXIN,t.UserInfoService.getInstance().setLoginInfo(o),t.ConnectService.getInstance().getStatus()==ConnectConst.ConnectStatus.Connected?(t.CommonView.showWaiting(),t.UserInfoService.getInstance().login(o)):this.connectSocketServer(!0)}else t.CommonView.showToast(Strings.loginFailed),this.weChatLoginBtn&&this.weChatLoginBtn.show()},a.prototype.connectSocketServer=function(e){t.CommonView.showWaiting(),this.connectCount++,t.ConnectService.getInstance().connect(!0)},a.prototype.connectHandler=function(t){if(null!=t.data){var e=t.data.status;if(e==ConnectConst.ConnectStatus.ConnectClose){egret.setTimeout(function(t){this.connectSocketServer(!1)},this,2e3,"egret")}else e==ConnectConst.ConnectStatus.Connected}},a.prototype.guestLogin=function(e){var a=this.getGuestIndex(e),i=new t.MsgLoginInfo,n=1;i.openId="openId_"+(n+a),i.channel="android",i.platform="qinghuai",i.headImgUrl="http://wx.qlogo.cn/mmopen/QiaGV991oIlm6kG5bjbRKhq5AeRWfOiaAibLqMon7F5iceQ7o31Pvj7mUroEb7W32KZiad9DrkGVMvJx4ULDJiaKRCzh8LEAzGR3Sv/0",i.nickName="guest_"+(n+a),i.gender=a%2==0?t.GenderType.MAN:t.GenderType.WOMAN,i.unionId="unionId_"+(n+a),i.hasRegisterInfo=!0,i.loginUserType=t.LoginUserType.GUEST,t.UserInfoService.getInstance().setLoginInfo(i),t.ConnectService.getInstance().getStatus()==ConnectConst.ConnectStatus.Connected?(t.CommonView.showWaiting(),t.UserInfoService.getInstance().login(i)):this.connectSocketServer(!0)},a.prototype.clickGetSmsCode=function(){var e=this.editableTextPhoneNumber.text;return 0==e.length?void t.CommonView.showToast("请输入手机号"):void t.GameHttpManager.getLoginSmsCode(e,this.getLoginSmsCodeCallBack.bind(this))},a.prototype.clickPhoneNumberLogin=function(){var e=this.editableTextPhoneNumber.text,a=this.editableTextCodeNumber.text;if(0==e.length)return void t.CommonView.showToast("请输入手机号");if(0==a.length)return void t.CommonView.showToast("请输入验证码");var i=new t.MsgLoginInfo;i.phoneNumber=e,i.code=a,i.loginUserType=t.LoginUserType.SMS,t.UserInfoService.getInstance().setLoginInfo(i),t.ConnectService.getInstance().getStatus()==ConnectConst.ConnectStatus.Connected?(t.CommonView.showWaiting(),t.UserInfoService.getInstance().login(i)):this.connectSocketServer(!0)},a.prototype.getGuestIndex=function(t){var e=t.currentTarget;return e==this.btnGuestLogin1?this.guestStartIndex+1:e==this.btnGuestLogin2?this.guestStartIndex+2:e==this.btnGuestLogin3?this.guestStartIndex+3:e==this.btnGuestLogin4?this.guestStartIndex+4:e==this.btnGuestLogin5?this.guestStartIndex+5:0},a.prototype.userloginCallback=function(e){t.CommonView.hideWaiting();var a=e.data;a.code==t.CmdResultType.SUCCESS?t.SceneSkip.skipToHallScene():t.CommonView.showToast("登陆失败，请重试!")},a.prototype.phoneNumberLoginCallBack=function(e){t.CommonView.hideWaiting();var a=e.data;if(a.code==t.CmdResultType.SUCCESS)t.SceneSkip.skipToHallScene();else if(a.errorCode==t.MsgConstant.ERROR_sms_code_expired)t.CommonView.showToast(Strings.smsCode_invalid);else if(a.errorCode==t.MsgConstant.ERROR_sms_phoneNumber_unBind){t.DialogManager.getInstance().show(new t.BindWeChatBox)}else t.CommonView.showToast("登陆失败，请重试")},a.prototype.getLoginSmsCodeCallBack=function(e){var a=e,i=a;if(i.code==t.CmdResultType.SUCCESS)this.codeTimer();else if(i.errorCode==t.MsgConstant.ERROR_sms_phoneNumber_unBind){t.DialogManager.getInstance().show(new t.BindWeChatBox)}else t.CommonView.showToast("获取验证失败")},a.prototype.codeTimer=function(){var t=this;this.btn_getCode.enabled=!1,this.lbTime.visible=!0,this.lbTime.text="60",this.timerTrigger=new egret.Timer(1e3,0),this.timerTrigger.addEventListener(egret.TimerEvent.TIMER,function(){t.currentTime--,t.lbTime.text=""+t.currentTime,t.currentTime<=0&&(t.btn_getCode.enabled=!0,t.lbTime.text="",t.timerTrigger.stop(),t.lbTime.visible=!1)},this),this.timerTrigger.start()},a.prototype.clean=function(){null!=this.weChatLoginBtn&&(this.weChatLoginBtn.hide(),this.weChatLoginBtn.destroy()),t.EAppFacade.getInstance().removeCommand(t.GameCmd.SOCKET_STATUS_CHANGE,this.connectHandler,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.userloginCallback,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_phoneNumber_login),this.phoneNumberLoginCallBack,this),e.prototype.clean.call(this)},a}(t.SceneBase);t.LoginScene=e,__reflect(e.prototype,"game.LoginScene")}(game||(game={}));var game;!function(t){var e;!function(t){t[t.NULL=0]="NULL",t[t.WEIXIN=1]="WEIXIN",t[t.GUEST=2]="GUEST",t[t.SMS=3]="SMS"}(e=t.LoginUserType||(t.LoginUserType={}));var a;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.MAN=1]="MAN",t[t.WOMAN=2]="WOMAN"}(a=t.GenderType||(t.GenderType={}))}(game||(game={}));var game;!function(t){var e=function(){function e(){this.openId="HHFJIAKAAK",this.nickName="老辛",this.hasRegisterInfo=!1,this.loginUserType=t.LoginUserType.NULL}return e.prototype.toJsonString=function(){return JSON.stringify(this)},e}();t.MsgLoginInfo=e,__reflect(e.prototype,"game.MsgLoginInfo")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.loginInfo=null,t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.loginCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.loginCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_phoneNumber_login),this.loginCallBack,this)}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.login=function(e){var a;this.loginInfo=e,this.loginInfo.loginUserType==t.LoginUserType.SMS?(a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_USER_phoneNumber_login,e),t.SocketManager.getInstance().send(a)):(a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_USER_LOGIN,e),t.SocketManager.getInstance().send(a))},e.prototype.autoLogin=function(){var a=DataStorage.readLocalData(DataStorageConst.DATA_KEY_UnionId);if(a.length>0&&"undefined"!=a){var i=new t.MsgLoginInfo;i.unionId=a,e.getInstance().login(i)}else e.getInstance().login(this.loginInfo)},e.prototype.loginCallBack=function(e){t.CommonView.hideWaiting();var a=e.data;if(a.code==t.MsgResultStatus.SUCCESS)GlobalData.userData.parse(a.data),GlobalData.userData.setDiamondNum(a.data.diamond),GlobalData.userData.setGoldNum(a.data.gold),"undefined"!=typeof a.data.unionId&&(this.loginInfo.unionId=a.data.unionId),this.loginInfo.phoneNumber=a.data.phoneNumber,this.loginInfo.loginUserType!=t.LoginUserType.GUEST&&DataStorage.writeLocalData(DataStorageConst.DATA_KEY_UnionId,this.loginInfo.unionId),t.EAppFacade.getInstance().sendNotification(t.GameCmd.USER_LOGIN_SUCCESS);else{var i=a.errorCode;if(i==t.MsgConstant.ERROR_forbid_login){t.CommonView.hideWaiting();Utils.format(Strings.fobidLogin,GlobalData.clientConfigs.customer_info)}}},e.prototype.getUserInfo=function(){return GlobalData.userData},e.prototype.setLoginInfo=function(t){this.loginInfo=t},e}();t.UserInfoService=e,__reflect(e.prototype,"game.UserInfoService")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getRulesInfo=function(e){var a=e,i=t.ConstantUtils.getRoomTypeName(a.roomType)+"  ";return i+=t.ConstantUtils.getPayModeName(a.payMode,!0)+"  ",i+="对局数："+a.turnNumber+t.ConstantUtils.getTurnModeName(a.turnMode)+"  ",i+=a.roomType==Constants.ROOM_TYPE.jinYuanZi?"携带积分："+a.roomScore+"分  ":a.roomScore>0?"单把上限："+a.roomScore+"分  ":"单把上限：无限制  ",a.huaZa&&(i+="花砸2  "),a.jieZhuangBi&&(i+="接庄比  "),a.faFen&&(i+="东南西北罚分  "),a.autoHost&&(i+="超时托管  "),a.calNum>0&&(i+="记分:"+a.calNum+"/100"),a.blessSwitch&&(i="防沉迷 "+i),i},e}();t.RoomUtils=e,__reflect(e.prototype,"game.RoomUtils")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.normalDialogMap=new t.HashMap,this.comfirmDialogMap=new t.HashMap}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.show=function(e,a){void 0===a&&(a=t.EDialog.show_ani_type_null);var i=!1,n=e instanceof t.ConfirmBox;i=n?this.comfirmDialogMap.containsKey(e.getDialogUUID()):this.normalDialogMap.containsKey(e.getDialogUUID()),i||(n?(Main.instance.confirmDialogLayer.addChild(e),this.comfirmDialogMap.put(e.getDialogUUID(),e)):(t.SceneManager.getInstance().getCurScene().addChild(e),this.normalDialogMap.put(e.getDialogUUID(),e)),e.show(a))},e.prototype.close=function(e,a){e.parent&&(e.parent.removeChild(e),e instanceof t.ConfirmBox?this.comfirmDialogMap.remove(e.getDialogUUID()):this.normalDialogMap.remove(e.getDialogUUID()),e=null)},e.prototype.showPopBox=function(e,a){void 0===a&&(a=null);var i=this.normalDialogMap.containsKey(e)||this.comfirmDialogMap.containsKey(e);if(!i){var n=null;switch(e){case Constants.UI_PANEL_DATA_SET.checkCheat.index:n=new t.CheckCheatBox;break;case Constants.UI_PANEL_DATA_SET.preventCheat.index:n=new t.PreventCheatBox(a);break;case Constants.UI_PANEL_DATA_SET.GameSettle_auto1.index:n=new t.GameSettleNormal(a);break;case Constants.UI_PANEL_DATA_SET.gameOverBox.index:n=new t.GameOverBox(a);break;case Constants.UI_PANEL_DATA_SET.applyQuit.index:n=new t.ApplyQuitBox(a);break;case Constants.UI_PANEL_DATA_SET.preventCheatStatusBox.index:n=new t.PreventCheatStatusBox;break;case Constants.UI_PANEL_DATA_SET.personInfoOther.index:n=new t.PersonalInfoOtherBox(a);break;case Constants.UI_PANEL_DATA_SET.todayRecords.index:n=new t.TodayRecordsBox;break;case Constants.UI_PANEL_DATA_SET.personInfo.index:n=new t.PersonalInfoBox(a);break;case Constants.UI_PANEL_DATA_SET.changePlayerNumBox.index:n=new t.ChangePlayerNumBox(a);break;case Constants.UI_PANEL_DATA_SET.GameScoreBoard.index:n=new t.GameScoreBoardBox;break;case Constants.UI_PANEL_DATA_SET.gameSetting.index:n=new t.GameSettingBox;break;case Constants.UI_PANEL_DATA_SET.roomInfoBox.index:n=new t.RoomInfoBox;break;case Constants.UI_PANEL_DATA_SET.chatBox.index:n=new t.GameChatBox;break;case Constants.UI_PANEL_DATA_SET.shop.index:n=new t.StoreBox(a);break;case Constants.UI_PANEL_DATA_SET.about.index:n=new t.AboutBox;break;case Constants.UI_PANEL_DATA_SET.wechatShare.index:n=new t.ShareBox;break;case Constants.UI_PANEL_DATA_SET.discardWinConfirmBox.index:n=new t.AbandomWinConfirmBox(a);break;case Constants.UI_PANEL_DATA_SET.advert.index:n=new t.AdvertBox(a)}null!=n&&this.show(n)}},e.prototype.popUp2=function(e,a,i){void 0===a&&(a=null),void 0===i&&(i=null);var n={type:2,info:e,confirmFunc:a,closeFun:i},o=new t.ConfirmBox(n);this.show(o)},e.prototype.popUp1=function(e,a){void 0===a&&(a=null);var i={type:1,info:e,confirmFunc:a},n=new t.ConfirmBox(i);this.show(n)},e.prototype.getBox=function(t){var e=this.normalDialogMap.get(t);return null==e&&(e=this.comfirmDialogMap.get(t)),e},e.prototype.clearAllDialog=function(){this.clearAllNormalDialog(),this.clearAllConfirmDialog()},e.prototype.clearAllNormalDialog=function(){for(var t=this.normalDialogMap.keySet(),e=0;e<t.length;e++){var a=this.normalDialogMap.get(t[e]);this.close(a)}},e.prototype.clearAllConfirmDialog=function(){for(var t=this.comfirmDialogMap.keySet(),e=0;e<t.length;e++){var a=this.comfirmDialogMap.get(t[e]);this.close(a)}Main.instance.confirmDialogLayer.removeChildren()},e}();t.DialogManager=e,__reflect(e.prototype,"game.DialogManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.offx=0,this.posMap=new t.HashMap}return e.getInstance=function(){return null==this.instance&&(this.instance=new e),this.instance},e.prototype.addPosData=function(t,e){this.posMap.put(t,e)},e.prototype.getPosData=function(t){return this.posMap.get(t)},e.prototype.setBoarderNode=function(t){var e=t.x,a=t.y;if(this.posMap.containsKey(t.hashCode)){var i=this.getPosData(t.hashCode);e=i.x,a=i.y}else this.posMap.put(t.hashCode,{x:e,y:a});t.x=this.convertX(e)},e.prototype.convertBoarderPos=function(t,e){return{x:t,y:e}},e.prototype.convertX=function(t){return t>GameConfig.ScreenW/2?t+this.offx:t-this.offx},e.prototype.setOffX=function(t){this.offx=t},e}();t.FixUIManager=e,__reflect(e.prototype,"game.FixUIManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.createBitmap=function(t){var e=new egret.Bitmap,a=RES.getRes(t);return e.texture=a,e},e.loadWebImage=function(a,i,n,o){void 0===o&&(o=5),egret.ImageLoader.crossOrigin="anonymous";var s=new egret.ImageLoader;s.addEventListener(egret.Event.COMPLETE,function(e){5>o&&t.LogUtils.info("重试成功  "+o);var s=e.currentTarget,r=new egret.Texture;null!=s.data?(r._setBitmapData(s.data),i.call(n,r,a)):t.LogUtils.info("加载图片失败...")},this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){t.LogUtils.info("加载图片错误..."),void 0!=o&&o>0&&(t.LogUtils.info("重试次数  "+o),e.loadWebImage(a,i,n,o-1))},this),s.load(a)},e}();t.ResManager=e,__reflect(e.prototype,"game.ResManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.curScene=null,this.sceneMap=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.skipToScene=function(t,e){void 0===e&&(e=!1),e?this.pushScene(t):this.replaceCurScene(t)},e.prototype.replaceCurScene=function(e){t.DialogManager.getInstance().clearAllConfirmDialog(),null!=this.curScene&&(Main.instance.sceneLayer.removeChild(this.curScene),this.curScene.onClose(),this.curScene=null),this.setCurScene(e)},e.prototype.setCurScene=function(t){this.curScene=t,Main.instance.sceneLayer.addChild(this.curScene),this.curScene.onShow()},e.prototype.pushScene=function(e){t.DialogManager.getInstance().clearAllConfirmDialog(),null!=this.curScene&&this.sceneMap.push(this.curScene),this.setCurScene(e)},e.prototype.popScene=function(){null!=this.curScene&&(Main.instance.sceneLayer.removeChild(this.curScene),this.curScene.onClose(),this.curScene=null),this.curScene=this.sceneMap.pop(),this.curScene.onShow()},e.prototype.isInGame=function(){return this.curScene instanceof t.GameScene?!0:!1},e.prototype.getCurScene=function(){return this.curScene},e.instance=null,e}();t.SceneManager=e,__reflect(e.prototype,"game.SceneManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.skipToGameScene=function(e,a){void 0===a&&(a=!1);var i=new t.GameScene(e);t.SceneManager.getInstance().skipToScene(i,a)},e.skipToLoginScene=function(e,a){void 0===a&&(a=!1);var i=new t.LoginScene;t.SceneManager.getInstance().skipToScene(i,a)},e.skipToHallScene=function(e,a){void 0===a&&(a=!1);var i=new t.HallScene;t.SceneManager.getInstance().skipToScene(i,a)},e.skipToClubScene=function(e,a){void 0===a&&(a=!1);var i=new t.ClubScene;t.SceneManager.getInstance().skipToScene(i,a)},e.skipToLoadinScene=function(e,a){void 0===a&&(a=!1);var i=new t.LoadingScene;t.SceneManager.getInstance().skipToScene(i,a)},e.skipToShopScene=function(t,e){void 0===e&&(e=!1)},e.skipToScene=function(t,a,i){switch(void 0===i&&(i=!1),t){case Constants.SCENE_INDEX.HOT_UPDATE:e.skipToLoadinScene(a,i);break;case Constants.SCENE_INDEX.GAME:e.skipToGameScene(a,i);break;case Constants.SCENE_INDEX.MAIN:e.skipToHallScene(a,i);break;case Constants.SCENE_INDEX.CLUB:e.skipToClubScene(a,i);break;case Constants.SCENE_INDEX.LOGIN:e.skipToLoginScene(a,i)}},e}();t.SceneSkip=e,__reflect(e.prototype,"game.SceneSkip")}(game||(game={}));var game;!function(t){var e=function(){function e(e,a){this.startTime=0,this.needTime=0,this.status=0,this.itemCmd=t.UUID.generateUUID(),this.timerType=a,this.needTime=e}return e.prototype.start=function(){var a=t.EAppFacade.getInstance().getNowTime();this.status=e.TimerStatus.start,this.startTime=a,this.updateLeftTime(a)},e.prototype.update=function(t){this.status=e.TimerStatus.process,this.updateLeftTime(t)},e.prototype.updateLeftTime=function(t){this.leftTime=this.needTime-(t-this.startTime),this.leftTime<0&&(this.leftTime=0,this.status=e.TimerStatus.end)},e.TimerType={once:1,perSec:2},e.TimerStatus={start:1,process:2,end:0},e}();t.TimerItem=e,__reflect(e.prototype,"game.TimerItem")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.lastTime=0,this.items=new t.HashMap,this.initData()}return e.prototype.initData=function(){t.EAppFacade.getInstance().getNowTime()},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.onTimer=function(){var a=t.EAppFacade.getInstance().getNowTime();if(a-this.lastTime>=e.UPDATE_TIME){t.EAppFacade.getInstance().sendNotification(t.TimerType.ONE_SECOND,""),this.lastTime=a;for(var i=this.items.values(),n=i.length,o=n-1;o>=0;o--){var s=i[o];s.update(a),s.leftTime<=0?(t.EAppFacade.getInstance().sendNotification(s.itemCmd,s),this.items.remove(s.itemCmd)):s.timerType==t.TimerItem.TimerType.perSec&&t.EAppFacade.getInstance().sendNotification(s.itemCmd,s)}}},e.prototype.startTimer=function(e,a,i,n){var o=new t.TimerItem(a,e);return t.EAppFacade.getInstance().registerCommand(o.itemCmd,i,n),this.items.put(o.itemCmd,o),o.start(),o.itemCmd},e.prototype.stopTimer=function(e,a){void 0===a&&(a=!1);var i=this.items.get(e);null!=i&&(this.items.remove(i.itemCmd),a&&t.EAppFacade.getInstance().sendNotification(e,i))},e.UPDATE_TIME=1e3,e}();t.TimerItemManager=e,__reflect(e.prototype,"game.TimerItemManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.timer=new egret.Timer(100,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this)}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.onTimer=function(){t.TimerItemManager.getInstance().onTimer()},e.prototype.start=function(){this.timer.start()},e.prototype.stop=function(){this.timer.stop()},e}();t.TimerManager=e,__reflect(e.prototype,"game.TimerManager")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.ONE_SECOND="TIMER_ONE_SECOND",t}();t.TimerType=e,__reflect(e.prototype,"game.TimerType")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.allCards={normalCard:[],huaCard:[]},this.cardValueList={Character:[1,2,3,4,5,6,7,8,9],Bamboo:[11,12,13,14,15,16,17,18,19],Dot:[21,22,23,24,25,26,27,28,29],Flower:[51,53,55,57,61,63,65,67],Wind:[31,33,35,37],Dragon:[41,43,45]},this.playerSet={},this.gameStatus=GameConst.GAME_STATUS_TYPE.playing,this.playerNum=4,this.isPlayBack=!0,this.testChairId=1}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.initMockData=function(){this.initUserData(),this.initRoomData(),this.initAllCards(),this.initAllPlayers()},e.prototype.initAllPlayers=function(){var e=1;GlobalData.gameData.setMyChairId(e),GlobalData.gameData.setDiscardChairId(e),this.testChairId=e;for(var a=(GameConst.ME_DIR,0);a<this.playerNum;a++){var i=a+1,n=GlobalData.gameData.changeChairIdToClientId(a),o=new t.PlayerInfo,s=Utils.getRandom(1,3);i==e?(o.setIP(GlobalData.userData.getIP()),o.setHeadIMGUrl(GlobalData.userData.getHeadIMGUrl()),o.setGender(GlobalData.userData.getGender()),o.setUserId(GlobalData.userData.getUserId()),o.setUserName(GlobalData.userData.getUserName())):(o.setIP("192.168.1."+i),o.setHeadIMGUrl(Constants.DEFAULT_HEAD_IMG_URL),o.setGender(s),o.setUserId(111+i),o.setUserName("1234456"+i)),o.setScore(GlobalData.gameData.getRoomInfo().getRoomScore()),o.setChairId(i),o.setStatus(GameConst.PLAYER_STATUS.PLAYING);
var r=new t.PlayerCardData;o.setCardData(r),r.setPongKongCards(this.getPongKongCards());var l=r.getPongKongNum();r.setPlayerHandCards(this.getHandCards(l,n,GlobalData.gameData.getDiscardChairId()==i)),r.setPlayerHuaCards(this.getHuaCards(n)),r.setPlayerOutCards(this.getOutCards(n)),this.playerSet[o.getChairId()]=o}},e.prototype.use=function(e){var a=e.area,i=e.cmd,n=null,o=a,s=i;a==t.MsgConstant.GAME&&i==t.MsgConstant.CMD_DISCARD&&(s=t.MsgConstant.CMD_DRAW,n={chairId:GlobalData.gameData.getMyChairId(),tileIds:[1],tingInfos:this.getTingTintData()}),null!=n&&this.sendMockData(o,s,n)},e.prototype.getPongKongCards=function(){for(var e=4,a=[],i=0;e>i;i++){var n=GameConst.PLAY_DIR.left;0==i?n=GameConst.PLAY_DIR.down:1==i&&(n=GameConst.PLAY_DIR.up);var o={type:GameConst.GAIN_TYPE.PongKong,provideClientId:n,value:[27]},s=new t.PongKongData(o);a.push(s)}return a},e.prototype.getOutCards=function(e){for(var a=15,i=[],n=0;a>n;n++){var o=this.allCards.normalCard.pop();null==o&&t.LogUtils.info(""),i.push(o)}return i},e.prototype.getHuaCards=function(t){for(var e=5,a=[],i=0;e>i&&0!=this.allCards.huaCard.length;i++){var n=this.allCards.huaCard.pop();a.push(n)}return a},e.prototype.getHandCards=function(t,e,a){for(var i=14-3*t,n=[],o=0;i>o;o++)if(e==GameConst.ME_DIR||this.isPlayBack){var s=this.allCards.normalCard.pop();n.push(1)}else n.push(0);if(n.sort(function(t,e){return t-e}),a)if(e==GameConst.ME_DIR||this.isPlayBack){var s=this.allCards.normalCard.pop();n.push(s)}else n.push(0);return n},e.prototype.initAllCards=function(){t.LogUtils.info("initAllCards");for(var e=0;e<this.cardValueList.Character.length;e++)for(var a=0;4>a;a++)this.allCards.normalCard.push(this.cardValueList.Character[e]);for(var e=0;e<this.cardValueList.Bamboo.length;e++)for(var a=0;4>a;a++)this.allCards.normalCard.push(this.cardValueList.Bamboo[e]);for(var e=0;e<this.cardValueList.Dot.length;e++)for(var a=0;4>a;a++)this.allCards.normalCard.push(this.cardValueList.Dot[e]);for(var e=0;e<this.cardValueList.Flower.length;e++)this.allCards.huaCard.push(this.cardValueList.Flower[e]);for(var e=0;e<this.cardValueList.Wind.length;e++)for(var a=0;4>a;a++)this.allCards.normalCard.push(this.cardValueList.Wind[e]);for(var e=0;e<this.cardValueList.Dragon.length;e++)for(var a=0;4>a;a++)this.allCards.huaCard.push(this.cardValueList.Dragon[e]);this.Shuffle()},e.prototype.Shuffle=function(){for(var t=this.allCards.normalCard.length,e=0;t>e;e++){var a=Utils.getRandom(e,t),i=this.allCards.normalCard[a];this.allCards.normalCard[a]=this.allCards.normalCard[e],this.allCards.normalCard[e]=i}for(var n=this.allCards.huaCard.length,e=0;n>e;e++){var a=Utils.getRandom(e,n),i=this.allCards.huaCard[a],i=this.allCards.huaCard[a];this.allCards.huaCard[a]=this.allCards.huaCard[e],this.allCards.huaCard[e]=i}},e.prototype.initRoomData=function(){var t={roomNumber:888888,roomType:Constants.ROOM_TYPE.jinYuanZi,roomScore:100,turnMode:Constants.ROOM_TIME_MODE.ba,turnNumber:8,payMode:Constants.ROOM_PAY_MODE.creator,huaZa:!0,faFen:!0,jieZhuangBi:!0,roomId:1,masterUserId:GlobalData.userData.getUserId()};GlobalData.gameData.getRoomInfo().parse(t)},e.prototype.initUserData=function(){var t={roomNumber:0,user:{userId:1,ip:"11.11.11.11",gender:Constants.GENDER.man,nickName:"测试玩家",headImgUrl:Constants.DEFAULT_HEAD_IMG_URL}};GlobalData.userData.parse(t),GlobalData.userData.setDiamondNum(123456),GlobalData.userData.setGoldNum(123456)},e.prototype.getMockGameData=function(){for(var e=this.getAllUserInfos(),a=[],i=0;i<this.playerNum;i++){t.LogUtils.info("mock reconnect msgUserGames i "+i);for(var n=i+1,o={msgUserData:e[n],jiaTileId:0,hasTing:!1,discardTileIds:this.playerSet[n].getCardData().getPlayerOutCards(),flowerIds:this.playerSet[n].getCardData().getPlayerHuaCards(),userTileIds:this.playerSet[n].getCardData().getPlayerHandCards(),gainTileInfos:[]},s=(GlobalData.gameData.changeChairIdToClientId(n),this.playerSet[n].getCardData().getPongKongCards()),r=0;r<s.length;r++){var l=s[r],c={discardChairId:GlobalData.gameData.changeClientIdToChairId(l.getProvideClientId()),gainType:l.getType(),tileIds:l.getValue()};o.gainTileInfos.push(c)}a.push(o)}var h=GlobalData.gameData.getRoomInfo(),u={bankerChairId:this.testChairId,biXiaHu:!0,biXiaHuDesc:"比下胡原因描述比下胡原因描述比下胡原因描述比下胡原因描述比下胡原因描述比下胡原因描述",curTurnNum:1,curTurnDirection:1,curChairId:GlobalData.gameData.getDiscardChairId(),lastDiscardChairId:4,lastDiscardTileId:1,stackTileNum:81,playerNum:this.playerNum,msgRoomGaming:{msgRoom:{roomNumber:h.getRoomNum(),roomType:h.getRoomType(),roomScore:h.getRoomScore(),turnMode:h.getTurnMode(),turnNumber:h.getTurnNumber(),payMode:h.getPayMode(),huaZa:h.isHuaZa(),faFen:h.isFaFen(),jieZhuangBi:h.isJieZhuangBi(),roomId:h.getRoomId(),masterUserId:h.getMasterUserId()},roomStatus:this.gameStatus},msgUserGames:a};return u},e.prototype.getAllUserInfos=function(){for(var t=[],e=0;e<this.playerNum;e++){var a=e+1,i=this.playerSet[a],n={chairId:i.getChairId(),userStatus:i.getStatus(),score:100,faScore:0,waiBaoScore:0,msgUser:this.getUserBaseInfo(a)};t[n.chairId]=n}return t},e.prototype.getUserBaseInfo=function(t){var e=this.playerSet[t],a={ip:e.getIP(),userId:e.getUserId(),gender:e.getGender(),headImgUrl:e.getHeadIMGUrl(),nickName:e.getUserName()};return a},e.prototype.sendMockData=function(e,a,i){var n={code:t.MsgResultStatus.SUCCESS,area:e,cmd:a,data:i},o=JSON.stringify(n),s=t.Base64Utils.encode(o+"\n");t.SocketManager.getInstance().onReceiveMessageEvent(s)},e.prototype.sendMockGameSettleData=function(){var e=this.getOverData();this.sendMockData(t.MsgConstant.GAME,t.MsgConstant.CMD_XJS_DATA,e)},e.prototype.getOverData=function(){for(var t={bankerChairId:GlobalData.gameData.getMyChairId(),baoPai:!0,baoPaiChairId:4,liuJuType:2,roomStatus:GameConst.GAME_STATUS_TYPE.over,winType:2,time:(new Date).getTime(),winPlayerNum:0,xJSUserInfos:null},e=[{curScore:210,faScore:90,score:400,superPointType:0,userChairId:1,waiBao:!0,waibaoScore:100,win:!0,msgUser:null,heapInfos:[{gain:!1,tileIds:[27,27]},{gain:!1,tileIds:[28,28]},{gain:!1,tileIds:[29,29]},{gain:!1,tileIds:[29,29]},{gain:!1,tileIds:[29,29]},{gain:!1,tileIds:[29,29]},{gain:!1,tileIds:[29,29]}],winTypeInfos:[{desc:"+10",name:"成牌",score:10,winPointType:0},{desc:"+10",name:"成牌",score:10,winPointType:0},{desc:"+10",name:"成牌",score:10,winPointType:0}]},{curScore:0,faScore:-30,score:0,superPointType:0,userChairId:4,waiBao:!1,waibaoScore:0,win:!1,msgUser:null,heapInfos:[{gain:!0,direction:1,tileIds:[27,27,27]},{gain:!0,direction:1,tileIds:[28,28,28,28]},{gain:!0,direction:1,tileIds:[29,29,29]},{gain:!0,direction:1,tileIds:[29,29,29]},{gain:!1,tileIds:[1]},{gain:!1,tileIds:[3]}],winTypeInfos:[{desc:"+10",name:"成牌",score:10,winPointType:0},{desc:"+10",name:"成牌",score:10,winPointType:0},{desc:"+10",name:"成牌",score:10,winPointType:0}]},{curScore:0,faScore:-30,score:0,superPointType:0,userChairId:2,waiBao:!1,waibaoScore:0,win:!1,msgUser:null,heapInfos:[{gain:!1,tileIds:[27,27,27,28,28,28,28,29,29,29,29,31,31]}]}],a=0;a<e.length;a++){var i=e[a].userChairId;e[a].msgUser=this.getUserBaseInfo(i)}return t.xJSUserInfos=e,t},e.prototype.getTingTintData=function(){for(var t=[],e=1;5>e;e++){var a={tileId:1,tingInfos:null};a.tileId=e;for(var i=[],n=0;2>n;n++){var o={tileId:1,num:1};o.tileId=e,o.num=e,i.push(o)}a.tingInfos=i,t.push(a)}return t},e.prototype.mockJiaPai=function(){var e={chairId:1,jiaTileId:1};this.sendMockData(t.MsgConstant.GAME,t.MsgConstant.CMD_JIA,e)},e}();t.Mock=e,__reflect(e.prototype,"game.Mock")}(game||(game={}));var ConnectConst;!function(t){t.ConnectStatus={Wait:0,Connecting:1,Connected:2,ConnectClose:3}}(ConnectConst||(ConnectConst={}));var game;!function(t){var e=function(){function e(){this.status=ConnectConst.ConnectStatus.Wait,this.timerRunning=!1}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.connect=function(a){this.udpateStatus(ConnectConst.ConnectStatus.Connecting),t.SocketManager.getInstance().connect(e.server_url,e.port,this.connectHandler.bind(this),t.DispatchHandler.getInstance().dispatch,a)},e.prototype.close=function(){t.SocketManager.getInstance().close()},e.prototype.udpateStatus=function(e){this.status=e,t.EAppFacade.getInstance().sendNotification(t.GameCmd.SOCKET_STATUS_CHANGE,{status:this.status}),t.LogUtils.info("连接状态变化="+this.status)},e.prototype.connectHandler=function(e){var a=e.status;this.udpateStatus(a),a==ConnectConst.ConnectStatus.Connected&&(t.HeartBeatService.getInstance(),t.UserInfoService.getInstance().autoLogin())},e.prototype.getStatus=function(){return this.status},e.prototype.startTimer=function(){this.timerRunning||(this.timerRunning=!0,null==this.timer&&(this.timer=new egret.Timer(1e3,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this)),this.timer.start())},e.prototype.stopTimer=function(){this.timer.stop(),this.timerRunning=!1},e.prototype.onTimer=function(){var e=this.status;e==ConnectConst.ConnectStatus.Connected?t.HeartBeatService.getInstance().sendHeartCmd():e!=ConnectConst.ConnectStatus.ConnectClose||GameConfig.localVersion||t.HeartBeatService.getInstance().reConnect()},e.port=9001,e.server_url=Constants.server_url_current,e}();t.ConnectService=e,__reflect(e.prototype,"game.ConnectService")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getRequestDomain=function(e,a,i){var n=new t.MsgDomain;return n.area=e,n.cmd=a,n.data=i,n},e.getSuccessResponseDomain=function(e,a,i){var n=new t.MsgDomain;return n.area=e,n.cmd=a,n.data=i,n.code=t.MsgResultStatus.SUCCESS,n},e.getFailedResponseDomain=function(e,a,i,n,o){var s=new t.MsgDomain;return s.area=e,s.cmd=a,s.data=o,s.code=t.MsgResultStatus.FAILED,s.errorCode=i,s.msg=n,s},e}();t.DomainUtils=e,__reflect(e.prototype,"game.DomainUtils")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.HALL=0,t.GAME=1,t.VERSION_ID=2,t.VERSION_NAME="2.0",t.ERROR_need_relogin=99999,t.ERROR_illegal_operation=99998,t.ERROR_forbid_login=99997,t.ERROR_creamRoom_inRoom=10001,t.ERROR_diamondNoEnough=10002,t.ERROR_creamRoom_paramError=10003,t.ERROR_room_over=10004,t.ERROR_joinRoom_roomId_error=10005,t.ERROR_join_inOtherRoom=10006,t.ERROR_join_ROOM_USERMAX=10007,t.ERROR_cancelDaiKai_gaming=10008,t.ERROR_hasNot_roomNumber=10009,t.ERROR_unionId_null=10010,t.ERROR_daiKai_maxLimit=10011,t.ERROR_Lack_userInfo=10012,t.ERROR_game_no_open=10013,t.ERROR_replaycode_no_exist=10014,t.ERROR_DataFormatIllegal=10020,t.ERROR_SaveEmailFail=10021,t.ERROR_playerNum3_low_version=10101,t.ERROR_playerNum3_repeatApply=10102,t.ERROR_Gold_not_enough=10201,t.ERROR_creamRoom_inRoom_new=10211,t.ERROR_content_already_end=10301,t.ERROR_redBag_valid_invite_not_enouth=10401,t.ERROR_redBag_valid_jus_not_enouth=10402,t.ERROR_club_hasPassed_member=10501,t.ERROR_club_hasUnCheck_member=10502,t.ERROR_club_memberTypeCanNotOperate=10503,t.ERROR_club_canNotRemoveSelf=10504,t.ERROR_club_monitorCanNotQuit=10505,t.ERROR_club_userIsNotInClub=10506,t.ERROR_club_MemberHasChecked=10507,t.ERROR_club_UserIdIsNotDaiLi=10508,t.ERROR_club_IsNotFund=10509,t.ERROR_club_userIsNotFund=10510,t.ERROR_club_roomMax=10511,t.ERROR_club_template_exist=10512,t.ERROR_club_black_list=10513,t.ERROR_admin_not_black=10514,t.ERROR_club_merge=10515,t.ERROR_watcher_not_normal=10516,t.ERROR_template_top_limit=10517,t.ERROR_invite_bind_no_proxy=10601,t.ERROR_invite_bind_has_proxy=10602,t.ERROR_need_refresh_board=10701,t.ERROR_combat_data_invalid=10801,t.ERROR_creamRoom_startscore_error=10901,t.ERROR_creamRoom_ckt_maxScore_error=10902,t.ERROR_redPacket_hasDraw=11001,t.ERROR_club_divide_memberExist=11101,t.ERROR_club_divide_memberNoExist=11102,t.ERROR_bless_not_enough=11010,t.ERROR_gold_not_enough=11011,t.ERROR_bless_score_limit=11012,t.ERROR_club_bless_isnot_member=11013,t.ERROR_sms_send_time_too_short=11201,t.ERROR_sms_code_expired=11202,t.ERROR_sms_code_wrong=11203,t.ERROR_sms_phoneNumber_hasBind=11204,t.ERROR_sms_phoneNumber_unBind=11205,t.ERROR_params_illegal_error=2e4,t.ERROR_wheel_not_modify=20001,t.ERROR_wheel_only_rate=20002,t.ERROR_room_not_gameing=20003,t.ERROR_user_realUser_name_error=20101,t.ERROR_user_realUser_idCardNo_error=20102,t.ERROR_belss_has_zero_del=20200,t.ERROR_belss_has_zero_set=20201,t.ERROR_not_set_group_manager=20202,t.ERROR_not_modify_self_bless=20203,t.ERROR_manager_not_by_set=20204,t.ERROR_manager_power_no_enough=20205,t.CMD_CREATE_ROOM=101,t.CMD_JOIN_ROOM=102,t.CMD_LEAVE_ROOM=103,t.CMD_CANCEL_ROOM=104,t.CMD_DISMISS_ROOM=105,t.CMD_REJECT_DISMISS_ROOM=106,t.CMD_SYSTEM_DISMISS_ROOM=107,t.CMD_CANCEL_DAIKAI_ROOM=108,t.CMD_CANCEL_TIMEOUT_ROOM=109,t.CMD_CLICK_CREATE_ROOM=110,t.CMD_CANCEL_DAIKAI_ROOM_BACK=131,t.CMD_CHEAT=132,t.CMD_IGNORE_CHEAT=133,t.CMD_CHEAT_LEAVE=134,t.CMD_SYNC_POSITION=135,t.CMD_CLIENT_QUERY_ROOMNUMBER=136,t.CMD_switch_player_num=151,t.CMD_switch_reject=152,t.CMD_switch_cancel=153,t.CMD_getCanUseNumber=160,t.CMD_OTHER_JOIN_ROOM=112,t.CMD_OTHER_LEAVE_ROOM=113,t.CMD_USER_LOGIN=201,t.CMD_USER_InviteCode=202,t.CMD_USER_Change_Status=203,t.CMD_USER_GETBINDSMSCODE=220,t.CMD_USER_getLoginSmsCode=221,t.CMD_USER_BINDPHONENUMBER=222,t.CMD_USER_phoneNumber_login=223,t.CMD_USER_BINDIDENTITY=230,t.CMD_EMAIL_LIST=401,t.CMD_SEND_EMAIL=402,t.CMD_SAVE_EMAIL=403,t.CMD_VIEW_EMAIL=404,t.CMD_DRAW_EMAIL_ATTACH=405,t.CMD_EMAIL_TIP=406,t.CMD_SEND_MSG=501,t.CMD_SEND_CHAT=502,t.CMD_SEND_FACE=503,t.CMD_SEND_MSG_ANI=504,t.CMD_ZHANJI_LIST=601,t.CMD_ZHANJI_DES_LIST=602,t.CMD_DAIKAI_LIST=603,t.CMD_CLUB_ZHANJI_LIST=605,t.CMD_REPLAY=610,t.CMD_Combat_REPLAY_data=611,t.CMD_SIGN_HASVIEW=614,t.CMD_PERSON_AGAINS=620,t.CMD_PERSON_TOTAL_AGAINS=621,t.CMD_get_clientConfigs=701,t.CMD_record_errorInfo=702,t.CMD_CONTENT_LIST=801,t.CMD_ADDORUPDATE_CONTENT=802,t.CMD_CONTENT_DETAIL=803,t.CMD_CONTENT_DELETE=804,t.CMD_CONTENT_SHOW_TYPE=805,t.CMD_Activity_ShowType=806,t.CMD_DRAW_LOTTERY_INITDATA=850,t.CMD_DRAW_LOTTERY_OPER=851,t.CMD_DRAW_LOTTERY_RECORDS=852,t.CMD_DRAW_LOTTERY_TAKED=853,t.CMD_DRAW_LOTTERY_ONERECORD=854,t.CMD_DRAW_LOTTERY_TIMES=855,t.CMD_GET_TASK_LIST=901,t.CMD_GET_TASK_REWARD=902,t.CMD_TASK_TIP=903,t.CMD_SHARE_SUCCESS=904,t.CMD_HTTP_ADD_NEW_TASK=905,t.CMD_HTTP_CHANGE_TASK_STATUS=906,t.CMD_HTTP_DEL_ALL_TASK=907,t.CMD_GET_SCORECARD_INFOS=920,t.CMD_HEAR_THROB=1e3,t.CMD_DISCARD=1001,t.CMD_PONG=1002,t.CMD_KONG=1003,t.CMD_CHOW=1004,t.CMD_WIN=1005,t.CMD_READY=1006,t.CMD_PASS=1007,t.CMD_FAFEN=1008,t.CMD_getFlowerIds=1011,t.CMD_DRAW=1012,t.CMD_JIA=1014,t.CMD_CANEL_JIA=1015,t.CMD_DEAL=1021,t.CMD_UPDATE_BOARD_INFO=1022,t.CMD_USER_RECONNECTION=1023,t.CMD_USER_STATUS_CHANGE=1031,t.CMD_READY_FOR_NEXT=1032,t.CMD_BACK_HALL=1033,t.CMD_BACK_GAME=1034,t.CMD_APP_Background=1035,t.CMD_APP_Foreground=1036,t.CMD_DISCARD_OTHER=1101,t.CMD_PONG_OTHER=1102,t.CMD_OPERATE_TIP=1201,t.CMD_XJS_DATA=1301,t.CMD_DJS_DATA=1401,t.CMD_AUTO_DISCARD=1501,t.CMD_AUTO_PASS=1502,t.CMD_Notice_AutoHost_start=1511,t.CMD_Notice_AutoHost_cancel=1512,t.CMD_Notice_AutoHost_Timer_start=1513,t.cmd_notice_autohost_status=1514,t.CMD_Notice_kick_lefttime=1601,t.CMD_Notice_cancel_kick=1602,t.ERROR_WEB_BODY_NULL=8e3,t.ERROR_WEB_UNKNOWN_ERROR=8001,t.ERROR_WEB_BODY_ERROR=8002,t.ERROR_WEB_need_bind_proxy=8003,t.CMD_CREATE_ORDER=2001,t.CMD_ORDER_FINISH=2002,t.CMD_QUERY_ORDER_STATUS=2003,t.CMD_GET_ITEL_INFOS=2004,t.CMD_GRANT_ITEM=3e3,t.CMD_USER_DIAMOND_CHANGE=3001,t.CMD_PROXY_GRANT_ITEM=3002,t.CMD_USER_GOLD_CHANGE=3101,t.CMD_checkHotUpdate=4001,t.CMD_checkAppUpdate=4002,t.CMD_getAllScrollMsg=5001,t.CMD_AddScrollMsg=5002,t.CMD_deleteScrollMsg=5003,t.CMD_getSingleScrollMsg=5004,t.CMD_updateScrollMsgStatus=5005,t.CMD_getUserInviteInfos=6001,t.CMD_getTotalInviteInfos=6002,t.CMD_getInviteInfos=6003,t.CMD_Invite_draw_user_reward=6004,t.CMD_Invite_draw_total_reward=6005,t.CMD_Invite_bind_proxy=6006,t.CMD_Invite_getUserInviteInfos=6021,t.CMD_Invite_applyDrawInviteReward=6022,t.CMD_Invite_getUserInviteHistory=6023,t.CMD_Invite_sendUserInviteReward=6024,t.CMD_getHallShareCfgs=6031,t.CMD_addHallShareCfgs=6032,t.CMD_getAllHallShareCfgs=6033,t.CMD_delHallShareCfgById=6034,t.CMD_httpSendMail=7001,t.CMD_SELF_CHECK_DEAL=80001,t.mail_valid_sec=1296e3,t.show_type=1,t.CMD_COMMON_gold_change=90001001,t.CMD_COMMON_diamond_change=90001002,t.CMD_COMMON_start_game_backDiamond=90001003,t.CMD_COMMON_close_room=90002001,t.CMD_COMMON_create_room=10001001,t.CMD_COMMON_check_startGame=10002001,t.CMD_COMMON_liujiu_over=10002002,t.CMD_CLUB_CREATE=9001,t.CMD_CLUB_CHECK=9002,t.CMD_CLUB_ALLLIST=9003,t.CMD_CLUB_JOIN=9004,t.CMD_CLUB_MEMBER_CHECK=9005,t.CMD_CLUB_MEMBERLIST=9006,t.CMD_CLUB_SET_MEMBER=9007,t.CMD_CLUB_BACK=9008,t.CMD_CLUB_ROOMINFOLIST=9009,t.CMD_CLUB_ROMEINFHIS=9010,t.CMD_CLUB_LIST=9011,t.CMD_CLUB_SET_HASPUSH=9012,t.CMD_CLUB_WAITCHECK_MEMBERLIST=9013,t.CMD_CLUB_SENDNOTICE=9014,t.CMD_CLUB_REMOVEMEMBER=9015,t.CMD_CLUB_NOTICE=9016,t.CMD_CLUB_ROOMINFO_CHANGE=9017,t.CMD_CLUB_MEMBER_CHANGE=9018,t.CMD_CLUB_ROOM_AUTOCREATE=9019,t.CMD_CLUB_ONE=9020,t.CMD_CLUB_get_inviteMember_info=9021,t.CMD_CLUB_medify_club_info=9022,t.CMD_CLUB_set_hasPopNotice=9023,t.CMD_CLUB_get_hasPopNotice=9024,t.CMD_CLUB_setting=9025,t.CMD_CLUB_getSettingInfo=9026,t.CMD_CLUB_forbid_game=9027,t.CMD_CLUB_roominfo_progress=9028,t.CMD_CLUB_apply_quit=9029,t.CMD_CLUB_check_apply_quit=9030,t.CMD_CLUB_forceCancelRoom=9031,t.CMD_CLUB_transferManager=9032,t.CMD_CLUB_BIND_ALL_MEMBER=9033,t.CMD_CLUB_BIND_ONE_MEMBER=9034,t.CMD_CLUB_update_free_time=9035,t.CMD_CLUB_query_free_time=9036,t.CMD_CLUB_del_proxy_club=9037,t.CMD_CLUB_get_template_names=9038,t.CMD_CLUB_updateTemplate=9040,t.CMD_CLUB_createTemplate=9041,t.CMD_CLUB_deleteTemplate=9042,t.CMD_CLUB_queryTemplates=9043,t.CMD_CLUB_createRoomByTemplateId=9044,t.CMD_CLUB_joinRoomByTemplateId=9045,t.CMD_CLUB_templateChange=9046,t.CMD_CLUB_merge=9047,t.CMD_CLUB_setWatcher=9048,t.CMD_CLUB_medify_templateNum=9049,t.CMD_CLUB_all_manager=9050,t.CMD_CLUB_modify_memberInfo=9051,t.CMD_CLUB_memberblesslist=9060,t.CMD_CLUB_blessmember=9061,t.CMD_CLUB_blessrecord=9062,t.CMD_CLUB_blesschangerecord=9063,t.CMD_CLUB_blessshopsetting=9064,t.CMD_CLUB_blessshoplist=9065,t.CMD_CLUB_shopexchange=9066,t.CMD_CLUB_grantexchangegold=9067,t.CMD_CLUB_exchangerecord=9068,t.CMD_CLUB_tryluck=9069,t.CMD_CLUB_myblessnum=9070,t.CMD_CLUB_exchangeratequery=9071,t.CMD_CLUB_bless_change_notice=9073,t.CMD_CLUB_BLESS_SCORE_ONLY=9074,t.CMD_CLUB_BATCH_MODIFY_BLESSNUM=9075,t.CMD_CLUB_MY_RECORD_DATA=9076,t.CMD_CLUB_set_permission=9101,t.CMD_CLUB_get_permission=9102,t.CMD_CLUB_notice_new_combat=9111,t.CMD_CLUB_get_operLog=9112,t.CMD_OPPART_GROUP_ADD=9200,t.CMD_OPPART_GROUP_DEL=9201,t.CMD_OPPART_GROUP_LIST=9202,t.CMD_OPPART_GROUP_BATCH_SETTING=9203,t.CMD_OPPART_GROUP_MEMBER_LIST=9206,t.CMD_OPPART_GROUP_MEMBER_DEL=9207,t.CMD_OPPART_SET_MANAGER=9208,t.CMD_OPPART_MAMAGER_RIGHT=9209,t.CMD_OPPART_MODIFYGROUPNAME=9210,t.CMD_CLUB_Divide_addDivide=10001,t.CMD_CLUB_Divide_removeDivide=10002,t.CMD_CLUB_Divide_updateDivideName=10003,t.CMD_CLUB_Divide_addDivideMember=10004,t.CMD_CLUB_Divide_removeDivideMember=10005,t.CMD_CLUB_Divide_getDivideMembers=10006,t.CMD_CLUB_Divide_getDivides=10007,t.CMD_CLUB_divide_all_member_list=10008,t}();t.MsgConstant=e,__reflect(e.prototype,"game.MsgConstant")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.version=t.MsgConstant.VERSION_NAME,this.versionId=t.MsgConstant.VERSION_ID,this.code=a.FAILED,this.errorCode=0,this.timestamp=t.EAppFacade.getInstance().getNowTime()}return e.toBean=function(t){var a=new e;return a.area=t.area,a.cmd=t.cmd,a.code=t.code,a.msg=t.msg,a.errorCode=t.errorCode,a.data=t.data,a},e}();t.MsgDomain=e,__reflect(e.prototype,"game.MsgDomain");var a;!function(t){t[t.FAILED=0]="FAILED",t[t.SUCCESS=1]="SUCCESS"}(a=t.MsgResultStatus||(t.MsgResultStatus={}))}(game||(game={}));var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.setStorage=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getStorage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,""]})})},t.prototype.getLocation=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.share=function(t,e,a,i,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getSystemInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{windowWidth:GameConfig.ScreenW,windowHeight:GameConfig.ScreenH,pixelRatio:1}]})})},t.prototype.shareWithImg=function(t,e,a,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.setClipboardData=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.setKeepScreenOn=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getBackgroundAudioPlayerState=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.playBackgroundAudio=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.pauseBackgroundAudio=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.stopBackgroundAudio=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getSetting=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getLaunchOptionsSync=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.onLaunch=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.onShow=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var game;!function(t){var e=function(){function e(){this.hallHandler=new t.HallHandler,this.gameHandler=new t.GameHandler}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.dispatch=function(a){var i=e.getInstance(),n=JSON.parse(a),o=t.MsgDomain.toBean(n),s=o.area;o.cmd;t.EAppFacade.getInstance().needUpdateServerTime()&&t.EAppFacade.getInstance().updateServerTime(o.timestamp),s==t.MsgConstant.HALL?i.hallHandler.handle(o):s==t.MsgConstant.GAME&&i.gameHandler.handle(o)},e}();t.DispatchHandler=e,__reflect(e.prototype,"game.DispatchHandler")}(game||(game={}));var game;!function(t){var e=function(e){function a(){return e.call(this)||this}return __extends(a,e),a.prototype.handle=function(a){e.prototype.handle.call(this,a);var i=a.cmd;switch(i){case t.MsgConstant.CMD_DEAL:t.GameDataService.getInstance().startGame(a);break;case t.MsgConstant.CMD_UPDATE_BOARD_INFO:GlobalData.isReconnecting&&GlobalData.setReconnecting(!1),t.GameDataService.getInstance().gameReconect(a),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED);break;case t.MsgConstant.CMD_USER_RECONNECTION:GlobalData.setReconnecting(!1),t.GameDataService.getInstance().parseReconnect(a);break;case t.MsgConstant.CMD_DRAW:t.GameDataService.getInstance().drawCard(a);break;case t.MsgConstant.CMD_DISCARD_OTHER:t.GameDataService.getInstance().otherDiscard(a);break;case t.MsgConstant.CMD_USER_STATUS_CHANGE:t.GameDataService.getInstance().playerStatusChanged(a);break;case t.MsgConstant.CMD_FAFEN:t.GameDataService.getInstance().faFenOperation(a);break;case t.MsgConstant.CMD_OPERATE_TIP:t.GameDataService.getInstance().operationCome(a);break;case t.MsgConstant.CMD_PONG:t.GameDataService.getInstance().pong(a);break;case t.MsgConstant.CMD_KONG:t.GameDataService.getInstance().kong(a);break;case t.MsgConstant.CMD_READY:t.GameDataService.getInstance().ready(a);break;case t.MsgConstant.CMD_DISCARD:t.GameDataService.getInstance().discard(a);break;case t.MsgConstant.CMD_PASS:t.GameDataService.getInstance().pass(a);break;case t.MsgConstant.CMD_AUTO_PASS:t.GameDataService.getInstance().autoPass(a);break;case t.MsgConstant.CMD_READY_FOR_NEXT:Utils.sendPanelEvent(t.GameCmd.CLOSE_GAME_SETTLE_PANEL);break;case t.MsgConstant.CMD_XJS_DATA:t.GameDataService.getInstance().xjsData(a);break;case t.MsgConstant.CMD_CHEAT:t.GameDataService.getInstance().preventCheatInfo(a);break;case t.MsgConstant.CMD_IGNORE_CHEAT:Utils.sendPanelEvent(t.GameCmd.CLOSE_CHEAT_INFO_BOX);break;case t.MsgConstant.CMD_CHEAT_LEAVE:GlobalData.gameData.setCheatStatus(!1),GlobalData.gameData.setNeedCheckCheat(!1),GlobalData.gameData.setPreventCheatInfo(null),Utils.sendPanelEvent(t.GameCmd.CLOSE_CHEAT_INFO_BOX);break;case t.MsgConstant.CMD_AUTO_DISCARD:t.GameDataService.getInstance().autoDiscard(a);break;case t.MsgConstant.CMD_Notice_AutoHost_start:t.GameDataService.getInstance().startAutoOfDelay(a);break;case t.MsgConstant.CMD_Notice_AutoHost_cancel:t.GameDataService.getInstance().cancelAutoOfDelay(a);break;case t.MsgConstant.CMD_Notice_AutoHost_Timer_start:t.GameDataService.getInstance().startAutoDiscardTimer(a);break;case t.MsgConstant.cmd_notice_autohost_status:t.GameDataService.getInstance().parseCanAutoHost(a);case t.MsgConstant.CMD_GET_SCORECARD_INFOS:t.GameDataService.getInstance().parseScoreBoardData(a);break;case t.MsgConstant.CMD_DJS_DATA:t.GameDataService.getInstance().djsData(a);break;case t.MsgConstant.CMD_SEND_MSG:t.GameDataService.getInstance().parseChatData(a);break;case t.MsgConstant.CMD_SEND_MSG_ANI:t.GameDataService.getInstance().parsePointEmotion(a);break;case t.MsgConstant.CMD_JIA:t.GameDataService.getInstance().beginJiapai(a);break;case t.MsgConstant.CMD_CANEL_JIA:t.GameDataService.getInstance().cancelJiapai(a);break;case t.MsgConstant.CMD_SYNC_POSITION:t.GameDataService.getInstance().parseAddress(a);break;case t.MsgConstant.CMD_getFlowerIds:t.GameDataService.getInstance().forceUpdateHuaCards(a);break;default:t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(i),a)}},a}(t.BaseHandler);t.GameHandler=e,__reflect(e.prototype,"game.GameHandler")}(game||(game={}));var game;!function(t){var e=function(e){function a(){return e.call(this)||this}return __extends(a,e),a.prototype.handle=function(a){e.prototype.handle.call(this,a);var i=a.cmd;switch(i){case t.MsgConstant.CMD_USER_LOGIN:t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(i),a);break;case t.MsgConstant.CMD_CREATE_ROOM:t.RoomService.getInstance().createRoomCallBack(a),t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(i),a);break;case t.MsgConstant.CMD_JOIN_ROOM:t.RoomService.getInstance().joinRoomCallBack(a);break;case t.MsgConstant.CMD_SYSTEM_DISMISS_ROOM:Utils.sendPanelEvent(t.GameCmd.CLOSE_APPLY_QUIT_PANEL);break;case t.MsgConstant.CMD_DISMISS_ROOM:t.GameDataService.getInstance().dissolveRoom(a);break;case t.MsgConstant.CMD_REJECT_DISMISS_ROOM:Utils.sendGameEvent(t.GameCmd.APPLY_QUIT_REJECT,a.data);break;case t.MsgConstant.CMD_CANCEL_ROOM:case t.MsgConstant.CMD_CANCEL_DAIKAI_ROOM:case t.MsgConstant.CMD_CANCEL_TIMEOUT_ROOM:t.GameDataService.getInstance().cancelRoom(a);break;case t.MsgConstant.CMD_LEAVE_ROOM:t.GameDataService.getInstance().playerLeaveRoom(a);break;case t.MsgConstant.CMD_OTHER_LEAVE_ROOM:t.GameDataService.getInstance().otherPlayerLeaveRoom(a);break;case t.MsgConstant.CMD_OTHER_JOIN_ROOM:t.GameDataService.getInstance().otherPlayerJoinRoom(a);break;case t.MsgConstant.CMD_PERSON_AGAINS:t.GameDataService.getInstance().myAgainstData(a);break;case t.MsgConstant.CMD_PERSON_TOTAL_AGAINS:t.GameDataService.getInstance().totalAgainstData(a);break;case t.MsgConstant.CMD_switch_reject:t.GameDataService.getInstance().rejectChangePlayerNum(a);break;case t.MsgConstant.CMD_switch_player_num:t.GameDataService.getInstance().agreeChangePlayerNum(a);break;case t.MsgConstant.CMD_switch_cancel:t.GameDataService.getInstance().cancelChangePlayerNum(a);break;case t.MsgConstant.CMD_REPLAY:t.GameDataService.getInstance().parseReplayData(a),t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(i),a);break;case t.MsgConstant.CMD_USER_DIAMOND_CHANGE:t.GameDataService.getInstance().parseDiamond(a),t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(i),a);break;case t.MsgConstant.CMD_USER_GOLD_CHANGE:t.GameDataService.getInstance().parseGold(a),t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(i),a);break;case t.MsgConstant.CMD_Notice_kick_lefttime:t.GameDataService.getInstance().noticeKickLeftTime(a);break;case t.MsgConstant.CMD_Notice_cancel_kick:t.GameDataService.getInstance().cancelKickLeftTime(a);break;case t.MsgConstant.CMD_USER_BINDIDENTITY:if(a.code==t.MsgResultStatus.SUCCESS){var n=a.data;Utils.sendPanelEvent(t.GameCmd.USER_BIND_ID,n)}else a.errorCode==t.MsgConstant.ERROR_user_realUser_name_error?t.CommonView.showToast("请填写真实的姓名"):a.errorCode==t.MsgConstant.ERROR_user_realUser_idCardNo_error&&t.CommonView.showToast("请填写真实的身份证号码");break;case t.MsgConstant.CMD_USER_GETBINDSMSCODE:if(a.code==t.MsgResultStatus.SUCCESS){var n=a.data;Utils.sendPanelEvent(t.GameCmd.USER_GETBINDSMSCODE,n)}else a.code==t.MsgResultStatus.FAILED&&t.CommonView.showToast("获取验证码失败");break;case t.MsgConstant.CMD_USER_BINDPHONENUMBER:if(a.code==t.MsgResultStatus.SUCCESS){var n=a.data;Utils.sendPanelEvent(t.GameCmd.USER_BINDPHONENUMBER,n)}else a.code==t.MsgResultStatus.FAILED&&t.CommonView.showToast("验证码错误");break;case t.MsgConstant.CMD_USER_BINDIDENTITY:if(a.code==t.MsgResultStatus.SUCCESS){var n=a.data;Utils.sendPanelEvent(t.GameCmd.PLAY_TOTAL_MESSAGE,n)}break;case t.MsgConstant.CMD_getAllScrollMsg:if(a.code==t.MsgResultStatus.SUCCESS){var n=a.data;t.CommonView.showBroadcast(n)}break;default:t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(i),a)}},a}(t.BaseHandler);t.HallHandler=e,__reflect(e.prototype,"game.HallHandler")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getFullUrl=function(e){return t.HTTP_URL+e},t.getErrString=function(t){var e="";switch(t){case 102:e="该账户已被暂停使用;请联系管理员";break;case 104:e="昵称重复";break;case 105:e="只允许输入中文,字母";break;case 106:e="您输入的昵称有敏感词";break;case 110:e="钻石不足";break;case 111:e="积攒数不足";break;case 121:e="对方好友数量已达到上限";break;case 122:e="您的好友数量已达到上限";break;case 130:e="您的PK次数不足";break;case 140:e="免费次数已用完";break;case 150:e="您不能领取";break;case 112:e="体力不足";break;case 113:e="没有可使用次数";break;case 160:e="不存在的激活码";break;case 161:e="已使用过的激活码";break;case 162:e="激活码已过期";break;case 163:e="钥匙数量不足";break;case 164:e="不能挑战自己"}return e},t.HTTP_PORT=8080,t.BASE_URL_PRODUCTION="http://127.0.0.1:8080/web/",t.BASE_URL_TEST="http://192.168.1.42:8080/web/",t.BASE_URL_ONLINE=Constants.server_url_current,t.HTTP_URL_HTTP=Utils.format("http://{0}:8080/web/",t.BASE_URL_ONLINE),t.HTTP_URL_HTTPS=Utils.format("https://{0}:8080/web/",t.BASE_URL_ONLINE),t.HTTP_URL_TEST="http://47.98.237.192:8080/web/",t.HTTP_URL_RELEASE="http://47.98.237.192:8080/web/",t.HTTP_URL_Tang="http://192.168.1.125:8080/web/",t.HTTP_URL=t.HTTP_URL_HTTP,t.HTTP_APP_SECRET="0ac1cab3409a1bd6fefe315b04710138",t.HTTP_APP_SECRET_new="7306165e6d0b5f44b07b2c5d63fefc1b",t.SIGNKEY_SOCIAL="0fc548c301f16da4f396dac8bc9304d4",t.inviteToClubURL="http://agent.qixigame.com/nanjing/wx/apply-club",t.url_checkAppUpdate="checkAppUpdate",t.url_getStoreList="getItemInfosNew",t.url_getCombatReplayData="game/getCombatReplayData",t.url_getUnionIdFromJsCode="user/getUnionIdFromJsCode",t.url_Feedback="user/feedback/add",t.url_getItemInfosNew="getItemInfosNew",t.url_getActivityList="content/contentList",t.url_getDiamondRecord="diamond/record",t.url_getGoldRecord="gold/record",t.url_createOrder="order/createOrder",t.url_getLoginSmsCode="user/getLoginSmsCode",t.url_pay_h5="http://agent.qixigame.com/nanjing/h5/do-pay",t.url_upload_head_img_in_app="http://agent.qixigame.com/nanjing/gamecontact/upload-head",t.url_get_head_img_data="http://agent.qixigame.com/nanjing/gamecontact/get-head-img",t.url_delete_head_img="http://agent.qixigame.com/nanjing/gamecontact/del-head-img",t.HTTP_STATUS_SUCCESS=1,t
}();t.GameHttpConst=e,__reflect(e.prototype,"game.GameHttpConst")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.checkAppUpdate=function(){var a=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_checkAppUpdate),i=this.getBaseData();e.request(a,i,e.checkAppUpdateCallBack)},e.checkAppUpdateCallBack=function(e){if(e.code==t.CmdResultType.SUCCESS){var a=e.data.clientConfigs;GlobalData.initClientConfigInfo(a)}},e.getCombatList=function(a){var i=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_checkAppUpdate),n=this.getBaseData();e.request(i,n,a)},e.getStoreList=function(a){var i=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getStoreList),n=this.getBaseData();n.diamondGroupId="2",n.goldGroupId="10002",e.request(i,n,a)},e.getCombatReplayData=function(a,i){var n=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getCombatReplayData),o=this.getBaseData();o.roomId=a,e.request(n,o,i)},e.getUnionId=function(a,i,n,o){var s=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getUnionIdFromJsCode),r=this.getBaseData();r.jscode=a,r.encryptedData=i,r.iv=n,e.request(s,r,o)},e.feeback=function(a,i,n,o,s){var r=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_Feedback),l=this.getBaseData();l.userId=a,l.type=i,l.content=n,l.telPhone=o,e.request(r,l,s)},e.getItemInfosNew=function(a,i,n){var o=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getItemInfosNew),s=this.getBaseData();s.diamondGroupId=a,s.goldGroupId=i,e.request(o,s,n)},e.getActivityList=function(a){var i=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getActivityList),n=this.getBaseData();e.request(i,n,a)},e.getDiamondRecord=function(a,i){var n=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getDiamondRecord),o=this.getBaseData();o.userId=a,e.request(n,o,i)},e.getGoldRecord=function(a,i){var n=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getGoldRecord),o=this.getBaseData();o.userId=a,e.request(n,o,i)},e.getLoginSmsCode=function(a,i){var n=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getLoginSmsCode),o=this.getBaseData();o.phoneNumber=a,e.request(n,o,i)},e.getBaseData=function(e){void 0===e&&(e=null);var a={};a.versionName=GameConfig.version,a.platform="H5",a.time=t.EAppFacade.getInstance().getNowTime();var i=new t.md5;null==e&&(e=t.GameHttpConst.HTTP_APP_SECRET_new);var n=i.hex_md5(a.time+"_"+e);return a.newSign=n,a},e.request=function(e,a,i,n){void 0===n&&(n=null);var o=this.getBaseData(n);for(var s in a)o[s]=a[s];var r=JSON.stringify(o);t.GameHttpRequest.request(e,r,i,n)},e}();t.GameHttpManager=e,__reflect(e.prototype,"game.GameHttpManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.request=function(t,a,i,n){void 0===n&&(n=null),e.sendPostRequest(t,a,i,n)},e.getSign=function(e,a){void 0===a&&(a=null);var i=new t.md5;return null==a&&(a=t.GameHttpConst.HTTP_APP_SECRET),i.hex_md5(e+a)},e.handleServerResult=function(e,a){if(t.LogUtils.info("data==="+e),e){var i=JSON.parse(e);a.call(a,i)}},e.sendPostRequest=function(a,i,n,o){void 0===o&&(o=null);var s=e.getSign(i,o),r=new egret.HttpRequest;r.responseType=egret.HttpResponseType.TEXT,r.setRequestHeader("sign",s),r.setRequestHeader("Content-Type","text/plain"),r.addEventListener(egret.Event.COMPLETE,function(a){var i=a.currentTarget;if(null!=i&&null!=i.response){var o=i.response;e.handleServerResult(o,n)}else t.CommonView.hideWaiting(),t.LogUtils.error("http 请求未知错误！")},this),r.addEventListener(egret.IOErrorEvent.IO_ERROR,function(e){t.CommonView.hideWaiting(),t.LogUtils.error("http 请求错误："+e)},this),r.addEventListener(egret.ProgressEvent.PROGRESS,function(t){},this),r.open(a,egret.HttpMethod.POST),r.send(i)},e.platformUID="333",e.uid="381",e.serverId="1",e.channel="777",e.channel_child="21",e.isShare=!1,e.shareuid="",e.shareserverId="",e.index=0,e}();t.GameHttpRequest=e,__reflect(e.prototype,"game.GameHttpRequest")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.status=ConnectConst.ConnectStatus.Wait}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.connect=function(e,a,i,n,o){if(this.status==ConnectConst.ConnectStatus.Connecting){if(!o)return;this.close(),this.clean()}else if(this.status==ConnectConst.ConnectStatus.Connected){if(!o)return;this.close(),this.clean()}this.status=ConnectConst.ConnectStatus.Connecting,this.url=e,this.port=a,this.connectHandler=i,this.msgHandler=n,this.webSocket=new egret.WebSocket,this.webSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.webSocket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.webSocket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),GameConfig.platform==GameConfig.PLATFORM_SET.H5?this.webSocket.connect(e,a):GameConfig.platform==GameConfig.PLATFORM_SET.weChat&&this.webSocket.connectByUrl("wss://"+e+"/wss"),t.LogUtils.info("开始连接，"+e+":"+a)},e.prototype.close=function(){this.status!=ConnectConst.ConnectStatus.ConnectClose&&(this.status=ConnectConst.ConnectStatus.ConnectClose,this.clean(),null!=this.connectHandler&&this.connectHandler.call(null,{status:this.status}))},e.prototype.clean=function(){null!=this.webSocket&&(this.webSocket.close(),this.webSocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.webSocket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.webSocket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.webSocket=null)},e.prototype.onSocketOpen=function(){t.LogUtils.info("连接成功"),this.status=ConnectConst.ConnectStatus.Connected,null!=this.connectHandler&&this.connectHandler.call(null,{status:this.status})},e.prototype.onSocketClose=function(){t.LogUtils.info("连接关闭"),this.close()},e.prototype.onReceiveMessage=function(t){var e=this.webSocket.readUTF();this.onReceiveMessageEvent(e)},e.prototype.onReceiveMessageEvent=function(e){var a=Base64.decode(e);GameConfig.localVersion&&(this.msgHandler=t.DispatchHandler.getInstance().dispatch),null!=this.msgHandler&&this.msgHandler.call(null,a)},e.prototype.send=function(e){if(GameConfig.localVersion&&t.Mock.getInstance().use(e),null!=e&&null!=this.webSocket){var a=JSON.stringify(e),i=t.Base64Utils.encode(a+"\n");this.webSocket.writeUTF(i)}},e.prototype.sendMsg=function(e,a,i){void 0===i&&(i=null);var n=t.DomainUtils.getRequestDomain(e,a,i);this.send(n)},e}();t.SocketManager=e,__reflect(e.prototype,"game.SocketManager")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.hasLoadBgm=!1}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.loadBGM=function(t,e){},t.prototype.getBGMUrl=function(){},t.prototype.onLoadComplete=function(t){var e=t.target;this.sound=e.data},t}();t.BGMManager=e,__reflect(e.prototype,"game.BGMManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.sounds=new t.HashMap}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.addSound=function(t,e){this.sounds.put(t.hashCode,e)},e.prototype.removeSound=function(t){this.sounds.remove(t)},e.prototype.play=function(e,a){void 0===a&&(a=1);var i=RES.getRes(e),n=i.play(0,a),o=new t.SoundItem(e,i,n,a);return this.addSound(n,o),o},e.prototype.playSound=function(t,e){return __awaiter(this,void 0,void 0,function(){var a,i,n;return __generator(this,function(o){return a=t,RES.hasRes(a)&&(i=RES.getRes(a),null==i?RES.getResAsync(a,function(a){this.playSound(t,e)},this):n=i.play(0,e)),[2]})})},e.prototype.playWxMusic=function(){platform.playBackgroundAudio("https://res.qixiyx.cn/file/bg.mp3")},e.prototype.playMusic=function(e,a,i){if(void 0===i&&(i=0),null!=t.SoundService.getInstance().curMusicChannel)return void(t.SoundService.getInstance().curMusicChannel.position=t.SoundService.getInstance().curMusicChannel.position);var n=e;if(RES.hasRes(n)){var o=RES.getRes(n);if(null==o)RES.getResAsync(n,function(t){this.playMusic(e,a)},this);else{t.SoundService.getInstance().curMusic=o,console.log("startPosition"+i);var s=t.SoundService.getInstance().curMusic.play(i,a);t.SoundService.getInstance().curMusicChannel=s}}},e.prototype.stopAllAudio=function(){var t=this.sounds.values();for(var e in t){var a=t[e];a.isBgMusic||(a.stop(),this.sounds.remove(a))}},e.prototype.stopAllSound=function(){var t=this.sounds.values();for(var e in t){var a=t[e];a.stop(),this.sounds.remove(a)}},e.prototype.pauseAllSound=function(){var t=this.sounds.values();for(var e in t){var a=t[e];a.pause()}},e.prototype.resumeAllSound=function(){var t=this.sounds.values();for(var e in t){var a=t[e];a.resume()}},e.prototype.resumeAllAudio=function(){var t=this.sounds.values();for(var e in t){var a=t[e];a.isBgMusic||a.resume()}},e}();t.SoundManager=e,__reflect(e.prototype,"game.SoundManager");var a=function(){function t(t,e,a,i){this.position=0,this.isPlaying=!1,this.isBgMusic=!1,this.name=t,this.sound=e,this.soundChannel=a,this.loops=i,this.isPlaying=!0,this.soundChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.playFinishCallback,this)}return t.prototype.playFinishCallback=function(t){egret.log("onSoundComplete");var a=t.target;e.getInstance().removeSound(a.hashCode)},t.prototype.stop=function(){this.clean()},t.prototype.pause=function(){this.position=this.soundChannel.position,this.clean()},t.prototype.resume=function(){if(!this.isPlaying){this.isPlaying=!0;var t=this.sound.play(this.position,this.loops);this.soundChannel=t,this.soundChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.playFinishCallback,this),e.getInstance().addSound(this.soundChannel,this)}},t.prototype.clean=function(){this.isPlaying=!1,this.soundChannel.stop(),e.getInstance().removeSound(this.soundChannel.hashCode),this.soundChannel.removeEventListener(egret.Event.SOUND_COMPLETE,this.playFinishCallback,this)},t}();t.SoundItem=a,__reflect(a.prototype,"game.SoundItem")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.isBgMusicOn=!0,this.isPlaying=!1,this.isAudioOn=!1,this.bgMusic=null,this.curMusic=null,this.curMusicChannel=null,this.curMusicChannelPos=0,this.curPos=0,this.initData()}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.initData=function(){this.isBgMusicOn=this.getBgMusicSwitch_(),this.isAudioOn=this.getAudioSwitch_(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.onResume,this.onResumeEvent,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.onPause,this.onPauseEvent,this)},e.prototype.onResumeEvent=function(){this.playMusic()},e.prototype.onPauseEvent=function(){this.pauseBgMusic()},e.prototype.getBgMusicSwitch=function(){return this.isBgMusicOn},e.prototype.getBgMusicSwitch_=function(){var t=DataStorage.readLocalData(LocalStorage.setting.GameMusicOn,"1");return"1"==t},e.prototype.setBgMusicSwitch=function(t){var e=t?1:0;this.isBgMusicOn=t,DataStorage.writeLocalData(LocalStorage.setting.GameMusicOn,""+e)},e.prototype.getAudioSwitch=function(){return this.isAudioOn},e.prototype.getAudioSwitch_=function(){var t=DataStorage.readLocalData(LocalStorage.setting.GameEffectOn,"1");return"1"==t},e.prototype.setAudioSwitch=function(t){var e=t?1:0;this.isAudioOn=t,DataStorage.writeLocalData(LocalStorage.setting.GameEffectOn,""+e)},e.prototype.playAudio=function(e,a){void 0===a&&(a=1),this.isAudioOn&&t.SoundManager.getInstance().playSound(e,a)},e.prototype.playMusic=function(e){void 0===e&&(e="bg_mp3"),this.isPlaying||(this.isBgMusicOn&&(GameConfig.platform==GameConfig.PLATFORM_SET.H5?t.SoundManager.getInstance().playMusic(e,0,this.curMusicChannelPos):t.SoundManager.getInstance().playWxMusic()),this.isPlaying=!0)},e.prototype.playBgMusic=function(e){void 0===e&&(e="bg_mp3"),this.isBgMusicOn&&(null==this.bgMusic?(this.bgMusic=t.SoundManager.getInstance().play(e,0),this.bgMusic.isBgMusic=!0):this.bgMusic.resume())},e.prototype.pauseBgMusic=function(){this.isPlaying=!1,GameConfig.platform==GameConfig.PLATFORM_SET.H5?null!=this.curMusicChannel&&(this.curMusicChannelPos=this.curMusicChannel.position,this.curMusicChannel.stop(),this.curMusicChannel=null):GameConfig.platform==GameConfig.PLATFORM_SET.weChat&&platform.pauseBackgroundAudio()},e.prototype.resumeBgMusic=function(){this.playMusic()},e.prototype.stopAllAudio=function(){t.SoundManager.getInstance().stopAllAudio()},e.prototype.resumeAllAudio=function(){this.isAudioOn&&t.SoundManager.getInstance().resumeAllAudio()},e.instance=null,e}();t.SoundService=e,__reflect(e.prototype,"game.SoundService")}(game||(game={}));var Test_imgUpload=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAdded2stage,e),e}return __extends(e,t),e.prototype.onAdded2stage=function(t){console.log("Test imgUpload added2stage!"),this.createGameScene()},e.prototype.createGameScene=function(){},e.prototype.doSelect=function(t){isWeixin()?selectImageWX(this.selectedHandler,this):selectImage(this.selectedHandler,this)},e.prototype.selectedHandler=function(t,e,a){RES.getResByUrl(e,t.compFunc,t,RES.ResourceItem.TYPE_IMAGE),getImageData(a,t.bytesHandler,t)},e.prototype.bytesHandler=function(t,e){console.log("大图数据:"+e)},e.prototype.compFunc=function(t){var e=new egret.Bitmap(t);e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.removeImgReview,this),this.addChild(e)},e.prototype.removeImgReview=function(t){var e=t.currentTarget;this.removeChild(e)},e}(egret.Sprite);__reflect(Test_imgUpload.prototype,"Test_imgUpload");var Test_uploadBase64=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAdded2stage,e),e}return __extends(e,t),e.prototype.onAdded2stage=function(t){console.log("Test imgUpload added2stage!"),this.createGameScene()},e.prototype.createGameScene=function(){},e.prototype.doSelect=function(t){isWeixin()?selectImageWX(this.selectedHandler,this):selectImage(this.selectedHandler,this)},e.prototype.selectedHandler=function(t,e,a){RES.getResByUrl(e,t.compFunc,t,RES.ResourceItem.TYPE_IMAGE)},e.prototype.bytesHandler=function(t,e){console.log("大图数据:"+e)},e.prototype.compFunc=function(t){var e=new egret.Bitmap(t);e.touchEnabled=!0,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.removeImgReview,this),this.addChild(e),this.uploadImgByTexture(t)},e.prototype.removeImgReview=function(t){var e=t.currentTarget;this.removeChild(e)},e.prototype.uploadImgByTexture=function(t){console.log("texture.wid:"+t.textureWidth+",hei:"+t.textureHeight);var e=t.toDataURL("image/jpeg");this.uploadData(e)},e.prototype.uploadData=function(t){var e="name=jarbowPic&imgData="+t,a=new egret.HttpRequest;a.responseType=egret.HttpResponseType.TEXT,a.open("http://localhost:4000/egretUpload",egret.HttpMethod.POST),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(e),a.addEventListener(egret.Event.COMPLETE,this.onDataComplete,this),a.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onPostIOError,this),a.addEventListener(egret.ProgressEvent.PROGRESS,this.onPostProgress,this)},e.prototype.onDataComplete=function(t){var e=t.currentTarget,a=String(e.response);console.log("onDataComplete data : "+a)},e.prototype.onPostIOError=function(t){console.log("post error : "+t)},e.prototype.onPostProgress=function(t){console.log("post progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")},e}(egret.Sprite);__reflect(Test_uploadBase64.prototype,"Test_uploadBase64");var Base64;!function(t){function e(t){for(var e="",a=0;a<t.length;a++)""===e?e=t.charCodeAt(a).toString(16):e+=","+t.charCodeAt(a).toString(16);return new Uint8Array(e.match(/[\da-f]{2}/gi).map(function(t){return parseInt(t,16)})).buffer}function a(t){var e,a,i,n,o,s;for(e="",i=t.length,a=0;i>a;)switch(n=t[a++],n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCharCode(n);break;case 12:case 13:o=t[a++],e+=String.fromCharCode((31&n)<<6|63&o);break;case 14:o=t[a++],s=t[a++],e+=String.fromCharCode((15&n)<<12|(63&o)<<6|(63&s)<<0)}var r=new RegExp("[%$]+","ig");e=e.replace(r,"");var l=decodeURIComponent(e);return l}function i(t){for(var e=new Uint16Array(t),a=e.length,i="",n=Math.pow(2,16)-1,o=0;a>o;o+=n)o+n>a&&(n=a-o),i+=String.fromCharCode.apply(null,e.subarray(o,o+n));return decodeURIComponent(i)}function n(e){var a=e.length;if(0===a)return"";if(a%4!==0)throw new Error("Bad length: "+a);if(!e.match(/^[a-zA-Z0-9+\/]+={0,2}$/))throw new Error("Invalid base64 encoded value");var i=3*(a/4),n=0;"="===e.charAt(a-1)&&(n++,i--),"="===e.charAt(a-2)&&(n++,i--);var o,r=new Uint8Array(new ArrayBuffer(i)),l=0,c=0;for(n>0&&(a-=4);a>l;){o=0;for(var h=0;4>h;++h)o=o<<6|s[e.charAt(l+h)];r[c++]=o>>16&255,r[c++]=o>>8&255,r[c++]=255&o,l+=4}if(n>0){o=0;for(var h=0;4-n>h;++h)o=o<<6|s[e.charAt(l+h)];1===n?(o>>=2,r[c++]=o>>8&255,r[c++]=255&o):(o>>=4,r[c++]=255&o)}return t.Utf8ArrayToStr(r)}for(var o="pqabcdeABCDEFGHIJKLklmMNOPQRS34TUVWX8YZfghijnor+stuvwxyz0125679/",s={},r=0;r<o.length;++r)s[o[r]]=r;t.stringToUint=e,t.Utf8ArrayToStr=a,t.arrayBufferToString=i,t.decode=n}(Base64||(Base64={}));var game;!function(t){var e=function(){function t(){}return t.getBytes=function(t){for(var e=[],a=0;a<t.length;++a)e.push(t.charCodeAt(a));return e},t.encode=function(e){e=e.replace(/\r\n/g,"\n");var a,i,n,o,s,r,l,c="",h=0;for(e=t._utf8_encode(e);h<e.length;)a=e.charCodeAt(h++),i=e.charCodeAt(h++),n=e.charCodeAt(h++),o=a>>2,s=(3&a)<<4|i>>4,r=(15&i)<<2|n>>6,l=63&n,isNaN(i)?r=l=64:isNaN(n)&&(l=64),c=c+t._keyStr.charAt(o)+t._keyStr.charAt(s)+t._keyStr.charAt(r)+t._keyStr.charAt(l);return c},t._utf8_encode=function(t){for(var e="",a=0;a<t.length;a++){var i=t.charCodeAt(a);128>i?e+=String.fromCharCode(i):i>127&&2048>i?(e+=String.fromCharCode(i>>6|192),e+=String.fromCharCode(63&i|128)):(e+=String.fromCharCode(i>>12|224),e+=String.fromCharCode(i>>6&63|128),e+=String.fromCharCode(63&i|128))}return e},t._utf8_decode=function(t){for(var e="",a=0,i=0,n=0,o=0;a<t.length;)i=t.charCodeAt(a),128>i?(e+=String.fromCharCode(i),a++):i>191&&224>i?(n=t.charCodeAt(a+1),e+=String.fromCharCode((31&i)<<6|63&n),a+=2):(n=t.charCodeAt(a+1),o=t.charCodeAt(a+2),e+=String.fromCharCode((15&i)<<12|(63&n)<<6|63&o),a+=3);return e},t._keyStr="pqabcdeABCDEFGHIJKLklmMNOPQRS34TUVWX8YZfghijnor+stuvwxyz0125679/",t}();t.Base64Utils=e,__reflect(e.prototype,"game.Base64Utils")}(game||(game={}));var DataStorage=function(){function t(){}return t.writeLocalData=function(t,e){egret.localStorage.setItem(t,e)},t.readLocalData=function(t,e){(void 0==e||null==e)&&(e="");var a="";return a=egret.localStorage.getItem(t),a=""==a||void 0==a||null==a?e:a},t.removeLocalData=function(t){egret.localStorage.removeItem(t)},t}();__reflect(DataStorage.prototype,"DataStorage");var DataStorageConst=function(){function t(){}return t.DATA_KEY_UnionId="login_user_unionId_1",t.DATA_KEY_DECLARE_CREATE_ROOM="DATA_KEY_DECLARE_CREATE_ROOM",t}();__reflect(DataStorageConst.prototype,"DataStorageConst");var game;!function(t){var e=function(){function t(){}return t.dateToString=function(t){},t.dateFormat=function(e){return t.dateFormat1(e,!0)},t.dateFormat1=function(t,e,a){void 0===a&&(a=!1);var i=new Date(t),n=i.getFullYear(),o=i.getMonth()+1,s=i.getDate(),r=i.getHours(),l=i.getMinutes(),c=i.getSeconds(),h="";return a||(h=n+"/",10>o&&(h+="0"),h+=o+"/",10>s&&(h+="0"),h+=s+" "),10>r&&(h+="0"),h+=r+":",10>l&&(h+="0"),h+=l,e&&(h+=":",10>c&&(h+="0"),h+=c),h},t.dateDesc=function(t){var e=Math.floor(t/1e3),a=e,i=Math.floor(e/86400);i>0&&(a=e%i*24*3600);var n=Math.floor(a/3600);n>0&&(a%=3600*n);var o=Math.floor(a/60);o&&(a%=60*o);var s=a,r="";return i>0&&(r+=i+"天"),n>0&&(r+=n+"小时"),o>0&&(r+=o+"分"),s>0&&(r+=s+"秒"),r},t.getRangeDate=function(t,e,a){void 0===a&&(a=["年","月","日"]);var i,n=function(t){for(var e=new Date(t),i=""+e.getFullYear(),n=""+(e.getMonth()+1),o=""+e.getDate(),s=[i,n,o],r="",l=0;3>l;l++)""!==a[l]&&(r=r+s[l]+a[l]);return r},o=n((new Date).getTime()),s=[];if(t){if(!e)return i=n((new Date).getTime()+864e5*t),console.log(i),i;if("one"===e)return i=n((new Date).getTime()+864e5*t),console.log(i),i;if("more"===e){if(0>t){for(var r=0;r<Math.abs(t);r++)s.push(n((new Date).getTime()+-864e5*r));return console.log(s),s}if(t>0){for(var r=0;t>r;r++)s.push(n((new Date).getTime()+864e5*r));return console.log(s),s}return o}}},t}();t.DateUtils=e,__reflect(e.prototype,"game.DateUtils")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.length=0,this.obj=new Object}return t.prototype.isEmpty=function(){return 0==this.length},t.prototype.containsKey=function(t){return t in this.obj},t.prototype.containsValue=function(t){for(var e in this.obj)if(this.obj[e]==t)return!0;return!1},t.prototype.put=function(t,e){this.containsKey(t)||this.length++,this.obj[t]=e},t.prototype.get=function(t){return this.containsKey(t)?this.obj[t]:null},t.prototype.remove=function(t){this.containsKey(t)&&delete this.obj[t]&&this.length--},t.prototype.values=function(){var t=new Array;for(var e in this.obj)t.push(this.obj[e]);return t},t.prototype.keySet=function(){var t=new Array;for(var e in this.obj)t.push(e);return t},t.prototype.size=function(){return this.length},t.prototype.clear=function(){this.length=0,this.obj=new Object},t}();t.HashMap=e,__reflect(e.prototype,"game.HashMap")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getStringFromJson=function(t,e){var a=t[e];return null==a?"":a},t.getNumberFromJson=function(t,e){var a=t[e];return null==a?0:Number(a)},t}();t.JsonUtils=e,__reflect(e.prototype,"game.JsonUtils")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.info=function(e){console.log(t.DateUtils.dateFormat((new Date).getTime())+" "+e)},e.error=function(t){},e}();t.LogUtils=e,__reflect(e.prototype,"game.LogUtils")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.md5_16=function(t){var e=this.hex_md5(t);return e.substring(8,24)},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,a){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),a)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var a=this.rstr2binl(t);a.length>16&&(a=this.binl_md5(a,8*t.length));for(var i=Array(16),n=Array(16),o=0;16>o;o++)i[o]=909522486^a[o],n[o]=1549556828^a[o];var s=this.binl_md5(i.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(n.concat(s),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var a,i=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",o=0;o<t.length;o++)a=t.charCodeAt(o),n+=i.charAt(a>>>4&15)+i.charAt(15&a);return n},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",n=t.length,o=0;n>o;o+=3)for(var s=t.charCodeAt(o)<<16|(n>o+1?t.charCodeAt(o+1)<<8:0)|(n>o+2?t.charCodeAt(o+2):0),r=0;4>r;r++)i+=8*o+6*r>8*t.length?this.b64pad:a.charAt(s>>>6*(3-r)&63);return i},t.prototype.rstr2any=function(t,e){var a,i,n,o,s,r=e.length,l=Array(Math.ceil(t.length/2));for(a=0;a<l.length;a++)l[a]=t.charCodeAt(2*a)<<8|t.charCodeAt(2*a+1);var c=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),h=Array(c);for(i=0;c>i;i++){for(s=Array(),o=0,a=0;a<l.length;a++)o=(o<<16)+l[a],n=Math.floor(o/r),o-=n*r,(s.length>0||n>0)&&(s[s.length]=n);h[i]=o,l=s}var u="";for(a=h.length-1;a>=0;a--)u+=e.charAt(h[a]);return u},t.prototype.str2rstr_utf8=function(t){for(var e,a,i="",n=-1;++n<t.length;)e=t.charCodeAt(n),a=n+1<t.length?t.charCodeAt(n+1):0,e>=55296&&56319>=e&&a>=56320&&57343>=a&&(e=65536+((1023&e)<<10)+(1023&a),n++),127>=e?i+=String.fromCharCode(e):2047>=e?i+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?i+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(i+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return i},t.prototype.str2rstr_utf16le=function(t){for(var e="",a=0;a<t.length;a++)e+=String.fromCharCode(255&t.charCodeAt(a),t.charCodeAt(a)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",a=0;a<t.length;a++)e+=String.fromCharCode(t.charCodeAt(a)>>>8&255,255&t.charCodeAt(a));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),a=0;a<e.length;a++)e[a]=0;for(var a=0;a<8*t.length;a+=8)e[a>>5]|=(255&t.charCodeAt(a/8))<<a%32;return e},t.prototype.binl2rstr=function(t){for(var e="",a=0;a<32*t.length;a+=8)e+=String.fromCharCode(t[a>>5]>>>a%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var a=1732584193,i=-271733879,n=-1732584194,o=271733878,s=0;s<t.length;s+=16){var r=a,l=i,c=n,h=o;a=this.md5_ff(a,i,n,o,t[s+0],7,-680876936),o=this.md5_ff(o,a,i,n,t[s+1],12,-389564586),n=this.md5_ff(n,o,a,i,t[s+2],17,606105819),i=this.md5_ff(i,n,o,a,t[s+3],22,-1044525330),a=this.md5_ff(a,i,n,o,t[s+4],7,-176418897),o=this.md5_ff(o,a,i,n,t[s+5],12,1200080426),n=this.md5_ff(n,o,a,i,t[s+6],17,-1473231341),i=this.md5_ff(i,n,o,a,t[s+7],22,-45705983),a=this.md5_ff(a,i,n,o,t[s+8],7,1770035416),o=this.md5_ff(o,a,i,n,t[s+9],12,-1958414417),n=this.md5_ff(n,o,a,i,t[s+10],17,-42063),i=this.md5_ff(i,n,o,a,t[s+11],22,-1990404162),a=this.md5_ff(a,i,n,o,t[s+12],7,1804603682),o=this.md5_ff(o,a,i,n,t[s+13],12,-40341101),n=this.md5_ff(n,o,a,i,t[s+14],17,-1502002290),i=this.md5_ff(i,n,o,a,t[s+15],22,1236535329),a=this.md5_gg(a,i,n,o,t[s+1],5,-165796510),o=this.md5_gg(o,a,i,n,t[s+6],9,-1069501632),n=this.md5_gg(n,o,a,i,t[s+11],14,643717713),i=this.md5_gg(i,n,o,a,t[s+0],20,-373897302),a=this.md5_gg(a,i,n,o,t[s+5],5,-701558691),o=this.md5_gg(o,a,i,n,t[s+10],9,38016083),n=this.md5_gg(n,o,a,i,t[s+15],14,-660478335),i=this.md5_gg(i,n,o,a,t[s+4],20,-405537848),a=this.md5_gg(a,i,n,o,t[s+9],5,568446438),o=this.md5_gg(o,a,i,n,t[s+14],9,-1019803690),n=this.md5_gg(n,o,a,i,t[s+3],14,-187363961),i=this.md5_gg(i,n,o,a,t[s+8],20,1163531501),a=this.md5_gg(a,i,n,o,t[s+13],5,-1444681467),o=this.md5_gg(o,a,i,n,t[s+2],9,-51403784),n=this.md5_gg(n,o,a,i,t[s+7],14,1735328473),i=this.md5_gg(i,n,o,a,t[s+12],20,-1926607734),a=this.md5_hh(a,i,n,o,t[s+5],4,-378558),o=this.md5_hh(o,a,i,n,t[s+8],11,-2022574463),n=this.md5_hh(n,o,a,i,t[s+11],16,1839030562),i=this.md5_hh(i,n,o,a,t[s+14],23,-35309556),a=this.md5_hh(a,i,n,o,t[s+1],4,-1530992060),o=this.md5_hh(o,a,i,n,t[s+4],11,1272893353),n=this.md5_hh(n,o,a,i,t[s+7],16,-155497632),i=this.md5_hh(i,n,o,a,t[s+10],23,-1094730640),a=this.md5_hh(a,i,n,o,t[s+13],4,681279174),o=this.md5_hh(o,a,i,n,t[s+0],11,-358537222),n=this.md5_hh(n,o,a,i,t[s+3],16,-722521979),i=this.md5_hh(i,n,o,a,t[s+6],23,76029189),a=this.md5_hh(a,i,n,o,t[s+9],4,-640364487),o=this.md5_hh(o,a,i,n,t[s+12],11,-421815835),n=this.md5_hh(n,o,a,i,t[s+15],16,530742520),i=this.md5_hh(i,n,o,a,t[s+2],23,-995338651),a=this.md5_ii(a,i,n,o,t[s+0],6,-198630844),o=this.md5_ii(o,a,i,n,t[s+7],10,1126891415),n=this.md5_ii(n,o,a,i,t[s+14],15,-1416354905),i=this.md5_ii(i,n,o,a,t[s+5],21,-57434055),a=this.md5_ii(a,i,n,o,t[s+12],6,1700485571),o=this.md5_ii(o,a,i,n,t[s+3],10,-1894986606),n=this.md5_ii(n,o,a,i,t[s+10],15,-1051523),i=this.md5_ii(i,n,o,a,t[s+1],21,-2054922799),a=this.md5_ii(a,i,n,o,t[s+8],6,1873313359),o=this.md5_ii(o,a,i,n,t[s+15],10,-30611744),n=this.md5_ii(n,o,a,i,t[s+6],15,-1560198380),i=this.md5_ii(i,n,o,a,t[s+13],21,1309151649),a=this.md5_ii(a,i,n,o,t[s+4],6,-145523070),o=this.md5_ii(o,a,i,n,t[s+11],10,-1120210379),n=this.md5_ii(n,o,a,i,t[s+2],15,718787259),i=this.md5_ii(i,n,o,a,t[s+9],21,-343485551),a=this.safe_add(a,r),i=this.safe_add(i,l),n=this.safe_add(n,c),o=this.safe_add(o,h)}return[a,i,n,o]},t.prototype.md5_cmn=function(t,e,a,i,n,o){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(i,o)),n),a)},t.prototype.md5_ff=function(t,e,a,i,n,o,s){return this.md5_cmn(e&a|~e&i,t,e,n,o,s)},t.prototype.md5_gg=function(t,e,a,i,n,o,s){return this.md5_cmn(e&i|a&~i,t,e,n,o,s)},t.prototype.md5_hh=function(t,e,a,i,n,o,s){return this.md5_cmn(e^a^i,t,e,n,o,s)},t.prototype.md5_ii=function(t,e,a,i,n,o,s){return this.md5_cmn(a^(e|~i),t,e,n,o,s)},t.prototype.safe_add=function(t,e){var a=(65535&t)+(65535&e),i=(t>>16)+(e>>16)+(a>>16);return i<<16|65535&a},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();t.md5=e,__reflect(e.prototype,"game.md5")}(game||(game={}));var SoundUtils;!function(t){function e(t,e){var a=GlobalData.gameData.getPlayerByClientId(t);if(null!=a){var i=a.getAgeType(),n=a.getGender(),o="nan";n==Constants.GENDER.female&&(o="nv");var s=Utils.format("{0}_chat_{1}_{2}_mp3",o,i,e);GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.standard&&(s=Utils.format("{0}_chat_{1}_mp3",o,e)),game.SoundService.getInstance().playAudio(s)}}function a(e,a,i){var n=GlobalData.gameData.getPlayerByClientId(e);if(null!=n){var o=n.getAgeType(),s=n.getGender(),r=t.getSoundName(s,o,a,i);null!=r&&game.SoundService.getInstance().playAudio(r)}}function i(t,e,a,i){if(null==i){var n=SoundCost.soundData[t][e][a];if(null==n)return;i=Utils.getRandom(1,n+1)}var o="nan";t==Constants.GENDER.female&&(o="nv");var s=Utils.format("{0}_{1}_{2}_{3}_mp3",o,a,e,i);return GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.standard&&(s=Utils.format("{0}_{1}_mp3",o,a)),s}t.playChatMsgEffectSoundNameBindPlayer=e,t.playEffectSoundNameBindPlayer=a,t.getSoundName=i}(SoundUtils||(SoundUtils={}));var Utils;!function(t){var e=function(){function t(){}return t.getOutLineStr=function(t){return[{text:t,style:{underline:!0}}]},t}();t.TextUtils=e,__reflect(e.prototype,"Utils.TextUtils")}(Utils||(Utils={}));var game;!function(t){var e=function(){function e(){}return e.showTips=function(e,a,i,n,o,s){void 0===o&&(o=120),void 0===s&&(s=20);var r=new eui.Group;Main.instance.toastLayer.addChild(r),r.touchThrough=!0,r.touchChildren=!1;var l=new eui.Rect(GameConfig.ScreenW,GameConfig.ScreenH);l.touchEnabled=!1,l.alpha=0,r.addChild(l);var c=new t.TipsView;r.addChild(c),c.setInfo(n,o,s),c.setPopPosition(e,a,i),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.parent.removeChild(r)},this)},e}();t.TipsUtils=e,__reflect(e.prototype,"game.TipsUtils")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.showByKey=function(e,a){t.show(e,a)},t.show=function(e,a){t.showToastString(e,a?a:t.defaultY,t.defaultDuration)},t.showToastString=function(t,e,i){var n=Main.instance.toastLayer,o=new a(t);o.alpha=0,o.anchorOffsetY=.5*o.height,o.y=e,n.addChild(o);var s=egret.Tween.get(o);s.to({alpha:1},300),s.wait(i),s.to({alpha:0},500),s.call(function(){n.removeChild(o)})},t.defaultY=80,t.defaultDuration=1300,t}();t.ToastUtils=e,__reflect(e.prototype,"game.ToastUtils");var a=function(e){function a(t){var a=e.call(this)||this;return a.str=t,a.init(),a}return __extends(a,e),a.prototype.init=function(){this.touchEnabled=!1,this.width=GameConfig.ScreenW;var e=t.ResManager.createBitmap("frame_tips_png");e.anchorOffsetX=.5*e.width,e.anchorOffsetY=.5*e.height,e.x=this.width/2,e.y=0,e.touchEnabled=!1,e.alpha=1,this.width=e.texture.textureWidth,this.height=e.texture.textureHeight,this.addChild(e);var a=new egret.TextField;a.touchEnabled=!1,a.bold=!0,a.fontFamily="fzch",a.text=this.str,a.size=24,a.textColor=16775405,a.anchorOffsetX=.5*a.width,a.anchorOffsetY=.5*a.height,a.x=this.width/2,a.y=0,this.addChild(a)},a}(egret.Sprite);__reflect(a.prototype,"ToastView")}(game||(game={}));var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,a,i){function n(t){e.call(i,t)
}function o(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),a.call(i))}"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(i,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var game;!function(t){var e=function(){function t(){}return t.generateUUID=function(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=new Array(36),i=0,n=0;36>n;n++)8===n||13===n||18===n||23===n?a[n]="-":14===n?a[n]="4":(2>=i&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,a[n]=e[19===n?3&t|8:t]);return a.join("")},t}();t.UUID=e,__reflect(e.prototype,"game.UUID")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.createView(),t}return __extends(a,e),a.prototype.createView=function(){this.width=GameConfig.ScreenW,this.height=GameConfig.ScreenH,this.touchEnabled=!0,this.background=new egret.Shape,this.background.width=this.width,this.background.height=this.height,this.background.graphics.beginFill(0,.5),this.background.graphics.drawRect(0,0,this.width,this.height),this.background.graphics.endFill(),this.addChild(this.background),this.icon=new eui.Image,this.icon.source="common_json.waiting_png",this.icon.anchorOffsetX=50,this.icon.anchorOffsetY=50,this.icon.x=this.width/2,this.icon.y=this.height/2,this.addChild(this.icon)},a.prototype.rotationLoop=function(){var t=2e3,e=this;this.icon.rotation=0;var a=egret.Tween.get(this.icon);a.to({rotation:360},t),a.call(function(){e.rotationLoop()})},a.prototype.stopRotation=function(){egret.Tween.removeTweens(this.icon)},a.showWaiting=function(e,i,n){if(!a.bShow){a.bShow=!0;var o=!0;if(void 0!=i&&(o=i),o){a.instance||(a.instance=new a),n?a.instance.background.alpha=1:a.instance.background.alpha=0;var s=Main.instance.confirmDialogLayer;s.addChild(a.instance),a.instance.rotationLoop()}e&&(a.currentTimeout=egret.setTimeout(function(){t.CommonView.hideWaiting(),egret.clearTimeout(a.currentTimeout),a.currentTimeout=-1},this,e))}},a.show=function(e,i){t.LogUtils.info("waiting show");var n=!0;void 0!=i&&(n=i),a.showWaiting(null,e,n)},a.isShowing=function(){return a.bShow},a.hide=function(){if(t.LogUtils.info("waiting hide"),-1!=a.currentTimeout&&(egret.clearTimeout(a.currentTimeout),a.currentTimeout=-1),a.bShow=!1,a.instance){var e=Main.instance.confirmDialogLayer;e.contains(a.instance)&&(a.instance.stopRotation(),e.removeChild(a.instance))}},a.bShow=!1,a.currentTimeout=-1,a}(egret.Sprite);t.WaitingUI=e,__reflect(e.prototype,"game.WaitingUI")}(game||(game={}));var qr;!function(t){var e=function(){function e(e){this.mode=t.QRMode.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var a=0,i=this.data.length;i>a;a++){var n=[],o=this.data.charCodeAt(a);o>65536?(n[0]=240|(1835008&o)>>>18,n[1]=128|(258048&o)>>>12,n[2]=128|(4032&o)>>>6,n[3]=128|63&o):o>2048?(n[0]=224|(61440&o)>>>12,n[1]=128|(4032&o)>>>6,n[2]=128|63&o):o>128?(n[0]=192|(1984&o)>>>6,n[1]=128|63&o):n[0]=o,this.parsedData.push(n)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}return e.prototype.getLength=function(t){return this.parsedData.length},e.prototype.write=function(t){for(var e=0,a=this.parsedData.length;a>e;e++)t.put(this.parsedData[e],8)},e}();t.QR8bitByte=e,__reflect(e.prototype,"qr.QR8bitByte")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){this.buffer=[],this.length=0}return t.prototype.get=function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},t.prototype.put=function(t,e){for(var a=0;e>a;a++)this.putBit(1==(t>>>e-a-1&1))},t.prototype.getLengthInBits=function(){return this.length},t.prototype.putBit=function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++},t}();t.QRBitBuffer=e,__reflect(e.prototype,"qr.QRBitBuffer")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.create=function(a,i,n,o,s,r){void 0===i&&(i=200),void 0===n&&(n=200),void 0===o&&(o=t.QRErrorCorrectLevel.M),void 0===s&&(s=4),void 0===r&&(r=0);var l={color:r,width:i,height:n,correctLevel:o,typeNumer:s},c=new t.QRCodeModel(l.typeNumer,l.correctLevel);return c.addData(a),c.make(),e.draw(c,l)},e.draw=function(t,e){var a=new egret.Sprite,e=e,i=t.getModuleCount(),n=e.width/i,o=e.height/i,s=10;a.graphics.moveTo(-s,-s),a.graphics.beginFill(16777215),a.graphics.drawRect(-s,-s,e.width+2*s,e.height+2*s),a.graphics.endFill();for(var r=0;i>r;r++)for(var l=0;i>l;l++){var c=t.isDark(r,l);c&&(a.graphics.moveTo(l*n,r*o),a.graphics.beginFill(e.color),a.graphics.drawRect(l*n,r*o,n,o),a.graphics.endFill())}return a},e}();t.QRCode=e,__reflect(e.prototype,"qr.QRCode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[],this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}return e.prototype.addData=function(e){var a=new t.QR8bitByte(e);this.dataList.push(a),this.dataCache=null},e.prototype.isDark=function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},e.prototype.getModuleCount=function(){return this.moduleCount},e.prototype.make=function(){this.makeImpl(!1,this.getBestMaskPattern())},e.prototype.makeImpl=function(t,a){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++){this.modules[i]=new Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[i][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,a),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=e.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,a)},e.prototype.setupPositionProbePattern=function(t,e){for(var a=-1;7>=a;a++)if(!(-1>=t+a||this.moduleCount<=t+a))for(var i=-1;7>=i;i++)-1>=e+i||this.moduleCount<=e+i||(a>=0&&6>=a&&(0==i||6==i)||i>=0&&6>=i&&(0==a||6==a)||a>=2&&4>=a&&i>=2&&4>=i?this.modules[t+a][e+i]=!0:this.modules[t+a][e+i]=!1)},e.prototype.getBestMaskPattern=function(){for(var e=0,a=0,i=0;8>i;i++){this.makeImpl(!0,i);var n=t.QRUtil.getLostPoint(this);(0==i||e>n)&&(e=n,a=i)}return a},e.prototype.createMovieClip=function(t,e,a){var i=t.createEmptyMovieClip(e,a),n=1;this.make();for(var o=0;o<this.modules.length;o++)for(var s=o*n,r=0;r<this.modules[o].length;r++){var l=r*n,c=this.modules[o][r];c&&(i.beginFill(0,100),i.moveTo(l,s),i.lineTo(l+n,s),i.lineTo(l+n,s+n),i.lineTo(l,s+n),i.endFill())}return i},e.prototype.setupTimingPattern=function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},e.prototype.setupPositionAdjustPattern=function(){for(var e=t.QRUtil.getPatternPosition(this.typeNumber),a=0;a<e.length;a++)for(var i=0;i<e.length;i++){var n=e[a],o=e[i];if(null==this.modules[n][o])for(var s=-2;2>=s;s++)for(var r=-2;2>=r;r++)-2==s||2==s||-2==r||2==r||0==s&&0==r?this.modules[n+s][o+r]=!0:this.modules[n+s][o+r]=!1}},e.prototype.setupTypeNumber=function(e){for(var a=t.QRUtil.getBCHTypeNumber(this.typeNumber),i=0;18>i;i++){var n=!e&&1==(a>>i&1);this.modules[Math.floor(i/3)][i%3+this.moduleCount-8-3]=n}for(var i=0;18>i;i++){var n=!e&&1==(a>>i&1);this.modules[i%3+this.moduleCount-8-3][Math.floor(i/3)]=n}},e.prototype.setupTypeInfo=function(e,a){for(var i=this.errorCorrectLevel<<3|a,n=t.QRUtil.getBCHTypeInfo(i),o=0;15>o;o++){var s=!e&&1==(n>>o&1);6>o?this.modules[o][8]=s:8>o?this.modules[o+1][8]=s:this.modules[this.moduleCount-15+o][8]=s}for(var o=0;15>o;o++){var s=!e&&1==(n>>o&1);8>o?this.modules[8][this.moduleCount-o-1]=s:9>o?this.modules[8][15-o-1+1]=s:this.modules[8][15-o-1]=s}this.modules[this.moduleCount-8][8]=!e},e.prototype.mapData=function(e,a){for(var i=-1,n=this.moduleCount-1,o=7,s=0,r=this.moduleCount-1;r>0;r-=2)for(6==r&&r--;;){for(var l=0;2>l;l++)if(null==this.modules[n][r-l]){var c=!1;s<e.length&&(c=1==(e[s]>>>o&1));var h=t.QRUtil.getMask(a,n,r-l);h&&(c=!c),this.modules[n][r-l]=c,o--,-1==o&&(s++,o=7)}if(n+=i,0>n||this.moduleCount<=n){n-=i,i=-i;break}}},e.createData=function(a,i,n){for(var o=t.QRRSBlock.getRSBlocks(a,i),s=new t.QRBitBuffer,r=0;r<n.length;r++){var l=n[r];s.put(l.mode,4),s.put(l.getLength(),t.QRUtil.getLengthInBits(l.mode,a)),l.write(s)}for(var c=0,r=0;r<o.length;r++)c+=o[r].dataCount;if(s.getLengthInBits()>8*c)throw new Error("code length overflow. ("+s.getLengthInBits()+">"+8*c+")");for(s.getLengthInBits()+4<=8*c&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(!1);for(;!(s.getLengthInBits()>=8*c)&&(s.put(e.PAD0,8),!(s.getLengthInBits()>=8*c));)s.put(e.PAD1,8);return e.createBytes(s,o)},e.createBytes=function(e,a){for(var i=0,n=0,o=0,s=new Array(a.length),r=new Array(a.length),l=0;l<a.length;l++){var c=a[l].dataCount,h=a[l].totalCount-c;n=Math.max(n,c),o=Math.max(o,h),s[l]=new Array(c);for(var u=0;u<s[l].length;u++)s[l][u]=255&e.buffer[u+i];i+=c;var d=t.QRUtil.getErrorCorrectPolynomial(h),m=new t.QRPolynomial(s[l],d.getLength()-1),p=m.mod(d);r[l]=new Array(d.getLength()-1);for(var u=0;u<r[l].length;u++){var g=u+p.getLength()-r[l].length;r[l][u]=g>=0?p.get(g):0}}for(var C=0,u=0;u<a.length;u++)C+=a[u].totalCount;for(var _=new Array(C),f=0,u=0;n>u;u++)for(var l=0;l<a.length;l++)u<s[l].length&&(_[f++]=s[l][u]);for(var u=0;o>u;u++)for(var l=0;l<a.length;l++)u<r[l].length&&(_[f++]=r[l][u]);return _},e.PAD0=236,e.PAD1=17,e}();t.QRCodeModel=e,__reflect(e.prototype,"qr.QRCodeModel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.L=1,t.M=0,t.Q=3,t.H=2,t}();t.QRErrorCorrectLevel=e,__reflect(e.prototype,"qr.QRErrorCorrectLevel")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.PATTERN000=0,t.PATTERN001=1,t.PATTERN010=2,t.PATTERN011=3,t.PATTERN100=4,t.PATTERN101=5,t.PATTERN110=6,t.PATTERN111=7,t}();t.QRMaskPattern=e,__reflect(e.prototype,"qr.QRMaskPattern")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.glog=function(e){return t.isInit||t.init(),1>e&&console.log("错误:n="+e),t.LOG_TABLE[e]},t.gexp=function(e){for(t.isInit||t.init();0>e;)e+=255;for(;e>=256;)e-=255;return t.EXP_TABLE[e]},t.init=function(){t.isInit=!0;for(var e=0;8>e;e++)t.EXP_TABLE[e]=1<<e;for(var e=8;256>e;e++)t.EXP_TABLE[e]=t.EXP_TABLE[e-4]^t.EXP_TABLE[e-5]^t.EXP_TABLE[e-6]^t.EXP_TABLE[e-8];for(var e=0;255>e;e++)t.LOG_TABLE[t.EXP_TABLE[e]]=e},t.EXP_TABLE=new Array(256),t.LOG_TABLE=new Array(256),t}();t.QRMath=e,__reflect(e.prototype,"qr.QRMath")}(qr||(qr={}));var qr;!function(t){var e=function(){function t(){}return t.MODE_NUMBER=1,t.MODE_ALPHA_NUM=2,t.MODE_8BIT_BYTE=4,t.MODE_KANJI=8,t}();t.QRMode=e,__reflect(e.prototype,"qr.QRMode")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var a=0;a<t.length&&0==t[a];)a++;this.num=new Array(t.length-a+e);for(var i=0;i<t.length-a;i++)this.num[i]=t[i+a]}return e.prototype.get=function(t){return this.num[t]},e.prototype.getLength=function(){return this.num.length},e.prototype.multiply=function(a){for(var i=new Array(this.getLength()+a.getLength()-1),n=0;n<this.getLength();n++)for(var o=0;o<a.getLength();o++)i[n+o]^=t.QRMath.gexp(t.QRMath.glog(this.get(n))+t.QRMath.glog(a.get(o)));return new e(i,0)},e.prototype.mod=function(a){if(this.getLength()-a.getLength()<0)return this;for(var i=t.QRMath.glog(this.get(0))-t.QRMath.glog(a.get(0)),n=new Array(this.getLength()),o=0;o<this.getLength();o++)n[o]=this.get(o);for(var o=0;o<a.getLength();o++)n[o]^=t.QRMath.gexp(t.QRMath.glog(a.get(o))+i);return new e(n,0).mod(a)},e}();t.QRPolynomial=e,__reflect(e.prototype,"qr.QRPolynomial")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(t,e){this.totalCount=t,this.dataCount=e}return e.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e.getRSBlocks=function(t,a){var i=e.getRsBlockTable(t,a);if(void 0==i)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+a);for(var n=i.length/3,o=[],s=0;n>s;s++)for(var r=i[3*s+0],l=i[3*s+1],c=i[3*s+2],h=0;r>h;h++)o.push(new e(l,c));return o},e.getRsBlockTable=function(a,i){switch(i){case t.QRErrorCorrectLevel.L:return e.RS_BLOCK_TABLE[4*(a-1)+0];case t.QRErrorCorrectLevel.M:return e.RS_BLOCK_TABLE[4*(a-1)+1];case t.QRErrorCorrectLevel.Q:return e.RS_BLOCK_TABLE[4*(a-1)+2];case t.QRErrorCorrectLevel.H:return e.RS_BLOCK_TABLE[4*(a-1)+3];default:return}},e}();t.QRRSBlock=e,__reflect(e.prototype,"qr.QRRSBlock")}(qr||(qr={}));var qr;!function(t){var e=function(){function e(){}return e.getBCHTypeInfo=function(t){for(var a=t<<10;e.getBCHDigit(a)-e.getBCHDigit(e.G15)>=0;)a^=e.G15<<e.getBCHDigit(a)-e.getBCHDigit(e.G15);return(t<<10|a)^e.G15_MASK},e.getBCHTypeNumber=function(t){for(var a=t<<12;e.getBCHDigit(a)-e.getBCHDigit(e.G18)>=0;)a^=e.G18<<e.getBCHDigit(a)-e.getBCHDigit(e.G18);return t<<12|a},e.getBCHDigit=function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},e.getPatternPosition=function(t){return e.PATTERN_POSITION_TABLE[t-1]},e.getMask=function(e,a,i){switch(e){case t.QRMaskPattern.PATTERN000:return(a+i)%2==0;case t.QRMaskPattern.PATTERN001:return a%2==0;case t.QRMaskPattern.PATTERN010:return i%3==0;case t.QRMaskPattern.PATTERN011:return(a+i)%3==0;case t.QRMaskPattern.PATTERN100:return(Math.floor(a/2)+Math.floor(i/3))%2==0;case t.QRMaskPattern.PATTERN101:return a*i%2+a*i%3==0;case t.QRMaskPattern.PATTERN110:return(a*i%2+a*i%3)%2==0;case t.QRMaskPattern.PATTERN111:return(a*i%3+(a+i)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},e.getErrorCorrectPolynomial=function(e){for(var a=new t.QRPolynomial([1],0),i=0;e>i;i++)a=a.multiply(new t.QRPolynomial([1,t.QRMath.gexp(i)],0));return a},e.getLengthInBits=function(e,a){if(a>=1&&10>a)switch(e){case t.QRMode.MODE_NUMBER:return 10;case t.QRMode.MODE_ALPHA_NUM:return 9;case t.QRMode.MODE_8BIT_BYTE:return 8;case t.QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(27>a)switch(e){case t.QRMode.MODE_NUMBER:return 12;case t.QRMode.MODE_ALPHA_NUM:return 11;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(41>a))throw new Error("type:"+a);switch(e){case t.QRMode.MODE_NUMBER:return 14;case t.QRMode.MODE_ALPHA_NUM:return 13;case t.QRMode.MODE_8BIT_BYTE:return 16;case t.QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},e.getLostPoint=function(t){for(var e=t.getModuleCount(),a=0,i=0;e>i;i++)for(var n=0;e>n;n++){for(var o=0,s=t.isDark(i,n),r=-1;1>=r;r++)if(!(0>i+r||i+r>=e))for(var l=-1;1>=l;l++)0>n+l||n+l>=e||(0!=r||0!=l)&&s==t.isDark(i+r,n+l)&&o++;o>5&&(a+=3+o-5)}for(var i=0;e-1>i;i++)for(var n=0;e-1>n;n++){var c=0;t.isDark(i,n)&&c++,t.isDark(i+1,n)&&c++,t.isDark(i,n+1)&&c++,t.isDark(i+1,n+1)&&c++,(0==c||4==c)&&(a+=3)}for(var i=0;e>i;i++)for(var n=0;e-6>n;n++)t.isDark(i,n)&&!t.isDark(i,n+1)&&t.isDark(i,n+2)&&t.isDark(i,n+3)&&t.isDark(i,n+4)&&!t.isDark(i,n+5)&&t.isDark(i,n+6)&&(a+=40);for(var n=0;e>n;n++)for(var i=0;e-6>i;i++)t.isDark(i,n)&&!t.isDark(i+1,n)&&t.isDark(i+2,n)&&t.isDark(i+3,n)&&t.isDark(i+4,n)&&!t.isDark(i+5,n)&&t.isDark(i+6,n)&&(a+=40);for(var h=0,n=0;e>n;n++)for(var i=0;e>i;i++)t.isDark(i,n)&&h++;var u=Math.abs(100*h/e/e-50)/5;return a+=10*u},e.prototype.static_isSupportCanvas=function(){return"undefined"!=typeof CanvasRenderingContext2D},e._getTypeNumber=function(a,i){for(var n=1,o=e._getUTF8Length(a),s=0,r=e.QRCodeLimitLength.length;r>=s;s++){var l=0;switch(i){case t.QRErrorCorrectLevel.L:l=e.QRCodeLimitLength[s][0];break;case t.QRErrorCorrectLevel.M:l=e.QRCodeLimitLength[s][1];break;case t.QRErrorCorrectLevel.Q:l=e.QRCodeLimitLength[s][2];break;case t.QRErrorCorrectLevel.H:l=e.QRCodeLimitLength[s][3]}if(l>=o)break;n++}if(n>e.QRCodeLimitLength.length)throw new Error("Too long data");return n},e._getUTF8Length=function(t){var e=encodeURI(t).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return e.length+(e.length!=t?3:0)},e.PATTERN_POSITION_TABLE=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],e.G15=1335,e.G18=7973,e.G15_MASK=21522,e.QRCodeLimitLength=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],e}();t.QRUtil=e,__reflect(e.prototype,"qr.QRUtil")}(qr||(qr={}));