var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,a){t.__class__=e,a?a.push(e):a=[e],t.__types__=t.__types__?a.concat(t.__types__):a},__extends=this&&this.__extends||function(t,e){function a(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);a.prototype=e.prototype,t.prototype=new a},__awaiter=this&&this.__awaiter||function(t,e,a,n){return new(a||(a=Promise))(function(o,i){function s(t){try{l(n.next(t))}catch(e){i(e)}}function r(t){try{l(n["throw"](t))}catch(e){i(e)}}function l(t){t.done?o(t.value):new a(function(e){e(t.value)}).then(s,r)}l((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function a(t){return function(e){return n([t,e])}}function n(a){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,i&&(s=i[2&a[0]?"return":a[0]?"throw":"next"])&&!(s=s.call(i,a[1])).done)return s;switch(i=0,s&&(a=[0,s.value]),a[0]){case 0:case 1:s=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,i=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===a[0]||2===a[0])){l=0;continue}if(3===a[0]&&(!s||a[1]>s[0]&&a[1]<s[3])){l.label=a[1];break}if(6===a[0]&&l.label<s[1]){l.label=s[1],s=a;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(a);break}s[2]&&l.ops.pop(),l.trys.pop();continue}a=e.call(t,l)}catch(n){a=[6,n],i=0}finally{o=s=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var o,i,s,r,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return r={next:a(0),"throw":a(1),"return":a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},Constants;!function(t){t.server_url_tang="192.168.50.218",t.server_url_test="47.98.237.192",t.server_url_online_test="mina-nj.njchunuo.com",t.server_url_online="nanjings.qixiyx.cn",t.server_url_current=t.server_url_online,t.BASE_PATH="resource/",t.BASE_SKIN_PATH=t.BASE_PATH+"skins/",t.UI_GAME_CSB_PATH=t.BASE_SKIN_PATH+"game/",t.DEFAULT_HEAD_IMG_URL="http://wx.qlogo.cn/mmopen/QiaGV991oIlm6kG5bjbRKhq5AeRWfOiaAibLqMon7F5iceQ7o31Pvj7mUroEb7W32KZiad9DrkGVMvJx4ULDJiaKRCzh8LEAzGR3Sv/0",t.GENDER={man:1,female:2},t.ROOM_TYPE={jinYuanZi:0,changKaiTou:1},t.ROOM_PAY_MODE={creator:1,AA:0,other:2},t.ROOM_TIME_MODE={ba:0,quan:1},t.GAME_ID_SET={nanjing:1,jiangdu:2,lianshui:5,xinghua:6},t.SCENE_INDEX={LOGIN:1,MAIN:2,GAME:3,HOT_UPDATE:4,ZDGAME:5,HOT_UPDATE_MINI_GAME:6,FIGHT_THREE:7,CLUB:8,BIJI:9,WORLDCUP:10},t.UI_PANEL_DATA_SET={about:{index:"1",filePath:"aboutBox.csb"},create_room:{index:"2",filePath:"createRoomBox.csb"},join_room:{index:"3",filePath:"joinRoom.csb"},common_confirm_box:{index:"4",filePath:"confirmBox.csb"},email:{index:"5",filePath:"emailBox.csb"},personInfo:{index:"6",filePath:"personInfo.csb"},applyQuit:{index:"7",filePath:"applyQuitRoom.csb"},setting:{index:"8",filePath:"SetBox.csb"},wechatShare:{index:"9",filePath:"weiChatShareBox.csb"},rulesBox:{index:"10",filePath:"RulesBox.csb"},roomInfoBox:{index:"11",filePath:"RoomInfoBox.csb"},chatBox:{index:"12",filePath:"chat/chatUI.csb"},sendVoice:{index:"13",filePath:"voice/sendVoice.csb"},GameSettle_auto1:{index:"14",filePath:"gameScene/GameSettle_auto1.csb"},GameSettle_auto2:{index:"15",filePath:"gameScene/GameSettle_auto2.csb"},GameSettle_auto3:{index:"16",filePath:"gameScene/GameSettle_auto3.csb"},guide:{index:"17",filePath:"GuideView.csb"},proxyBox:{index:"18",filePath:"proxyBox.csb"},shop:{index:"19",filePath:"shop.csb"},updateGame:{index:"20",filePath:"updateGameBox.csb"},advert:{index:"21",filePath:"advertBox.csb"},daikaiRecords:{index:"22",filePath:"daikaiRecords.csb"},daikaiMsgBox:{index:"23",filePath:"daikaiNotify.csb"},zhanjiBox:{index:"24",filePath:"gameRecords.csb"},storePopBox:{index:"25",filePath:"storePopBox.csb"},personInfoOther:{index:"26",filePath:"personalInfoOther.csb"},preventCheat:{index:"27",filePath:"preventCheat.csb"},checkCheat:{index:"28",filePath:"checkCheatBox.csb"},gameActivity:{index:"29",filePath:"gameActivity.csb"},shareActivity:{index:"30",filePath:"ShareActivity.csb"},shareActivityIntro:{index:"31",filePath:"shareActivityIntro.csb"},changePlayerNumBox:{index:"32",filePath:"changePlayerNum.csb"},preventCheatStatusBox:{index:"33",filePath:"PreventCheatStatusBox.csb"},taskBox:{index:"34",filePath:"taskBox.csb"},todayRecords:{index:"35",filePath:"todayRecords.csb"},GameScoreBoard:{index:"36",filePath:"gameScene/gameScoreBoard.csb"},InviteBoxRedPacket:{index:"37",filePath:"InviteBoxRedPacket.csb"},TaskBoxRedPacket:{index:"38",filePath:"TaskBoxRedPacket.csb"},RedPacketBox:{index:"39",filePath:"RedPacketBox.csb"},turntableBox:{index:"40",filePath:"turntableBox.csb"},TurntableRecordBox:{index:"41",filePath:"TurntableRecord.csb"},TurntableNormalResultBox:{index:"42",filePath:"TurnTableNormalResult.csb"},TurntablePacket:{index:"43",filePath:"TurntablePacket.csb"},confirmShareRedPacketBox:{index:"44",filePath:"confirmShareRedPacketBox.csb"},downloadMiniGameView:{index:"45",filePath:"DownloadMiniGameView.csb"},LoginDeclare:{index:"46",filePath:"LoginDeclare.csb"},LoginDeclareSpe:{index:"47",filePath:"LoginDeclareSpe.csb"},createRoomDeclare:{index:"48",filePath:"CreateRoomDeclareView.csb"},clubCreateView:{index:"49",filePath:"club/clubCreateView.csb"},clubJoinView:{index:"50",filePath:"club/clubJoinView.csb"},clubCommonPopView:{index:"51",filePath:"club/clubCommonPopView.csb"},clubNoticePop:{index:"52",filePath:"club/clubNoticePop.csb"},clubRecordDetails:{index:"53",filePath:"club/clubRecordDetails.csb"},clubMemberHistories:{index:"54",filePath:"club/clubMemberHistories.csb"},clubCommonPopView2:{index:"55",filePath:"club/clubCommonPopView2.csb"},shopBindProxyBox:{index:"56",filePath:"ShopBindProxyBox.csb"},clubMgrDissRoomView:{index:"57",filePath:"club/clubMgrDissRoomView.csb"},clubCheckOthersReplayView:{index:"58",filePath:"club/clubCheckOthersReplayView.csb"},goBackGameView:{index:"59",filePath:"GoBackGameConfirm.csb"},gameSetting:{index:"60",filePath:"GameSettingBox.csb"},discardWinConfirmBox:{index:"61",filePath:"AbandomWinConfirm.csb"},gameOverBox:{index:"62",filePath:"AbandomWinConfirm.csb"},shareOverBox:{index:"63"}}}(Constants||(Constants={}));var GameConst;!function(t){t.operateTime=10,t.CLICK_CARD_TYPE={click:1,doubleClick:2},t.maxPlayerNum=4,t.perPlayerTotalCardNum=14,t.PLAY_DIR={down:0,right:1,up:2,left:3},t.PLAYER_STATUS={OFFLINE:0,LEAVE:2,SIT:4,PLAYING:5,STAND:6,NULL:7},t.ME_DIR=t.PLAY_DIR.down,t.CARD_SIZE={HAND_CARD:[{width:90,height:126,width_playBack:79,height_playBack:110},{width:36,height:68,width_playBack:60,height_playBack:53},{width:45,height:59,width_playBack:47,height_playBack:62},{width:36,height:68,width_playBack:60,height_playBack:53}]},t.CARD_DATA={HAND_CARD:[{path:"card/DownHandCardSkin.exml",offx:86,offy:0,playBackOffx:86,playBackOffy:0,gapLastX:22,gapLastY:0,gapPlayBackLastX:22,gapPlayBackLastY:0},{path:"card/RightHandCardSkin.exml",offx:0,offy:-34,playBackOffx:0,playBackOffy:-39,gapLastX:0,gapLastY:-20,gapPlayBackLastX:0,gapPlayBackLastY:-20},{path:"card/TopHandCardSkin.exml",offx:-42,offy:0,playBackOffx:-45,playBackOffy:0,gapLastX:-20,gapLastY:0,gapPlayBackLastX:-20,gapPlayBackLastY:0},{path:"card/LeftHandCardSkin.exml",offx:0,offy:34,playBackOffx:0,playBackOffy:39,gapLastX:0,gapLastY:20,gapPlayBackLastX:0,gapPlayBackLastY:20}],HUA_CARD:[{path:"card/DownHuaCardSkin.exml",offx:40,offy:0},{path:"card/RightHuaCardSkin.exml",offx:0,offy:-35},{path:"card/TopHuaCardSkin.exml",offx:-40,offy:0},{path:"card/LeftHuaCardSkin.exml",offx:0,offy:35}],OUT_CARD:[{path:"card/DownOutCardSkin.exml",offx:48,offy:58,multiLineXOff:0,multiLineYOff:-10},{path:"card/RightOutCardSkin.exml",offx:61,offy:-42,multiLineXOff:0,multiLineYOff:-15},{path:"card/TopOutCardSkin.exml",offx:-48,offy:-58,multiLineXOff:0,multiLineYOff:10},{path:"card/LeftOutCardSkin.exml",offx:-61,offy:42,multiLineXOff:0,multiLineYOff:-15}],EFFECT_OUT_CARD:[{x:640,y:490},{x:1020,y:340},{x:640,y:160},{x:260,y:340}],PONG_KONG_CARD:[{path:"card/DownPongKongNodeSkin.exml",offx:240,offy:0,dirOffx:0,dirOffy:0},{path:"card/RightPongKongNodeSkin.exml",offx:0,offy:-112,dirOffx:0,dirOffy:-3},{path:"card/TopPongKongNodeSkin.exml",offx:-124,offy:0,dirOffx:-5,dirOffy:0},{path:"card/LeftPongKongNodeSkin.exml",offx:0,offy:114,dirOffx:0,dirOffy:3}]},t.GAME_ALL_CARD_NODE_POSITION={HAND_CARD:[{x:43,y:574,playBackx:-590,playBacky:0},{x:1102,y:506,playBackx:-10,playBacky:-235},{x:884,y:0,playBackx:310,playBacky:-5},{x:142,y:68,playBackx:10,playBacky:300}],HUA_CARD:[{x:400,y:522},{x:1022,y:506},{x:834,y:70},{x:196,y:123}],OUT_CARD:[{x:399,y:452},{x:955,y:496},{x:831,y:128},{x:264,y:126}],PONG_KONG_NODE:[{x:50,y:595},{x:1085,y:465},{x:810,y:0},{x:145,y:30}]},t.HAND_CARD_ACTION_TYPE={MOVE_HORIZONTAL:1,INSERT_DRAW_CARD:2,DRAW_CARD_ME:3,DRAW_CARD_OTHER:4},t.GAME_STATUS_TYPE={ready:1,playing:2,over:3,allOver:4,before_playing:5,waiting:6},t.GAIN_TYPE={CHOW:1,PONG:2,PongKong:3,Exposed:4,ConcealedKong:5},t.OPERATE_TYPE={pong:1,kong:2,win:3,ready:4,pass:5,chow:6},t.FaFenType={KONG:1,CONCEALED_KONG:2,FLOWER_KONG:3,DNXB:4,DISCARD_4:5,DISCARD_SAME:6},t.DIRECT_DESC=(e={},e[1]="东",e[2]="南",e[3]="西",e[4]="北",e),t.ACTION_DATA={OPERATE:{KONG:{index:1,data:{name:"gang",dragonbonesData:"gang_ske_json",textureData:"gang_tex_json",texture:"gang_tex_png"}},WIN:{index:2,data:{name:"hupai",dragonbonesData:"hupai_ske_json",textureData:"hupai_tex_json",texture:"hupai_tex_png"}},PONG:{index:3,data:{name:"peng",dragonbonesData:"peng_ske_json",textureData:"peng_tex_json",texture:"peng_tex_png"}},HUA_KONG:{index:4,data:{name:"huagang",dragonbonesData:"huagang_ske_json",textureData:"huagang_tex_json",texture:"huagang_tex_png"}},BUHUA:{index:5,data:{name:"buhua",dragonbonesData:"buhua_ske_json",textureData:"buhua_tex_json",texture:"buhua_tex_png"}},SIFENG:{index:6,data:{name:"sifeng",dragonbonesData:"sifeng_ske_json",textureData:"sifeng_tex_json",texture:"sifeng_tex_png"}},PASS:{index:7,data:{name:"pass",dragonbonesData:"pass_ske_json",textureData:"pass_tex_json",texture:"pass_tex_png"}}},FIREWORKS:{index:7,data:{name:"yanhua",dragonbonesData:"yanhua_ske_json",textureData:"yanhua_tex_json",texture:"yanhua_tex_png"}},ARROW:{index:8,data:{name:"mark",dragonbonesData:"mark_ske_json",textureData:"mark_tex_json",texture:"mark_tex_png"}},SHAIZI:{index:9,data:{dragonbonesData:"",textureData:"",texture:""}},CARDEFFECT:{index:10,data:{dragonbonesData:"",textureData:"",texture:""}},FENGXIANG:{index:11,data:{name:"fengxiang",dragonbonesData:"fengxiang_ske_json",textureData:"fengxiang_tex_json",texture:"fengxiang_tex_png"}}},t.ACTION_POSITION={OPERATE:[{x:641,y:570},{x:955,y:292},{x:627,y:127},{x:302,y:303}],FA_FEN:[{x:145,y:492},{x:1134,y:292},{x:906,y:155},{x:145,y:292}],CHAT_MSG:{EMOTION:[{x:245,y:492},{x:1034,y:292},{x:806,y:155},{x:245,y:292}],TEXT:[{x:345,y:492},{x:934,y:292},{x:706,y:155},{x:345,y:292}]},VOICE:[{x:145,y:472},{x:1134,y:272},{x:856,y:35},{x:145,y:272}]},t.ACTION_DIR_ARROW_DATA=[{actindex:0,offx:78,offy:101},{actindex:1,offx:126,offy:63},{actindex:2,offx:78,offy:25},{actindex:3,offx:30,offy:63}],t.ACTION_WIN_ACTINDEX={hu:"hu",zimo:"zimo",dihu:"dihu",tianhu:"tianhu",gangkai:"gangkai"},t.POINT_EMOTION_NAME=["meigui","feiwen","ganbei","dushen","jidan","zhuantou","caidao","zhadan"],t.CHAT_EMOTION_NAME=["daxiao","hongyun","ku","koubi","shaoxiang","tuosai","tuxue","wenhao","zaijian","zan","zhuakuang","shanzi"],t.PLAYER_HEAD_POSITION=[{x:45,y:438},{x:1235,y:292},{x:956,y:55},{x:45,y:292}],t.CHAT_MSG_TYPE={EMOTION:1,TEXT:2,VOICE:3},t.DissolveRoomType={MASTER:1,DAIKAI:2,TIMEOUT:3},t.POINT_EMOTION_PRICE=[88,88,58,58,188,188,188,188],t.APPLY_QUIT_STATUS={unchosen:0,apply:1,agree:2,reject:3},t.CHANGE_PALYER_NUM_STATUS={unchosen:0,apply:1,agree:2,reject:3},t.specialHuType={NONE:0,GODHU:1,SUPRICHSEVDUI:2,RICHSEVDUI:3,PAIRSSEVDUI:4,SECONDHU:5,SEAFISHMONTH:6,BIGSTICKBLOOM:7,STICKBLOOM:8,SEVENDUI:9,ALLINONE:10,PRESSJUE:11,ONLYFISHING:12,HUNYICE:13,PAIRSHU:14,FIGHU:15},t.SOUND_TYPE_ENUM={nanjing:0,standard:1},t.card_back_index=0,t.game_bg_index=0,t.sound_type=t.SOUND_TYPE_ENUM.nanjing,t.REPLAY_TYPE={DISCARD:1,DRAW:2,PONG:3,KONG:4,FAFEN:5,JIAPAI:6,CANCELJIPAI:7,TING:8,OPERATE:9,PASS:10};var e}(GameConst||(GameConst={}));var game;!function(t){var e=function(){function e(){this.roomNum=0,this.roomType=Constants.ROOM_TYPE.jinYuanZi,this.roomScore=2,this.turnMode=3,this.turnNumber=4,this.payMode=5,this.huaZa=6,this.faFen=7,this.jieZhuangBi=8,this.roomId=9,this.masterUserId=10,this.turnModeDesc=null,this.payModeDesc=null,this.roomTypeDesc=null,this.maxPlayerNum=GameConst.maxPlayerNum,this.clubId=0,this.calNum=1,this.autoHost=!1,this.baoMi=!1}return e.prototype.isBaomi=function(){return this.baoMi},e.prototype.getCountNum=function(){var t=0;return this.roomType==Constants.ROOM_TYPE.jinYuanZi?t=this.calNum:this.roomType==Constants.ROOM_TYPE.changKaiTou&&(t=this.calNum/10),t},e.prototype.getClubID=function(){return this.clubId},e.prototype.isClubRoom=function(){return 0==this.clubId?!1:!0},e.prototype.getMaxPlayerNum=function(){return this.maxPlayerNum},e.prototype.getRoomId=function(){return this.roomId},e.prototype.isJieZhuangBi=function(){return this.jieZhuangBi},e.prototype.isFaFen=function(){return this.faFen},e.prototype.isHuaZa=function(){return this.huaZa},e.prototype.getPayMode=function(){return this.payMode},e.prototype.getPayModeDesc=function(){return this.payModeDesc},e.prototype.getTurnMode=function(){return this.turnMode},e.prototype.getTurnModeDesc=function(){return this.turnModeDesc},e.prototype.getTurnNumber=function(){return this.turnNumber},e.prototype.getMasterUserId=function(){return this.masterUserId},e.prototype.getRoomType=function(){return this.roomType},e.prototype.getRoomTypeDesc=function(){return this.roomTypeDesc},e.prototype.getRoomNum=function(){return this.roomNum},e.prototype.getRoomScore=function(){return this.roomScore},e.prototype.parse=function(t){this.maxPlayerNum=t.maxPlayerNum,null==this.maxPlayerNum&&(this.maxPlayerNum=GameConst.maxPlayerNum),this.roomNum=t.roomNumber,this.roomType=t.roomType,this.roomScore=t.roomScore,this.turnMode=t.turnMode,this.turnNumber=t.turnNumber,this.payMode=t.payMode,this.huaZa=t.huaZa,this.faFen=t.faFen,this.baoMi=t.baoMi,this.jieZhuangBi=t.jieZhuangBi,this.roomId=t.roomId,this.masterUserId=t.masterUserId,this.calNum=t.calNum,this.clubId=t.clubId,null==this.clubId&&(this.clubId=0),this.autoHost=t.autoHost,this.turnMode==Constants.ROOM_TIME_MODE.ba?this.turnModeDesc="把":this.turnModeDesc="圈","0"==GlobalData.clientConfigs.showCreateRoom?this.payModeDesc="":this.payMode==Constants.ROOM_PAY_MODE.AA?this.payModeDesc="AA模式":this.payMode==Constants.ROOM_PAY_MODE.creator?this.payModeDesc="房主模式":this.payMode==Constants.ROOM_PAY_MODE.other&&(this.isClubRoom()?this.payModeDesc="会长模式 ":this.payModeDesc="代开房间 "),this.roomType==Constants.ROOM_TYPE.jinYuanZi?this.roomTypeDesc="进园子":this.roomType==Constants.ROOM_TYPE.changKaiTou&&(this.roomTypeDesc="敞开头")},e.prototype.getShareRoomInfo=function(){var e="",a=this.turnNumber,n="对局数:"+a+this.turnModeDesc,o=this.getRulesDesc();if(this.roomType==Constants.ROOM_TYPE.jinYuanZi)e=this.roomTypeDesc+" "+this.payModeDesc+n+" 携带积分: "+this.roomScore+"分 "+o;else if(this.roomType==Constants.ROOM_TYPE.changKaiTou){var i="";i=0==this.roomScore?"无上限":this.roomScore+"分 ",e=this.roomTypeDesc+" :"+this.payModeDesc+n+" 单把上限: "+i+" "+o}return t.LogUtils.info("微信分享内容 "+e),e},e.prototype.getRulesDesc=function(){var e="";return t.LogUtils.info("getRulesDesc this.roomType "+this.roomType),this.roomType==Constants.ROOM_TYPE.jinYuanZi?(e=this.isHuaZa()?"花砸2":"",this.isJieZhuangBi()&&(e.length>0?e+="、接庄比":e="接庄比"),this.isFaFen()&&(e.length>0?e+="、东南西北罚分":e="东南西北罚分")):this.roomType==Constants.ROOM_TYPE.changKaiTou&&(e="花砸2、接庄比、东南西北罚分"),this.autoHost&&(""==e?e="超时托管":e+="、超时托管"),this.baoMi&&(""==e?e="保米":e+="、保米"),e},e.prototype.getGameUIRulesDesc=function(){var e="";return t.LogUtils.info("getRulesDesc this.roomType "+this.roomType),this.roomType==Constants.ROOM_TYPE.jinYuanZi?(e=this.isHuaZa()?"花砸2":"",this.isJieZhuangBi()&&(e.length>0?e+=",接庄比":e="接庄比"),this.isFaFen()&&(e.length>0?e+=",东南西北罚分":e="东南西北罚分")):this.roomType==Constants.ROOM_TYPE.changKaiTou&&(e="花砸2,接庄比,东南西北罚分"),this.autoHost&&(""==e?e="超时托管":e+=",超时托管"),this.baoMi&&""==e&&(e="保米"),"0"==GlobalData.clientConfigs.showCreateRoom?this.turnNumber+this.turnModeDesc+","+e:this.payModeDesc+","+this.turnNumber+this.turnModeDesc+","+e},e.prototype.clearData=function(){this.roomNum=0},e}();t.RoomInfo=e,__reflect(e.prototype,"game.RoomInfo")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.userId=0,this.userName=null,this.headImgUrl=null,this.gender=1,this.ip=null,this.ageType=0;var t=100*Math.random();10>t?this.ageType=SoundCost.soundType.old:this.ageType=SoundCost.soundType.young}return t.prototype.setAgeType=function(t){this.ageType=t},t.prototype.getAgeType=function(){return this.ageType},t.prototype.getGender=function(){return this.gender},t.prototype.setGender=function(t){t!=Constants.GENDER.female&&t!=Constants.GENDER.man&&(t=Constants.GENDER.female),this.gender=t,t==Constants.GENDER.female&&this.setAgeType(SoundCost.soundType.young)},t.prototype.setUserId=function(t){this.userId=t},t.prototype.getUserId=function(){return this.userId},t.prototype.setUserName=function(t){this.userName=t},t.prototype.getUserName=function(){return this.userName},t.prototype.setHeadIMGUrl=function(t){this.headImgUrl=t},t.prototype.getHeadIMGUrl=function(){return this.headImgUrl},t.prototype.setIP=function(t){this.ip=t},t.prototype.getIP=function(){return this.ip},t}();t.BaseUserInfo=e,__reflect(e.prototype,"game.BaseUserInfo")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.eventMap_=[],e.isSelfViewComplete=!1,e.isChildrenCreated=!1,e.isViewCreated=!1,e.addEventListener(eui.UIEvent.COMPLETE,e.onSelfViewComplete,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.clean,e),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.isChildrenCreated=!0,this.isSelfViewComplete&&this.onCreateViewComplete()},e.prototype.onSelfViewComplete=function(){this.isSelfViewComplete=!0,this.isChildrenCreated&&this.onCreateViewComplete()},e.prototype.onCreateViewComplete=function(){this.isViewCreated=!0},e.prototype.updateUI=function(){this.isViewCreated&&this.updateUI_()},e.prototype.updateUI_=function(){},e.prototype.addTapEvent=function(t,e){t.addEventListener(egret.TouchEvent.TOUCH_TAP,e,this);var a={obj:t,event:e};this.eventMap_.push(a)},e.prototype.removeTapEvent=function(){for(var t=0;t<this.eventMap_.length;t++){var e=this.eventMap_[t],a=e.obj,n=e.event;a.removeEventListener(egret.TouchEvent.TOUCH_TAP,n,this)}},e.prototype.clean=function(){this.removeTapEvent(),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clean,this)},e}(eui.Component);t.EComponent=e,__reflect(e.prototype,"game.EComponent")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.playerSet=null,this.gameStatus=GameConst.GAME_STATUS_TYPE.ready,this.clickCardType=1,this.flowerCardVisible=!0,this.roomInfo=new t.RoomInfo,this.myChairId=2,this.biXiaHu=!1,this.biXiaHuDesc=null,this.curTurnNum=0,this.eastChairId=1,this.curTurnDirection=1,this.curDiscardChairId=0,this.lastDiscardChairId=0,this.lastDiscardCardValue=0,this.leftCardNum=0,this.leftFlowerNum=0,this.needPlayStartEffect=!1,this.operateTypes=[],this.lastSendChatMsgTime=0,this.bankerChairId=0,this._isPlayBack=!1,this.curArrowDirChairId=0,this._isFirstDrawCard=!0,this.firstDrawCardData=null,this.needCheckCheat=!1,this.preventCheatInfo=null,this.tingPaiData=null,this.myTingInfos=null,this.playerNum=GameConst.maxPlayerNum,this._isCheatStatus=!1,this.autoDelayTimeNum=-1,this.tempDataBeforeGameStart=[],this.kickOfflineTime=0,this.autoDiscardData=null,this.changePlayerNumInfo=null,this.applyQuitInfo=null,this.playerSet=[]}return e.prototype.getOverData=function(){return this.overData},e.prototype.setOverData=function(e){this.overData=e;for(var a=e.winType,n=[],o=[],i=0;i<e.xJSUserInfos.length;i++){var s=e.xJSUserInfos[i],r=s.userChairId,l=s.readyStatus,c=this.getPlayer(r);if(null!=c){var u=s.score;c.setScore(u),c.setReadyStatus(l)}var h=this.changeChairIdToClientId(r);Utils.sendGameEvent(t.GameCmd.PLAYER_SCORE_NUM_CHANGED,{clientId:h,score:u});var d=100,m="";if(null!=s.winTypeInfos)for(var p=0;p<s.winTypeInfos.length;p++){var g=s.winTypeInfos[p].winPointType;g==GameConst.specialHuType.GODHU&&d>g?(m=GameConst.ACTION_WIN_ACTINDEX.tianhu,d=g):g==GameConst.specialHuType.SECONDHU&&d>g?(m=GameConst.ACTION_WIN_ACTINDEX.dihu,d=g):(g==GameConst.specialHuType.BIGSTICKBLOOM||s.superPointType==GameConst.specialHuType.STICKBLOOM)&&d>g&&(m=GameConst.ACTION_WIN_ACTINDEX.gangkai,d=g)}var C=s.win;C&&(n.push(h),""==m?1==a?o.push(GameConst.ACTION_WIN_ACTINDEX.zimo):o.push(GameConst.ACTION_WIN_ACTINDEX.hu):o.push(m))}var _=0,f=e.winPlayerNum;e.dianPaoChairId&&e.dianPaoChairId>0&&(_=this.changeChairIdToClientId(e.dianPaoChairId)),f>0&&Utils.sendGameEvent(t.GameCmd.WIN_OVER,{clientId:n,actionIndex:o,chuchongIndex:_})},e.prototype.setAllOverData=function(t){this.allOverData=t},e.prototype.getAllOverData=function(){return this.allOverData},e.prototype.setKickOfflineTime=function(t){this.kickOfflineTime=t},e.prototype.getKickOfflineTime=function(){return this.kickOfflineTime},e.prototype.getTempDataBeforeGameStart=function(){return this.tempDataBeforeGameStart},e.prototype.addTempDataBeforeGameStart=function(t){this.tempDataBeforeGameStart.push(t)},e.prototype.clearTempDataBeforeGameStart=function(){this.tempDataBeforeGameStart=[]},e.prototype.setAutoDelayTimeNum=function(t){this.autoDelayTimeNum=t},e.prototype.getAutoDelayTimeNum=function(){return this.autoDelayTimeNum},e.prototype.clearAutoDelayTimeNum=function(){this.autoDelayTimeNum=0},e.prototype.isAutoDelay=function(t){var e=!1,a=this.isPlayBack();if(!a){var n=this.getPlayerByClientId(t);null!=n&&(e=n.isAutoDiscardOfDelay())}return e},e.prototype.setAutoDiscardInfo=function(t){this.autoDiscardData=t},e.prototype.getAutoDiscardInfo=function(){return this.autoDiscardData},e.prototype.clearAutoDiscardInfo=function(){this.autoDiscardData=null},e.prototype.getPlayerNum=function(){return this.playerNum},e.prototype.setPlayerNum=function(t){this.playerNum=t},e.prototype.setCheatStatus=function(t){this._isCheatStatus=t},e.prototype.isCheatStatus=function(){return this._isCheatStatus},e.prototype.getPreventInfo=function(){return this.preventCheatInfo},e.prototype.setPreventCheatInfo=function(t){this.preventCheatInfo=t},e.prototype.isNeedCheckCheat=function(){return this.needCheckCheat},e.prototype.setNeedCheckCheat=function(t){this.needCheckCheat=t},e.prototype.setMyTingInfo=function(t){null!=t&&t.length>0?this.myTingInfos=t:this.myTingInfos=null},e.prototype.getMyTingInfo=function(){return this.myTingInfos},e.prototype.getTingInfo=function(t){if(this.hasTingPaiInfo()){for(var e=null,a=0;a<this.tingPaiData.length;a++){var n=this.tingPaiData[a];if(n.tileId==t){e=n.tingInfos;break}}return e}},e.prototype.hasTingPaiInfo=function(){return null!=this.tingPaiData&&this.tingPaiData.length>0},e.prototype.clearTingPaiInfo=function(){this.tingPaiData=null},e.prototype.setTingPaiInfo=function(t){this.tingPaiData=t},e.prototype.getTingPaiInfo=function(){return this.tingPaiData},e.prototype.isFirstDrawCard=function(){return this._isFirstDrawCard},e.prototype.clearFirstDrawCardData=function(){this.firstDrawCardData=null},e.prototype.setFirstDrawCardData=function(t){this._isFirstDrawCard=!1,this.firstDrawCardData=t},e.prototype.getFirstDrawCardData=function(){return this.firstDrawCardData},e.prototype.setPlayBack=function(t){this._isPlayBack=t},e.prototype.isPlayBack=function(){return this._isPlayBack},e.prototype.getBankerChairId=function(){return this.bankerChairId},e.prototype.updateSendChatTime=function(){this.lastSendChatMsgTime=(new Date).getTime()},e.prototype.canSendChatMsg=function(){return(new Date).getTime()-this.lastSendChatMsgTime>1e3},e.prototype.getCurTurnDirection=function(){return this.curTurnDirection},e.prototype.getChangePlayerNumInfo=function(){return this.changePlayerNumInfo},e.prototype.setChangePlayerNumInfo=function(t){this.changePlayerNumInfo=t},e.prototype.setApplyQuitInfo=function(t){this.applyQuitInfo=t},e.prototype.getApplyQuitInfo=function(){return this.applyQuitInfo},e.prototype.getLastDiscarChairId=function(){return this.lastDiscardChairId},e.prototype.getLastDiscardValue=function(){return this.lastDiscardCardValue},e.prototype.setEastChairId=function(t){this.eastChairId=t},e.prototype.getEastChairId=function(){return this.eastChairId},e.prototype.changeDirArrow=function(e){this.curArrowDirChairId=e;var a=this.changeChairIdToClientId(e);Utils.sendGameEvent(t.GameCmd.DIR_ARROW_CHANGE,{clientId:a})},e.prototype.curDirArrow=function(){return this.curArrowDirChairId},e.prototype.getDiscardChairId=function(){return this.curDiscardChairId},e.prototype.setDiscardChairId=function(t){this.curDiscardChairId=t},e.prototype.setNeedPlayStartStatus=function(t){this.needPlayStartEffect=t},e.prototype.isNeedPlayStartStatus=function(){return this.needPlayStartEffect},e.prototype.setLeftCardNum=function(t){this.leftCardNum=t},e.prototype.getLeftCardNum=function(){return this.leftCardNum},e.prototype.getLeftFlowerNum=function(){return this.leftFlowerNum},e.prototype.setLeftFlowerNum=function(t){this.leftFlowerNum=t},e.prototype.isBiXiaHu=function(){return this.biXiaHu},e.prototype.getBiXiaHuDesc=function(){return this.biXiaHuDesc},e.prototype.getCurTurnNumber=function(){return this.curTurnNum},e.prototype.setMyChairId=function(e){t.LogUtils.info("我的椅子id "+e),this.myChairId=e},e.prototype.getMyChairId=function(){return this.myChairId},e.prototype.getClickCardType=function(){return this.clickCardType},e.prototype.setClickType=function(t){this.clickCardType!=t&&DataStorage.writeLocalData(LocalStorage.setting.GameDoubleClickType,""+t),this.clickCardType=t},e.prototype.setFlowerCardVisible=function(t){t?DataStorage.writeLocalData(LocalStorage.setting.Flower_card_Visible,"1"):DataStorage.writeLocalData(LocalStorage.setting.Flower_card_Visible,"0"),this.flowerCardVisible=t},e.prototype.getFlowerCardVisible=function(){return this.flowerCardVisible},e.prototype.isMeCreator=function(){return this.roomInfo.getMasterUserId()==GlobalData.userData.getUserId()},e.prototype.getRoomInfo=function(){return this.roomInfo},e.prototype.resetOperateTypes=function(){this.operateTypes=[]},e.prototype.setOperateTypes=function(t){this.operateTypes=t},e.prototype.getOperateTypes=function(){return this.operateTypes},e.prototype.needOperate=function(){var t=this.operateTypes.length;return t>0},e.prototype.getPlayerByClientId=function(t){var e=this.changeClientIdToChairId(t);return this.getPlayer(e)},e.prototype.changeIndexToClientId=function(e){var a=e;return this.playerNum!=GameConst.maxPlayerNum&&3==this.playerNum&&2==e&&(a=3),t.LogUtils.info("changeIndexToClientId index"+e+" ->resultIndex"+a),a},e.prototype.changeChairIdToClientId=function(e){var a=(e-this.myChairId+this.playerNum)%this.playerNum;return t.LogUtils.info("changeChairIdToClientId chairId"+e+" ->clientId"+a),this.changeIndexToClientId(a)},e.prototype.changeClientIdToChairId=function(t){if(0>t||t>=GameConst.maxPlayerNum)return 0;this.playerNum!=GameConst.maxPlayerNum&&3==this.playerNum&&3==t&&(t=2);var e=((t+this.myChairId-1+this.playerNum)%this.playerNum,(t+this.myChairId-1+this.playerNum)%this.playerNum+1);return e},e.prototype.getHeadImgName=function(t){var e=t,a=new a,n=a.sumhexa(e);return"headImage_"+n+".png"},e.prototype.getPlayerHeadImgPathByUserID=function(t){},e.prototype.getPlayerSet=function(){return this.playerSet},e.prototype.addPlayer=function(e,a){t.LogUtils.info("addPlayer chairId "+e),this.playerSet[e]=a},e.prototype.getPlayer=function(t){return 1>t||t>GameConst.maxPlayerNum?void 0:this.playerSet[t]},e.prototype.getPlayerInfoByClientId=function(t){var e=this.changeClientIdToChairId(t);return this.getPlayer(e)},e.prototype.getCardData=function(t){var e=this.getPlayerInfoByClientId(t);return null==e?null:e.getCardData()},e.prototype.getCurPlayerNum=function(){for(var t=0,e=1;e<=GameConst.maxPlayerNum;e++)null!=this.playerSet[e]&&(t+=1);return t},e.prototype.removePlayer=function(t){this.playerSet[t]=null},e.prototype.setGameStatus=function(e){t.LogUtils.info("setGameStatus "+e),this.gameStatus=e},e.prototype.getGameStatus=function(){return this.gameStatus},e.prototype.isMyOutCardTurn=function(){return this.curDiscardChairId==this.myChairId},e.prototype.resetRoomSet=function(){},e.prototype.parse=function(e){this.clearFirstDrawCardData(),t.LogUtils.info("GameData:parse"),this.biXiaHu=e.biXiaHu,this.biXiaHuDesc=e.biXiaHuDesc,this.curTurnNum=e.curTurnNum,this.curTurnDirection=e.curTurnDirection,this.curDiscardChairId=e.curChairId,this.lastDiscardChairId=e.lastDiscardChairId,this.lastDiscardCardValue=e.lastDiscardTileId,this.bankerChairId=e.bankerChairId,t.LogUtils.info("curTurnDirection "+this.curTurnDirection),t.LogUtils.info("curDiscardChairId "+this.curDiscardChairId),t.LogUtils.info("lastDiscardChairId "+this.lastDiscardChairId),t.LogUtils.info("lastDiscardCardValue "+this.lastDiscardCardValue),this.leftCardNum=e.stackTileNum,this.leftFlowerNum=e.stackFlowerNum;var a=e.msgRoomGaming,n=a.msgRoom;this.roomInfo.parse(n),this.playerNum=this.roomInfo.getMaxPlayerNum(),t.LogUtils.info("this.playerNum "+this.playerNum);var o=a.roomStatus;this.setGameStatus(o);for(var i=e.msgUserGames,s=1,r=0;r<this.playerNum;r++){var l=i[r],c=l.msgUserData,u=c.msgUser.userId;if(u==GlobalData.userData.getUserId()){var h=c.chairId;s=h;break}}this.setMyChairId(s),this.clearPlayerData(),this.clearLastGameData();for(var r=0;r<this.playerNum;r++){var l=i[r];t.LogUtils.info("msgUserGame i == "+r);var c=l.msgUserData,d=c.chairId,m=this.getPlayer(d);if(null==m&&(m=new t.PlayerInfo,this.addPlayer(d,m)),m.parse(c),d==s){var p=l.tingInfos;this.setMyTingInfo(p)}if(o==GameConst.GAME_STATUS_TYPE.playing){for(var g=l.hasTing,C=l.jiaTileId,_=l.discardTileIds,f=l.flowerIds,D=l.gainTileInfos,I=l.userTileIds,E=[],y=0;y<D.length;y++){var T=D[y],v=T.discardChairId,S=GlobalData.gameData.changeChairIdToClientId(v),b=T.gainType,A={type:b,provideClientId:S,value:T.tileIds[0]},M=new t.PongKongData(A);E.push(M)}var G=new t.PlayerCardData;G.setTing(g),G.setJiaPaiValue(C),G.setPlayerHuaCards(f),G.setPlayerOutCards(_),G.setPlayerHandCards(I),G.setPongKongCards(E),m.setCardData(G)}}var p=e.tingInfos;this.setTingPaiInfo(p),t.LogUtils.info("gameData init Complete")},e.prototype.clearPlayerData=function(){this.playerSet=[]},e.prototype.clearLastGameData=function(){this.myTingInfos=null,this.clearAutoDiscardInfo(),this.clearAutoDelayTimeNum(),this.clearTempDataBeforeGameStart(),this.resetOperateTypes()},e.prototype.clearData=function(){this.clearPlayerData(),this.clearLastGameData(),this.roomInfo.clearData(),GlobalData.userData.clearRoomNumber(),this.setCheatStatus(!1),this.playerNum=GameConst.maxPlayerNum,this.bankerChairId=0,this.applyQuitInfo=null,this.changePlayerNumInfo=null,this._isFirstDrawCard=!0,this.needCheckCheat=!1,this.preventCheatInfo=null},e}();t.GameData=e,__reflect(e.prototype,"game.GameData")}(game||(game={}));var Utils;!function(t){function e(t,e){var a=Math.random(),n=Math.floor(t+a*(e-t));return n}function a(t){for(var e=[],a=1;a<arguments.length;a++)e[a-1]=arguments[a];if(0==arguments.length)return t;for(var n=0;n<arguments.length;n++){var o=new RegExp("\\{"+(n-1)+"\\}","gm");null!=t.match(o)&&(t=t.replace(o,arguments[n]))}return t}function n(t){var e=t;return 10>t&&(e="0"+t),e}function o(e){var a="";return 1==GameConst.card_back_index?a="_1":2==GameConst.card_back_index&&(a="_2"),t.format(e,a)}function i(t,e){void 0===e&&(e=null);var a=null;a=null==e?{cmd:t}:{cmd:t,data:e},game.EAppFacade.getInstance().sendNotification("gameScene",a)}function s(t,e){void 0===e&&(e=null);var a=null;a=null==e?{cmd:t}:{cmd:t,data:e},game.EAppFacade.getInstance().sendNotification("panel",a)}function r(t){var e=/^[0-9]+.?[0-9]*$/;
return e.test(t)?!0:!1}function l(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],a=new egret.ColorMatrixFilter(e);t.filters=[a]}function c(t){t.filters=null}function u(t,e,a,n){void 0===n&&(n=255);var o=parseInt((t<<16|e<<8|a).toString(16),16);return o}function h(t,e,a){for(var n=new egret.SpriteSheet(t),o=[],i=t.textureWidth/e,s=t.textureHeight/a,r=0;i*s>r;r++){var l=r%i*e,c=Math.floor(r/i)*a;o.push(n.createTexture("a"+r,l,c,e,a))}return o}function d(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return void 0==t||null==t?[2]:GameConfig.platform!=GameConfig.PLATFORM_SET.H5?[3,1]:[3,3];case 1:return[4,platform.setClipboardData(t)];case 2:e.sent(),e.label=3;case 3:return[2]}})})}function m(t){for(var e=0,a=t.length,n=-1,o=0;a>o;o++)n=t.charCodeAt(o),e+=n>=0&&128>=n?1:2;return e}t.getRandom=e,t.format=a,t.getNumberFormatStr=n,t.getCardBack=o,t.sendGameEvent=i,t.sendPanelEvent=s,t.isNumbers=r,t.addGrayEffect=l,t.removeGrayEffect=c,t.RGBA2Color=u,t.CreateTextureSheet=h,t.copyToClipboard=d,t.getCharLen=m}(Utils||(Utils={}));var game;!function(t){var e=function(e){function a(){var t=null!==e&&e.apply(this,arguments)||this;return t.roomNumber=0,t.diamond=0,t._isNewPlayer=!0,t.gold=0,t.longitude=0,t.latitude=0,t}return __extends(a,e),a.prototype.parse=function(t){this._isNewPlayer=t.regist,null!=t.roomNumber&&this.setRoomNumber(t.roomNumber);var e=t.user;this.setUserId(e.userId),this.setHeadIMGUrl(e.headImgUrl),this.setGender(e.gender),this.setUserName(e.nickName),this.setIP(e.ip)},a.prototype.isNewPlayer=function(){return this._isNewPlayer},a.prototype.setNewPlayer=function(t){this._isNewPlayer=t},a.prototype.getRoomNumber=function(){return this.roomNumber},a.prototype.setRoomNumber=function(t){this.roomNumber=t},a.prototype.getGoldNum=function(){return this.gold},a.prototype.setGoldNum=function(e){t.LogUtils.info("setGoldNum "+e);var a=!1;this.gold!=e&&(t.LogUtils.info("gold changed "+e),a=!0),this.gold=e,a&&t.EAppFacade.getInstance().sendNotification(t.GameCmd.GOLD_NUMBER_CHANGE)},a.prototype.setDiamondNum=function(e){t.LogUtils.info("setDiamondNum "+e);var a=!1;this.diamond!=e&&(t.LogUtils.info("diamond changed "+e),a=!0),this.diamond=e,a&&t.EAppFacade.getInstance().sendNotification(t.GameCmd.DIAMOND_NUMBER_CHANGE)},a.prototype.getDiamondNum=function(){return this.diamond},a.prototype.setLocation=function(t,e){this.longitude=t,this.latitude=e},a.prototype.getLocation=function(){return{longitude:this.longitude,latitude:this.latitude}},a.prototype.clearRoomNumber=function(){this.roomNumber=0},a.prototype.cleanUser=function(){this.setUserId(0)},a}(t.BaseUserInfo);t.UserInfo=e,__reflect(e.prototype,"game.UserInfo")}(game||(game={}));var game;!function(t){var e=function(e){function a(a,n,o){void 0===n&&(n=!0),void 0===o&&(o=.6);var i=e.call(this)||this;return i.animationType=0,i.needMask=!0,i.maskClickable=!0,i.maskAlpha=0,void 0==a||null==a?i.dialogUUID=t.UUID.generateUUID():i.dialogUUID=a,i.maskClickable=n,i.maskAlpha=o,i}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.needMask&&this.addBgRect(),this.needShow&&(this.needShow=!1,this.show(this.animationType,this.callback)),t.EAppFacade.getInstance().registerCommand("panel",this.onEventHandler,this)},a.prototype.onEventHandler=function(t){this.eventMsg=t.data,this.eventId=this.eventMsg.cmd,this.eventData=this.eventMsg.data},a.prototype.addBgRect=function(){null==this.bgRect&&(this.bgRect=new eui.Rect,this.bgRect.fillColor=0,this.bgRect.alpha=this.maskAlpha,this.bgRect.width=GameConfig.ScreenW,this.bgRect.height=GameConfig.ScreenH,this.addChildAt(this.bgRect,0)),this.maskClickable&&this.addTapEvent(this.bgRect,this.close)},a.prototype.show=function(t,e){if(!this.isViewCreated)return this.needShow=!0,this.animationType=t,void(this.callback=e);var n=t;switch(n){case a.show_ani_type_null:var o=this;o.anchorOffsetX=.5*o.width,o.anchorOffsetY=.5*o.height,o.x=.5*GameConfig.ScreenW,o.y=.5*GameConfig.ScreenH;break;case a.show_ani_type_ZoomIn:this.playAnimationZoomIn();break;case a.show_ani_type_MoveDown:this.playMoveDown();break;case a.show_ani_type_MoveFromLeft:this.playMoveFromLeft()}},a.prototype.playAnimationZoomIn=function(){var t=this,e=300;t.scaleX=0,t.scaleY=0,t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=.5*GameConfig.ScreenW,t.y=.5*GameConfig.ScreenH;var a=egret.Tween.get(t);a.to({scaleX:1,scaleY:1},e,egret.Ease.quadIn)},a.prototype.playAnimationExitJump=function(t){},a.prototype.playAniamtionJump=function(t){var e=this;e.anchorOffsetX=.5*e.width,e.anchorOffsetY=.5*e.height;var a=-30,n=400,o=20,i=egret.Tween.get(e);i.to({y:0+a},n+o),i.to({y:0-a},2*o),i.to({y:0},o),i.call(t)},a.prototype.playAnimationDrop=function(){var t=this;t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height;var e=500,a=50,n=50,o=30,i=0,s=i-o,r=egret.Tween.get(t);r.to({y:i},e,egret.Ease.quadIn),r.to({y:s},a,egret.Ease.quadOut),r.to({y:i},n,egret.Ease.quadIn)},a.prototype.playMoveDown=function(){var t=this,e=200;t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=.5*GameConfig.ScreenW,t.y=-.5*GameConfig.ScreenH;var a=egret.Tween.get(t);a.to({y:.5*GameConfig.ScreenH},e,egret.Ease.getPowIn(2))},a.prototype.playMoveFromLeft=function(){var t=this,e=200;t.anchorOffsetX=.5*t.width,t.anchorOffsetY=.5*t.height,t.x=-.5*GameConfig.ScreenW,t.y=.5*GameConfig.ScreenH;var a=egret.Tween.get(t);a.to({x:.5*GameConfig.ScreenW},e,egret.Ease.getPowIn(2))},a.prototype.onShowEnd=function(){},a.prototype.getDialogUUID=function(){return this.dialogUUID},a.prototype.close=function(){t.EAppFacade.getInstance().removeCommand("panel",this.onEventHandler,this),t.DialogManager.getInstance().close(this)},a.show_ani_type_null=0,a.show_ani_type_ZoomIn=1,a.show_ani_type_MoveDown=2,a.show_ani_type_MoveFromLeft=3,a}(t.EComponent);t.EDialog=e,__reflect(e.prototype,"game.EDialog")}(game||(game={}));var game;!function(t){var e=function(t){function e(e,a,n){var o=t.call(this)||this;return o.dir=e,o._value=a,o.idx=n,o}return __extends(e,t),e.prototype.onCreateViewComplete=function(){this.setCardValue(this._value)},e.prototype.setCardValue=function(t){this._value=t},e.prototype.getDir=function(){return this.dir},e.prototype.getCardValue=function(){return this._value},e}(t.EComponent);t.BaseCardNode=e,__reflect(e.prototype,"game.BaseCardNode")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.sceneIndex=e,a}return __extends(e,t),e.prototype.onShow=function(){},e.prototype.onClose=function(){},e.prototype.onPause=function(){},e.prototype.onResume=function(){},e.prototype.getIndex=function(){return this.sceneIndex},e.prototype.clean=function(){t.prototype.clean.call(this)},e}(t.EComponent);t.SceneBase=e,__reflect(e.prototype,"game.SceneBase")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.checkCheat.index,!1)||this;return t.skinName="resource/skins/game/panel/checkCheatBox.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){var a=this;e.prototype.onCreateViewComplete.call(this),Utils.sendPanelEvent(t.GameCmd.CLOSE_CHEAT_STATUS_BOX),this.Image_rotate.rotation=-45;var n=egret.Tween.get(this.Image_rotate);n.to({rotation:675},2e3),n.call(function(){a.checkFinish()})},a.prototype.checkFinish=function(){this.Text_info.text="防作弊扫描检测完成";var t=egret.Tween.get(this);t.wait(1e3),t.call(this.finishFuc)},a.prototype.finishFuc=function(){this.close();var e=GlobalData.getCurGameData();e.setNeedCheckCheat(!1);var a=e.getPreventInfo();null!=a?t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.preventCheat.index,a):Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED)},a}(t.EDialog);t.CheckCheatBox=e,__reflect(e.prototype,"game.CheckCheatBox")}(game||(game={}));var EScroller=function(t){function e(){var e=t.call(this)||this;return e.elementSize=10,e.disOfElement=0,e.scrollerHeight=0,e.bInited=!1,e.firstViewIndex=0,e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.release,e),e}return __extends(e,t),e.prototype.setScrollerHeight=function(t){this.scrollerHeight=t},e.prototype.setElementViewInfo=function(t,e){this.elementSize=t,this.disOfElement=e},e.prototype.init=function(){this.viewElementSize=this.elementSize+this.disOfElement;var t=this.getViewSize();if(this.maxShowCount=Math.round(t/this.viewElementSize)+1,this.bInited=!0,this.viewElementList=[],this.viewport=this.viewContentGroup,this.firstViewIndex=0,this.needOptimize()){var e=new eui.Rect;e.visible=!1,e.height=this.getContentSize(),this.viewContentGroup.addChild(e),this.addEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)}},e.prototype.needOptimize=function(){return this.getElementCount()>=this.maxShowCount},e.prototype.getViewSize=function(){return 0==this.scrollerHeight&&(this.scrollerHeight=this.height,0==this.scrollerHeight&&(this.scrollerHeight=400)),this.scrollerHeight},e.prototype.getContentSize=function(){return this.getElementCount()*this.viewElementSize-this.disOfElement},e.prototype.getElementCount=function(){return this.dataContent?this.dataContent.length:0},e.prototype.addScrollerElement=function(t){this.bInited||this.init();var e=this.viewElementList.length;if(e<this.maxShowCount){var a=this.createElement(t),n=this.getPos(e);this.setPos(a,n),this.viewElementList.push(a),this.viewContentGroup.addChild(a)}},e.prototype.getPos=function(t){return this.viewElementSize*t},e.prototype.setPos=function(t,e){t.y=e},e.prototype.clearContent=function(){null!=this.viewport&&(this.viewport.scrollV=0),this.bInited=!1,this.viewContentGroup?this.viewContentGroup.removeChildren():this.viewContentGroup=new eui.Group,this.needOptimize()&&this.removeEventListener(egret.Event.ENTER_FRAME,this.onEnterFrame,this)},e.prototype.release=function(){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.release,this),this.clearContent()},e.prototype.setScrollerContent=function(t,e){if(this.dataContent!=t||e){this.dataContent=t,this.clearContent();for(var a=0;a<t.length;a++)this.addScrollerElement(t[a])}},e.prototype.setElementCreateFunction=function(t){this.elementCreate=t},e.prototype.createElement=function(t){if(this.elementCreate){var e=this.elementCreate.call(null,t);return this.needOptimize()||this.onElementShown(e),e}return null},e.prototype.setElementUpdateDataFun=function(t){this.updateElement=t},e.prototype.updateElementData=function(t,e){this.updateElement&&this.updateElement.call(null,t,e)},e.prototype.setElementUpdateUIFun=function(t){this.updateElementUIFun=t},e.prototype.updateElementUI=function(t){this.updateElementUIFun&&this.updateElementUIFun.call(null,t)},e.prototype.setElementOnShowFun=function(t){this.onShowElementFun=t},e.prototype.onElementShown=function(t){this.onShowElementFun&&this.onShowElementFun.call(null,t)},e.prototype.onEnterFrame=function(){if(this.visible&&this.bInited){var t=this.localToGlobal().y-this.viewContentGroup.localToGlobal().y,e=this.getCurrentFirstIndexView(t);if(e!=this.firstViewIndex){this.firstViewIndex=e;for(var a=e;a<e+this.maxShowCount;a++){var n=a-e,o=this.viewElementList[n],i=this.dataContent[a],s=this.getPos(a);this.setPos(o,s),this.updateElementData(o,i)}}for(var a=0;a<this.viewElementList.length;a++){var o=this.viewElementList[a],r=this.getElementTop(o)-t<this.height;o.visible=r,r&&this.onElementShown(o)}}},e.prototype.getElementTop=function(t){return t.y-t.anchorOffsetY},e.prototype.updateUI=function(){if(this.bInited)for(var t=0;t<this.viewElementList.length;t++){var e=this.viewElementList[t];this.updateElementUI(e)}},e.prototype.getCurrentFirstIndexView=function(t){var e=Math.floor(t/this.viewElementSize);if(0>e)e=0;else{var a=this.getElementCount()-this.maxShowCount;e>a&&(e=a)}return 0>e&&(e=0),e},e}(eui.Scroller);__reflect(EScroller.prototype,"EScroller"),window.EScroller=EScroller;var EToggleButton=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.buttonReleased=function(){game.LogUtils.info("点击按钮----"),game.SoundService.getInstance().playAudio("game_button_click_mp3")},e}(eui.ToggleButton);__reflect(EToggleButton.prototype,"EToggleButton"),window.EToggleButton=EToggleButton;var game;!function(t){var e=function(){function e(){}return e.createBitmap=function(t){var e=new egret.Bitmap,a=RES.getRes(t);return e.texture=a,e},e.loadWebImage=function(a,n,o,i){void 0===i&&(i=5),egret.ImageLoader.crossOrigin="anonymous";var s=new egret.ImageLoader;s.addEventListener(egret.Event.COMPLETE,function(e){5>i&&t.LogUtils.info("重试成功  "+i);var a=e.currentTarget,s=new egret.Texture;null!=a.data?(s._setBitmapData(a.data),n.call(o,s)):t.LogUtils.info("加载图片失败...")},this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,function(){t.LogUtils.info("加载图片错误..."),void 0!=i&&i>0&&(t.LogUtils.info("重试次数  "+i),e.loadWebImage(a,n,o,i-1))},this),s.load(a)},e}();t.ResManager=e,__reflect(e.prototype,"game.ResManager")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getFullUrl=function(e){return t.BASE_URL+e},t.getErrString=function(t){var e="";switch(t){case 102:e="该账户已被暂停使用;请联系管理员";break;case 104:e="昵称重复";break;case 105:e="只允许输入中文,字母";break;case 106:e="您输入的昵称有敏感词";break;case 110:e="钻石不足";break;case 111:e="积攒数不足";break;case 121:e="对方好友数量已达到上限";break;case 122:e="您的好友数量已达到上限";break;case 130:e="您的PK次数不足";break;case 140:e="免费次数已用完";break;case 150:e="您不能领取";break;case 112:e="体力不足";break;case 113:e="没有可使用次数";break;case 160:e="不存在的激活码";break;case 161:e="已使用过的激活码";break;case 162:e="激活码已过期";break;case 163:e="钥匙数量不足";break;case 164:e="不能挑战自己"}return e},t.HTTP_PORT=8080,t.BASE_URL_PRODUCTION="http://127.0.0.1:8080/web/",t.BASE_URL_TEST="http://192.168.1.42:8080/web/",t.BASE_URL_ONLINE=Constants.server_url_current,t.BASE_URL=Utils.format("https://{0}/web/",t.BASE_URL_ONLINE),t.HTTP_APP_SECRET="0ac1cab3409a1bd6fefe315b04710138",t.url_checkAppUpdate="checkAppUpdate",t.url_getStoreList="getItemInfosNew",t.url_getCombatReplayData="game/getCombatReplayData",t.url_getUnionIdFromJsCode="user/getUnionIdFromJsCode",t.HTTP_STATUS_SUCCESS=1,t}();t.GameHttpConst=e,__reflect(e.prototype,"game.GameHttpConst")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.checkAppUpdate=function(){var a=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_checkAppUpdate),n=this.getBaseData(),o=JSON.stringify(n);t.GameHttpRequest.request(a,o,e.checkAppUpdateCallBack)},e.checkAppUpdateCallBack=function(e){if(e.code==t.CmdResultType.SUCCESS){var a=e.data.clientConfigs;GlobalData.initClientConfigInfo(a)}},e.getCombatList=function(e){var a=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_checkAppUpdate),n=this.getBaseData(),o=JSON.stringify(n);t.GameHttpRequest.request(a,o,e)},e.getStoreList=function(e){var a=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getStoreList),n=this.getBaseData();n.diamondGroupId="2",n.goldGroupId="10002";var o=JSON.stringify(n);t.GameHttpRequest.request(a,o,e)},e.getCombatReplayData=function(e,a){var n=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getCombatReplayData),o=this.getBaseData();o.roomId=e;var i=JSON.stringify(o);t.GameHttpRequest.request(n,i,a)},e.getUnionId=function(e,a,n,o){var i=t.GameHttpConst.getFullUrl(t.GameHttpConst.url_getUnionIdFromJsCode),s=this.getBaseData();s.jscode=e,s.encryptedData=a,s.iv=n;var r=JSON.stringify(s);t.GameHttpRequest.request(i,r,o)},e.getBaseData=function(){var t={};return t.versionName=GameConfig.version,t.platform="H5",t},e}();t.GameHttpManager=e,__reflect(e.prototype,"game.GameHttpManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.request=function(t,a,n){e.sendPostRequest(t,a,n)},e.getSign=function(e){var a=new t.md5;return a.hex_md5(e+t.GameHttpConst.HTTP_APP_SECRET)},e.handleServerResult=function(e,a){if(t.LogUtils.info("data==="+e),e){var n=JSON.parse(e);a.call(a,n)}},e.sendPostRequest=function(a,n,o){var i=e.getSign(n),s=new egret.HttpRequest;s.responseType=egret.HttpResponseType.TEXT,s.setRequestHeader("sign",i),s.setRequestHeader("Content-Type","text/plain"),s.addEventListener(egret.Event.COMPLETE,function(a){var n=a.currentTarget;if(null!=n&&null!=n.response){var i=n.response;e.handleServerResult(i,o)}else t.WaitingUI.hide(),t.LogUtils.error("http 请求未知错误！")},this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,function(e){t.WaitingUI.hide(),t.LogUtils.error("http 请求错误："+e)},this),s.addEventListener(egret.ProgressEvent.PROGRESS,function(t){},this),s.open(a,egret.HttpMethod.POST),s.send(n)},e.platformUID="333",e.uid="381",e.serverId="1",e.channel="777",e.channel_child="21",e.isShare=!1,e.shareuid="",e.shareserverId="",e.index=0,e}();t.GameHttpRequest=e,__reflect(e.prototype,"game.GameHttpRequest")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.status=ConnectConst.ConnectStatus.Wait}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.connect=function(e,a,n,o,i){if(this.status==ConnectConst.ConnectStatus.Connecting){if(!i)return;this.close(),this.clean()}else if(this.status==ConnectConst.ConnectStatus.Connected){if(!i)return;this.close(),this.clean()}this.status=ConnectConst.ConnectStatus.Connecting,this.url=e,this.port=a,this.connectHandler=n,this.msgHandler=o,this.webSocket=new egret.WebSocket,this.webSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.webSocket.addEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.webSocket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),GameConfig.platform==GameConfig.PLATFORM_SET.H5?this.webSocket.connect(e,a):GameConfig.platform==GameConfig.PLATFORM_SET.weChat&&this.webSocket.connectByUrl("wss://"+e+"/wss"),t.LogUtils.info("开始连接，"+e+":"+a)},e.prototype.close=function(){this.status!=ConnectConst.ConnectStatus.ConnectClose&&(this.status=ConnectConst.ConnectStatus.ConnectClose,this.clean(),null!=this.connectHandler&&this.connectHandler.call(null,{status:this.status}))},e.prototype.clean=function(){null!=this.webSocket&&(this.webSocket.close(),this.webSocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceiveMessage,this),this.webSocket.removeEventListener(egret.Event.CONNECT,this.onSocketOpen,this),this.webSocket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.webSocket=null)},e.prototype.onSocketOpen=function(){t.LogUtils.info("连接成功"),this.status=ConnectConst.ConnectStatus.Connected,null!=this.connectHandler&&this.connectHandler.call(null,{status:this.status})},e.prototype.onSocketClose=function(){t.LogUtils.info("连接关闭"),this.close()},e.prototype.onReceiveMessage=function(t){var e=this.webSocket.readUTF();this.onReceiveMessageEvent(e)},e.prototype.onReceiveMessageEvent=function(e){var a=Base64.decode(e);t.LogUtils.info("get数据："+a),GameConfig.localVersion&&(this.msgHandler=t.DispatchHandler.getInstance().dispatch),null!=this.msgHandler&&this.msgHandler.call(null,a)},e.prototype.send=function(e){if(GameConfig.localVersion&&t.Mock.getInstance().use(e),null!=e&&null!=this.webSocket){var a=JSON.stringify(e);t.LogUtils.info("send数据："+a);var n=t.Base64Utils.encode(a+"\n");this.webSocket.writeUTF(n)}},e.prototype.sendMsg=function(e,a,n){void 0===n&&(n=null);var o=t.DomainUtils.getRequestDomain(e,a,n);this.send(o)},e}();t.SocketManager=e,__reflect(e.prototype,"game.SocketManager")}(game||(game={}));var CardCost;!function(t){t.Character=(e={},e[1]=1,e[2]=2,e[3]=3,e[4]=4,e[5]=5,e[6]=6,e[7]=7,e[8]=8,e[9]=9,e),t.Bamboo=(a={},a[1]=11,a[2]=12,a[3]=13,a[4]=14,a[5]=15,a[6]=16,a[7]=17,a[8]=18,a[9]=19,a),t.Dot=(n={},n[1]=21,n[2]=22,n[3]=23,n[4]=24,n[5]=25,n[6]=26,n[7]=27,n[8]=28,n[9]=29,n),t.Flower={spring:51,summer:53,autumn:55,winter:57,wintersweet:61,orchid:63,bamboo:65,mum:67},t.Wind={east:31,south:33,west:35,north:37},t.Dragon={Red:41,Green:43,White:45},t.other={buHua:101,pong:102,kong:103,win:104,kongWin:105,tianHu:106,diHu:107,ziMo:108};var e,a,n}(CardCost||(CardCost={}));var Main=function(t){function e(){var a=t.call(this)||this;return e.instance=a,a.addEventListener(egret.Event.ADDED_TO_STAGE,a.onAddToStage,a),a}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause(),console.log("-----------onPause"),game.EAppFacade.getInstance().sendNotification(game.GameCmd.onPause)},egret.lifecycle.onResume=function(){egret.ticker.resume(),console.log("-----------onResume"),game.EAppFacade.getInstance().sendNotification(game.GameCmd.onResume)},this.init(),this.assetAdapter=new AssetAdapter,egret.registerImplementation("eui.IAssetAdapter",this.assetAdapter),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.init=function(){egret.ImageLoader.crossOrigin="anonymous",egret.Capabilities.runtimeType==egret.RuntimeType.WXGAME?GameConfig.platform==GameConfig.PLATFORM_SET.weChat:egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&GameConfig.platform==GameConfig.PLATFORM_SET.H5,this.sceneLayer=this.createGroup(),this.addChild(this.sceneLayer),this.dialogLayer=this.createGroup(),this.addChild(this.dialogLayer),this.toastLayer=this.createGroup(),this.addChild(this.toastLayer),this.confirmDialogLayer=this.createGroup(),this.addChild(this.confirmDialogLayer),game.TimerManager.getInstance().start()},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e,a,n;return __generator(this,function(o){switch(o.label){case 0:return console.log("-----------runGame start"),GameConfig.isDebug,[4,platform.getLaunchOptionsSync()];case 1:return t=o.sent(),console.log("launcher:"+t.query.key1),[4,platform.setKeepScreenOn()];case 2:return o.sent(),[4,this.loadResource()];case 3:return o.sent(),[4,platform.getSystemInfo()];case 4:return e=o.sent(),a=e.windowWidth*e.pixelRatio,n=e.windowHeight*e.pixelRatio,GameConfig.windowWidth=a,GameConfig.windowHeight=n,GameConfig.pixelRatio=e.pixelRatio,this.initService(),game.SceneSkip.skipToLoginScene(),[2]}})})},e.prototype.initService=function(){game.UserInfoService.getInstance()},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,a){var n=new eui.Theme("resource/default.thm.json?v="+GameConfig.version,t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,7,,8]),console.log("-----------loadResource start"),GameConfig.platform!=GameConfig.PLATFORM_SET.H5?[3,2]:(console.log("-----------loadResource H5"),[4,RES.loadConfig("resource/default.res.json","resource/")]);case 1:return e.sent(),[3,4];case 2:return GameConfig.platform!=GameConfig.PLATFORM_SET.weChat?[3,4]:(console.log("-----------loadResource weChat"),[4,RES.loadConfig("default.res.json?v="+GameConfig.version,"https://res.qixiyx.cn/file/mahjong_client_egret_new_wxgame_remote/resource/")]);case 3:e.sent(),e.label=4;case 4:return[4,this.loadTheme()];case 5:return e.sent(),[4,RES.loadGroup("preload",0)];case 6:return e.sent(),console.log("-----------loadResource finish"),[3,8];case 7:return t=e.sent(),console.error(t),[3,8];case 8:return[2]}})})},e.prototype.createGroup=function(){var t=new eui.Group;return t},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var game;!function(t){var e=function(){function t(){}return t.getRoomTypeName=function(t){return t==Constants.ROOM_TYPE.jinYuanZi?"进园子":"敞开头"},t.getPayModeName=function(t,e){return"0"==GlobalData.clientConfigs.showCreateRoom?"":t==Constants.ROOM_PAY_MODE.AA?"AA模式":t==Constants.ROOM_PAY_MODE.creator?"房主模式":t==Constants.ROOM_PAY_MODE.other?e?"会长模式":"代开":"未知"},t.getTurnModeName=function(t){return t==Constants.ROOM_TIME_MODE.ba?"把":"圈"},t}();t.ConstantUtils=e,__reflect(e.prototype,"game.ConstantUtils")}(game||(game={}));var GameConfig;!function(t){t.isDebug=!0,t.ScreenW=1280,t.ScreenH=720,t.windowWidth=0,t.windowHeight=0,t.pixelRatio=0,t.gameID=Constants.GAME_ID_SET.nanjing,t.localVersion=!1,t.version="1.0.0",t.PLATFORM_SET={H5:"h5",weChat:"weChat"},t.platform=t.PLATFORM_SET.weChat}(GameConfig||(GameConfig={}));var LocalStorage;!function(t){t.createRoomSet={RoomType:"RoomType",Score:"Score",PayMode:"PayMode",DaiKai:"DaiKai",turnMode:"turnMode",timeModeIndex:"timeModeIndex",HuaZa2:"HuaZa2",DNXBFaFen:"DNXBFaFen",JieZhuangBi:"JieZhuangBi",JieSuanLimit:"JieSuanLimit",countIndex:"countIndex",autoDiscard:"autoDiscard",baoMi:"baomi"},t.createRoomSetZhuanDan={PayMode:"PayModeZD",timeModeIndex:"zdTimeModeIndex"},t.createRoomSetFightThree={PayMode:"PayModeFT",timeModeIndex:"timeModeIndexFT",round:"round_FT",pot:"pot_FT",stuffyNum:"stuffyNum_FT",playType:"playType_FT",isShowPoker:"isShowPoker_FT"},t.createRoomSetBJ={PayMode:"PayModeBJ",timeModeIndex:"timeModeIndexBJ",hasTwoWang:"hasTwoWang",canThrowTile:"canThrowTile",hasPierSort:"hasPierSort",hasFirstShunQing:"hasFirstShunQing",hasSanQing:"hasSanQing",multiple:"multiple"},t.setting={GameDoubleClickType:"GameDoubleClickType",GameMusicOn:"GameMusicOn",GameEffectOn:"GameEffectOn",Card_back_index:"Card_back_index",Game_bg_index:"Game_bg_index",Flower_card_Visible:"Flower_card_Visible",Game_bg_frame:"Game_bg_frame",Sound_type:"Sound_type"},t.account={wxId:"wxUid",deviceId:"deviceUId",lastLoginId:"lastLoginId",lastLoginWxTime:"lastLoginWxTime",lastLoginVersion:"lastLoginVersionNumber",sexy:"gender",declare_login:"declare_login",declare_create_room:"declare_create_room",lastGameId:"lastGameId",sortByValue_BJ:"sortByValue_BJ"}}(LocalStorage||(LocalStorage={}));var SoundCost;!function(t){t.soundType={young:1,old:2},t.soundData={},t.soundData[1]=[],t.soundData[2]={},t.soundData[1][t.soundType.young]={},t.soundData[1][t.soundType.old]={},t.soundData[2][t.soundType.young]={},t.soundData[2][t.soundType.old]={},t.soundData[1][1][CardCost.Character[1]]=2,t.soundData[1][1][CardCost.Character[2]]=4,t.soundData[1][1][CardCost.Character[3]]=1,t.soundData[1][1][CardCost.Character[4]]=1,t.soundData[1][1][CardCost.Character[5]]=1,t.soundData[1][1][CardCost.Character[6]]=2,t.soundData[1][1][CardCost.Character[7]]=1,t.soundData[1][1][CardCost.Character[8]]=3,t.soundData[1][1][CardCost.Character[9]]=1,t.soundData[1][2][CardCost.Character[1]]=2,t.soundData[1][2][CardCost.Character[2]]=3,t.soundData[1][2][CardCost.Character[3]]=1,t.soundData[1][2][CardCost.Character[4]]=1,t.soundData[1][2][CardCost.Character[5]]=1,t.soundData[1][2][CardCost.Character[6]]=2,t.soundData[1][2][CardCost.Character[7]]=1,t.soundData[1][2][CardCost.Character[8]]=3,t.soundData[1][2][CardCost.Character[9]]=1,t.soundData[2][1][CardCost.Character[1]]=2,t.soundData[2][1][CardCost.Character[2]]=3,t.soundData[2][1][CardCost.Character[3]]=1,t.soundData[2][1][CardCost.Character[4]]=1,t.soundData[2][1][CardCost.Character[5]]=1,t.soundData[2][1][CardCost.Character[6]]=2,t.soundData[2][1][CardCost.Character[7]]=1,t.soundData[2][1][CardCost.Character[8]]=3,t.soundData[2][1][CardCost.Character[9]]=1,t.soundData[2][2][CardCost.Character[1]]=2,t.soundData[2][2][CardCost.Character[2]]=3,t.soundData[2][2][CardCost.Character[3]]=1,t.soundData[2][2][CardCost.Character[4]]=1,t.soundData[2][2][CardCost.Character[5]]=1,t.soundData[2][2][CardCost.Character[6]]=2,t.soundData[2][2][CardCost.Character[7]]=1,t.soundData[2][2][CardCost.Character[8]]=3,t.soundData[2][2][CardCost.Character[9]]=1,t.soundData[1][1][CardCost.Bamboo[1]]=3,t.soundData[1][1][CardCost.Bamboo[2]]=2,t.soundData[1][1][CardCost.Bamboo[3]]=2,t.soundData[1][1][CardCost.Bamboo[4]]=2,t.soundData[1][1][CardCost.Bamboo[5]]=3,t.soundData[1][1][CardCost.Bamboo[6]]=2,t.soundData[1][1][CardCost.Bamboo[7]]=2,t.soundData[1][1][CardCost.Bamboo[8]]=2,t.soundData[1][1][CardCost.Bamboo[9]]=1,t.soundData[1][2][CardCost.Bamboo[1]]=3,t.soundData[1][2][CardCost.Bamboo[2]]=2,t.soundData[1][2][CardCost.Bamboo[3]]=2,t.soundData[1][2][CardCost.Bamboo[4]]=2,t.soundData[1][2][CardCost.Bamboo[5]]=3,t.soundData[1][2][CardCost.Bamboo[6]]=2,t.soundData[1][2][CardCost.Bamboo[7]]=2,t.soundData[1][2][CardCost.Bamboo[8]]=2,t.soundData[1][2][CardCost.Bamboo[9]]=1,t.soundData[2][1][CardCost.Bamboo[1]]=3,t.soundData[2][1][CardCost.Bamboo[2]]=2,t.soundData[2][1][CardCost.Bamboo[3]]=2,t.soundData[2][1][CardCost.Bamboo[4]]=2,t.soundData[2][1][CardCost.Bamboo[5]]=3,t.soundData[2][1][CardCost.Bamboo[6]]=2,t.soundData[2][1][CardCost.Bamboo[7]]=2,t.soundData[2][1][CardCost.Bamboo[8]]=2,t.soundData[2][1][CardCost.Bamboo[9]]=1,t.soundData[2][2][CardCost.Bamboo[1]]=3,t.soundData[2][2][CardCost.Bamboo[2]]=2,t.soundData[2][2][CardCost.Bamboo[3]]=2,t.soundData[2][2][CardCost.Bamboo[4]]=2,t.soundData[2][2][CardCost.Bamboo[5]]=3,t.soundData[2][2][CardCost.Bamboo[6]]=2,t.soundData[2][2][CardCost.Bamboo[7]]=2,t.soundData[2][2][CardCost.Bamboo[8]]=2,t.soundData[2][2][CardCost.Bamboo[9]]=1,t.soundData[1][1][CardCost.Dot[1]]=2,t.soundData[1][1][CardCost.Dot[2]]=3,t.soundData[1][1][CardCost.Dot[3]]=2,t.soundData[1][1][CardCost.Dot[4]]=3,t.soundData[1][1][CardCost.Dot[5]]=2,t.soundData[1][1][CardCost.Dot[6]]=1,t.soundData[1][1][CardCost.Dot[7]]=2,t.soundData[1][1][CardCost.Dot[8]]=4,t.soundData[1][1][CardCost.Dot[9]]=2,t.soundData[1][2][CardCost.Dot[1]]=2,t.soundData[1][2][CardCost.Dot[2]]=3,t.soundData[1][2][CardCost.Dot[3]]=2,t.soundData[1][2][CardCost.Dot[4]]=3,t.soundData[1][2][CardCost.Dot[5]]=2,t.soundData[1][2][CardCost.Dot[6]]=1,t.soundData[1][2][CardCost.Dot[7]]=2,t.soundData[1][2][CardCost.Dot[8]]=4,t.soundData[1][2][CardCost.Dot[9]]=2,t.soundData[2][1][CardCost.Dot[1]]=2,t.soundData[2][1][CardCost.Dot[2]]=3,t.soundData[2][1][CardCost.Dot[3]]=2,t.soundData[2][1][CardCost.Dot[4]]=3,t.soundData[2][1][CardCost.Dot[5]]=2,t.soundData[2][1][CardCost.Dot[6]]=1,t.soundData[2][1][CardCost.Dot[7]]=2,t.soundData[2][1][CardCost.Dot[8]]=4,t.soundData[2][1][CardCost.Dot[9]]=2,t.soundData[2][2][CardCost.Dot[1]]=2,t.soundData[2][2][CardCost.Dot[2]]=3,t.soundData[2][2][CardCost.Dot[3]]=2,t.soundData[2][2][CardCost.Dot[4]]=3,t.soundData[2][2][CardCost.Dot[5]]=2,t.soundData[2][2][CardCost.Dot[6]]=1,t.soundData[2][2][CardCost.Dot[7]]=2,t.soundData[2][2][CardCost.Dot[8]]=4,t.soundData[2][2][CardCost.Dot[9]]=2,t.soundData[1][1][CardCost.Wind.east]=2,t.soundData[1][1][CardCost.Wind.south]=3,t.soundData[1][1][CardCost.Wind.west]=4,t.soundData[1][1][CardCost.Wind.north]=2,t.soundData[2][1][CardCost.Wind.east]=3,t.soundData[2][1][CardCost.Wind.south]=3,t.soundData[2][1][CardCost.Wind.west]=4,t.soundData[2][1][CardCost.Wind.north]=2,t.soundData[1][2][CardCost.Wind.east]=2,t.soundData[1][2][CardCost.Wind.south]=3,t.soundData[1][2][CardCost.Wind.west]=3,t.soundData[1][2][CardCost.Wind.north]=2,t.soundData[2][2][CardCost.Wind.east]=2,t.soundData[2][2][CardCost.Wind.south]=3,t.soundData[2][2][CardCost.Wind.west]=4,t.soundData[2][2][CardCost.Wind.north]=2,t.soundData[1][1][CardCost.other.buHua]=4,t.soundData[1][1][CardCost.other.pong]=4,t.soundData[1][1][CardCost.other.kong]=1,t.soundData[1][1][CardCost.other.win]=1,t.soundData[1][1][CardCost.other.kongWin]=1,t.soundData[1][1][CardCost.other.tianHu]=1,t.soundData[1][1][CardCost.other.diHu]=1,t.soundData[1][1][CardCost.other.ziMo]=1,t.soundData[2][1][CardCost.other.buHua]=4,t.soundData[2][1][CardCost.other.pong]=3,t.soundData[2][1][CardCost.other.kong]=1,t.soundData[2][1][CardCost.other.win]=1,t.soundData[2][1][CardCost.other.kongWin]=1,t.soundData[2][1][CardCost.other.tianHu]=1,t.soundData[2][1][CardCost.other.diHu]=1,t.soundData[2][1][CardCost.other.ziMo]=1,t.soundData[1][2][CardCost.other.buHua]=4,t.soundData[1][2][CardCost.other.pong]=3,t.soundData[1][2][CardCost.other.kong]=1,t.soundData[1][2][CardCost.other.win]=1,t.soundData[1][2][CardCost.other.kongWin]=1,t.soundData[1][2][CardCost.other.tianHu]=1,t.soundData[1][2][CardCost.other.diHu]=1,t.soundData[1][2][CardCost.other.ziMo]=1,t.soundData[2][2][CardCost.other.buHua]=4,t.soundData[2][2][CardCost.other.pong]=3,t.soundData[2][2][CardCost.other.kong]=1,t.soundData[2][2][CardCost.other.win]=1,t.soundData[2][2][CardCost.other.kongWin]=1,t.soundData[2][2][CardCost.other.tianHu]=1,t.soundData[2][2][CardCost.other.diHu]=1,t.soundData[2][2][CardCost.other.ziMo]=1
}(SoundCost||(SoundCost={}));var Strings;!function(t){t.dismissRoom="开局前解散房间不会消耗钻石，是否解散房间",t.dismissRoom_timeOut="房间超时,系统将自动解散",t.dismissRoom_leave="因你长时间没有回来，你已自动离开牌桌",t.dismissRoom_daikai="很遗憾，房主解散了当前房间",t.dismissRoom_master="很遗憾，房主解散了当前房间",t.dismissRoom_xieshang="玩家协商解散了当前房间",t.dismissRoom_gameOver="牌局已结束",t.dismissRoom_other="房间已解散或者牌局已结束",t.roomNotExist="您输入的房间号不存在，请重新输入，谢谢！",t.funcNotOpen="亲，功能暂未开放，请耐心等待",t.noRoomCard="您的钻石不足，请充值",t.createRoomFail="创建房间失败",t.logingRoomFail="登录失败",t.joinRoomFail="加入房间失败",t.backRoomFangzhu="返回大厅房间仍会保留，快去邀请大伙来玩吧",t.backRoomJoin="是否退出房间",t.connectGameFail="连接游戏服务器失败",t.connectLoginFail="连接登录服务器失败",t.buyOk="购买成功！",t.heartLost="您的游戏已经断开连接，游戏退到大厅！",t.tuiGuangFailed="绑定失败，请重新绑定",t.tuiGuangFailOne="您输入的邀请码错误，请重新输入",t.tuiGuangFailTwo="出现未知导致绑定失败，请重新绑定",t.tuiGuangFailThree="您已领取过，无法再次绑定",t.tuiGuangSuccess="绑定成功，恭喜你获得钻石*50",t.buyFail="购买失败！",t.getShopListFailed="获取商店信息失败！",t.notopen="该功能暂未开通",t.buyCancel="取消支付",t.reconnect="你上把牌局还未结束，请点击确定自动进入",t.changeAccount="是否注销当前账号",t.exitRoom="你确定要离开房间吗？",t.enterRoom="你已在房间中，不能加入别的房间，是否返回到房间中?",t.offline="哎呀，网络出现问题了，是否尝试重新连接",t.roomNumberNotExist="房间不存在",t.roomHasNotExistInGame="当前牌局已结束，可前往战绩查看详情",t.roomPlayerFull="房间人员已满",t.roomNumberError="房间号错误",t.roomhasJiesan="房间已解散",t.InRoom="你当前已经在房间中",t.networkConnectionsError="当前网络不可用，如果继续，请先设置网络！",t.roomJiesan="由于长时间没有进入房间，房间已解散",t.noWeixin="当前手机不支持微信，请检查是否安装微信",t.WeixinLoginFailed="微信登陆授权失败",t.WeixinCancelLogin="取消登陆",t.outCardError="报听后只能出最后一张",t.copyToClipboardSuccess="复制成功",t.failedGetGameConfig="游戏配置获取失败",t.hasPlayerLeave="有玩家离开，牌局结束，将自动返回大厅",t.tooShortVoice="您的录音长度太短",t.noEmail="暂时没有邮件",t.selectEmail="请选择一封邮件",t.checkVersionFailed="检测更新信息失败，请检查您的网络是否可用",t.receiveSuccess="领取成功",t.getEmailFailed="拉取邮件列表失败",t.tooShortTime="您的操作太频繁",t.exitAppConfirm="是否确认退出游戏?",t.shareFailed="分享失败",t.shareFailedAppNotExist="请先安装应用[%s]",t.shareSuccess="分享成功",t.shareCancel="取消分享",t.invalidOperate="用户非法操作",t.hasInRoomWhenCreateRoom="你已经在{0}房间中,不能创建房间",t.quitReplayerInfo="确认退出当前回放么?",t.replayOver="回放已结束",t.daikaiBeMaxNum="代开房间数已达到上限",t.loginFailed="登陆已失效，请重新登陆",t.onlyCreatOtherPayMode="当前只能创建代开房间",t.mailAttachSuccess="领取成功",t.createRoomParamsError="创建房间参数错误",t.hasInRoomWhenJoinRoom="你已经在房间中,不能加入房间",t.getShareInfoFailed="获取邀请信息失败",t.getShareRewardFailed="领取奖励失败",t.changePlayerNumFailed="当前有用户为老版本，不支持三人麻将",t.changePlayerNumRepeat="当前已是3人房，不需要重复申请",t.goldNotEnough="金币不足",t.fobidLogin="当前账号已限制登陆，详情请联系客服微信号：%s",t.getActivityInfoFailed="获取活动信息失败",t.applyThreePlayer="是否确认要申请3人麻将?",t.taskRewardHasGet="您已领取过奖励",t.redPacketNumNotEnoughError="系统检测到你有刷单嫌疑，如有疑问请加申诉微信号：%s",t.redPacketPlayerNotValidError="系统检测到你有刷单嫌疑，如有疑问请加申诉微信号：%s",t.addTurntableTimes="次数不足，赢得大玩家可以获得抽奖次数,是否前往创建房间?",t.TurntableTimesNoEnough="次数不足，今日抽奖次数花光啦",t.RedPacketOverTime="红包已超时失效",t.activityOver="活动已结束",t.downloadZhuanDanTint="是否立即下载转蛋？",t.downloadFightThreeTint="是否立即下载拼三张？",t.updateZhuanDanTint="是否立即更新转蛋？",t.updateFightThree="是否立即更新拼三张？",t.downloadBijiTint="是否立即下载比鸡？",t.updateBijiTint="是否立即更新比鸡？",t.hotupdateFailed="热更新失败,是否重新下载",t.declare_not_selected="请确认及勾选同意服务条款，即可进入游戏",t.replayDataError="数据出错，暂时不能回放",t.downloadZhuanDanInGameTint="你正在加入到转蛋游戏中，请点击确认开始加载游戏!",t.updateZhuanDanInGameTint="转蛋有新的更新，请点击确认下载最新版本！",t.downloadFightThreeInGameTint="你正在加入到拼三张游戏中，请点击确认开始加载游戏!",t.updateFightThreeInGameTint="拼三张有新的更新，请点击确认下载最新版本！",t.downloadBijiInGameTint="你正在加入到比鸡游戏中，请点击确认开始加载游戏!",t.updateBijiInGameTint="比鸡有新的更新，请点击确认下载最新版本！",t.onlyCreateMajiongGame="当前只能创建麻将房间",t.proxyIdCannotBeNull="邀请ID不能为空",t.purchaseErrorNeedBindProxy="您当前还未绑定代理，请联系客服(官方客服微信号:%s)",t.bind_no_proxy="您绑定的代理游戏ID不存在",t.bind_has_proxy="您已经绑定代理",t.save_pic_success="保存成功",t.save_pic_failed="保存失败",t.gameNotLauncher="%s正在维护中，暂时无法进入",t.club_error_already_joined="您已经加入了俱乐部",t.club_error_already_rejected="请勿重复操作",t.club_error_cant_operate="您没有操作的权限",t.club_error_cant_kick_self="您不能把自己踢出俱乐部",t.club_error_cant_exit="会长不能退出俱乐部",t.club_error_not_joined_club="您尚未加入俱乐部",t.club_error_already_passed="请勿重复操作",t.club_error_not_proxy="需要成为代理，才能创建俱乐部，请联系招商客服：%s 申请成为代理",t.club_error_club_ID_not_exists="该俱乐部不存在",t.club_error_replay_code_not_exists="回放码不存在",t.chatText=["来来来，带快点带快点","你这么打会没朋友的","真是有钱难买左膀子对哦","手气不错，今天又是个发财的日子","不急不慌，后面还有老鳖汤","归归，宝庆银楼真精哦","哎呀！打错牌了，说不定错打错成"],t.chatText_standard=["快点啊，都等得我花都谢了","高手啊，厉害，甘拜下风","这牌有点坑爹啊","这一把又有好戏看咯","高手玩牌，讲究的就是一个范","手气这么好，你咋不上天呢","小宇宙要爆发了，好戏在后头"]}(Strings||(Strings={}));var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.setStorage=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getStorage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,""]})})},t.prototype.getLocation=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.share=function(t,e,a,n,o){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getSystemInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{windowWidth:GameConfig.ScreenW,windowHeight:GameConfig.ScreenH,pixelRatio:1}]})})},t.prototype.shareWithImg=function(t,e,a,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.setClipboardData=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.setKeepScreenOn=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getBackgroundAudioPlayerState=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.playBackgroundAudio=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.pauseBackgroundAudio=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.stopBackgroundAudio=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getSetting=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getLaunchOptionsSync=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.onLaunch=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.onShow=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,a,n){function o(t){e.call(n,t)}function i(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),a.call(n))}"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(n,generateEUI)},this):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var GlobalData;!function(t){function e(e){if(null!=e)for(var a=0;a<e.length;a++){var n=e[a].infoKey,o=e[a].infoValue;t.clientConfigs[n]=o}}function a(e){t.isReconnecting=e}function n(){return t.gameData}t.gameData=new game.GameData,t.userData=new game.UserInfo,t.platformRoomNumber=0,t.isReconnecting=!1,t.firstInGame=!1,t.curGameID=Constants.GAME_ID_SET.nanjing,t.clientConfigs={customer_info:"qhuaimj",weixin_mp_name:"情怀南京麻将",investment_info:"qhuaimj",functionInfos:null,red_bag_customer_info:"qhuaimj",red_bag_appeal_info:"qhuaimj",worldcup:"1",showCreateRoom:"0",showClubRoom:"0"},t.initClientConfigInfo=e,t.setReconnecting=a,t.getCurGameData=n}(GlobalData||(GlobalData={}));var game;!function(t){var e=function(){function t(){this.handCards=[1,1,1,1,1,1,1,1,1,1,1,1,1],this.outCards=[],this.pongKongCards=[],this.huaCards=[],this.jiapaiId=-1,this._isTing=!1,this.huaNum=0,this.jiapaiValue=0}return t.prototype.isTing=function(){return this._isTing},t.prototype.setTing=function(t){this._isTing=t},t.prototype.setJiaPaiValue=function(t){this.jiapaiValue=t},t.prototype.getJiaPaiValue=function(){return this.jiapaiValue},t.prototype.setPongKongCards=function(t){this.pongKongCards=t},t.prototype.getPongKongCards=function(){return this.pongKongCards},t.prototype.addPongKongData=function(t){this.pongKongCards.push(t)},t.prototype.getPongKongNum=function(){return this.pongKongCards.length},t.prototype.getPongKongTotalCardNum=function(){return 3*this.getPongKongNum()},t.prototype.getDrawCardIndex=function(){return GameConst.perPlayerTotalCardNum-this.getPongKongTotalCardNum()},t.prototype.getDiscardNum=function(){return this.outCards.length},t.prototype.getPlayerOutCards=function(){return this.outCards},t.prototype.setPlayerOutCards=function(t){this.outCards=t},t.prototype.addOutCard=function(t){this.outCards.push(t)},t.prototype.removeOutCard=function(t){this.outCards.splice(t,1)},t.prototype.getOutCardNum=function(){return this.outCards.length},t.prototype.setHuaNum=function(t){this.huaNum=t},t.prototype.getHuaNum=function(){return this.huaNum},t.prototype.getPlayerHuaCards=function(){return this.huaCards},t.prototype.setPlayerHuaCards=function(t){this.huaCards=t},t.prototype.removeHandsCard=function(t){this.handCards.splice(t,1)},t.prototype.getHandCardsNum=function(){return this.handCards.length},t.prototype.setPlayerHandCards=function(t){this.handCards=t},t.prototype.getPlayerHandCards=function(){return this.handCards},t.prototype.clear=function(){this.huaCards=[],this.handCards=[],this.outCards=[],this.pongKongCards=[],this.jiapaiValue=0},t}();t.PlayerCardData=e,__reflect(e.prototype,"game.PlayerCardData")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cardData=null,e.chairId=0,e.status=null,e.score=0,e.fanfen=0,e.totalWaibao=0,e.isRoomCreator=!1,e.detailAddress="",e.userFill=0,e.readyStatus=0,e.autoDiscardOfDelay=!1,e}return __extends(e,t),e.prototype.isAutoDiscardOfDelay=function(){return this.autoDiscardOfDelay},e.prototype.setAutoDiscardOfDelay=function(t){this.autoDiscardOfDelay=t},e.prototype.setDetailAddress=function(t){this.detailAddress=t},e.prototype.getDetailAddress=function(){return this.detailAddress},e.prototype.setScore=function(t){this.score=t},e.prototype.getScore=function(){return this.score},e.prototype.setReadyStatus=function(t){this.readyStatus=t},e.prototype.getReadyStatus=function(){return this.readyStatus},e.prototype.setStatus=function(t){this.status=t},e.prototype.getStatus=function(){return this.status},e.prototype.setChairId=function(t){this.chairId=t},e.prototype.getChairId=function(){return this.chairId},e.prototype.isBanker=function(){return this.chairId==GlobalData.gameData.getBankerChairId()},e.prototype.parse=function(t){var e=t.chairId;this.setChairId(e);var a=t.userStatus;this.setStatus(a);var n=t.readyStatus;this.setReadyStatus(n);var o=t.msgUser,i=o.ip;this.setIP(i);var s=o.userId;this.setUserId(s);var r=o.gender;this.setGender(r);var l=o.headImgUrl;this.setHeadIMGUrl(l);var c=o.nickName;this.setUserName(c);var u=t.detailAddress;this.setDetailAddress(u);var h=t.score;this.setScore(h);var d=t.faScore;this.fanfen=d;var m=t.waiBaoScore;this.totalWaibao=m;var p=t.autoHost;this.setAutoDiscardOfDelay(p)},e.prototype.setCardData=function(t){this.cardData=t},e.prototype.getCardData=function(){return this.cardData},e.prototype.clearCardData=function(){null!=this.cardData&&this.cardData.clear(),this.cardData=null},e}(t.BaseUserInfo);t.PlayerInfo=e,__reflect(e.prototype,"game.PlayerInfo")}(game||(game={}));var game;!function(t){var e=function(){function t(t){this.setType(t.type),this.setProvideClientId(t.provideClientId),this.setValue(t.value)}return t.prototype.setType=function(t){this.type=t},t.prototype.getType=function(){return this.type},t.prototype.setProvideClientId=function(t){this.provideClientId=t},t.prototype.getProvideClientId=function(){return this.provideClientId},t.prototype.setValue=function(t){this.value=t},t.prototype.getValue=function(){return this.value},t}();t.PongKongData=e,__reflect(e.prototype,"game.PongKongData")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.dialogMap=new t.HashMap}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.show=function(e,a){void 0===a&&(a=t.EDialog.show_ani_type_null);var n=this.dialogMap.containsKey(e.getDialogUUID());n||(e instanceof t.ConfirmBox?Main.instance.confirmDialogLayer.addChild(e):Main.instance.dialogLayer.addChild(e),this.dialogMap.put(e.getDialogUUID(),e),e.show(a))},e.prototype.close=function(t,e){t.parent&&(t.parent.removeChild(t),this.dialogMap.remove(t.getDialogUUID()),t=null)},e.prototype.showPopBox=function(e,a){void 0===a&&(a=null);var n=this.dialogMap.containsKey(e);if(!n){var o=null;switch(e){case Constants.UI_PANEL_DATA_SET.checkCheat.index:o=new t.CheckCheatBox;break;case Constants.UI_PANEL_DATA_SET.preventCheat.index:o=new t.PreventCheatBox(a);break;case Constants.UI_PANEL_DATA_SET.GameSettle_auto1.index:o=new t.GameSettleNormal(a);break;case Constants.UI_PANEL_DATA_SET.gameOverBox.index:o=new t.GameOverBox;break;case Constants.UI_PANEL_DATA_SET.applyQuit.index:o=new t.ApplyQuitBox(a);break;case Constants.UI_PANEL_DATA_SET.preventCheatStatusBox.index:o=new t.PreventCheatStatusBox;break;case Constants.UI_PANEL_DATA_SET.personInfoOther.index:o=new t.PersonalInfoOtherBox(a);break;case Constants.UI_PANEL_DATA_SET.todayRecords.index:o=new t.TodayRecordsBox;break;case Constants.UI_PANEL_DATA_SET.personInfo.index:o=new t.PersonalInfoBox(a);break;case Constants.UI_PANEL_DATA_SET.changePlayerNumBox.index:o=new t.ChangePlayerNumBox(a);break;case Constants.UI_PANEL_DATA_SET.GameScoreBoard.index:o=new t.GameScoreBoardBox;break;case Constants.UI_PANEL_DATA_SET.gameSetting.index:o=new t.GameSettingBox;break;case Constants.UI_PANEL_DATA_SET.roomInfoBox.index:o=new t.RoomInfoBox;break;case Constants.UI_PANEL_DATA_SET.chatBox.index:o=new t.GameChatBox;break;case Constants.UI_PANEL_DATA_SET.shop.index:break;case Constants.UI_PANEL_DATA_SET.about.index:o=new t.AboutBox;break;case Constants.UI_PANEL_DATA_SET.wechatShare.index:o=new t.ShareBox;break;case Constants.UI_PANEL_DATA_SET.discardWinConfirmBox.index:o=new t.AbandomWinConfirmBox(a);break;case Constants.UI_PANEL_DATA_SET.advert.index:o=new t.AdvertBox(a)}null!=o&&this.show(o)}},e.prototype.popUp2=function(e,a,n){void 0===a&&(a=null),void 0===n&&(n=null);var o={type:2,info:e,confirmFunc:a,closeFun:n},i=new t.ConfirmBox(o);this.show(i)},e.prototype.popUp1=function(e,a){void 0===a&&(a=null);var n={type:1,info:e,confirmFunc:a},o=new t.ConfirmBox(n);this.show(o)},e.prototype.getBox=function(t){return this.dialogMap.get(t)},e.prototype.clearAllDialog=function(){for(var t=this.dialogMap.keySet(),e=0;e<t.length;e++){var a=this.dialogMap.get(t[e]);this.close(a)}Main.instance.dialogLayer.removeChildren(),Main.instance.confirmDialogLayer.removeChildren()},e}();t.DialogManager=e,__reflect(e.prototype,"game.DialogManager")}(game||(game={}));var EButton=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.buttonReleased=function(){t.prototype.buttonReleased.call(this),game.LogUtils.info("点击按钮----"),game.SoundService.getInstance().playAudio("game_button_click_mp3")},e}(eui.Button);__reflect(EButton.prototype,"EButton"),window.EButton=EButton;var ClubConst;!function(t){t.MemberType={MONITOR:0,ADMIN:1,MEMBER:2,MONITOR2:3},t.MemberCheckStatus={UNCHECK:0,PASSED:1,UNPASS:2,THROW:3},t.RightType={EditNotice:1,CreateRoom:2,MemberSetting:3,SetMonitor2:4,SetManager:5,KickMember:6}}(ClubConst||(ClubConst={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,null,!1)||this;return t.skinName="resource/skins/club/createClubUI.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnCreate,this.clickCreate),this.editPhoneNumber.inputType=egret.TextFieldInputType.TEL,this.editPhoneNumber.restrict="0-9",this.gameType1.setText("麻将"),this.gameType1.setSelected(!0),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_CREATE),this.createClubCallback,this)},a.prototype.clickCreate=function(){var e=this.editClubName.text.trim(),a=Utils.getCharLen(e);if(a>12||0>a)return void t.CommonView.showToast("名称长度应该是1-6个文字");var n=this.editPhoneNumber.text.trim(),o=Utils.getCharLen(n);if(11!=o||!Utils.isNumbers(n))return void t.CommonView.showToast("手机号应该是11位的数字");var i=this.editInfo.text.trim();return i.trim().length<=0?void t.CommonView.showToast("请填写你的申请说明信息"):void t.ClubService.getInstance().createClub(e,n,i)},a.prototype.createClubCallback=function(e){var a=e.data;return a.code==t.CmdResultType.SUCCESS?(t.CommonView.showToast("已成功发送申请，请等待审核"),void this.close()):a.errorCode==t.MsgConstant.ERROR_club_UserIdIsNotDaiLi?void t.CommonView.showToast("需要先成为代理才可以创建俱乐部〜"):void 0},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_CREATE),this.createClubCallback,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubCreateDialog=e,__reflect(e.prototype,"game.ClubCreateDialog")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.selected=!1}return t.prototype.parse=function(t){this.gameId=t.gameId,this.clubId=t.clubId,this.clubName=t.name,this.onLineNum=t.onLineNum,this.allNum=t.allNum,this.hasShowRedTip=t.hasShowRedTip,this.noticeContent=t.pubContent,this.hasAutoCreate=t.hasAutoCreate,this.memberType=t.memberType},t}();t.ClubData=e,__reflect(e.prototype,"game.ClubData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.clubData=t,a.skinName="resource/skins/club/clubItemSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.toggle,this.clickItem),this.updateUI()},a.prototype.setData=function(t){this.clubData=t,this.updateUI()},a.prototype.clickItem=function(){t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_ITEM,this.clubData)},a.prototype.updateUI_=function(){null!=this.clubData&&(this.toggle.selected=this.clubData.selected,this.labelClubName.text=this.clubData.clubName,this.labelClubMemberNum.text=this.clubData.onLineNum+"/"+this.clubData.allNum,this.labelGameName.text="麻将",this.imgSelfClub.visible=this.clubData.memberType==ClubConst.MemberType.MONITOR,this.imgRedTip.visible=this.clubData.hasShowRedTip)},a}(t.EComponent);t.ClubItem=e,__reflect(e.prototype,"game.ClubItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a,n){var o=e.call(this,null,!1)||this;return o.canEdit=!1,o.clubId=t,o.notice=a,o.canEdit=n,o.skinName="resource/skins/club/clubNoticeShowSkin.exml",o}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnOK,this.clickOK),this.addTapEvent(this.btnPublish,this.clickPublish),this.editNotice.touchEnabled=this.canEdit,this.editNotice.text=this.notice,this.btnOK.visible=!this.canEdit,this.btnPublish.visible=this.canEdit,t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SENDNOTICE),this.publishNoticeCallback,this)},a.prototype.clickOK=function(){this.close()},a.prototype.clickPublish=function(){var e=this.editNotice.text.trim();t.ClubService.getInstance().publishNotice(this.clubId,e)},a.prototype.publishNoticeCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("发布公告成功"),this.close())},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SENDNOTICE),this.publishNoticeCallback,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ClubNoticeShowDialog=e,__reflect(e.prototype,"game.ClubNoticeShowDialog")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.parse=function(e){this.userId=e.userId,this.roomId=e.roomId,this.type=e.type;var a=e.msgDaiKai,n=new t.ClubRoomData;n.parse(a),this.clubRoomData=n},e}();t.ClubRoomInfoChangeInfo=e,__reflect(e.prototype,"game.ClubRoomInfoChangeInfo")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.SCENE_INDEX.CLUB)||this;return t.selectedClubData=null,t.skinName="resource/skins/club/clubSceneSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.groupClubUI.visible=!1,this.noClubUI.visible=!1,this.addTapEvent(this.btnBack,this.clickBack),this.addTapEvent(this.btnInviteMember,this.clickInviteMember),this.addTapEvent(this.btnCreateClub,this.clickCreateClub),this.addTapEvent(this.btnJoinClub,this.clickJoinClub),this.addTapEvent(this.btnApplyRecord,this.clickApplyRecord),this.addTapEvent(this.btnEditNotice,this.clickEditNotice),this.addTapEvent(this.btnRooms,this.clickRooms),this.addTapEvent(this.btnMembers,this.clickMembers),this.addTapEvent(this.btnApplyJoins,this.clickApplyJoins),this.addTapEvent(this.btnCombatRecords,this.clickCombatRecords),this.addTapEvent(this.autoCreateRoom,this.clickAutoCreate),this.addTapEvent(this.marqueeNotice,this.showNotice),this.addTapEvent(this.btnCreateTable,this.createRoom),this.addTapEvent(this.btnResetSearch,this.resetSearch),this.addTapEvent(this.btnSearch,this.searchMember),this.addTapEvent(this.btnSetting,this.clickSetting),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_LIST),this.getClubListBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_ROOM_AUTOCREATE),this.getSwitchAutoTableBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLICK_CLUB_ITEM,this.clickClubItem,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.CLICK_CLUB_UpdateRedTip,this.updateRedTip,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_NOTICE),this.updateNotice,this),this.marqueeNotice.setTextColor(15921097),this.marqueeNotice.setTextSize(24),this.initScroller(),this.getClubList()},a.prototype.updateUI_=function(){var e=this.getSelectedClubData();if(this.autoCreateRoom.setText("自动续房"),this.groupClubIdAdmin.visible=!1,this.groupClubIdMember.visible=!0,null!=e){var a=e.memberType!=ClubConst.MemberType.MEMBER;this.btnApplyJoins.visible=a,this.btnCombatRecords.visible=a,this.imgApplyRedTip.visible=e.hasShowRedTip,this.updateClubItems();var n=t.ClubService.getInstance().checkRight(e.memberType,e.memberType,ClubConst.RightType.CreateRoom);this.btnCreateTable.visible=n,this.autoCreateRoom.visible=n,this.autoCreateRoom.setSelected(e.hasAutoCreate),this.labelNotice.text=e.noticeContent,this.marqueeNotice.start(e.noticeContent),this.btnEditNotice.visible=n,this.noClubUI.visible=!1,this.groupClubUI.visible=!0;t.ClubService.getInstance().isManager(e.memberType)}else this.btnCreateTable.visible=!1,this.autoCreateRoom.visible=!1,this.noClubUI.visible=!0,this.groupClubUI.visible=!1},a.prototype.updateClubList=function(){this.scrollerClubList.clearContent(),this.scrollerClubList.setScrollerContent(this.clubDataList);this.getSelectedClubData()},a.prototype.initScroller=function(){this.scrollerClubList.setElementViewInfo(72,2),this.scrollerClubList.setElementCreateFunction(this.createElement.bind(this)),this.scrollerClubList.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerClubList.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.registerPushNotice=function(){},a.prototype.createElement=function(e){t.LogUtils.info("createElement===="+e);var a=new t.ClubItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.clickClubItem=function(e){null!=this.selectedClubData&&t.ClubService.getInstance().setPushNotice(this.selectedClubData.clubId,!1),this.setSelectedClubData(e.data),this.updateClubItems(),this.clickRooms(),this.updateUI()},a.prototype.updateClubItems=function(){for(var t=this.clubDataList.length,e=0;t>e;e++)this.clubDataList[e].selected=this.clubDataList[e]==this.selectedClubData;this.scrollerClubList.updateUI()},a.prototype.getClubList=function(){t.ClubService.getInstance().getClubList()},a.prototype.getClubListBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.clubDataList=[];var n=a.data;for(var o in n){var i=n[o],s=new t.ClubData;s.parse(i),s.gameId==Constants.GAME_ID_SET.nanjing&&this.clubDataList.push(s)}this.updateClubList(),this.updateUI(),t.LogUtils.info("this.clubDataList==="+this.clubDataList.length),this.clickRooms()}},a.prototype.clickBack=function(){t.SceneSkip.skipToHallScene()},a.prototype.clickCreateClub=function(){var e=new t.ClubCreateDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickJoinClub=function(){var e=new t.JoinClubDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickInviteMember=function(){},a.prototype.clickApplyRecord=function(){},a.prototype.clickEditNotice=function(){if(null!=this.selectedClubData){var e=new t.ClubNoticeShowDialog(this.selectedClubData.clubId,this.selectedClubData.noticeContent,!0);t.DialogManager.getInstance().show(e)}},a.prototype.clickRooms=function(){this.updateClubMenus(this.btnRooms),this.updateClubMenuViews(this.clubRoomUI),t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_Rooms,this.getSelectedClubData())},a.prototype.clickMembers=function(){this.updateClubMenus(this.btnMembers),this.updateClubMenuViews(this.clubMembersUI),t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_Members,this.getSelectedClubData())},a.prototype.clickApplyJoins=function(){this.updateClubMenus(this.btnApplyJoins),this.updateClubMenuViews(this.clubApplyJoinsUI),t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_ApplyJoins,this.getSelectedClubData())},a.prototype.clickCombatRecords=function(){this.updateClubMenus(this.btnCombatRecords),this.updateClubMenuViews(this.clubCombatRecordsUI),this.clubCombatRecordsUI.setData(this.getSelectedClubData().clubId)},a.prototype.updateClubMenus=function(e){for(var a=[this.btnRooms,this.btnMembers,this.btnApplyJoins,this.btnCombatRecords],n=a.length,o=0;n>o;o++)a[o].selected=a[o]==e;this.groupCreateRoom.visible=this.btnRooms==e,this.groupSearch.visible=!1;var i=this.btnMembers==e;if(i){var s=this.getSelectedClubData();t.ClubService.getInstance().isManager(s.memberType)&&(this.groupSearch.visible=!0)}this.scrollerClubList.updateUI()},a.prototype.updateClubMenuViews=function(t){for(var e=[this.clubRoomUI,this.clubMembersUI,this.clubApplyJoinsUI,this.clubCombatRecordsUI],a=e.length,n=0;a>n;n++)e[n].visible=e[n]==t;this.scrollerClubList.updateUI()},a.prototype.getSelectedClubData=function(){return null==this.selectedClubData&&this.clubDataList.length>0&&this.setSelectedClubData(this.clubDataList[0]),this.selectedClubData},a.prototype.setSelectedClubData=function(t){this.selectedClubData=t,this.labelClubId.text=this.selectedClubData.clubId,this.labelClubId1.text=this.selectedClubData.clubId},a.prototype.clickAutoCreate=function(){var e=this.autoCreateRoom.isSelected();t.ClubService.getInstance().autoCreateTableSwitch(this.selectedClubData.clubId,e)},a.prototype.getSwitchAutoTableBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var n=a.data;this.autoCreateRoom.setSelected(n)}},a.prototype.showNotice=function(){if(null!=this.selectedClubData){var e=new t.ClubNoticeShowDialog(this.selectedClubData.clubId,this.selectedClubData.noticeContent,!1);t.DialogManager.getInstance().show(e)}},a.prototype.createRoom=function(){if(null!=this.selectedClubData){var e=new t.CreateRoomDialog(this.selectedClubData.clubId);t.DialogManager.getInstance().show(e)}},a.prototype.resetSearch=function(){this.editSearch.text="",this.clubMembersUI.filterMember("")},a.prototype.searchMember=function(){var t=this.editSearch.text.trim();this.clubMembersUI.filterMember(t)},a.prototype.updateNotice=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var n=a.data;this.selectedClubData.noticeContent=n.pubContent,this.marqueeNotice.start(this.selectedClubData.noticeContent)}},a.prototype.updateRedTip=function(t){if(null!=t.data){var e=t.data;null!=this.selectedClubData&&(this.selectedClubData.hasShowRedTip=e.isShow,this.scrollerClubList.updateUI(),this.imgApplyRedTip.visible=this.selectedClubData.hasShowRedTip)}},a.prototype.clickSetting=function(){if(null!=this.selectedClubData){var e=new t.ClubSettingDialog(this.selectedClubData.clubId);t.DialogManager.getInstance().show(e)}},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_LIST),this.getClubListBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_ROOM_AUTOCREATE),this.getSwitchAutoTableBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLICK_CLUB_ITEM,this.clickClubItem,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_NOTICE),this.showNotice,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.CLICK_CLUB_UpdateRedTip,this.updateRedTip,this),null!=this.selectedClubData&&t.ClubService.getInstance().setPushNotice(this.selectedClubData.clubId,!1),e.prototype.clean.call(this)},a}(t.SceneBase);t.ClubScene=e,__reflect(e.prototype,"game.ClubScene")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getClubList=function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_LIST,null);t.SocketManager.getInstance().send(e)},e.prototype.joinClub=function(e,a){var n={clubId:e,applyDesc:a},o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_JOIN,n);t.SocketManager.getInstance().send(o)},e.prototype.getClubRoomList=function(e){var a={clubId:e},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_ROOMINFOLIST,a);t.SocketManager.getInstance().send(n)},e.prototype.getClubMemberList=function(e){var a={clubId:e},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_MEMBERLIST,a);t.SocketManager.getInstance().send(n)},e.prototype.getClubApplyJoins=function(e){var a={clubId:e},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_WAITCHECK_MEMBERLIST,a);t.SocketManager.getInstance().send(n)},e.prototype.setPushNotice=function(e,a){var n={clubId:e,hashPush:a},o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_SET_HASPUSH,n);t.SocketManager.getInstance().send(o)},e.prototype.getClubErrorCodeInfo=function(e){return e==t.MsgConstant.ERROR_club_hasPassed_member?"你已加入俱乐部，不需要重复申请!":e==t.MsgConstant.ERROR_club_IsNotFund?"输入的俱乐部ID不正确，请重新输入!":e==t.MsgConstant.ERROR_club_hasUnCheck_member?"你已提交过申请了，不需要重复申请!":"申请失败!"},e.prototype.forceCancelRoom=function(e){var a={roomNumber:e},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_forceCancelRoom,a);t.SocketManager.getInstance().send(n)},e.prototype.checkMemberJoin=function(e,a,n){var o={clubId:e,memberId:a,checkStatus:n},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_MEMBER_CHECK,o);
t.SocketManager.getInstance().send(i)},e.prototype.autoCreateTableSwitch=function(e,a){var n={clubId:e,hasAutoCreate:a},o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_ROOM_AUTOCREATE,n);t.SocketManager.getInstance().send(o)},e.prototype.publishNotice=function(e,a){var n={clubId:e,pubContent:a},o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_SENDNOTICE,n);t.SocketManager.getInstance().send(o)},e.prototype.setMemberType=function(e,a,n){var o={clubId:e,memberId:a,memberType:n},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_SET_MEMBER,o);t.SocketManager.getInstance().send(i)},e.prototype.kickMember=function(e,a){var n={clubId:e,memberId:a},o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_REMOVEMEMBER,n);t.SocketManager.getInstance().send(o)},e.prototype.createClub=function(e,a,n){var o={name:e,monitorMobile:a,applyDesc:n},i=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_CREATE,o);t.SocketManager.getInstance().send(i)},e.prototype.getClubSettingInfo=function(e){var a={clubId:e},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_getSettingInfo,a);t.SocketManager.getInstance().send(n)},e.prototype.clubSetting=function(e){var a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_setting,e);t.SocketManager.getInstance().send(a)},e.prototype.checkRight=function(t,e,a){return t==ClubConst.MemberType.MONITOR?a==ClubConst.RightType.CreateRoom?!0:e==ClubConst.MemberType.MONITOR?!1:!0:t==ClubConst.MemberType.MONITOR2?a==ClubConst.RightType.CreateRoom?!0:e==ClubConst.MemberType.MONITOR||e==ClubConst.MemberType.MONITOR2?!1:a==ClubConst.RightType.SetMonitor2?!1:!0:t==ClubConst.MemberType.ADMIN&&e==ClubConst.MemberType.MEMBER?a==ClubConst.RightType.SetMonitor2?!1:a==ClubConst.RightType.SetManager?!1:!0:!1},e.prototype.isManager=function(t){return t==ClubConst.MemberType.MONITOR?!0:t==ClubConst.MemberType.MONITOR2?!0:t==ClubConst.MemberType.ADMIN?!0:!1},e}();t.ClubService=e,__reflect(e.prototype,"game.ClubService")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.clubId=t,a.skinName="resource/skins/club/clubSettingSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.offlineStartType0.setText("有玩家离线不开局"),this.offlineStartType1.setText(""),this.roomType0.setText("进园子"),this.roomType1.setText("敞开头"),this.radio1.setText(""),this.radio2.setText(""),this.scoreLimit0.setText(""),this.scoreLimit1.setText("无限制"),this.addTapEvent(this.btnClose,this.close),this.editKickTime.inputType=egret.TextFieldInputType.TEL,this.editKickTime.restrict="0-9",this.editAutoHostTime.inputType=egret.TextFieldInputType.TEL,this.editAutoHostTime.restrict="0-9",this.editJYZStartScore.inputType=egret.TextFieldInputType.TEL,this.editJYZStartScore.restrict="0-9",this.editCKTScore.inputType=egret.TextFieldInputType.TEL,this.editCKTScore.restrict="0-9",this.addTapEvent(this.offlineStartType0,this.clickOfflineStartType0),this.addTapEvent(this.offlineStartType1,this.clickOfflineStartType1),this.addTapEvent(this.editKickTime,this.clickOfflineStartType1),this.addTapEvent(this.roomType0,this.clickRoomType0),this.addTapEvent(this.roomType1,this.clickRoomType1),this.addTapEvent(this.scoreLimit0,this.clickScoreLimit0),this.addTapEvent(this.scoreLimit1,this.clickScoreLimit1),this.addTapEvent(this.editCKTScore,this.clickScoreLimit0),this.addTapEvent(this.btnSave,this.saveConfig),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_getSettingInfo),this.getSettingConfigInfoCallback,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_setting),this.saveConfigCallback,this),this.getSettingConfigInfo()},a.prototype.getSettingConfigInfo=function(){t.ClubService.getInstance().getClubSettingInfo(this.clubId)},a.prototype.getSettingConfigInfoCallback=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var n=a.data;this.clubSettingInfo=n,t.LogUtils.info("---------"),this.updateUI()}},a.prototype.updateUI_=function(){var t=this.clubSettingInfo;this.labelKickTip.text="("+Math.floor(t.configDefaultInfo.minKickTime/1e3)+"-"+Math.floor(t.configDefaultInfo.maxKickTime/1e3)+")秒后踢出离线玩家",this.labelAutoHostTip.text="("+Math.floor(t.configDefaultInfo.minAutoHostTime/1e3)+"-"+Math.floor(t.configDefaultInfo.maxAutoHostTime/1e3)+")秒后自动进行托管",this.labelJYZ.text="("+Math.floor(t.configDefaultInfo.minStartScore)+"-"+Math.floor(t.configDefaultInfo.maxStartScore)+")",this.labelCKT.text="("+Math.floor(t.configDefaultInfo.minCtkScore)+"-"+Math.floor(t.configDefaultInfo.maxCtkScore)+")",this.offlineStartType0.setSelected(!1),this.offlineStartType1.setSelected(!1),1==t.offlineStartType?(this.offlineStartType1.setSelected(!0),this.editKickTime.text=Math.floor(t.offlineKickTime/1e3)+""):(this.offlineStartType0.setSelected(!0),this.editKickTime.text=Math.floor(t.offlineKickTime/1e3)+""),this.editAutoHostTime.text=Math.floor(t.autoHostTime/1e3)+"",this.roomType0.setSelected(!1),this.roomType1.setSelected(!1),this.groupJYZ.visible=!1,this.groupCKT.visible=!1,this.scoreLimit0.setSelected(!1),this.scoreLimit1.setSelected(!1),t.roomType==Constants.ROOM_TYPE.jinYuanZi?(this.roomType0.setSelected(!0),this.groupJYZ.visible=!0,this.scoreLimit0.setSelected(!0),this.imgSelectRoomType.x=239,this.editJYZStartScore.text=t.startScore+""):(this.roomType1.setSelected(!0),this.groupCKT.visible=!0,this.scoreLimit1.setSelected(!0),this.imgSelectRoomType.x=529,this.scoreLimit0.setSelected(!1),this.scoreLimit1.setSelected(!1),this.editCKTScore.text=t.oneMaxScore+"",0==t.oneMaxScore?(this.scoreLimit1.setSelected(!0),this.editCKTScore.text=t.configDefaultInfo.defaultCtkScore+""):(this.scoreLimit0.setSelected(!0),this.editCKTScore.text=t.oneMaxScore+""))},a.prototype.clickOfflineStartType0=function(){this.clubSettingInfo.offlineStartType=0,this.updateUI()},a.prototype.clickOfflineStartType1=function(){this.clubSettingInfo.offlineStartType=1,this.updateUI()},a.prototype.clickRoomType0=function(){this.clubSettingInfo.roomType=Constants.ROOM_TYPE.jinYuanZi,this.updateUI()},a.prototype.clickRoomType1=function(){this.clubSettingInfo.roomType=Constants.ROOM_TYPE.changKaiTou,this.updateUI()},a.prototype.clickRoomType2=function(){this.clubSettingInfo.roomType=Constants.ROOM_TYPE.changKaiTou,this.updateUI()},a.prototype.clickScoreLimit0=function(){this.clubSettingInfo.oneMaxScore=this.clubSettingInfo.configDefaultInfo.defaultCtkScore,this.updateUI()},a.prototype.clickScoreLimit1=function(){this.clubSettingInfo.oneMaxScore=0,this.updateUI()},a.prototype.saveConfig=function(){var e=this.clubSettingInfo;if(1==e.offlineStartType){var a=this.editKickTime.text.trim(),n=Math.floor(e.configDefaultInfo.minKickTime/1e3),o=Math.floor(e.configDefaultInfo.maxKickTime/1e3);if(!this.checkInputConfigInfo(a,n,o))return void t.CommonView.showToast(Utils.format("时间应该是{0}-{1}之间",n,o));e.offlineKickTime=1e3*parseInt(a)}var i=this.editAutoHostTime.text.trim(),n=Math.floor(e.configDefaultInfo.minAutoHostTime/1e3),o=Math.floor(e.configDefaultInfo.maxAutoHostTime/1e3);if(!this.checkInputConfigInfo(i,n,o))return void t.CommonView.showToast(Utils.format("时间应该是{0}-{1}之间",n,o));if(e.autoHostTime=1e3*parseInt(i),e.roomType==Constants.ROOM_TYPE.jinYuanZi){var s=this.editJYZStartScore.text.trim(),n=Math.floor(e.configDefaultInfo.minStartScore),o=Math.floor(e.configDefaultInfo.maxStartScore);if(!this.checkInputConfigInfo(s,n,o))return void t.CommonView.showToast(Utils.format("开始分数应该是{0}-{1}之间",n,o));e.startScore=parseInt(s)}else if(e.oneMaxScore>0){var r=this.editCKTScore.text.trim(),n=Math.floor(e.configDefaultInfo.minCtkScore),o=Math.floor(e.configDefaultInfo.maxCtkScore);if(!this.checkInputConfigInfo(r,n,o))return void t.CommonView.showToast(Utils.format("单把上限应该是{0}-{1}之间",n,o));e.oneMaxScore=parseInt(r)}t.ClubService.getInstance().clubSetting(e)},a.prototype.checkInputConfigInfo=function(t,e,a){if(0==t.length)return!1;var n=parseInt(t);return n>=e&&a>=n?!0:!1},a.prototype.saveConfigCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS?(t.CommonView.showToast("俱乐部设置成功"),this.close()):t.CommonView.showToast("俱乐部设置失败")},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EDialog);t.ClubSettingDialog=e,__reflect(e.prototype,"game.ClubSettingDialog")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.offlineStartType=1,this.offlineKickTime=3e4,this.autoHostTime=18e4,this.roomType=Constants.ROOM_TYPE.jinYuanZi,this.startScore=100,this.oneMaxScore=300}return t}();t.ClubSettingInfo=e,__reflect(e.prototype,"game.ClubSettingInfo");var a=function(){function t(){}return t}();t.ClubSettingDefaultInfo=a,__reflect(a.prototype,"game.ClubSettingDefaultInfo")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.clubCreateView.index,!1)||this;return t.skinName="resource/skins/club/joinClubSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnOK,this.clickOK),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_JOIN),this.joinClubCallback,this)},a.prototype.clickOK=function(){var e=this.inputClubId.text.trim();if(6!=e.length||!Utils.isNumbers(e))return void t.CommonView.showToast("俱乐部ID应该是6位数字！");var a=this.inputRemarks.text.trim();return 0==a.length?void t.CommonView.showToast("请填写备注信息，会长更容易通过你的加入申请哦〜"):void t.ClubService.getInstance().joinClub(e,a)},a.prototype.joinClubCallback=function(e){var a=e.data;return a.code==t.CmdResultType.SUCCESS?(t.CommonView.showToast("申请成功，联系会长去审核吧！"),void this.close()):void t.CommonView.showToast(t.ClubService.getInstance().getClubErrorCodeInfo(a.errorCode))},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EDialog);t.JoinClubDialog=e,__reflect(e.prototype,"game.JoinClubDialog")}(game||(game={}));var NoClubUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/club/noClubUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnCreate,this.clickCreate),this.addTapEvent(this.btnJoin,this.clickJoin)},e.prototype.clickCreate=function(){var t=new game.ClubCreateDialog;game.DialogManager.getInstance().show(t)},e.prototype.clickJoin=function(){var t=new game.JoinClubDialog;game.DialogManager.getInstance().show(t)},e}(game.EComponent);__reflect(NoClubUI.prototype,"NoClubUI"),window.NoClubUI=NoClubUI;var game;!function(t){var e=function(){function t(){}return t.prototype.parse=function(t){this.memberId=t.memberId,this.memberName=t.nickName,this.headImgUrl=t.headImgUrl,this.applyInfo=t.memberWx},t}();t.ClubApplyJoinData=e,__reflect(e.prototype,"game.ClubApplyJoinData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var n=e.call(this)||this;return n.clubData=t,n.clubApplyJoinData=a,n.skinName="resource/skins/club/applyJoin/clubApplyJoinItemSkin.exml",n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnAgree,this.clickAgree),this.addTapEvent(this.btnReject,this.clickReject),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.clubApplyJoinData=e,this.updateUI()},a.prototype.updateUI_=function(){if(null!=this.clubApplyJoinData){var e=this;t.ResManager.loadWebImage(this.clubApplyJoinData.headImgUrl,function(t){e.imgHead.texture=t,e.imgHead.addEventListener(eui.UIEvent.COMPLETE,function(){e.imgHead.texture=t},this)},this),this.labelMemberName.text=this.clubApplyJoinData.memberName,this.labelMemberID.text="ID:"+this.clubApplyJoinData.memberId,this.labelApplyInfo.text=this.clubApplyJoinData.applyInfo}},a.prototype.clickAgree=function(){t.ClubService.getInstance().checkMemberJoin(this.clubData.clubId,this.clubApplyJoinData.memberId,ClubConst.MemberCheckStatus.PASSED)},a.prototype.clickReject=function(){t.ClubService.getInstance().checkMemberJoin(this.clubData.clubId,this.clubApplyJoinData.memberId,ClubConst.MemberCheckStatus.UNPASS)},a}(t.EComponent);t.ClubApplyJoinItem=e,__reflect(e.prototype,"game.ClubApplyJoinItem")}(game||(game={}));var ClubApplyJoinsUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/club/applyJoin/clubApplyJoinsUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_WAITCHECK_MEMBERLIST),this.getClubApplyJoinsBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.CLICK_CLUB_ApplyJoins,this.getClubApplyJoins,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_MEMBER_CHECK),this.checkMemberStatus,this),this.initScroller()},e.prototype.updateUI_=function(){this.scrollerTables.clearContent(),this.scrollerTables.setScrollerContent(this.clubMemberDataList)},e.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(108,2),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.ClubApplyJoinItem(this.clubData,t);return e},e.prototype.updateElement=function(t,e){t.setData(this.clubData,e)},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.getClubApplyJoins=function(t){null!=t.data&&(this.clubData=t.data,game.ClubService.getInstance().getClubApplyJoins(t.data.clubId))},e.prototype.getClubApplyJoinsBack=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){this.clubMemberDataList=[];var a=e.data,n=a.clubMembers;for(var o in n){var i=n[o],s=new game.ClubApplyJoinData;s.parse(i),this.clubMemberDataList.push(s)}game.EAppFacade.getInstance().sendNotification(game.GameCmd.CLICK_CLUB_UpdateRedTip,{isShow:this.clubMemberDataList.length>0}),this.updateUI()}},e.prototype.checkMemberStatus=function(t){var e=t.data;e.code==game.CmdResultType.SUCCESS&&game.ClubService.getInstance().getClubApplyJoins(this.clubData.clubId)},e.prototype.clean=function(){game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_WAITCHECK_MEMBERLIST),this.getClubApplyJoinsBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.CLICK_CLUB_ApplyJoins,this.getClubApplyJoins,this),t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ClubApplyJoinsUI.prototype,"ClubApplyJoinsUI"),window.ClubApplyJoinsUI=ClubApplyJoinsUI;var ClubCombatRecordsUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/club/combatRecord/clubCombatsUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.updateUI_=function(){null!=this.clubId&&this.zhanjiUI.getCombatList_Club(this.clubId)},e.prototype.setData=function(t){this.clubId=t,this.updateUI()},e.prototype.clean=function(){t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ClubCombatRecordsUI.prototype,"ClubCombatRecordsUI"),window.ClubCombatRecordsUI=ClubCombatRecordsUI;var game;!function(t){var e=function(){function t(){}return t.prototype.parse=function(t){this.memberId=t.memberId,this.memberType=t.memberType,this.memberName=t.memberName,this.headImgUrl=t.headImgUrl,this.hasOnline=t.hasOnline,this.achieveNum=t.achieveNum,this.todayAchieveNum=t.todayAchieveNum},t}();t.ClubMemberData=e,__reflect(e.prototype,"game.ClubMemberData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var n=e.call(this)||this;return n.clubData=t,n.clubMemberData=a,n.skinName="resource/skins/club/member/clubMemberItemSkin.exml",n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnSetting,this.clickMemberManage),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SET_MEMBER),this.setMemberCallback,this),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.clubMemberData=e,this.updateUI()},a.prototype.updateUI_=function(){if(null!=this.clubMemberData){var e=this;t.ResManager.loadWebImage(this.clubMemberData.headImgUrl,function(t){e.imgHead.texture=t,e.imgHead.addEventListener(eui.UIEvent.COMPLETE,function(){e.imgHead.texture=t},this)},this),this.labelMemberName.text=this.clubMemberData.memberName,this.labelMemberID.text="ID:"+this.clubMemberData.memberId,this.imgMemberType.visible=!0,this.clubMemberData.memberType==ClubConst.MemberType.MONITOR?this.imgMemberType.source="img_club_member_position_1_png":this.clubMemberData.memberType==ClubConst.MemberType.MONITOR2?this.imgMemberType.source="img_club_member_position_3_png":this.clubMemberData.memberType==ClubConst.MemberType.ADMIN?this.imgMemberType.source="img_club_member_position_2_png":this.imgMemberType.visible=!1,this.labelStatus.text=this.clubMemberData.hasOnline?"在线":"离线",this.labelStatus.textColor=this.clubMemberData.hasOnline?3001920:10309128,this.labelTodayNum.text=this.clubMemberData.todayAchieveNum+"局",this.labelTotalNum.text=this.clubMemberData.achieveNum+"局",this.clubData.memberType==ClubConst.MemberType.MEMBER?this.labelTotalNum.visible=!1:this.labelTotalNum.visible=!0;var a=t.ClubService.getInstance().checkRight(this.clubData.memberType,this.clubMemberData.memberType,ClubConst.RightType.MemberSetting);this.btnSetting.visible=a}},a.prototype.clickMemberManage=function(){var e=new t.clubMemberManageDialog(this.clubData,this.clubMemberData);e.needMask=!1;var a=this.btnSetting.localToGlobal(0,0);e.setContentPostion(a),t.DialogManager.getInstance().show(e)},a.prototype.setMemberCallback=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){var n=a.data;this.clubMemberData.memberId==n.memberId&&(this.clubMemberData=n,this.updateUI())}},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SET_MEMBER),this.setMemberCallback,this),e.prototype.clean.call(this)},a}(t.EComponent);t.ClubMemberItem=e,__reflect(e.prototype,"game.ClubMemberItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var n=e.call(this)||this;return n.clubData=t,n.clubMemberData=a,n.skinName="resource/skins/club/member/clubMemberManageUISkin.exml",n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.rect,this.close),this.addTapEvent(this.btnSetMonistor2,this.clickSetMonitor2),this.addTapEvent(this.btnCancelMonistor2,this.clickCancelMonitor2),this.addTapEvent(this.btnSetManager,this.clickSetManager),this.addTapEvent(this.btnCancelManager,this.clickCancelManager),this.addTapEvent(this.btnKickMember,this.clickKickMember),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SET_MEMBER),this.setMemberCallback,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_REMOVEMEMBER),this.kickMemberCallback,this),this.updateUI()},a.prototype.setContentPostion=function(t){this.group.x=t.x-this.group.width-10,this.group.y=t.y-50},a.prototype.updateUI_=function(){var e=t.ClubService.getInstance().checkRight(this.clubData.memberType,this.clubMemberData.memberType,ClubConst.RightType.SetMonitor2);this.btnSetMonistor2.visible=!1,this.btnCancelMonistor2.visible=!1,e?this.clubMemberData.memberType==ClubConst.MemberType.MONITOR2?this.btnCancelMonistor2.visible=!0:this.btnSetMonistor2.visible=!0:(this.btnSetMonistor2.visible=!0,this.btnSetMonistor2.enabled=!1);var a=t.ClubService.getInstance().checkRight(this.clubData.memberType,this.clubMemberData.memberType,ClubConst.RightType.SetManager);this.btnSetManager.visible=!1,this.btnCancelManager.visible=!1,a?this.clubMemberData.memberType==ClubConst.MemberType.ADMIN?this.btnCancelManager.visible=!0:this.btnSetManager.visible=!0:(this.btnSetManager.visible=!0,this.btnSetManager.enabled=!1);var n=t.ClubService.getInstance().checkRight(this.clubData.memberType,this.clubMemberData.memberType,ClubConst.RightType.KickMember);n&&(this.btnKickMember.enabled=n)},a.prototype.clickSetMonitor2=function(){var e=this.clubData.clubId,a=this.clubMemberData.memberId;t.ClubService.getInstance().setMemberType(e,a,ClubConst.MemberType.MONITOR2)},a.prototype.clickCancelMonitor2=function(){var e=this.clubData.clubId,a=this.clubMemberData.memberId;t.ClubService.getInstance().setMemberType(e,a,ClubConst.MemberType.MEMBER)},a.prototype.clickSetManager=function(){var e=this.clubData.clubId,a=this.clubMemberData.memberId;t.ClubService.getInstance().setMemberType(e,a,ClubConst.MemberType.ADMIN)},a.prototype.clickCancelManager=function(){var e=this.clubData.clubId,a=this.clubMemberData.memberId;t.ClubService.getInstance().setMemberType(e,a,ClubConst.MemberType.MEMBER)},a.prototype.setMemberCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.close(),t.CommonView.showToast("操作成功"))},a.prototype.clickKickMember=function(){var e=this.clubData.clubId,a=this.clubMemberData.memberId;t.ClubService.getInstance().kickMember(e,a)},a.prototype.kickMemberCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.close(),t.CommonView.showToast("操作成功"),t.EAppFacade.getInstance().sendNotification(t.GameCmd.CLICK_CLUB_Members,this.clubData))},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_SET_MEMBER),this.setMemberCallback,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_REMOVEMEMBER),this.kickMemberCallback,this),e.prototype.clean.call(this)},a}(t.EDialog);t.clubMemberManageDialog=e,__reflect(e.prototype,"game.clubMemberManageDialog")}(game||(game={}));var ClubMembersUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/club/member/clubMembersUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_MEMBERLIST),this.getClubMemberListBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.CLICK_CLUB_Members,this.getClubMemberList,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_SET_MEMBER),this.setMemberCallback,this),this.initScroller()},e.prototype.updateUI_=function(){this.labelTotalNumTitle.visible=this.clubData.memberType!=ClubConst.MemberType.MEMBER,this.scrollerTables.clearContent(),this.scrollerTables.setScrollerContent(this.clubMemberDataList)},e.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(108,2),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.ClubMemberItem(this.clubData,t);return e},e.prototype.updateElement=function(t,e){t.setData(this.clubData,e)},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.getClubMemberList=function(t){null!=t.data&&(this.clubData=t.data,game.ClubService.getInstance().getClubMemberList(t.data.clubId))},e.prototype.getClubMemberListBack=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){this.clubMemberDataList=[],this.clubMemberDataListAll=[];var a=e.data,n=a.clubMemberList;for(var o in n){var i=n[o],s=new game.ClubMemberData;s.parse(i),this.clubMemberDataList.push(s),this.clubMemberDataListAll.push(s)}this.updateUI()}},e.prototype.setMemberCallback=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){var a=e.data;this.updateMemberData(a)}},e.prototype.updateMemberData=function(t){var e=0;null!=this.clubMemberDataList&&(e=this.clubMemberDataList.length);for(var a=0;e>a;a++)if(this.clubMemberDataList[a].memberId==t.memberId)return this.clubMemberDataList[a]=t,!0;return!1},e.prototype.filterMember=function(t){for(var e=[],a=this.clubMemberDataListAll.length,n=0;a>n;n++){var o=this.clubMemberDataListAll[n];((o.memberId+"").indexOf(t)>=0||o.memberName.indexOf(t)>=0)&&e.push(o)}0==e.length?game.CommonView.showToast("未找到对应的玩家"):(this.clubMemberDataList=e,this.updateUI())},e.prototype.clean=function(){game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_MEMBERLIST),this.getClubMemberListBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.CLICK_CLUB_Members,this.getClubMemberList,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_SET_MEMBER),this.setMemberCallback,this),t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ClubMembersUI.prototype,"ClubMembersUI"),window.ClubMembersUI=ClubMembersUI;var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.numbers="",a.roomNumber=t,a.skinName="resource/skins/club/room/clubCancelRoomConfirmSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnCancel,this.close),this.addTapEvent(this.btnClear,this.clickClear),this.addTapEvent(this.btnDelete,this.clickDelete),this.addTapEvent(this.btnOK,this.clickOK),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CLUB_forceCancelRoom),this.cancelRoomCallback,this),this.initBtnsEvent(),this.updateUI()},a.prototype.initBtnsEvent=function(){for(var t=this.getBtns(),e=t.length,a=0;e>a;a++)this.addTapEvent(t[a],this.clickBtn)},a.prototype.getBtns=function(){return[this.btn0,this.btn1,this.btn2,this.btn3,this.btn4,this.btn5,this.btn6,this.btn7,this.btn8,this.btn9]},a.prototype.getBtnNumber=function(t){for(var e=t.currentTarget,a=this.getBtns(),n=a.length,o=0;n>o;o++)if(e==a[o])return o;return 0},a.prototype.updateUI_=function(){this.labelNumbers.text=this.numbers},a.prototype.clickBtn=function(t){if(!(this.numbers.length>=6)){var e=this.getBtnNumber(t);this.numbers+=e,this.updateUI()}},a.prototype.clickClear=function(){this.numbers="",this.updateUI()},a.prototype.clickDelete=function(){this.numbers.length>0&&(this.numbers=this.numbers.substr(0,this.numbers.length-1)),this.updateUI()},a.prototype.clickOK=function(){this.roomNumber==this.numbers?t.ClubService.getInstance().forceCancelRoom(this.roomNumber):t.CommonView.showToast("输入的房间号不正确！")},a.prototype.cancelRoomCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(t.CommonView.showToast("房间解散成功"),this.close())},a}(t.EDialog);t.ClubCancelRoomConfirmDialog=e,__reflect(e.prototype,"game.ClubCancelRoomConfirmDialog")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.parse=function(e){this.roomJson=e.roomJson,this.gaming=e.gaming,this.curTurnNum=e.curTurnNum,this.curTurnDirection=e.curTurnDirection,this.roomUsers=[];var e=e.roomUsers;for(var a in e){var n=e[a],o=new t.ClubRoomUserData;o.parse(n),this.roomUsers.push(o)}},e}();t.ClubRoomData=e,__reflect(e.prototype,"game.ClubRoomData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var n=e.call(this)||this;return n.clubData=t,n.clubRoomData=a,n.skinName="resource/skins/club/room/clubRoomItemSkin.exml",n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnRoomInfo,this.clickRoomInfo),this.addTapEvent(this.btnCancelRoom,this.clickCancelRoom),this.addTapEvent(this.rectJoinRoom,this.clickJoinRoom),this.updateUI()},a.prototype.setData=function(t,e){this.clubData=t,this.clubRoomData=e,this.updateUI()},a.prototype.clickRoomInfo=function(){var e=this.btnRoomInfo.localToGlobal(this.btnRoomInfo.x,this.btnRoomInfo.y);t.TipsUtils.showTips(1,e.x,e.y,this.getRulesInfo_(),280)},a.prototype.updateUI_=function(){if(null!=this.clubRoomData){var e=this.clubRoomData.roomJson;this.labelRoomType.text=t.ConstantUtils.getRoomTypeName(e.roomType),this.labelRoomInfo.text=this.getRulesInfo(),this.clubRoomData.gaming?(this.img3Person.visible=this.clubRoomData.roomUsers.length<4,this.userItem4.visible=!this.img3Person.visible):(this.img3Person.visible=!1,this.userItem4.visible=!this.img3Person.visible);for(var a=[this.userItem1,this.userItem2,this.userItem3,this.userItem4],n=this.clubRoomData.roomUsers.length,o=0;4>o;o++){var i=null;n>o&&(i=this.clubRoomData.roomUsers[o]),a[o].setData(i)}if(this.labelTurnNum.text=this.getCurTurnNumberInfo(),this.clubData.memberType==ClubConst.MemberType.MONITOR||this.clubData.memberType==ClubConst.MemberType.MONITOR2)this.btnCancelRoom.visible=!0,this.clubRoomData.gaming?(this.btnInvitePlayer.visible=!1,this.labelGaming.visible=!0,this.labelTurnNum.visible=!0,this.labelGaming.y=0,this.labelTurnNum.y=29):(this.btnInvitePlayer.visible=!0,this.btnInvitePlayer.y=2,this.labelGaming.visible=!1,this.labelTurnNum.visible=!1);else if(this.btnCancelRoom.visible=!1,this.clubRoomData.gaming){this.btnInvitePlayer.visible=!1,this.labelGaming.visible=!0,this.labelTurnNum.visible=!0;var s=25;this.labelGaming.y=s+0,this.labelTurnNum.y=s+29}else this.btnInvitePlayer.visible=!0,this.btnInvitePlayer.y=28,this.labelGaming.visible=!1,this.labelTurnNum.visible=!1}},a.prototype.getRulesInfo=function(){var e=this.clubRoomData.roomJson,a="房号:"+e.roomNumber+"    ";return a+=e.turnNumber+t.ConstantUtils.getTurnModeName(e.turnMode)+"    ",a+=t.ConstantUtils.getPayModeName(e.payMode,!0)+"    ",e.autoHost&&(a+="超时托管    "),a},a.prototype.getCurTurnNumberInfo=function(){var t=this.clubRoomData.roomJson;return t.turnMode==Constants.ROOM_TIME_MODE.ba?Utils.format("{0}/{1}把",this.clubRoomData.curTurnNum,t.turnNumber):Utils.format("{0} {1}/{2}圈",GameConst.DIRECT_DESC[this.clubRoomData.curTurnDirection],this.clubRoomData.curTurnNum,t.turnNumber)},a.prototype.getRulesInfo_=function(){var e=this.clubRoomData.roomJson,a=t.ConstantUtils.getRoomTypeName(e.roomType)+"  ";return a+=t.ConstantUtils.getPayModeName(e.payMode,!0)+"  ",a+="对局数："+e.turnNumber+t.ConstantUtils.getTurnModeName(e.turnMode)+"  ",a+=e.roomType==Constants.ROOM_TYPE.jinYuanZi?"携带积分："+e.roomScore+"分  ":e.roomScore>0?"单把上限："+e.roomScore+"分  ":"单把上限：无限制  ",e.huaZa&&(a+="花砸2  "),e.jieZhuangBi&&(a+="接庄比  "),e.faFen&&(a+="东南西北罚分  "),e.autoHost&&(a+="超时托管  "),a},a.prototype.clickCancelRoom=function(){var e=this.clubRoomData.roomJson;if(this.clubRoomData.gaming){var a=new t.ClubCancelRoomConfirmDialog(e.roomNumber);t.DialogManager.getInstance().show(a)}else t.RoomService.getInstance().cancelDaiKaiRoom(e.roomId)},a.prototype.clickJoinRoom=function(){var e=this.clubRoomData.roomJson;t.RoomService.getInstance().joinRoom(e.roomNumber)},a}(t.EComponent);t.ClubRoomItem=e,__reflect(e.prototype,"game.ClubRoomItem")}(game||(game={}));var ClubRoomUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/club/room/clubRoomUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ROOMINFOLIST),this.getClubRoomListBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.CLICK_CLUB_Rooms,this.getClubRoomList,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ROOMINFO_CHANGE),this.roomInfoChange,this),this.initScroller()},e.prototype.updateUI_=function(){this.scrollerTables.clearContent(),this.sortRoomList(),this.scrollerTables.setScrollerContent(this.clubRoomDataList,!0)
},e.prototype.initScroller=function(){this.scrollerTables.setElementViewInfo(153,2),this.scrollerTables.setElementCreateFunction(this.createElement.bind(this)),this.scrollerTables.setElementUpdateDataFun(this.updateElement.bind(this)),this.scrollerTables.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.ClubRoomItem(this.clubData,t);return e},e.prototype.updateElement=function(t,e){t.setData(this.clubData,e)},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.getClubRoomList=function(t){null!=t.data&&(this.clubData=t.data,game.ClubService.getInstance().getClubRoomList(t.data.clubId))},e.prototype.getClubRoomListBack=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){this.clubRoomDataList=[];var a=e.data,n=a.getBoardInfos;for(var o in n){var i=n[o],s=new game.ClubRoomData;s.parse(i),this.clubRoomDataList.push(s)}game.ClubService.getInstance().setPushNotice(this.clubData.clubId,!0),this.updateUI()}},e.prototype.sortRoomList=function(){var t=this.clubRoomDataList;t.sort(function(t,e){var a=t.roomUsers.length,n=e.roomUsers.length;if(a!=n)return n-a;var o=t.roomJson,i=e.roomJson;return o.roomId-i.roomId});var e=t[0];if(null!=e&&(4==e.roomUsers.length||e.gaming)){t.sort(function(t,e){var a=t.roomUsers.length,n=e.roomUsers.length;return n-a});for(var a=-1,n=0;n<t.length;n++){var o=t[n];if(null!=o&&o.roomUsers.length<4&&!o.gaming){a=n;break}}if(-1!=a){var i=t[a];t[a]=e,t[0]=i}}},e.prototype.roomInfoChange=function(t){if(null!=t.data){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){var a=e.data,n=new game.ClubRoomInfoChangeInfo;if(n.parse(a),0==n.type)this.clubRoomDataList.push(n.clubRoomData);else if(1==n.type){var o=this.getClubRoomDataIndex(n.roomId);-1!=o&&(this.clubRoomDataList[o]=n.clubRoomData)}else if(2==n.type){var o=this.getClubRoomDataIndex(n.roomId);-1!=o&&this.clubRoomDataList.splice(o,1)}this.updateUI()}}},e.prototype.getClubRoomDataIndex=function(t){for(var e=this.clubRoomDataList.length,a=0;e>a;a++){var n=this.clubRoomDataList[a].roomJson;if(n.roomId==t)return a}return-1},e.prototype.clickBack=function(){game.SceneSkip.skipToHallScene()},e.prototype.clickCreateClub=function(){},e.prototype.clickJoinClub=function(){var t=new game.JoinClubDialog;game.DialogManager.getInstance().show(t,game.EDialog.show_ani_type_null)},e.prototype.clickInviteMember=function(){},e.prototype.clickApplyRecord=function(){},e.prototype.clickEditNotice=function(){},e.prototype.clean=function(){game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ROOMINFOLIST),this.getClubRoomListBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.CLICK_CLUB_Rooms,this.getClubRoomList,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ROOMINFO_CHANGE),this.roomInfoChange,this),t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ClubRoomUI.prototype,"ClubRoomUI"),window.ClubRoomUI=ClubRoomUI;var game;!function(t){var e=function(){function t(){this.ready=!0}return t.prototype.parse=function(t){this.headImgUrl=t.headImgUrl,this.nickName=t.nickName},t}();t.ClubRoomUserData=e,__reflect(e.prototype,"game.ClubRoomUserData")}(game||(game={}));var ClubRoomUserItem=function(t){function e(e){var a=t.call(this)||this;return a.clubRoomUserData=e,a.skinName="resource/skins/club/room/clubRoomUserItemSkin.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.setData=function(t){this.clubRoomUserData=t,this.updateUI()},e.prototype.updateUI_=function(){var t=this;null!=this.clubRoomUserData?(this.labelNickName.text=this.clubRoomUserData.nickName,game.ResManager.loadWebImage(this.clubRoomUserData.headImgUrl,function(e){t.imgHeadIcon.texture=e,t.imgHeadIcon.addEventListener(eui.UIEvent.COMPLETE,function(){t.imgHeadIcon.texture=e},this)},this)):(this.labelNickName.text="",t.imgHeadIcon.texture=null)},e}(game.EComponent);__reflect(ClubRoomUserItem.prototype,"ClubRoomUserItem"),window.ClubRoomUserItem=ClubRoomUserItem;var game;!function(t){var e=function(){function e(){}return e.showToast=function(e){var a=new t.Toast;Main.instance.toastLayer.addChild(a),a.showText(e)},e}();t.CommonView=e,__reflect(e.prototype,"game.CommonView")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,null,!1)||this;return a.params=t,a.skinName="resource/skins/common/ConfirmBoxSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this);var t=this.params.type;this.params.confirmFunc,this.params.cancelFun;1==t&&(this.Button_cancel.visible=!1,this.Button_Ok.x=(GameConfig.ScreenW-this.Button_Ok.width)/2),this.addTapEvent(this.Button_Ok,this.clickConfirmEvent),this.addTapEvent(this.Button_cancel,this.clickCancelEvent),this.Text_info.text=this.params.info},a.prototype.clickConfirmEvent=function(){var t=this.params.confirmFunc;null!=t&&t.call(),this.close()},a.prototype.clickCancelEvent=function(){var t=this.params.cancelFun;null!=t&&t.call(),this.close()},a.prototype.getDialogUUID=function(){return(new t.md5).hex_md5(this.params.info)},a.prototype.close=function(){e.prototype.close.call(this)},a}(t.EDialog);t.ConfirmBox=e,__reflect(e.prototype,"game.ConfirmBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.itemData=t,a.skinName="resource/skins/common/ShareOverResultItemSkin.exml",a}return __extends(a,e),a.prototype.loadHeadImg=function(){var e=this;t.ResManager.loadWebImage(this.itemData.headImgUrl,function(a){e.Image_head.texture=a,t.EAppFacade.getInstance().sendNotification(t.GameCmd.SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE)},this)},a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.updateUI()},a.prototype.setData=function(t){this.itemData=t,this.updateUI()},a.prototype.updateUI_=function(){this.Text_userName.text=this.itemData.userName,this.itemData.score>=0?(this.Text_score.text="+"+this.itemData.score,this.Text_score.textColor=Utils.RGBA2Color(114,90,63)):(this.Text_score.text=this.itemData.score,this.Text_score.textColor=Utils.RGBA2Color(136,180,243)),this.itemData.waibaoFen>=0?(this.Text_wbScore.text="+"+this.itemData.waibaoFen,this.Text_wbScore.textColor=Utils.RGBA2Color(114,90,63)):(this.Text_wbScore.text=this.itemData.waibaoFen,this.Text_wbScore.textColor=Utils.RGBA2Color(136,180,243)),this.Image_homer.visible=this.itemData.master,this.loadHeadImg()},a}(t.EComponent);t.ShareOverResultItem=e,__reflect(e.prototype,"game.ShareOverResultItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.shareOverBox.index)||this;return a.curCompleteHeadNum=0,a.hasAdd=!1,a.addEventListener(eui.UIEvent.CREATION_COMPLETE,a.onCreationComplete,a),a.data=t,a.skinName="resource/skins/common/ShareOverResultViewSkin.exml",a}return __extends(a,e),a.prototype.onCreationComplete=function(){this.hasAdd=!0,this.showShare()},a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.initScroller(),this.updateUI(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE,this.headDownloadCompeteEvent,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.onResume,this.onResume,this)},a.prototype.onResume=function(){this.close()},a.prototype.headDownloadCompeteEvent=function(){this.curCompleteHeadNum=this.curCompleteHeadNum+1,this.showShare()},a.prototype.showShare=function(){var e=RES.isGroupLoaded("shareResult");e||RES.loadGroup("shareResult"),this.hasAdd&&e&&this.curCompleteHeadNum==this.data.userInfoList.length&&(t.EAppFacade.getInstance().removeCommand(t.GameCmd.SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE,this.headDownloadCompeteEvent,this),egret.setTimeout(this.callShare.bind(this),this,100))},a.prototype.callShare=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,platform.share("没有硝烟的雀坛，留下你不败的神话！","",123,GameConfig.windowWidth,GameConfig.windowHeight)];case 1:return t=e.sent(),console.log(t),[2]}})})},a.prototype.initScroller=function(){this.userList.setElementViewInfo(87,0),this.userList.setElementCreateFunction(this.createElement.bind(this)),this.userList.setElementUpdateDataFun(this.updateElement.bind(this)),this.userList.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(e){var a=new t.ShareOverResultItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.updateUI_=function(){this.userList.clearContent(),this.userList.setScrollerContent(this.data.userInfoList),this.Text_roomNumber.text="房间号 "+this.data.msgRoom.roomNumber,this.data.msgRoom.roomType==Constants.ROOM_TYPE.jinYuanZi?this.Text_roomType.text="进园子":this.data.msgRoom.roomType==Constants.ROOM_TYPE.changKaiTou&&(this.Text_roomType.text="敞开头")},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE,this.headDownloadCompeteEvent,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.onResume,this.onResume,this),e.prototype.clean.call(this)},a}(t.EDialog);t.ShareOverResultView=e,__reflect(e.prototype,"game.ShareOverResultView")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.tbX=160,e.lrY=52,e.skinName="resource/skins/common/TipsViewSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this)},e.prototype.setInfo=function(t,e,a){void 0===e&&(e=120),void 0===a&&(a=28),this.info.maxWidth=e,this.info.text=t},e.prototype.setPopPosition=function(t,e,a){this.x=e,this.y=a,2==t?(this.anchorOffsetX=70,this.anchorOffsetY=8):1==t?(this.anchorOffsetX=-20,this.anchorOffsetY=120):4==t?(this.anchorOffsetX=5,this.anchorOffsetY=54):3==t&&(this.anchorOffsetX=this.width,this.anchorOffsetY=70)},e}(t.EComponent);t.TipsView=e,__reflect(e.prototype,"game.TipsView")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/common/ToastSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.x=GameConfig.ScreenW/2-this.width/2,this.y=-this.height},e.prototype.showText=function(t){var e=this;this.Text_msg.text=t;var a=egret.Tween.get(this);a.to({y:0},300,egret.Ease.getPowOut(3)),a.wait(1500),a.to({y:-this.height},300,egret.Ease.getPowIn(3)),a.call(function(){e.parent.removeChild(e)})},e}(t.EComponent);t.Toast=e,__reflect(e.prototype,"game.Toast")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.SUCCESS=1,t.FAIL=0,t}();t.CmdResultType=e,__reflect(e.prototype,"game.CmdResultType")}(game||(game={}));var game;!function(t){var e=function(){function e(t,e,a){this.tingTint=null,this.status=-1,this.clickedIndex=-1,this.selectIndex=-1,this.moveIndex=-1,this.canMove=!1,this.beginStartX=0,this.beginStartY=0,this.flagValue=0,this.flagSet=[],this._isBuHuaing=!1,this._needClearCardWhenStatusIsOver=!1,this.playerCardNode={},this.tempDataType={DRAW_CARD:1,AUTO_DISCARD_TILE:2,DISCARD_OTHER:3},this.gs=t,this.cardGroup=a,this.touchErea=e,this.init()}return e.prototype.init=function(){this.status=GameConst.GAME_STATUS_TYPE.ready,null==this.tingTint&&(this.tingTint=new t.TingTint,this.tingTint.visible=!1,this.gs.addChild(this.tingTint)),this.initData(),this.setFlowerCardVisible(),this.initTouchEvent()},e.prototype.initData=function(){this.handCardNode=[],this.pongKongNode=[],this.huaCardNode=[],this.outCardNode=[],this.RightCardGroup=new eui.Group,this.cardGroup.addChild(this.RightCardGroup),this.UpCardGroup=new eui.Group,this.cardGroup.addChild(this.UpCardGroup),this.LeftCardGroup=new eui.Group,this.cardGroup.addChild(this.LeftCardGroup),this.DownCardGroup=new eui.Group,this.cardGroup.addChild(this.DownCardGroup),this.HandCardGroupSet=[],this.HuaCardGroupSet=[],this.PongKongCardGroupSet=[],this.OutCardGroupSet=[];for(var t=0;t<GameConst.maxPlayerNum;t++){this.handCardNode[t]=[],this.pongKongNode[t]=[],this.huaCardNode[t]=[],this.outCardNode[t]=[],this.HandCardGroupSet[t]=new eui.Group,this.HuaCardGroupSet[t]=new eui.Group,this.PongKongCardGroupSet[t]=new eui.Group,this.OutCardGroupSet[t]=new eui.Group;var e=null;t==GameConst.ME_DIR?e=this.DownCardGroup:t==GameConst.PLAY_DIR.left?e=this.LeftCardGroup:t==GameConst.PLAY_DIR.right?e=this.RightCardGroup:t==GameConst.PLAY_DIR.up&&(e=this.UpCardGroup),e.addChild(this.OutCardGroupSet[t]),e.addChild(this.PongKongCardGroupSet[t]),e.addChild(this.HuaCardGroupSet[t]),t==GameConst.PLAY_DIR.right?e.addChildAt(this.HandCardGroupSet[t],1):e.addChild(this.HandCardGroupSet[t])}this.flagValue=0,this.flagSet=[],this._isBuHuaing=!1,this._needClearCardWhenStatusIsOver=!1,this.playerCardNode={},this.allScheduler=[]},e.prototype.onEventHandler=function(e){var a=e.data,n=a.cmd,o=a.data;if(n==t.GameCmd.OPERATE_PONG||n==t.GameCmd.OPERATE_PONG_BACK)var i=o.clientId,s=o.pongData;if(n==t.GameCmd.OPERATE_PONG)this.pong(i,s);else if(n==t.GameCmd.OPERATE_PONG_BACK)this.pongBack(i,s);else if(n==t.GameCmd.OPERATE_KONG||n==t.GameCmd.OPERATE_KONG_BACK){var i=o.clientId,r=o.kongData;n==t.GameCmd.OPERATE_KONG?this.kong(i,r):n==t.GameCmd.OPERATE_KONG_BACK&&this.kongBack(i,r)}else if(n==t.GameCmd.DRAW_CARD||n==t.GameCmd.DRAW_CARD_BACK){GlobalData.gameData.clearFirstDrawCardData();var l=o.chairId,c=o.cardValues,i=GlobalData.gameData.changeChairIdToClientId(l);this.status!=GameConst.GAME_STATUS_TYPE.playing?GlobalData.gameData.addTempDataBeforeGameStart({type:this.tempDataType.DRAW_CARD,data:o}):n==t.GameCmd.DRAW_CARD?this.drawCard(i,c):n==t.GameCmd.DRAW_CARD_BACK&&this.drawBackCard(i,c)}else if(n==t.GameCmd.DISCARD||n==t.GameCmd.DISCARD_BACK){var l=o.chairId,u=o.cardValue,i=GlobalData.gameData.changeChairIdToClientId(l);if(this.status!=GameConst.GAME_STATUS_TYPE.playing)GlobalData.gameData.addTempDataBeforeGameStart({type:this.tempDataType.DISCARD_OTHER,data:o});else if(GlobalData.gameData.isPlayBack())if(n==t.GameCmd.DISCARD){var h=this.getHandCardIdxByValue(i,u);this.discard(i,h)}else n==t.GameCmd.DISCARD_BACK&&this.discardBack(i,u);else this.otherDiscard(i,u)}else if(n==t.GameCmd.UPDATE_DISCARD_ARROW){var i=o.clientId;this.playDiscardArrow(i)}else if(n==t.GameCmd.UPDATE_HUA)this.updateHuaCards(GameConst.ME_DIR,o);else if(n==t.GameCmd.AUTO_DISCARD_INFO)if(GlobalData.gameData.clearAutoDiscardInfo(),this.clearAllScheduler(),this.status!=GameConst.GAME_STATUS_TYPE.playing)t.LogUtils.info("~~~~~~~~~~~~~~~~增加 自动打牌数据"),GlobalData.gameData.addTempDataBeforeGameStart({type:this.tempDataType.AUTO_DISCARD_TILE,data:o});else{var d=o.tileId;this.autoDelayDiscard(d)}else n==t.GameCmd.CHANGE_CARD_BACK?this.changeCardBack():n==t.GameCmd.FLOWER_VISIBLE&&this.setFlowerCardVisible()},e.prototype.setStatus=function(t,e){var a=this;void 0===e&&(e=!1),this.status=t,this.status==GameConst.GAME_STATUS_TYPE.ready?this.clearAllCard():this.status==GameConst.GAME_STATUS_TYPE.before_playing?this.clearAllCard():this.status==GameConst.GAME_STATUS_TYPE.playing?(e?this.addSchedulerFunc(function(){a.setTouchEnable(!0)},1e3):this.setTouchEnable(!0),this.showPlayerCard(e),this.excuteTempDataWhenGameBegin()):this.status==GameConst.GAME_STATUS_TYPE.waiting?(this.clearAllCard(),this.gs.getEffectLayer().hideCurDiscardArrow()):(this.status==GameConst.GAME_STATUS_TYPE.over||this.status==GameConst.GAME_STATUS_TYPE.allOver)&&(GlobalData.gameData.clearTempDataBeforeGameStart(),this.clearSelectCard())},e.prototype.changeCardBack=function(){for(var t=0;t<this.handCardNode.length;t++)for(var e=0;e<this.handCardNode[t].length;e++){var a=this.handCardNode[t][e];a.changeCardBack()}for(var t=0;t<this.huaCardNode.length;t++)for(var e=0;e<this.huaCardNode[t].length;e++){var a=this.huaCardNode[t][e];a.changeCardBack()}for(var t=0;t<this.outCardNode.length;t++)for(var e=0;e<this.outCardNode[t].length;e++){var a=this.outCardNode[t][e];a.changeCardBack()}for(var t=0;t<this.pongKongNode.length;t++)for(var e=0;e<this.pongKongNode[t].length;e++){var a=this.pongKongNode[t][e];a.changeCardBack()}},e.prototype.playDiscardArrow=function(t){var e=this.getLastOutCard(t);if(null!=e){var a=e.localToGlobal(e.width/2,e.height/2);this.gs.getEffectLayer().playCurDiscardArrow(a)}},e.prototype.excuteTempDataWhenGameBegin=function(){for(var t=GlobalData.gameData.getTempDataBeforeGameStart(),e=0;e<t.length;e++){var a=t[e],n=a.type,o=a.data;if(n==this.tempDataType.DRAW_CARD){var i=o.chairId,s=o.cardValues,r=GlobalData.gameData.changeChairIdToClientId(i);this.drawCard(r,s)}else if(n==this.tempDataType.AUTO_DISCARD_TILE){this.clearAllScheduler();var l=o.tileId;this.autoDelayDiscard(l,!0)}else if(n==this.tempDataType.DISCARD_OTHER){var i=o.chairId,c=o.cardValue,r=GlobalData.gameData.changeChairIdToClientId(i);this.otherDiscard(r,c)}}GlobalData.gameData.clearTempDataBeforeGameStart();var u=GlobalData.gameData.getFirstDrawCardData();if(null!=u){var i=u.chairId,s=u.cardValues,r=GlobalData.gameData.changeChairIdToClientId(i);this.drawCard(r,s),GlobalData.gameData.clearFirstDrawCardData()}var h=GlobalData.gameData.getAutoDiscardInfo();if(null!=h){this.clearAllScheduler();var l=h.tileId;this.autoDelayDiscard(l,!0),GlobalData.gameData.clearAutoDiscardInfo()}},e.prototype.setTouchEnable=function(t){GlobalData.gameData.isPlayBack()||(this.touchErea.touchEnabled=t)},e.prototype.showPlayerCard=function(e){this.clearAllScheduler();for(var a=0;a<GameConst.maxPlayerNum;a++){var n=GlobalData.gameData.changeIndexToClientId(a);this.initPongKongNode(n),this.initOutCard(n),this.initHuaCard(n,e),this.initHandCard(n)}var o=GlobalData.gameData.getLastDiscarChairId();if(0!=o){var i=GlobalData.gameData.changeChairIdToClientId(o),s=GlobalData.gameData.getLastDiscardValue(),r=this.getLastOutCard(i);t.LogUtils.info("lastDiscardClientId "+i),t.LogUtils.info("lastDiscardCardValue "+s),null!=r&&t.LogUtils.info("cur lastDiscardCardValue "+r.getCardValue()),r&&s==r.getCardValue()&&this.playDiscardArrow(i)}this.gs.getGameUILayer().checkMyTingInfoBtn()},e.prototype.initPongKongNode=function(e){this.clearPongKongCard(e);var a=GlobalData.gameData.getCardData(e);if(null==a)return void t.LogUtils.error("initPongKongNode cardData is null dir "+e);for(var n=a.getPongKongCards(),o=n.length,i=0;o>i;i++)this.createPongKongNode(e,n[i],i)},e.prototype.createPongKongNode=function(e,a,n,o){void 0===o&&(o=0);var i=GameConst.CARD_DATA.PONG_KONG_CARD[e].path,s=new t.PongKongCardNode(Constants.UI_GAME_CSB_PATH+i,a,e,n);o>0?(s.visible=!1,this.addSchedulerFunc(function(){t.EAppFacade.getInstance().sendNotification(t.GameCmd.REPLAYER_ACTION_FINISH),s.visible=!0},o)):t.EAppFacade.getInstance().sendNotification(t.GameCmd.REPLAYER_ACTION_FINISH);var r=-1;e==GameConst.PLAY_DIR.right&&(r=0),-1==r?this.PongKongCardGroupSet[e].addChild(s):this.PongKongCardGroupSet[e].addChildAt(s,0),this.pongKongNode[e].push(s)},e.prototype.initOutCard=function(e){this.clearOutCard(e);var a=GlobalData.gameData.getCardData(e);if(null!=a){var n=a.getPlayerOutCards();t.LogUtils.info(n.toString());for(var o=n.length,i=0;o>i;i++)this.createOutCard(e,n[i],i)}},e.prototype.createOutCard=function(e,a,n){var o=GameConst.CARD_DATA.OUT_CARD[e].path,i=new t.OutCardNode(Constants.UI_GAME_CSB_PATH+o,a,e,n),s=-1;(e==GameConst.PLAY_DIR.up||e==GameConst.PLAY_DIR.right)&&(s=0,n>=20&&(s=20)),-1==s?this.OutCardGroupSet[e].addChild(i):this.OutCardGroupSet[e].addChildAt(i,s),this.outCardNode[e].push(i)},e.prototype.initHuaCard=function(t,e){var a=this,n=GlobalData.gameData.getCardData(t);if(null!=n){var o=n.getPlayerHuaCards(),i=o.length,s=function(){a.clearHuaCard(t);for(var e=0;i>e;e++)a.createHuaCard(t,o[e],e)};t==GameConst.ME_DIR&&i>0&&e?this.addSchedulerFunc(function(){a.gs.getEffectLayer().playBuHua(GameConst.ME_DIR,1),s()},500):s()}},e.prototype.initHandCard=function(t){this.clearHandCard(t);var e=GlobalData.gameData.getCardData(t);if(null!=e){var a,n=e.getPlayerHandCards(),o=n.length,i=[],s=e.getDrawCardIndex();if(o>=s){for(var r=0;s-1>r;r++)i[r]=n[r];a=n[o-1]}else i=n;i.sort(function(t,e){return t-e}),null!=a&&i.push(a);for(var r=0;o>r;r++)this.createHandCard(t,i[r],r);this.checkShowTingInfo()}},e.prototype.pongBack=function(t,e){var a=e.getValue(),n=e.getProvideClientId(),o=this.getPongKongNum(t),i=this.pongKongNode[t][o];if(i.getCardValue()==a){this.pongKongNode[t].splice(o,1),this.PongKongCardGroupSet[t].removeChild(i);var s=this.handCardNode[t],r=this.getHandCardsNum(t),l=s[r],c=this.calcCardInsertIndex(t,l.getCardValue());s.splice(r,1),s.splice(c,0,l);for(var u=0;2>u;u++){var c=this.calcCardInsertIndex(t,a);this.createHandCard(t,a,c)}for(var h=this.getHandCardsNum(t),u=0;h>u;u++){var d=s[u];t==GameConst.PLAY_DIR.right?this.HandCardGroupSet[t].addChildAt(d,0):t==GameConst.PLAY_DIR.left&&this.HandCardGroupSet[t].addChild(d),d.resetPosition(u,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL)}}var m=this.getDiscardNum(n);this.createOutCard(n,a,m)},e.prototype.pong=function(t,e){var a=t==GameConst.ME_DIR||GlobalData.gameData.isPlayBack(),n=e.getValue(),o=this.getPongCardIndex(t,n);if(null!=o)for(var i=this.handCardNode[t],s=0;2>s;s++){var r=i[o];if(null!=r){if(a){var l=this.getUpOffData(t),c=l.moveOffX,u=l.moveOffY,h=egret.Tween.get(r);h.to({x:r.x+c,y:r.y+u},200),h.wait(200),h.call(function(){this.parent.removeChild(this)})}else this.HandCardGroupSet[t].removeChild(r);i.splice(o,1)}}var d=this.getPongKongNum(t);a?this.createPongKongNode(t,e,d,400):this.createPongKongNode(t,e,d);var m=e.getProvideClientId();this.removePongKongProvideCard(t,m),this.resetAllHandCardPosition(t),this.checkShowTingInfo()},e.prototype.updateHuaCards=function(e,a){for(var n=this.huaCardNode[e].length,o=0;n>o;o++)this.HuaCardGroupSet[e].removeChild(this.huaCardNode[e][o]);this.huaCardNode[e]=[];for(var o=0;o<a.length;o++){this.getHuaNum(e);this.createHuaCard(e,a[o],o)}var i=this.huaCardNode[e].length;Utils.sendGameEvent(t.GameCmd.PLAYER_HUA_NUM_CHANGED,{clientId:e,huaNum:i})},e.prototype.getUpOffData=function(t){var e=0,a=0;return GlobalData.gameData.isPlayBack()?t==GameConst.ME_DIR?e=-GameConst.CARD_SIZE.HAND_CARD[t].height_playBack:t==GameConst.PLAY_DIR.up?e=GameConst.CARD_SIZE.HAND_CARD[t].height_playBack:t==GameConst.PLAY_DIR.left?a=GameConst.CARD_SIZE.HAND_CARD[t].width_playBack:t==GameConst.PLAY_DIR.right&&(a=-GameConst.CARD_SIZE.HAND_CARD[t].width_playBack):t==GameConst.ME_DIR?e=-GameConst.CARD_SIZE.HAND_CARD[t].height:t==GameConst.PLAY_DIR.up?e=GameConst.CARD_SIZE.HAND_CARD[t].height:t==GameConst.PLAY_DIR.left?a=GameConst.CARD_SIZE.HAND_CARD[t].width:t==GameConst.PLAY_DIR.right&&(a=-GameConst.CARD_SIZE.HAND_CARD[t].width),{moveOffX:a,moveOffY:e}},e.prototype.checkShowTingInfo=function(){if(!GlobalData.gameData.isPlayBack()&&(this.clearTingFlag(),GlobalData.gameData.hasTingPaiInfo()))for(var t=this.handCardNode[GameConst.ME_DIR],e=GlobalData.gameData.getTingPaiInfo(),a=0;a<e.length;a++)for(var n=e[a].tileId,o=0;o<t.length;o++){var i=t[o].getCardValue();i==n&&t[o].setTingFlagVisible(!0)}},e.prototype.setFlowerCardVisible=function(){for(var t=GlobalData.gameData.getFlowerCardVisible(),e=0;e<this.HuaCardGroupSet.length;e++)this.HuaCardGroupSet[e].visible=t},e.prototype.createHuaCard=function(e,a,n){var o=GameConst.CARD_DATA.HUA_CARD[e].path,i={nodePath:Constants.UI_GAME_CSB_PATH+o,cardValue:a,dir:e,idx:n},s=new t.HuaCardNode(i);this.huaCardNode[e].pu;var r=-1;e==GameConst.PLAY_DIR.right&&(r=0),-1==r?this.HuaCardGroupSet[e].addChild(s):this.HuaCardGroupSet[e].addChildAt(s,r),this.huaCardNode[e].push(s);var l=this.huaCardNode[e].length;Utils.sendGameEvent(t.GameCmd.PLAYER_HUA_NUM_CHANGED,{clientId:e,huaNum:l})},e.prototype.createHandCard=function(e,a,n,o){void 0===o&&(o=-1);var i=this.getDrawCardIndex(e),s=this.getHandCardsNum(e);if(!(s>=i+1)){null==a&&t.LogUtils.error("数据错误");var r=this.getHandCardCsbPath(e),l={nodePath:Constants.UI_GAME_CSB_PATH+r,cardValue:a,dir:e,idx:n,actionType:o},c=new t.HandCardNode(this,l);this.handCardNode[e].push(c);var u=-1;e==GameConst.PLAY_DIR.right&&(u=0),-1==u?this.HandCardGroupSet[e].addChild(c):this.HandCardGroupSet[e].addChildAt(c,u)}},e.prototype.getHandCardCsbPath=function(t){var e=GameConst.CARD_DATA.HAND_CARD[t].path;return t!=GameConst.ME_DIR&&GlobalData.gameData.isPlayBack()&&(e=GameConst.CARD_DATA.OUT_CARD[t].path),e},e.prototype.initTouchEvent=function(){this.clickedIndex=-1;this.touchErea.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchEventBegin,this),this.touchErea.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.touchEventMove,this),this.touchErea.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEventEnd,this),this.touchErea.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchEventEnd,this),this.touchErea.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEventEnd,this)},e.prototype.checkAutoDelay=function(){if(GlobalData.gameData.isAutoDelay(GameConst.ME_DIR)){if(-1!=this.moveIndex){var t=this.getHandCardByIdx(GameConst.ME_DIR,this.moveIndex);null!=t&&(t.resetPosition(this.moveIndex),this.clearSelectCard()),this.moveIndex=-1}return!0}return!1},e.prototype.touchEventBegin=function(t){if(this.isGestureDiscardEnable()&&!this.checkAutoDelay()){var e=this.isMeGestureDiscard();if(e){this.clickedIndex=-1,this.moveIndex=-1,this.canMove=!1;var a=this.getTouchIndex(t.stageX,t.stageY);if(-1==a)return void this.gs.resetClickEvent();this.clickedIndex=a,this.beginStartX=t.stageX,this.beginStartY=t.stageY}else this.clickedIndex=this.getTouchIndex(t.stageX,t.stageY),-1==this.clickedIndex&&this.gs.resetClickEvent()}},e.prototype.touchEventMove=function(e){if(this.status==GameConst.GAME_STATUS_TYPE.playing&&!this.checkAutoDelay()){var a=this.isMeGestureDiscard();if(a&&-1!=this.clickedIndex){var n=e.stageX,o=e.stageY;if(!this.canMove){var i=this.beginStartX-n,s=this.beginStartY-o;if(Math.abs(i)<5&&Math.abs(s)<5)return;this.canMove=!0}this.clearSelectCard();var r=this.getHandCardByIdx(GameConst.ME_DIR,this.clickedIndex);if(null!=r&&r.canSelect()){this.moveIndex=this.clickedIndex;var l=this.HandCardGroupSet[GameConst.ME_DIR].getChildIndex(r),c=this.getHandCardsNum(GameConst.ME_DIR);c>l&&this.HandCardGroupSet[GameConst.ME_DIR].setChildIndex(r,c),r.x=n-GameConst.CARD_SIZE.HAND_CARD[GameConst.ME_DIR].width/2,r.y=o-GameConst.CARD_SIZE.HAND_CARD[GameConst.ME_DIR].height/2-30,t.LogUtils.info("touchEventMove evt y:"+o)}}}},e.prototype.touchEventEnd=function(e){if(!this.isGestureDiscardEnable())return void this.gs.resetClickEvent();if(!this.checkAutoDelay()){var a=this.isMeGestureDiscard();if(a){if(-1==this.clickedIndex)return;var n=e.stageX,o=e.stageY,i=this.getTouchIndex(n,o);if(-1!=this.moveIndex){var s=this.getHandCardByIdx(GameConst.ME_DIR,this.moveIndex);this.HandCardGroupSet[GameConst.ME_DIR].setChildIndex(s,0),t.LogUtils.info("touchEventEnd evt y:"+o),570>o?this.discard(GameConst.ME_DIR,this.clickedIndex):(s.resetPosition(this.moveIndex),this.clearSelectCard())}else if(GlobalData.gameData.getClickCardType()==GameConst.CLICK_CARD_TYPE.click)i==this.clickedIndex&&this.discard(GameConst.ME_DIR,this.clickedIndex);else if(GlobalData.gameData.getClickCardType()==GameConst.CLICK_CARD_TYPE.doubleClick){if(i!=this.clickedIndex)return;var r=this.getHandCardByIdx(GameConst.ME_DIR,this.clickedIndex);if(null==r)return;r.isSelected()?this.discard(GameConst.ME_DIR,this.clickedIndex):this.setSelectCardIndex(this.clickedIndex)}}else{var l=this.getTouchIndex(e.stageX,e.stageY);if(l!=this.clickedIndex)return;this.setSelectCardIndex(this.clickedIndex),this.clickedIndex=-1}}},e.prototype.getTouchIndex=function(e,a){for(var n=-1,o=this.handCardNode[GameConst.ME_DIR].length,i=0;o>i;i++){var s=this.handCardNode[GameConst.ME_DIR][i];if(s.hitTestPoint(e,a)){t.LogUtils.info("选中"+(i+1)+"张"),n=i;break}}return n},e.prototype.setSelectCardIndex=function(t){var e=this.getHandCardByIdx(GameConst.ME_DIR,t);if(this.selectIndex==t)return void this.clearSelectCard();if(this.clearSelectCard(),null!=e&&e.canSelect()){e.setSelect(!0),this.flagSameValueCardForSelectedCard(e.getCardValue()),this.selectIndex=t;var a=GlobalData.gameData.getTingInfo(e.getCardValue());if(null!=a){var n=e.localToGlobal(0,0);this.tingTint.initData(a,n.x),this.tingTint.visible=!0}}},e.prototype.calcCardInsertIndex=function(t,e){for(var a=this.getHandCardsNum(t),n=a+1,o=0;a>o;o++){var i=this.handCardNode[t][o].getCardValue();if(i>=e){n=o;break}}return n},e.prototype.autoDelayDiscard=function(t,e){void 0===e&&(e=!1);var a=this.getHandCardsNum(GameConst.ME_DIR),n=this.getDrawCardIndex(GameConst.ME_DIR)+1;if(n==a){for(var o=-1,i=a-1;i>=0;i--){var s=this.handCardNode[GameConst.ME_DIR][i].getCardValue();if(s==t){o=i;break}}-1!=o&&this.discard(GameConst.ME_DIR,o,!0)}},e.prototype.discardBack=function(e,a){var n=this.getDrawCardIndex(e);this.createHandCard(e,a,n);var o=this.getLastOutCard(e);if(null!=o){o.getCardValue()!=a&&t.LogUtils.error("回退打牌 桌面上的牌值与打的牌值不相等");var i=this.getDiscardNum(e);this.outCardNode[e].splice(i-1,1),this.OutCardGroupSet[e].removeChild(o)}else t.LogUtils.error("回退打牌 桌面上的牌不存在")},e.prototype.discard=function(e,a,n){void 0===n&&(n=!1),t.LogUtils.info("出牌");var o=this.getHandCardByIdx(e,a);if(!this.checkCanDiscardCard(e,a))return o.resetPosition(a),this.clearSelectCard(),void t.CommonView.showToast(Strings.outCardError);var i=o.getCardValue();SoundUtils.playEffectSoundNameBindPlayer(e,i),this.clearSelectCard(),GlobalData.gameData.clearTingPaiInfo(),this.clearTingFlag();var s=this.handCardNode[e],r=this.getDrawCardIndex(e),l=s[r],c=s[a];if(this.HandCardGroupSet[e].removeChild(c),this.gs.getEffectLayer().playDiscardEffect(e,i),s.splice(a,1),r==a);else{var u,h,d;if(null==l)u=a,h=s.length-1;else{if(d=this.calcCardInsertIndex(e,l.getCardValue()),s.splice(r-1,1),s.splice(d,0,l),d>=a?(u=a,h=d-1):(u=d+1,h=a),e==GameConst.PLAY_DIR.right)for(var m=s.length,p=0;m>p;p++)this.HandCardGroupSet[e].setChildIndex(s[p],0);else if(e==GameConst.PLAY_DIR.left)for(var m=s.length,p=0;m>p;p++)this.HandCardGroupSet[e].setChildIndex(s[p],p);d==s.length-1?l.resetPosition(d,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL):l.resetPosition(d,GameConst.HAND_CARD_ACTION_TYPE.INSERT_DRAW_CARD)}if(t.LogUtils.info("startIndex:"+u),t.LogUtils.info("endIndex:"+h),h>=u)for(var p=u;h>=p;p++)d!=p&&s[p].resetPosition(p,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL)}this.addOutCard(e,i),t.EAppFacade.getInstance().sendNotification(t.GameCmd.REPLAYER_ACTION_FINISH),n||t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_DISCARD,{tileId:i}),e==GameConst.ME_DIR&&Utils.sendGameEvent(t.GameCmd.DIR_ARROW_CHANGE,{clientId:GlobalData.gameData.changeIndexToClientId(GameConst.ME_DIR%GameConst.maxPlayerNum)})},e.prototype.otherDiscard=function(t,e){SoundUtils.playEffectSoundNameBindPlayer(t,e);var a=GameConst.perPlayerTotalCardNum-this.getPongKongTotalCardNum(t)-1,n=this.getHandCardByIdx(t,a);if(null!=n){this.HandCardGroupSet[t].removeChild(n);var o=this.handCardNode[t];o.splice(a,1)}this.gs.getEffectLayer().playDiscardEffect(t,e),this.addOutCard(t,e)},e.prototype.drawBackCard=function(e,a){var n=a.length;if(n>1){for(var o=this.huaCardNode[e],i=0;n-1>i;i++){var s=o.length-1,r=o[s];o.splice(s,1),this.HuaCardGroupSet[e].removeChild(r)}var l=o.length;Utils.sendGameEvent(t.GameCmd.PLAYER_HUA_NUM_CHANGED,{clientId:e,huaNum:l})}var c=a[n-1],u=this.getDrawCardIndex(e),h=this.getHandCardByIdx(e,u),d=this.handCardNode[e];if(h.getCardValue()==c)return d.splice(u,1),void this.HandCardGroupSet[e].removeChild(h);d.splice(u,1);var m=this.getHandCardIdxByValue(e,c),p=d[m];d.splice(m,1),this.HandCardGroupSet[e].removeChild(p);var g=this.calcCardInsertIndex(e,h.getCardValue());d.splice(g,0,h);for(var i=(d.length,0);i<d.length;i++){var C=d[i];e==GameConst.PLAY_DIR.right?this.HandCardGroupSet[e].addChildAt(C,0):e==GameConst.PLAY_DIR.left&&this.HandCardGroupSet[e].addChild(C),C.resetPosition(i,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL)
}},e.prototype.drawCard=function(e,a){var n=this,o=a.length,i=0;if(o>1){for(var s=[],r=0;o-1>r;r++)s.push(a[r]);var l=this.drawManyHuaCard(e,s);i+=l}var c=this.getDrawCardIndex(e),u=GameConst.HAND_CARD_ACTION_TYPE.DRAW_CARD_ME;e!=GameConst.ME_DIR&&(u=GameConst.HAND_CARD_ACTION_TYPE.DRAW_CARD_OTHER),this.addSchedulerFunc(function(){n.checkHuaNum(e),n.createHandCard(e,a[o-1],c,u),n._isBuHuaing=!1,n.gs.getGameUILayer().operateCome(),t.EAppFacade.getInstance().sendNotification(t.GameCmd.REPLAYER_ACTION_FINISH),e==GameConst.ME_DIR&&n.checkShowTingInfo()},i)},e.prototype.checkHuaNum=function(e){if(!GlobalData.gameData.isPlayBack()&&e==GameConst.ME_DIR){var a=this.getHuaNum(e),n=GlobalData.gameData.getCardData(e).getHuaNum();if(n&&n!=a){GlobalData.gameData.changeClientIdToChairId(e);t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_getFlowerIds)}}},e.prototype.drawManyHuaCard=function(t,e){var a=this,n=0,o=e.length,i=GlobalData.gameData.isAutoDelay(GameConst.ME_DIR);if(o>=1){this._isBuHuaing=!0;for(var s=1==o,r=0;o>r;r++){i||(n+=600);var l=e[r];this.addSchedulerFunc(function(e){s?a.drawHuaCard(t,e[0]):a.drawHuaCard(t,e[0],1)},n,[l])}}return n},e.prototype.drawHuaCard=function(t,e,a){void 0===a&&(a=-1),-1==a?this.gs.getEffectLayer().playBuHua(t):this.gs.getEffectLayer().playBuHua(t,a);var n=this.getHuaNum(t);this.createHuaCard(t,e,n)},e.prototype.addOutCard=function(e,a){var n=this.getDiscardNum(e);t.SoundService.getInstance().playAudio("cardTodesk_mp3"),this.createOutCard(e,a,n),this.playDiscardArrow(e)},e.prototype.flagSameValueCardForSelectedCard=function(t){this.flagValue=t;for(var e=function(t){var e="";return t==GameConst.ME_DIR?e="cover_me-dachu_png":t==GameConst.PLAY_DIR.left?e="cover_left-dachu_png":t==GameConst.PLAY_DIR.up?e="cover_me-dachu_png":t==GameConst.PLAY_DIR.right&&(e="cover_left-dachu_png"),e},a=0;a<GlobalData.gameData.getPlayerNum();a++){for(var n=GlobalData.gameData.changeIndexToClientId(a),o=this.outCardNode[n],i=0;i<o.length;i++){var s=e(n);if(o[i].getCardValue()==t){var r=new eui.Image(s);r.x=0,r.y=0,o[i].addChild(r),this.flagSet.push(r)}}for(var l=this.pongKongNode[n],i=0;i<l.length;i++){var s=e(n);if(l[i].getCardValue()==t)for(var c=l[i].flagSameValueCard(),u=0;u<c.length;u++)this.flagSet.push(c[u])}}},e.prototype.clearSameValueCardFlag=function(){for(var t=0;t<this.flagSet.length;t++){var e=this.flagSet[t];e.parent.removeChild(e)}this.flagSet=[],this.flagValue=0},e.prototype.clearTingFlag=function(){for(var t=this.handCardNode[GameConst.ME_DIR],e=0;e<t.length;e++)null!=t[e]&&t[e].setTingFlagVisible(!1)},e.prototype.clearSelectCard=function(){if(-1!=this.selectIndex){var t=this.getHandCardByIdx(GameConst.ME_DIR,this.selectIndex);null!=t&&t.setSelect(!1)}this.selectIndex=-1,this.clearSameValueCardFlag(),null!=this.tingTint&&(this.tingTint.visible=!1)},e.prototype.checkCanDiscardCard=function(t,e){var a=!0;if(GlobalData.gameData.isPlayBack())a=!0;else if(GameConfig.gameID==Constants.GAME_ID_SET.nanjing&&t==GameConst.ME_DIR){var n=GlobalData.gameData.getPlayerByClientId(GameConst.ME_DIR).getCardData().isTing();n&&e!=this.getDrawCardIndex(GameConst.ME_DIR)&&(a=!1)}return a},e.prototype.isGestureDiscardEnable=function(){return this.status!=GameConst.GAME_STATUS_TYPE.playing||GlobalData.gameData.isPlayBack()?!1:!0},e.prototype.isMeGestureDiscard=function(){var t=GlobalData.gameData.isMyOutCardTurn(),e=GlobalData.gameData.needOperate(),a=!1;return t&&!e&&(a=this.cardNumberIsMax(GameConst.ME_DIR)),t&&!e&&a},e.prototype.cardNumberIsMax=function(t){var e=!1,a=this.getHandCardsNum(t),n=this.getDrawCardIndex(t)+1;return n==a&&(e=!0),e},e.prototype.resetAllHandCardPosition=function(t){for(var e=this.handCardNode[t].length,a=0;e>a;a++)this.handCardNode[t][a].resetPosition(a,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL)},e.prototype.removePongKongProvideCard=function(t,e){if(t!=e){var a=this.getDiscardNum(e),n=a-1,o=this.outCardNode[e][n];null!=o&&this.flagValue==o.getCardValue()&&(this.clearSameValueCardFlag(),this.flagSameValueCardForSelectedCard(this.flagValue)),null!=o&&this.OutCardGroupSet[e].removeChild(o),this.outCardNode[e].splice(n,1)}},e.prototype.getPongKongNum=function(t){return this.pongKongNode[t].length},e.prototype.getPongCardIndex=function(t,e){if(t!=GameConst.ME_DIR&&!GlobalData.gameData.isPlayBack())return 0;for(var a,n=this.getHandCardsNum(t),o=0;n>o;o++)if(this.handCardNode[t][o].getCardValue()==e){a=o;break}return a},e.prototype.getHandCardByIdx=function(t,e){var a=this.handCardNode[t],n=a.length;return 0>e||e>n?void 0:a[e]},e.prototype.getHandCardIdxByValue=function(t,e){for(var a=0,n=0;n<this.handCardNode[t].length;n++){var o=this.handCardNode[t][n].getCardValue();if(o==e){a=n;break}}return a},e.prototype.getLastOutCard=function(t){var e=this.getDiscardNum(t);return e>0?this.outCardNode[t][e-1]:null},e.prototype.getHandCardsNum=function(t){return this.handCardNode[t].length},e.prototype.getDiscardNum=function(t){return this.outCardNode[t].length},e.prototype.getDrawCardIndex=function(t){return GameConst.perPlayerTotalCardNum-this.getPongKongTotalCardNum(t)-1},e.prototype.getPongKongTotalCardNum=function(t){return 3*this.pongKongNode[t].length},e.prototype.clearPongKongCard=function(t){this.PongKongCardGroupSet[t].removeChildren(),this.pongKongNode[t]=[]},e.prototype.getHuaNum=function(t){return this.huaCardNode[t].length},e.prototype.clearAllCard=function(){this.clearSameValueCardFlag(),this.clearAllHandCard(),this.clearAllPongKongCard(),this.clearAllHuaCard(),this.clearAllOutCard()},e.prototype.clearAllHandCard=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.clearHandCard(t)},e.prototype.clearAllHuaCard=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.clearHuaCard(t)},e.prototype.clearAllPongKongCard=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.clearPongKongCard(t)},e.prototype.clearAllOutCard=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.clearOutCard(t)},e.prototype.clearHuaCard=function(t){this.HuaCardGroupSet[t].removeChildren(),this.huaCardNode[t]=[]},e.prototype.clearHandCard=function(t){this.HandCardGroupSet[t].removeChildren(),this.handCardNode[t]=[]},e.prototype.clearOutCard=function(t){this.OutCardGroupSet[t].removeChildren(),this.outCardNode[t]=[]},e.prototype.addSchedulerFunc=function(t,e,a){var n=this;void 0===a&&(a=null);var o=egret.Tween.get(this.cardGroup);o.wait(e),o.call(function(){n.allScheduler.splice(n.allScheduler.indexOf(t),1),t.call(n,a)}),this.allScheduler.push(t)},e.prototype.clearAllScheduler=function(){for(egret.Tween.removeTweens(this.cardGroup);this.allScheduler.length>0;){var t=this.allScheduler.pop();t.call(this)}this.allScheduler=[]},e.prototype.kongBack=function(t,e){var a=e.getValue(),n=e.getType(),o=e.getProvideClientId(),i=this.findPongKongIndex(t,a),s=this.pongKongNode[t][i],r=this.handCardNode[t];if(n==GameConst.GAIN_TYPE.ConcealedKong){this.pongKongNode[t].splice(i,1),this.PongKongCardGroupSet[t].removeChild(s);for(var l=0;4>l;l++){var c=this.calcCardInsertIndex(t,a);this.createHandCard(t,a,c)}}else if(n==GameConst.GAIN_TYPE.PongKong){var e=s.getData();e.setType(GameConst.GAIN_TYPE.PONG),s.setData(e);var c=this.calcCardInsertIndex(t,a);this.createHandCard(t,a,c)}else if(n==GameConst.GAIN_TYPE.Exposed){this.pongKongNode[t].splice(i,1),this.PongKongCardGroupSet[t].removeChild(s);for(var l=0;3>l;l++){var c=this.calcCardInsertIndex(t,a);this.createHandCard(t,a,c)}var u=this.getDiscardNum(o)+1;this.createOutCard(o,a,u)}for(var h=this.getHandCardsNum(t),l=0;h>l;l++){var d=r[l];t==GameConst.PLAY_DIR.right?this.HandCardGroupSet[t].addChildAt(d,0):t==GameConst.PLAY_DIR.left&&this.HandCardGroupSet[t].addChild(d),d.resetPosition(l,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL)}},e.prototype.findPongKongIndex=function(t,e){for(var a=0,n=0;n<this.pongKongNode[t].length;n++){var o=this.pongKongNode[t][n];if(o.getCardValue()==e){a=n;break}}return a},e.prototype.kong=function(e,a){for(var n,o,i=this,s=e==GameConst.ME_DIR||GlobalData.gameData.isPlayBack(),r=a.getValue(),l=a.getProvideClientId(),c=a.getType(),u=!1,h=this.pongKongNode[e],d=this.getPongKongNum(e),m=0;d>m;m++){var p=h[m].getData().getValue(),c=h[m].getData().getType();if(c==GameConst.GAIN_TYPE.PONG&&p==r){u=!0,n=m,o=h[m].getData().getProvideClientId();break}}var g=GameConst.perPlayerTotalCardNum-this.getPongKongTotalCardNum(e),C=s;g!=this.getHandCardsNum(e)&&(C=!1);for(var _=this.getKongCardIndex(e,r,l,u),m=0;m<_.length;m++)if(m==g){C=!1;break}for(var f=_.length,D=this.handCardNode[e],I=0,m=0;f>m;m++){var E=_[m]-I,y=D[E];if(s){var T=this.getUpOffData(e),v=T.moveOffX,S=T.moveOffY,b=egret.Tween.get(y);b.to({x:y.x+v,y:y.y+S},200),b.wait(200),b.call(function(){this.parent.removeChild(this)})}else this.HandCardGroupSet[e].removeChild(y);D.splice(E,1),I+=1}var A=-1;if(C){var M=D.length-1,G=D[M];A=this.calcCardInsertIndex(e,G.getCardValue()),D.splice(M,1),D.splice(A,0,G);for(var R=D.length,m=0;R>m;m++)e==GameConst.PLAY_DIR.right?this.HandCardGroupSet[e].setChildIndex(D[m],0):e==GameConst.PLAY_DIR.left&&this.HandCardGroupSet[e].setChildIndex(D[m],m)}var N=400;if(e!=GameConst.ME_DIR&&(N=200),u?this.addSchedulerFunc(function(){a.setProvideClientId(o),i.pongKongNode[e][n].setData(a),t.EAppFacade.getInstance().sendNotification(t.GameCmd.REPLAYER_ACTION_FINISH)},N):this.createPongKongNode(e,a,this.getPongKongNum(e),N),c==GameConst.GAIN_TYPE.Exposed){var l=a.getProvideClientId();this.removePongKongProvideCard(e,l)}this.addSchedulerFunc(function(){for(var t=D.length,e=0;t>e;e++)null!=D[e]&&(e!=A?D[e].resetPosition(e,GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL):D[e].resetPosition(e,GameConst.HAND_CARD_ACTION_TYPE.INSERT_DRAW_CARD))},200)},e.prototype.getKongCardIndex=function(t,e,a,n){var o=[];if(t==GameConst.ME_DIR||GlobalData.gameData.isPlayBack())for(var i=this.getHandCardsNum(t),s=0;i>s&&!(this.handCardNode[t][s].getCardValue()==e&&(o.push(s),o.length>=4));s++);else{var r=this.getPongKongTotalCardNum(t),i=GameConst.perPlayerTotalCardNum-r;n||(i-=3);for(var l=this.getHandCardsNum(t),c=l-i,s=0;c>s;s++)o.push(s)}return o},e.prototype.isBuhuaing=function(){return this._isBuHuaing},e.prototype.release=function(){this.clearAllCard(),this.clearAllScheduler(),this.allScheduler=null,this.tingTint=null},e}();t.GameCardLayer=e,__reflect(e.prototype,"game.GameCardLayer")}(game||(game={}));var GameCenterNode=function(t){function e(){var e=t.call(this)||this;return e.time=0,e.skinName="resource/skins/game/gameCenterNodeSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.initData(),this.initCenterNode()},e.prototype.setGameScene=function(t){this.gs=t},e.prototype.initData=function(){this.time=0},e.prototype.initCenterNode=function(){this.lightNode=[this.center_light_1,this.center_light_2,this.center_light_3,this.center_light_4],this.darkFengNode=[this.center_dark_dir_1,this.center_dark_dir_2,this.center_dark_dir_3,this.center_dark_dir_4],this.fengNode=[this.center_dir_1,this.center_dir_2,this.center_dir_3,this.center_dir_4],this.lineNode=[this.center_line_1,this.center_line_2,this.center_line_3,this.center_line_4];for(var t=0;t<GameConst.maxPlayerNum;t++)this.lightNode[t].visible=!1,this.lightNode[t].alpha=.5,this.darkFengNode[t].visible=!0,this.fengNode[t].visible=!1;this.center_dir_effect.visible=!1},e.prototype.onEventHandler=function(t){var e=t.data,a=e.cmd,n=e.data;if(a==game.GameCmd.LEFT_CARD_NUM_CHANGED){var o=n.leftCardNum,i=n.leftFlowerNum;this.updateLeftCardNum(o),this.updateLeftFlowerNum(i)}else if(a==game.GameCmd.AUTO_DISCARD_TIME){GlobalData.gameData.clearAutoDelayTimeNum();var s=Math.floor(n.leftTime/1e3);this.resetClock(s,!0)}else if(a==game.GameCmd.DIR_ARROW_CHANGE){var r=n.clientId;this.updateDirArrow(r)}else if(a==game.GameCmd.AUTO_DISCARD_TIME){GlobalData.gameData.clearAutoDelayTimeNum();var s=Math.floor(n.leftTime/1e3);this.resetClock(s,!0)}},e.prototype.setStatus=function(t){this.status=t,this.updateCenterNode(),this.updateAutoTimer()},e.prototype.updateCenterNode=function(){if(this.status==GameConst.GAME_STATUS_TYPE.ready||this.status==GameConst.GAME_STATUS_TYPE.before_playing||this.status==GameConst.GAME_STATUS_TYPE.waiting?this.centerClock.visible=!1:this.centerClock.visible=!0,this.updateTurnNumber(),this.updateDir(),this.status==GameConst.GAME_STATUS_TYPE.ready)this.Node_centerText.visible=!1;else if(this.status==GameConst.GAME_STATUS_TYPE.playing){this.Node_centerText.visible=!0,this.Node_LeftNum.visible=!0,this.updateLeftCardNum(),this.updateLeftFlowerNum();var t=GlobalData.gameData.getDiscardChairId(),e=GlobalData.gameData.changeChairIdToClientId(t);this.updateDirArrow(e)}else if(this.status==GameConst.GAME_STATUS_TYPE.waiting){this.center_dir_effect.visible=!1;for(var a=0;a<GameConst.maxPlayerNum;a++)this.lineNode[a].visible=!0,this.darkFengNode[a].visible=!0,this.lightNode[a].visible=!1,this.fengNode[a].visible=!1;this.Node_LeftNum.visible=!1}else(this.status==GameConst.GAME_STATUS_TYPE.over||this.status==GameConst.GAME_STATUS_TYPE.allOver)&&this.stopTimer()},e.prototype.updateDirArrow=function(t){for(var e=0;e<GameConst.maxPlayerNum;e++)this.lightNode[e].visible=t==e,this.darkFengNode[e].visible=t!=e,this.fengNode[e].visible=t==e,this.lineNode[e].visible=e!=t;this.center_dir_effect.visible=!0,this.gs.getEffectLayer().playDirArrow(t,this.center_dir_effect),this.resetClock()},e.prototype.updateLeftFlowerNum=function(t){void 0===t&&(t=-1);var e=t;-1==e&&(e=GlobalData.gameData.getLeftFlowerNum()),this.Text_leftFlowerNum.text=""+e},e.prototype.updateLeftCardNum=function(t){void 0===t&&(t=-1);var e=t;-1==e&&(e=GlobalData.gameData.getLeftCardNum()),this.Text_leftCardNum.text=""+e},e.prototype.updateTurnNumber=function(){var t,e=GlobalData.gameData.getCurTurnNumber(),a=GlobalData.gameData.getRoomInfo().getTurnNumber();if(GlobalData.gameData.getRoomInfo().getTurnMode()==Constants.ROOM_TIME_MODE.quan){var n=GlobalData.gameData.getCurTurnDirection();t=GameConst.DIRECT_DESC[n]+e+"/"+a}else t=e+" / "+a;this.Text_turnNum.text=t,this.Text_turnMode.text=GlobalData.gameData.getRoomInfo().getTurnModeDesc()+"数"},e.prototype.updateDir=function(){for(var t=GlobalData.gameData.getEastChairId(),e=GlobalData.gameData.changeChairIdToClientId(t),a=0;a<GameConst.maxPlayerNum;a++){var n=(a-e+GameConst.maxPlayerNum)%GameConst.maxPlayerNum+1,o="feng"+n+"_png",i="nowFeng"+n+"_png";this.fengNode[a].source=i,this.darkFengNode[a].source=o,this.darkFengNode[a].visible=!0}},e.prototype.updateAutoTimer=function(){var t=GlobalData.gameData.getAutoDelayTimeNum();t>0&&(GlobalData.gameData.clearAutoDelayTimeNum(),this.resetClock(t,!0))},e.prototype.resetClock=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1),e&&(this.centerClock.visible=!0),Utils.sendGameEvent(game.GameCmd.UPDATE_AUTODISCARD_Text_Visible,{visible:e}),this.time=GameConst.operateTime,-1!=t&&(this.time=t),this.centerClock.text=""+this.time,this.startTimer()},e.prototype.startTimer=function(){this.stopTimer(),this.tickScheduler=game.TimerItemManager.getInstance().startTimer(game.TimerItem.TimerType.perSec,1e3*this.time,this.timerEventHandler,this)},e.prototype.stopTimer=function(){null!=this.tickScheduler&&(game.TimerItemManager.getInstance().stopTimer(this.tickScheduler),this.tickScheduler=null)},e.prototype.timerEventHandler=function(t){GlobalData.gameData.isPlayBack()&&this.gs.getReplayer()&&this.gs.getReplayer().isPause()||(this.time=Math.max(this.time-1,0),3==this.time&&GlobalData.gameData.getDiscardChairId()==GlobalData.gameData.getMyChairId()&&game.SoundService.getInstance().playAudio("countdown_mp3",3),this.centerClock.text=""+this.time,0==this.time&&this.stopTimer())},e.prototype.release=function(){this.stopTimer()},e}(game.EComponent);__reflect(GameCenterNode.prototype,"GameCenterNode"),window.GameCenterNode=GameCenterNode;var game;!function(t){var e=function(t){function e(e,a){var n=t.call(this)||this;return n.dir=e,n.info=a,n.skinName="resource/skins/game/gameChatTextSkin.exml",n}return __extends(e,t),e.prototype.onCreateViewComplete=function(){var e=this;t.prototype.onCreateViewComplete.call(this),this.Text_info.text=this.info;var a=this.Text_info.width;this.Image_bg.width=a;var n=GameConst.ACTION_POSITION.CHAT_MSG.TEXT[this.dir].x-this.width/2,o=GameConst.ACTION_POSITION.CHAT_MSG.TEXT[this.dir].y-this.height/2;this.x=n,this.y=o;var i=egret.Tween.get(this);i.wait(2e3),i.call(function(){e.parent.removeChild(e)})},e}(t.EComponent);t.GameChatText=e,__reflect(e.prototype,"game.GameChatText")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getCmdFromNet=function(t){return t+""},t.onResume="onResume",t.onPause="onPause",t.GAME_STATUS_CHANGED="GAME_STATUS_CHANGED",t.DIR_ARROW_CHANGE="DIR_ARROW_CHANGE",t.GOLD_NUMBER_CHANGE="GOLD_NUMBER_CHANGE",t.DIAMOND_NUMBER_CHANGE="DIAMOND_NUMBER_CHANGE",t.REPLAYER_ACTION_FINISH="REPLAYER_ACTION_FINISH",t.PLAYER_HUA_NUM_CHANGED="PLAYER_HUA_NUM_CHANGED",t.DRAW_CARD="DRAW_CARD",t.DRAW_CARD_BACK="DRAW_CARD_BACK",t.LEFT_CARD_NUM_CHANGED="LEFT_CARD_NUM_CHANGED",t.OPERATE_PONG="OPERATE_PONG",t.OPERATE_PONG_BACK="OPERATE_PONG_BACK",t.OPERATE_KONG="OPERATE_KONG",t.OPERATE_KONG_BACK="OPERATE_KONG_BACK",t.DISCARD="DISCARD",t.DISCARD_BACK="DISCARD_BACK",t.UPDATE_DISCARD_ARROW="UPDATE_DISCARD_ARROW",t.UPDATE_HUA="UPDATE_HUA",t.AUTO_DISCARD_INFO="AUTO_DISCARD_INFO",t.CHANGE_CARD_BACK="CHANGE_CARD_BACK",t.FLOWER_VISIBLE="FLOWER_VISIBLE",t.PLAYER_STATUS_CHANGED="PLAYER_STATUS_CHANGED",t.PLAYER_SCORE_FAFEN="PLAYER_SCORE_FAFEN",t.PLAYER_SCORE_FAFEN_BACK="PLAYER_SCORE_FAFEN_BACK",t.OPERATE="OPERATE",t.OPERATE_BACK="OPERATE_BACK",t.OPERATE_READY="OPERATE_READY",t.OPERATE_READY_BACK="OPERATE_READY_BACK",t.GET_MY_TING_INFO="GET_MY_TING_INFO",t.OTHER_PLAYER_IN="OTHER_PLAYER_IN",t.PLAYER_LEAVE="PLAYER_LEAVE",t.OTHER_PLAYER_LEAVE="OTHER_PLAYER_LEAVE",t.PLAYER_SCORE_NUM_CHANGED="PLAYER_SCORE_NUM_CHANGED",t.OPERATE_PASS="OPERATE_PASS",t.BATTERY_CHANGED="BATTERY_CHANGED",t.APP_NET_SINGAL_CHANGED="APP_NET_SINGAL_CHANGED",t.WIN_OVER="WIN_OVER",t.PLAYER_BEGIN_JIA_PAI="PLAYER_BEGIN_JIA_PAI",t.PLAYER_CANCEL_JIA_PAI="PLAYER_CANCEL_JIA_PAI",t.CHAT_MSG="CHAT_MSG",t.START_PLAY_VOICE="START_PLAY_VOICE",t.VOICE_OVER="VOICE_OVER",t.POINT_EMOTION="POINT_EMOTION",t.START_AUTO_OF_DEALY="START_AUTO_OF_DEALY",t.CANCEL_AUTO_OF_DEALY="CANCEL_AUTO_OF_DEALY",t.AUTO_DISCARD_TIME="AUTO_DISCARD_TIME",t.NOTICE_KICK_LEFT_TIME="NOTICE_KICK_LEFT_TIME",t.CANCEL_KICK_LEFT_TIME="CANCEL_KICK_LEFT_TIME",t.PREVENT_CHEAT_INFO="PREVENT_CHEAT_INFO",t.CLOSE_APPLY_QUIT_PANEL="CLOSE_APPLY_QUIT_PANEL",t.CLOSE_CHEAT_INFO_BOX="CLOSE_CHEAT_INFO_BOX",t.CHECK_CHEAT_STATUS="CHECK_CHEAT_STATUS",t.CLOSE_GAME_SETTLE_PANEL="CLOSE_GAME_SETTLE_PANEL",t.GameSettleInfo_1="GameSettleInfo_1",t.GameSettleInfo_over="GameSettleInfo_over",t.APPLY_QUIT_INFO="APPLY_QUIT_INFO",t.APPLY_QUIT_REJECT="APPLY_QUIT_REJECT",t.DISSOLVE_ROOM="DISSOLVE_ROOM",t.CLOSE_CHEAT_STATUS_BOX="CLOSE_CHEAT_STATUS_BOX",t.PLAY_SINGLE_MESSAGE="PLAY_SINGLE_MESSAGE",t.PLAY_TOTAL_MESSAGE="PLAY_TOTAL_MESSAGE",t.CHANGE_PLAYER_NUM_REJECT="CHANGE_PLAYER_NUM_REJECT",t.CHANGE_PLAYER_NUM_INFO="CHANGE_PLAYER_NUM_INFO",t.CHANGE_PLAYER_NUM_CANCEL="CHANGE_PLAYER_NUM_CANCEL",t.CLOSE_CHANGE_PLAYERNUM_PANEL="CLOSE_CHANGE_PLAYERNUM_PANEL",t.UPDATE_GAEMSCORE_BOARD="UPDATE_GAEMSCORE_BOARD",t.CHANGE_GAME_BG="CHANGE_GAME_BG",t.CHANGE_GAME_BG_FRAME="CHANGE_GAME_BG_FRAME",t.CLOSE_CHAT_BOX_PANEL="CLOSE_CHAT_BOX_PANEL",t.UPDATE_PLAYER_POSITION="UPDATE_PLAYER_POSITION",t.SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE="SHARE_VIEW_HEAD_DOWNLOAD_COMPLETE",t.UPDATE_AUTODISCARD_Text_Visible="UPDATE_AUTODISCARD_Text_Visible",t.CLICK_CLUB_ITEM="clickClubItem",t.CLICK_CLUB_Rooms="clickClubRooms",t.CLICK_CLUB_Members="clickClubMembers",t.CLICK_CLUB_ApplyJoins="clickApplyJoins",t.CLICK_CLUB_UpdateRedTip="club_UpdateRedTip",t.SOCKET_STATUS_CHANGE="socketStatusChange",t.USER_LOGIN_SUCCESS="user_login_success",t}();t.GameCmd=e,__reflect(e.prototype,"game.GameCmd")}(game||(game={}));var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,a){function n(n){e.call(a,n,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?n(o):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var game;!function(t){var e=function(){function e(){this.isGameOverTimeOut=!1}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.gameReconect=function(e){e.code==t.MsgResultStatus.SUCCESS&&(GlobalData.gameData.parse(e.data),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED))},e.prototype.startGame=function(e){e.code==t.MsgResultStatus.SUCCESS&&this.realParseStartGame(e.data)},e.prototype.realParseStartGame=function(e){GlobalData.gameData.setNeedPlayStartStatus(!0),GlobalData.gameData.parse(e),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED)},e.prototype.drawCard=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.chairId;t.LogUtils.info("parseDrawCard chairId "+n),GlobalData.gameData.changeDirArrow(n),GlobalData.gameData.setDiscardChairId(n);var o=a.flowerNum;t.LogUtils.info("HuaNum "+o);var i=GlobalData.gameData.changeChairIdToClientId(n),s=GlobalData.gameData.getCardData(i);null!=o&&null!=s&&s.setHuaNum(o);var r={chairId:n,cardValues:a.tileIds};GlobalData.gameData.isFirstDrawCard()&&GlobalData.gameData.setFirstDrawCardData(r),Utils.sendGameEvent(t.GameCmd.DRAW_CARD,r);var l=a.stackTileNum;GlobalData.gameData.setLeftCardNum(l);var c=a.stackFlowerNum;GlobalData.gameData.setLeftFlowerNum(c),Utils.sendGameEvent(t.GameCmd.LEFT_CARD_NUM_CHANGED,{leftCardNum:l,leftFlowerNum:c});var u=a.tingInfos;GlobalData.gameData.setTingPaiInfo(u)}},e.prototype.otherDiscard=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n={cardValue:a.tileId,chairId:a.chairId};Utils.sendGameEvent(t.GameCmd.DISCARD,n)}},e.prototype.playerStatusChanged=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.userId,o=a.chairId,i=a.userStatus,s=a.readyStatus,r=GlobalData.gameData.changeChairIdToClientId(o),l=GlobalData.gameData.getPlayer(o);if(null==l)return void t.LogUtils.error("玩家状态改变出错，玩家信息为空");l.getUserId()!=n&&t.LogUtils.error("移除玩家头像出错，头像id："+l.getUserId()+"和用户id: "+n+" 不匹配"),l.setStatus(i),l.setReadyStatus(s);var c={clientId:r,status:i};Utils.sendGameEvent(t.GameCmd.PLAYER_STATUS_CHANGED,c)}},e.prototype.faFenOperation=function(e){if(e.code==t.MsgResultStatus.SUCCESS){for(var a=e.data,n=a.faFenUserInfos,o=0;o<n.length;o++){var i=n[o],s=i.chairId,r=i.score;GlobalData.gameData.getPlayer(s).setScore(r)}Utils.sendGameEvent(t.GameCmd.PLAYER_SCORE_FAFEN,a)}},e.prototype.operationCome=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setOperateTypes(a.operateTypes),Utils.sendGameEvent(t.GameCmd.OPERATE)}},e.prototype.pong=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.operationChairId,o=a.gainTileInfo,i=o.discardChairId,s=GlobalData.gameData.changeChairIdToClientId(i),r={type:o.gainType,provideClientId:s,value:o.tileIds[1]},l=new t.PongKongData(r),c=GlobalData.gameData.changeChairIdToClientId(n);GlobalData.gameData.changeDirArrow(n),GlobalData.gameData.setDiscardChairId(n);var u=a.tingInfos;GlobalData.gameData.setTingPaiInfo(u);var h={clientId:c,pongData:l};Utils.sendGameEvent(t.GameCmd.OPERATE_PONG,h)}},e.prototype.kong=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.operationChairId,o=a.gainTileInfo,i=o.discardChairId,s=GlobalData.gameData.changeChairIdToClientId(i),r={type:o.gainType,provideClientId:s,value:o.tileIds[1]},l=new t.PongKongData(r),c=GlobalData.gameData.changeChairIdToClientId(n),u={clientId:c,kongData:l};Utils.sendGameEvent(t.GameCmd.OPERATE_KONG,u)}},e.prototype.ready=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.chairId;GlobalData.gameData.getPlayer(n).getCardData().setTing(!0);var o={chairId:n};Utils.sendGameEvent(t.GameCmd.OPERATE_READY,o)}},e.prototype.discard=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.tingInfos;null!=n&&n.length>0?(GlobalData.gameData.setMyTingInfo(n),Utils.sendGameEvent(t.GameCmd.GET_MY_TING_INFO,{tingValue:!0})):Utils.sendGameEvent(t.GameCmd.GET_MY_TING_INFO,{tingValue:!1})}},e.prototype.pass=function(e){e.code==t.MsgResultStatus.SUCCESS&&Utils.sendGameEvent(t.GameCmd.OPERATE_PASS,{clientId:GameConst.ME_DIR})},e.prototype.autoPass=function(e){e.code==t.MsgResultStatus.SUCCESS&&Utils.sendGameEvent(t.GameCmd.OPERATE_PASS,{clientId:GameConst.ME_DIR})},e.prototype.xjsData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;this.realParseXjsData(a)}},e.prototype.realParseXjsData=function(e){this.isGameOverTimeOut=!1,GlobalData.gameData.setAllOverData(null),GlobalData.gameData.setOverData(e);var a=e.roomStatus;GlobalData.gameData.setGameStatus(a),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED),Utils.sendGameEvent(t.GameCmd.GameSettleInfo_1)},e.prototype.djsData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setAllOverData(a),this.isGameOverTimeOut&&Utils.sendGameEvent(t.GameCmd.GameSettleInfo_over)}},e.prototype.dissolveRoom=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setApplyQuitInfo(a),Utils.sendGameEvent(t.GameCmd.APPLY_QUIT_INFO)}},e.prototype.cancelRoom=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.diamond,o=a.cancelType;GlobalData.userData.setDiamondNum(n),Utils.sendGameEvent(t.GameCmd.DISSOLVE_ROOM,{dissolveType:o})}},e.prototype.playerLeaveRoom=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.diamond;GlobalData.userData.setDiamondNum(n),Utils.sendGameEvent(t.GameCmd.PLAYER_LEAVE)}},e.prototype.otherPlayerLeaveRoom=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.userId,o=a.chairId,i=GlobalData.gameData.changeChairIdToClientId(o),s=GlobalData.gameData.getPlayer(o);null==s?t.LogUtils.error("移除玩家头像出错，玩家信息为空"):s.getUserId()!=n&&t.LogUtils.error("移除玩家头像出错，头像id："+s.getUserId()+" 和用户id: "+n+" 不匹配"),GlobalData.gameData.removePlayer(o);var r={clientId:i};Utils.sendGameEvent(t.GameCmd.OTHER_PLAYER_LEAVE,r)}},e.prototype.otherPlayerJoinRoom=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=new t.PlayerInfo;n.parse(a);var o=n.getChairId();GlobalData.gameData.addPlayer(o,n),Utils.sendGameEvent(t.GameCmd.OTHER_PLAYER_IN,n)}},e.prototype.preventCheatInfo=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setNeedCheckCheat(!0),GlobalData.gameData.setPreventCheatInfo(a),Utils.sendGameEvent(t.GameCmd.PREVENT_CHEAT_INFO)}},e.prototype.autoDiscard=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setAutoDiscardInfo(a),Utils.sendGameEvent(t.GameCmd.AUTO_DISCARD_INFO,a)}},e.prototype.startAutoOfDelay=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.chairId,o=(GlobalData.gameData.changeChairIdToClientId(n),GlobalData.gameData.getPlayer(n));null!=o&&o.setAutoDiscardOfDelay(!0);Utils.sendGameEvent(t.GameCmd.START_AUTO_OF_DEALY)}},e.prototype.cancelAutoOfDelay=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.chairId,o=(GlobalData.gameData.changeChairIdToClientId(n),GlobalData.gameData.getPlayer(n));null!=o&&o.setAutoDiscardOfDelay(!1);Utils.sendGameEvent(t.GameCmd.CANCEL_AUTO_OF_DEALY)}},e.prototype.noticeKickLeftTime=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.kickLeftTime;GlobalData.gameData.setKickOfflineTime(Math.floor(n/1e3)),Utils.sendGameEvent(t.GameCmd.NOTICE_KICK_LEFT_TIME)}},e.prototype.cancelKickLeftTime=function(e){if(e.code==t.MsgResultStatus.SUCCESS){e.data;GlobalData.gameData.setKickOfflineTime(0),Utils.sendGameEvent(t.GameCmd.CANCEL_KICK_LEFT_TIME)}},e.prototype.startAutoDiscardTimer=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setAutoDelayTimeNum(Math.floor(a.leftTime/1e3)),Utils.sendGameEvent(t.GameCmd.AUTO_DISCARD_TIME,a)}},e.prototype.myAgainstData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setAutoDelayTimeNum(Math.floor(a.leftTime/1e3)),Utils.sendPanelEvent(t.GameCmd.PLAY_SINGLE_MESSAGE,a)}},e.prototype.totalAgainstData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;Utils.sendPanelEvent(t.GameCmd.PLAY_TOTAL_MESSAGE,a)}},e.prototype.rejectChangePlayerNum=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;Utils.sendGameEvent(t.GameCmd.CHANGE_PLAYER_NUM_REJECT,a)}},e.prototype.agreeChangePlayerNum=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;GlobalData.gameData.setChangePlayerNumInfo(a),Utils.sendGameEvent(t.GameCmd.CHANGE_PLAYER_NUM_INFO)}},e.prototype.cancelChangePlayerNum=function(e){if(e.code==t.MsgResultStatus.SUCCESS){e.data;Utils.sendGameEvent(t.GameCmd.CHANGE_PLAYER_NUM_CANCEL)}},e.prototype.parseScoreBoardData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;Utils.sendPanelEvent(t.GameCmd.UPDATE_GAEMSCORE_BOARD,a)}},e.prototype.parseChatData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;a.type==GameConst.CHAT_MSG_TYPE.VOICE||Utils.sendGameEvent(t.GameCmd.CHAT_MSG,a)}},e.prototype.parseReplayData=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;a.playBack=!0,a.curSceneIndex=t.SceneManager.getInstance().curScene.getIndex(),t.SceneSkip.skipToGameScene(a)}},e.prototype.parseDiamond=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.diamond;GlobalData.userData.setDiamondNum(n)}},e.prototype.parseGold=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data,n=a.gold;GlobalData.userData.setGoldNum(n)}},e.prototype.parsePointEmotion=function(e){if(e.code==t.MsgResultStatus.SUCCESS){var a=e.data;Utils.sendGameEvent(t.GameCmd.POINT_EMOTION,a)}else{var n=e.errorCode;n==t.MsgConstant.ERROR_Gold_not_enough&&t.CommonView.showToast(Strings.goldNotEnough)}},e.prototype.parseReconnect=function(e){if(e.code==t.MsgResultStatus.SUCCESS);else{var a=e.errorCode;if(a==t.MsgConstant.ERROR_room_over){var n=e.data;if(null!=n){var o=n.roomStatus,i="";i=4==o?Strings.dismissRoom_gameOver:5==o?Strings.dismissRoom_master:6==o?Strings.dismissRoom_xieshang:7==o?Strings.dismissRoom_timeOut:1==o?Strings.dismissRoom_leave:Strings.dismissRoom_other}else i=Strings.dismissRoom_other;var s=function(){t.SceneManager.getInstance().isInGame()&&(GlobalData.gameData.getRoomInfo().isClubRoom()?t.SceneSkip.skipToClubScene():t.SceneSkip.skipToHallScene())};t.DialogManager.getInstance().popUp1(i,s)}}},e.prototype.beginJiapai=function(e){if(e.code=t.MsgResultStatus.SUCCESS){var a=e.data,n=a.chairId,o=GlobalData.gameData.changeChairIdToClientId(n);Utils.sendGameEvent(t.GameCmd.PLAYER_BEGIN_JIA_PAI,{clientId:o,value:a.jiaTileId})}},e.prototype.cancelJiapai=function(e){if(e.code=t.MsgResultStatus.SUCCESS){var a=e.data,n=a.chairId,o=GlobalData.gameData.changeChairIdToClientId(n);Utils.sendGameEvent(t.GameCmd.PLAYER_CANCEL_JIA_PAI,{clientId:o})}},e.prototype.parseAddress=function(e){if(e.code=t.MsgResultStatus.SUCCESS){var a=e.data,n=a.chairId,o=a.detailAddress,i=GlobalData.gameData.getPlayer(n);null!=i&&i.setDetailAddress(o),Utils.sendPanelEvent(t.GameCmd.UPDATE_PLAYER_POSITION)}},e.prototype.forceUpdateHuaCards=function(e){if(e.code=t.MsgResultStatus.SUCCESS){var a=e.data;Utils.sendGameEvent(t.GameCmd.UPDATE_HUA,a)}},e}();t.GameDataService=e,__reflect(e.prototype,"game.GameDataService")}(game||(game={}));var game;!function(t){var e=function(){function e(t){this.effectGroup=t,this.init()}return e.prototype.init=function(){},e.prototype.playFireWorks=function(t){var e=GameConst.ACTION_DATA.FIREWORKS.index,a=GameConst.ACTION_DATA.FIREWORKS.data;this.playOperateEffect(t,e,a)},e.prototype.playWin=function(t,e){var a=this;e==GameConst.ACTION_WIN_ACTINDEX.gangkai?SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.kongWin):e==GameConst.ACTION_WIN_ACTINDEX.dihu?SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.diHu):e==GameConst.ACTION_WIN_ACTINDEX.hu?SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.win):e==GameConst.ACTION_WIN_ACTINDEX.zimo?SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.ziMo):e==GameConst.ACTION_WIN_ACTINDEX.tianhu&&SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.tianHu);
var n=GameConst.ACTION_POSITION.OPERATE[t].x,o=GameConst.ACTION_POSITION.OPERATE[t].y,i=GameConst.ACTION_DATA.OPERATE.WIN.data;this.playEffect(i,function(t){t.x=n,t.y=o,t.animation.play(e,1),a.effectGroup.addChild(t)})},e.prototype.playPong=function(e){SoundUtils.playEffectSoundNameBindPlayer(e,CardCost.other.pong),t.SoundService.getInstance().playAudio("pen_s_mp3");var a=GameConst.ACTION_DATA.OPERATE.PONG.index,n=GameConst.ACTION_DATA.OPERATE.PONG.data;this.playOperateEffect(e,a,n)},e.prototype.playHuaKong=function(t){SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.kong);var e=GameConst.ACTION_DATA.OPERATE.HUA_KONG.index,a=GameConst.ACTION_DATA.OPERATE.HUA_KONG.data;this.playOperateEffect(t,e,a)},e.prototype.playSiFeng=function(t){var e=GameConst.ACTION_DATA.OPERATE.SIFENG.index,a=GameConst.ACTION_DATA.OPERATE.SIFENG.data;this.playOperateEffect(t,e,a)},e.prototype.playBuHua=function(t,e){SoundUtils.playEffectSoundNameBindPlayer(t,CardCost.other.buHua,e);var a=GameConst.ACTION_DATA.OPERATE.BUHUA.index,n=GameConst.ACTION_DATA.OPERATE.BUHUA.data;this.playOperateEffect(t,a,n)},e.prototype.playKong=function(e){SoundUtils.playEffectSoundNameBindPlayer(e,CardCost.other.kong),t.SoundService.getInstance().playAudio("gang_s_mp3");var a=GameConst.ACTION_DATA.OPERATE.KONG.index,n=GameConst.ACTION_DATA.OPERATE.KONG.data;this.playOperateEffect(e,a,n)},e.prototype.playPass=function(t){var e=GameConst.ACTION_DATA.OPERATE.PASS.index,a=GameConst.ACTION_DATA.OPERATE.PASS.data;this.playOperateEffect(t,e,a)},e.prototype.playOperateEffect=function(e,a,n,o){var i=this;void 0===o&&(o=null),this.playEffect(n,function(a){i.effectGroup.addChild(a);var n=GameConst.ACTION_POSITION.OPERATE[e].x,s=GameConst.ACTION_POSITION.OPERATE[e].y;a.visible=!0,a.x=n,a.y=s,a.addEventListener(dragonBones.EventObject.COMPLETE,function(){t.LogUtils.info("播放完成"),i.effectGroup.removeChild(a)},i),a.animation.play(o,1)})},e.prototype.playEffect=function(t,e){var a=this,n=RES.getRes(t.dragonbonesData),o=RES.getRes(t.textureData),i=RES.getRes(t.texture);if(null==n)return console.log("dbdata null"),void RES.getResAsync(t.dragonbonesData,function(n){a.playEffect(t,e)},this);if(null==o)return console.log("texturedata null"),void RES.getResAsync(t.textureData,function(n){a.playEffect(t,e)},this);if(null==i)return console.log("texture null"),void RES.getResAsync(t.texture,function(n){a.playEffect(t,e)},this);var s=dragonBones.EgretFactory.factory;null==s.getDragonBonesData(t.name)&&(s.parseDragonBonesData(n),s.parseTextureAtlasData(o,i));var r=s.buildArmatureDisplay(t.name);null!=r&&null!=e&&e(r)},e.prototype.playDiscardEffect=function(e,a){var n=new t.OutCardEffect(e,a);this.effectGroup.addChild(n)},e.prototype.playShaiZi=function(e){var a=this;t.SoundService.getInstance().playAudio("saizi_mp3");var n=RES.getRes("shezi_json"),o=RES.getRes("shezi_png");if(null==n)return void RES.getResAsync("shezi_json",function(t){a.playShaiZi(e)},this);if(null==o)return void RES.getResAsync("shezi_png",function(t){a.playShaiZi(e)},this);var i=new egret.MovieClipDataFactory(n,o),s=new egret.MovieClip(i.generateMovieClipData("shezi"));s.x=640-s.width/2,s.y=320-s.height/2,this.effectGroup.addChild(s),s.gotoAndPlay("run",1),s.addEventListener(egret.Event.COMPLETE,function(t){console.log(t.type),a.effectGroup.removeChild(s),null!=e&&e()},this)},e.prototype.showScoreEffect=function(e,a){if(null!=a&&0!=a){var n=new t.GameScoreEffect(a),o=GameConst.ACTION_POSITION.FA_FEN[e].x,i=GameConst.ACTION_POSITION.FA_FEN[e].y;n.x=o,n.y=i,this.effectGroup.addChild(n)}},e.prototype.playCurDiscardArrow=function(t){var e=this,a=function(){t.y=t.y-30;var a=e.markOutCardEffect;a.x=t.x,a.y=t.y,a.animation.play(null,0)},n=(GameConst.ACTION_DATA.ARROW.index,GameConst.ACTION_DATA.ARROW.data);return null==this.markOutCardEffect?void this.playEffect(n,function(t){e.markOutCardEffect=t,e.effectGroup.addChild(e.markOutCardEffect),a()}):void a()},e.prototype.hideCurDiscardArrow=function(){if(null!=this.markOutCardEffect){GameConst.ACTION_DATA.ARROW.index;this.markOutCardEffect.visible=!1}},e.prototype.playChatMsg=function(e,a,n){var o,i,s=this;if(a==GameConst.CHAT_MSG_TYPE.EMOTION){o=GameConst.ACTION_POSITION.CHAT_MSG.EMOTION[e].x,i=GameConst.ACTION_POSITION.CHAT_MSG.EMOTION[e].y;var r=GameConst.CHAT_EMOTION_NAME[n],l={name:r,dragonbonesData:r+"_ske_json",textureData:r+"_tex_json",texture:r+"_tex_png"};this.playEffect(l,function(e){e.x=o,e.y=i,e.animation.play(null,1),e.addEventListener(dragonBones.EventObject.COMPLETE,function(){t.LogUtils.info("播放完成"),s.effectGroup.removeChild(e)},s),s.effectGroup.addChild(e)})}else if(a==GameConst.CHAT_MSG_TYPE.TEXT){var c=Strings.chatText;GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.standard&&(c=Strings.chatText_standard),SoundUtils.playChatMsgEffectSoundNameBindPlayer(e,n+1);var u=new t.GameChatText(e,c[n]);this.effectGroup.addChild(u)}},e.prototype.playVoiceEffect=function(t){},e.prototype.stopVoiceEffect=function(){},e.prototype.playPointEmotion=function(e,a,n){var o=this;t.SoundService.getInstance().playAudio("pesound_send_mp3");var i=GameConst.PLAYER_HEAD_POSITION[e],s=GameConst.PLAYER_HEAD_POSITION[a],r=new eui.Image("img_personal_item_"+n+"_png");r.width=80,r.height=80,r.x=i.x-r.width/2,r.y=i.y-r.height/2,this.effectGroup.addChild(r);var l=Math.sqrt(Math.pow(i.x-s.x,2)+Math.pow(i.y-s.y,2))/2.5,c=egret.Tween.get(r);c.to({x:s.x-r.width/2,y:s.y-r.height/2},l,egret.Ease.getPowIn(3)),c.call(function(){o.effectGroup.removeChild(r);var e=GameConst.POINT_EMOTION_NAME[n-1],a={name:e,dragonbonesData:e+"_ske_json",textureData:e+"_tex_json",texture:e+"_tex_png"};o.playEffect(a,function(e){e.x=s.x,e.y=s.y,e.animation.play(null,1),e.addEventListener(dragonBones.EventObject.COMPLETE,function(){t.LogUtils.info("播放完成"),o.effectGroup.removeChild(e)},o),o.effectGroup.addChild(e),t.SoundService.getInstance().playAudio("pesound_"+n+"_mp3")})})},e.prototype.playPointEmotionGold=function(t,e){},e.prototype.playBixihuaEffect=function(){var t=this,e=new eui.Group,a=new eui.Image("bg_gameUI_bixiahu_png");a.width=460,a.height=200;var n=new eui.Image("text_gameUI_bixiahu_png");n.width=294,n.height=112,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,e.addChild(a),e.addChild(n),e.width=a.width,e.height=a.height,n.x=(e.width-n.width)/2+n.anchorOffsetX,n.y=(e.height-n.height)/2+n.anchorOffsetY;var o=(GameConfig.ScreenW-e.width)/2,i=(GameConfig.ScreenH-e.height)/2-35;e.x=o,e.y=i,this.effectGroup.addChild(e);var s=egret.Tween.get(n);n.scaleX=4,n.scaleY=4,n.alpha=0,s.to({alpha:1,scaleX:1,scaleY:1},400,egret.Ease.getPowIn(2)),s.wait(1e3),s.call(function(){t.effectGroup.removeChild(e)})},e.prototype.playChuchongEffect=function(t){var e=this,a=new eui.Group,n=new eui.Image("bg_gameUI_chuchong_png");n.width=310,n.height=170;var o=new eui.Image("text_gameUI_chuchong_png");o.width=175,o.height=100,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,a.addChild(n),a.addChild(o),a.width=n.width,a.height=n.height,o.x=(a.width-o.width)/2+o.anchorOffsetX,o.y=(a.height-o.height)/2+o.anchorOffsetY;var i=GameConst.ACTION_POSITION.OPERATE[t].x-a.width/2,s=GameConst.ACTION_POSITION.OPERATE[t].y-a.height/2;a.x=i,a.y=s,this.effectGroup.addChild(a);var r=egret.Tween.get(o);o.scaleX=3,o.scaleY=3,o.alpha=0,r.to({alpha:1,scaleX:1,scaleY:1},400,egret.Ease.getPowIn(5)),r.wait(500),r.call(function(){e.effectGroup.removeChild(a)})},e.prototype.playDirArrow=function(e,a){var n=this,o=function(){var t=GameConst.ACTION_DIR_ARROW_DATA[e].offx,a=GameConst.ACTION_DIR_ARROW_DATA[e].offy,o=n.dirArrowEffect;o.x=t,o.y=a,o.animation.play("fengxiang_"+(e+1),0)};return null==this.dirArrowEffect?(t.LogUtils.info("创建动画"),void this.playEffect(GameConst.ACTION_DATA.FENGXIANG.data,function(t){null==n.dirArrowEffect&&(n.dirArrowEffect=t,a.addChild(n.dirArrowEffect)),o()})):void o()},e}();t.GameEffect=e,__reflect(e.prototype,"game.GameEffect")}(game||(game={}));var GamePlayerHead=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/gamePlayerHeadSkin.exml",e}return __extends(e,t),e.prototype.init=function(){this.headGroup.visible=!0,this.leaveImg.visible=!1,this.autoImg.visible=!1,this.bankImg.visible=!1,this.scoreGroup.visible=!1,this.huaGroup.visible=!1,this.readyImg.visible=!1,this.tingImg.visible=!1,this.jyzImg.visible=!1,this.jiapaiGroup.visible=!1,GlobalData.gameData.isPlayBack()||(this.addTapEvent(this.huaGroup,this.clickHuaEvet),this.addTapEvent(this.headGroup,this.clickHeadEvent))},e.prototype.clickHeadEvent=function(){this.playerInfo.getUserId()!=GlobalData.userData.getUserId()?game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.personInfoOther.index,this.playerInfo):game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.personInfo.index,GlobalData.userData)},e.prototype.clickHuaEvet=function(){var t=GlobalData.gameData.getFlowerCardVisible();GlobalData.gameData.setFlowerCardVisible(!t),Utils.sendGameEvent(game.GameCmd.FLOWER_VISIBLE)},e.prototype.setDir=function(t){this.dir=t,this.dir==GameConst.PLAY_DIR.right?(this.tingImg.x=164,this.readyImg.x=0,this.jyzImg.x=19,this.jiapaiGroup.x=28):(this.dir!=GameConst.PLAY_DIR.up?this.readyImg.x=186:this.readyImg.x=0,this.tingImg.x=48,this.jyzImg.x=160,this.jiapaiGroup.x=168)},e.prototype.setData=function(t){this.playerInfo=t,this.updateUI()},e.prototype.updateUI_=function(){var e=this;t.prototype.updateUI_.call(this);var a=GlobalData.gameData.getGameStatus();this.updateGameStatus(a);var n=this.playerInfo.getStatus();this.updateStatus(n),this.updateScore(this.playerInfo.getScore()),this.updateAutoStatus();var o=!1;null!=this.playerInfo.getCardData()&&(o=this.playerInfo.getCardData().isTing()),this.updateTingStatus(o);var i=this.playerInfo.isBanker();this.bankImg.visible=i;var s=this.playerInfo.getUserName();this.nameLabel.text=s;var r=this.playerInfo.getHeadIMGUrl();game.ResManager.loadWebImage(r,function(t){e.headImg.texture=t,e.headImg.addEventListener(eui.UIEvent.COMPLETE,function(){e.headImg.texture=t},e)},this)},e.prototype.updateGameStatus=function(t){t==GameConst.GAME_STATUS_TYPE.ready?(this.scoreGroup.visible=!1,this.huaGroup.visible=!1):t==GameConst.GAME_STATUS_TYPE.playing?(this.scoreGroup.visible=!0,this.huaGroup.visible=!0):t==GameConst.GAME_STATUS_TYPE.waiting&&(this.huaGroup.visible=!1)},e.prototype.updateTingStatus=function(t){this.tingImg.visible=t},e.prototype.updateAutoStatus=function(){var t=GlobalData.gameData.isAutoDelay(this.dir);this.autoImg.visible=t},e.prototype.updateScore=function(t){if(GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.ready&&0==t&&GlobalData.gameData.getRoomInfo().getRoomType()==Constants.ROOM_TYPE.jinYuanZi){if(!this.jyzImg.visible){this.jyzImg.visible=!0,this.jyzImg.scaleX=7,this.jyzImg.scaleY=7,this.jyzImg.alpha=0;var e=egret.Tween.get(this.jyzImg);e.to({scaleX:1,scaleY:1,alpha:1},400,egret.Ease.getPowIn(3))}}else this.jyzImg.visible=!1;this.scoreLabel.text=""+t},e.prototype.updateStatus=function(t){if(this.readyImg.visible=!1,this.leaveImg.visible=!1,Utils.removeGrayEffect(this.headImg),t==GameConst.PLAYER_STATUS.NULL?this.visible=!1:(t==GameConst.PLAYER_STATUS.OFFLINE||t==GameConst.PLAYER_STATUS.LEAVE)&&(Utils.addGrayEffect(this.headImg),this.leaveImg.visible=!0),null!=this.playerInfo){var e=this.playerInfo.getReadyStatus();1==e&&GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.playing&&(this.readyImg.visible=!0)}},e.prototype.updateHuaNum=function(t){var e=Utils.RGBA2Color(231,83,83,255);t>=4&&(e=Utils.RGBA2Color(72,191,11,255)),this.huaLabel.textColor=e,this.huaLabel.text="花 x "+t},e.prototype.setJiapaiData=function(t){this.jiapaiGroup.visible=!0,this.jiaPaiFace.source=Utils.format("leftPeng_dao_{0}_png",Utils.getNumberFormatStr(t))},e.prototype.cancelJiapaiData=function(){this.jiapaiGroup.visible=!1},e.prototype.changeCardBack=function(){this.jiaPaiBack.source=Utils.getCardBack("me-dachu{0}_png")},e}(game.EComponent);__reflect(GamePlayerHead.prototype,"GamePlayerHead"),window.GamePlayerHead=GamePlayerHead;var game;!function(t){var e=function(e){function a(t,a){var n=e.call(this)||this;return n.replayData=null,n.overData=null,n.curReplayIdx=0,n.replaySchedulerId=null,n.curDuration=0,n.speedDuration=0,n.curDurationIndex=0,n.uiActionFinished=!0,n._isPause=!1,n._isOver=!1,n._speed=1,n.quitToSceneIndex=-1,n.gs=t,n.params=a,null!=a&&a.curSceneIndex?n.quitToSceneIndex=a.curSceneIndex:n.quitToSceneIndex=Constants.SCENE_INDEX.MAIN,n.skinName="resource/skins/game/gameReplayerBarSkin.exml",n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.initData(this.params)},a.prototype.init=function(){this.initUI(),this.replayData=null,this.curReplayIdx=0,this.replaySchedulerId=null,this.curDuration=0,this.speedDuration=0,this.curDurationIndex=0,this.uiActionFinished=!0,this._isPause=!1,this._isOver=!1,this.hideRoomInfo(),this.setSpeed(1)},a.prototype.startReplayer=function(){var t=this;null!=this.replayData&&(this.replaySchedulerId=setInterval(function(){t.update()},100))},a.prototype.update=function(){if(!this.isPause()&&!this._isOver&&(this.curDuration=this.curDuration+100,!(this.curDuration<this.speedDuration)&&this.uiActionFinished)){if(this.curReplayIdx>=this.replayData.length)return this._isOver=!0,t.CommonView.showToast(Strings.replayOver),t.LogUtils.info("回放结束"),this.stopScheduler(),void this.playOver();var e=this.replayData[this.curReplayIdx];this.uiActionFinished=!1,t.LogUtils.info("replayer running"),this.sendReplayUnitData(e,!1),this.curReplayIdx=this.curReplayIdx+1,this.updateNextDuration(this.curReplayIdx),this.curDuration=0}},a.prototype.initData=function(e){var a=e.startData;this.overData=e.overData,t.GameDataService.getInstance().realParseStartGame(a),this.replayData=e.processData,t.EAppFacade.getInstance().registerCommand(t.GameCmd.REPLAYER_ACTION_FINISH,this.oneStepFinishFinish,this),this.updateNextDuration(1),this.updateUI()},a.prototype.oneStepFinishFinish=function(){this.setUIActionsFinished(!0)},a.prototype.setUIActionsFinished=function(t){this.uiActionFinished=t},a.prototype.initUI=function(){this.Button_roomInfo.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.showRoomInfo,this),this.Button_roomInfo.addEventListener(egret.TouchEvent.TOUCH_END,this.hideRoomInfo,this),this.Button_roomInfo.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.hideRoomInfo,this),this.Button_roomInfo.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.hideRoomInfo,this),this.addTapEvent(this.Button_back,this.backEvent.bind(this)),this.addTapEvent(this.Button_play,this.play.bind(this)),this.addTapEvent(this.Button_pause,this.pause.bind(this)),this.addTapEvent(this.Button_speed,this.addSpeedEvent.bind(this)),this.addTapEvent(this.Button_quit,this.quitEvent.bind(this)),this.updatePlayBtn()},a.prototype.quitEvent=function(){var e=this;t.DialogManager.getInstance().popUp2(Strings.quitReplayerInfo,function(){t.SceneSkip.skipToScene(e.quitToSceneIndex)},function(){e.setPause(!0)})},a.prototype.addSpeedEvent=function(){var t=this._speed%4+1;this.setSpeed(t)},a.prototype.setSpeed=function(t){this._speed=t,this.updateSpeed(),this.updateCurDuration()},a.prototype.updateCurDuration=function(){this.updateNextDuration(this.curDurationIndex)},a.prototype.updateSpeed=function(){this.Text_speed.text="x"+this._speed},a.prototype.play=function(){this.setPause(!1)},a.prototype.pause=function(){this.setPause(!0)},a.prototype.updatePlayBtn=function(){this.isPause()?(this.Button_pause.visible=!1,this.Button_play.visible=!0):(this.Button_pause.visible=!0,this.Button_play.visible=!1)},a.prototype.showRoomInfo=function(){this.Group_rules.visible=!0},a.prototype.hideRoomInfo=function(){this.Group_rules.visible=!1},a.prototype.backEvent=function(){if(this._isOver&&t.CommonView.showToast(Strings.replayOver),!(this.curReplayIdx<=0)){this.uiActionFinished=!0,this.setPause(!0),this.curDuration=0,this.gs.getCardLayer().clearAllScheduler(),this.curReplayIdx=this.curReplayIdx-1;var e=this.replayData[this.curReplayIdx];this.updateNextDuration(this.curReplayIdx),this.sendReplayUnitData(e,!0)}},a.prototype.sendReplayUnitData=function(e,a){var n=e.replayType,o=e.jsonData,i=0;if(n==GameConst.REPLAY_TYPE.DISCARD){var s=o.chairId;i=s;var r=GlobalData.gameData.changeChairIdToClientId(s),l=o.tileId,c=t.GameCmd.DISCARD;a?(c=t.GameCmd.DISCARD_BACK,t.LogUtils.info("replayer 出牌回退")):t.LogUtils.info("replayer 出牌"),Utils.sendGameEvent(c,{chairId:s,cardValue:l})}else if(n==GameConst.REPLAY_TYPE.DRAW){var s=o.chairId;i=s;var u=o.tileIds;GlobalData.gameData.changeDirArrow(s);var c=t.GameCmd.DRAW_CARD;a?(t.LogUtils.info("replayer 抓牌回退"),c=t.GameCmd.DRAW_CARD_BACK):t.LogUtils.info("replayer 抓牌"),Utils.sendGameEvent(c,{chairId:s,cardValues:u});var h=o.stackTileNum;Utils.sendGameEvent(t.GameCmd.LEFT_CARD_NUM_CHANGED,{leftCardNum:h})}else if(n==GameConst.REPLAY_TYPE.PONG){var s=o.operationChairId;i=s;var d=o.gainTileInfo,m=d.discardChairId,p=GlobalData.gameData.changeChairIdToClientId(m),g={type:d.gainType,provideClientId:p,value:d.tileIds[1]},C=new t.PongKongData(g);GlobalData.gameData.changeDirArrow(s);var r=GlobalData.gameData.changeChairIdToClientId(s),c=t.GameCmd.OPERATE_PONG;a?(c=t.GameCmd.OPERATE_PONG_BACK,t.LogUtils.info("replayer 碰牌回退")):t.LogUtils.info("replayer 碰牌"),Utils.sendGameEvent(c,{clientId:r,pongData:C}),r==GameConst.ME_DIR&&Utils.sendGameEvent(t.GameCmd.OPERATE_BACK)}else if(n==GameConst.REPLAY_TYPE.KONG){var s=o.operationChairId;i=s;var d=o.gainTileInfo,m=d.discardChairId,p=GlobalData.gameData.changeChairIdToClientId(m),g={type:d.gainType,provideClientId:p,value:d.tileIds[1]},C=new t.PongKongData(g),r=GlobalData.gameData.changeChairIdToClientId(s),c=t.GameCmd.OPERATE_KONG;a?(c=t.GameCmd.OPERATE_KONG_BACK,t.LogUtils.info("replayer 杠牌回退")):t.LogUtils.info("replayer 杠牌"),Utils.sendGameEvent(c,{clientId:r,kongData:C}),r==GameConst.ME_DIR&&Utils.sendGameEvent(t.GameCmd.OPERATE_BACK)}else if(n==GameConst.REPLAY_TYPE.FAFEN){for(var _=o.faFenUserInfos,f=0;f<_.lenght;f++){var D=_[f],s=D.chairId,I=D.score;GlobalData.gameData.getPlayer(s).setScore(I)}var c=t.GameCmd.PLAYER_SCORE_FAFEN;a?(c=t.GameCmd.PLAYER_SCORE_FAFEN_BACK,t.LogUtils.info("replayer 罚分回退")):t.LogUtils.info("replayer 罚分"),Utils.sendGameEvent(c,o)}else if(n==GameConst.REPLAY_TYPE.JIAPAI){var s=o.chairId;i=s;var r=GlobalData.gameData.changeChairIdToClientId(s),c=t.GameCmd.PLAYER_BEGIN_JIA_PAI;a?(c=t.GameCmd.PLAYER_CANCEL_JIA_PAI,t.LogUtils.info("replayer 架牌回退")):t.LogUtils.info("replayer 架牌"),Utils.sendGameEvent(c,{clientId:r,value:o.jiaTileId})}else if(n==GameConst.REPLAY_TYPE.CANCELJIPAI){var s=o.chairId;i=s;var r=GlobalData.gameData.changeChairIdToClientId(s),c=t.GameCmd.PLAYER_CANCEL_JIA_PAI;a?(c=t.GameCmd.PLAYER_BEGIN_JIA_PAI,t.LogUtils.info("replayer 取消架牌回退")):t.LogUtils.info("replayer 取消架牌"),Utils.sendGameEvent(c,{clientId:r,value:o.jiaTileId})}else if(n==GameConst.REPLAY_TYPE.TING){var s=o.chairId,c=t.GameCmd.OPERATE_READY;a?(c=t.GameCmd.OPERATE_READY_BACK,t.LogUtils.info("replayer 听牌回退")):t.LogUtils.info("replayer 听牌"),Utils.sendGameEvent(c,{chairId:s})}else if(n==GameConst.REPLAY_TYPE.OPERATE){GlobalData.gameData.setOperateTypes(o);var c=t.GameCmd.OPERATE;a?(c=t.GameCmd.OPERATE_BACK,t.LogUtils.info("replayer 取消架牌回退")):t.LogUtils.info("replayer 取消架牌"),Utils.sendGameEvent(c)}else if(n==GameConst.REPLAY_TYPE.PASS&&!a){var s=o.chairId;Utils.sendGameEvent(t.GameCmd.OPERATE_PASS,{clientId:GlobalData.gameData.changeChairIdToClientId(s)})}if(a){0!=i&&GlobalData.gameData.curDirArrow()!=i&&GlobalData.gameData.changeDirArrow(i);var E=this.curReplayIdx-1;if(E>0){var y=this.replayData[E],T=y.replayType,v=y.jsonData;if(T==GameConst.REPLAY_TYPE.DISCARD){var s=v.chairId,r=GlobalData.gameData.changeChairIdToClientId(s),l=v.tileId;t.LogUtils.info("刷新打牌箭头 clientId "+r),Utils.sendGameEvent(t.GameCmd.UPDATE_DISCARD_ARROW,{clientId:r,value:l})}}}},a.prototype.updateNextDuration=function(t){this.curDurationIndex=t;var e=0;if(0==t||t>=this.replayData.length)e=1.5;else{var a=this.replayData[t].replayType;a==GameConst.REPLAY_TYPE.DRAW?e=1:a==GameConst.REPLAY_TYPE.DISCARD?e=2:a==GameConst.REPLAY_TYPE.PONG?e=1:a==GameConst.REPLAY_TYPE.KONG?e=1:a==GameConst.REPLAY_TYPE.FAFEN?e=.5:a==GameConst.REPLAY_TYPE.JIAPAI?e=.5:a==GameConst.REPLAY_TYPE.CANCELJIPAI?e=.5:a==GameConst.REPLAY_TYPE.TING?e=.5:a==GameConst.REPLAY_TYPE.OPERATE?e=1:a==GameConst.REPLAY_TYPE.PASS&&(e=1)}this.speedDuration=1e3*e/this._speed},a.prototype.isPause=function(){return this._isPause},a.prototype.setPause=function(t){this._isPause=t,this.updatePlayBtn()},a.prototype.stopScheduler=function(){null!=this.replaySchedulerId&&(clearInterval(this.replaySchedulerId),this.replaySchedulerId=null)},a.prototype.playOver=function(){t.GameDataService.getInstance().realParseXjsData(this.overData),Utils.sendGameEvent(t.GameCmd.OPERATE_BACK)},a.prototype.updateUI_=function(){this.Text_roomRulesDesc.text=GlobalData.gameData.getRoomInfo().getShareRoomInfo()},a.prototype.release=function(){this.stopScheduler(),t.EAppFacade.getInstance().removeCommand(t.GameCmd.REPLAYER_ACTION_FINISH,this.oneStepFinishFinish,this),this.parent.removeChild(this)},a}(t.EComponent);t.GameReplayBar=e,__reflect(e.prototype,"game.GameReplayBar")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.SCENE_INDEX.GAME)||this;return a.needReconnectBeforeGameStart=!1,a.lastForegroundTime=0,a.params=t,a.initData(),a.skinName="resource/skins/game/gameSceneSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){if(GameConfig.localVersion){var e=t.Mock.getInstance();e.initMockData();var a=e.getMockGameData();GlobalData.gameData.parse(a)}this.initTouch(),this.gameEffect=new t.GameEffect(this.effectLayer),this.cardLayer=new t.GameCardLayer(this,this.touchErea,this.CardGroup),this.gameUILayer.setGameScene(this),this.gameCenter.setGameScene(this),this.changeBg(),this.setBgFrameVisible(),GlobalData.gameData.isPlayBack()&&(this.Replayer=new t.GameReplayBar(this,this.params),this.Replayer.x=(GameConfig.ScreenW-this.Replayer.width)/2,this.Replayer.y=GameConfig.ScreenH-200-this.Replayer.height,Main.instance.toastLayer.addChild(this.Replayer)),this.test(),t.EAppFacade.getInstance().registerCommand("gameScene",this.onEventHandler,this),this.checkCheatInfo(),this.checkGameStatus(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.userloginComplete,this)},a.prototype.userloginComplete=function(){if(GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.allOver&&!GlobalData.gameData.isPlayBack()){var e=!0,a=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.GameSettle_auto1.index);null!=a&&(e=!1),e&&this.cardLayer.clearAllScheduler(),t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_USER_RECONNECTION,{needStartGame:e,roomId:GlobalData.gameData.getRoomInfo().getRoomId()})}},a.prototype.initData=function(){GameConst.card_back_index=parseInt(DataStorage.readLocalData(LocalStorage.setting.Card_back_index,"0")),GameConst.game_bg_index=parseInt(DataStorage.readLocalData(LocalStorage.setting.Game_bg_index,"0")),GameConst.sound_type=parseInt(DataStorage.readLocalData(LocalStorage.setting.Sound_type,""+GameConst.SOUND_TYPE_ENUM.nanjing));var t=parseInt(DataStorage.readLocalData(LocalStorage.setting.GameDoubleClickType,""+GameConst.CLICK_CARD_TYPE.doubleClick));GlobalData.gameData.setClickType(t);var e=1==parseInt(DataStorage.readLocalData(LocalStorage.setting.Flower_card_Visible,"1"));if(GlobalData.gameData.setFlowerCardVisible(e),null!=this.params){var a=!1;this.params.playBack&&(a=this.params.playBack),GlobalData.gameData.setPlayBack(a)}},a.prototype.checkGameStatus=function(){t.LogUtils.info("checkGameStatus "+GlobalData.gameData.getGameStatus()),this.setStatus(GlobalData.gameData.getGameStatus()),this.showApplyQuit(),this.showChangePlayerNum()},a.prototype.showChangePlayerNum=function(){var e=GlobalData.gameData.getChangePlayerNumInfo(),a=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.changePlayerNumBox.index);return null==e?void Utils.sendPanelEvent(t.GameCmd.CLOSE_CHANGE_PLAYERNUM_PANEL):void(null==a?t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.changePlayerNumBox.index,e):a.setData(e))},a.prototype.showApplyQuit=function(){var e=GlobalData.gameData.getApplyQuitInfo(),a=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.applyQuit.index);if(null==e)return void(null!=a&&a.close());if(null==a)t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.applyQuit.index,e);else{var n=a;n.setData(e)}},a.prototype.onEventHandler=function(e){var a=e.data,n=a.cmd,o=a.data;if(n==t.GameCmd.GAME_STATUS_CHANGED)this.statusChanged();else if(n==t.GameCmd.PREVENT_CHEAT_INFO){var i=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.preventCheat.index);null!=i&&i.close(),GlobalData.gameData.setCheatStatus(!0),t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.checkCheat.index)}else if(n==t.GameCmd.CHECK_CHEAT_STATUS)this.checkCheatStatus();else if(n==t.GameCmd.GameSettleInfo_1)setTimeout(function(){var e=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.GameSettle_auto1.index);null!=e&&t.DialogManager.getInstance().close(e);var a=GlobalData.gameData.getOverData();t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.GameSettle_auto1.index,a)},1e3);else if(n==t.GameCmd.GameSettleInfo_over)t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.gameOverBox.index);else if(n==t.GameCmd.APPLY_QUIT_INFO)this.showApplyQuit();else if(n==t.GameCmd.APPLY_QUIT_REJECT){var s=o.rejectUserName;t.CommonView.showToast(Utils.format("玩家[{0}]不同意退出",s));var r=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.applyQuit.index);null!=r&&r.close()}else if(n==t.GameCmd.DISSOLVE_ROOM)if(null!=o){var l=o.dissolveType,c=null;l==GameConst.DissolveRoomType.TIMEOUT?c=Strings.dismissRoom_timeOut:l==GameConst.DissolveRoomType.DAIKAI?c=Strings.dismissRoom_daikai:l==GameConst.DissolveRoomType.MASTER&&(GlobalData.gameData.isMeCreator()||(c=Strings.dismissRoom_master)),null!=c?t.DialogManager.getInstance().popUp1(c,function(){GlobalData.gameData.getRoomInfo().isClubRoom()?t.SceneSkip.skipToClubScene():t.SceneSkip.skipToHallScene()}):GlobalData.gameData.getRoomInfo().isClubRoom()?t.SceneSkip.skipToClubScene():t.SceneSkip.skipToHallScene()}else GlobalData.gameData.getRoomInfo().isClubRoom()?t.SceneSkip.skipToClubScene():t.SceneSkip.skipToHallScene();else if(n==t.GameCmd.CHANGE_PLAYER_NUM_INFO)this.showChangePlayerNum();else if(n==t.GameCmd.CHANGE_PLAYER_NUM_REJECT){var s=o.rejectUserName;t.CommonView.showToast(Utils.format("玩家[{0}]不同意",s)),Utils.sendPanelEvent(t.GameCmd.CLOSE_CHANGE_PLAYERNUM_PANEL)}else n==t.GameCmd.CHANGE_PLAYER_NUM_CANCEL?Utils.sendPanelEvent(t.GameCmd.CLOSE_CHANGE_PLAYERNUM_PANEL):n==t.GameCmd.CHANGE_GAME_BG?this.changeBg():n==t.GameCmd.CHANGE_GAME_BG_FRAME&&this.setBgFrameVisible();this.cardLayer.onEventHandler(e),this.gameUILayer.onEventHandler(e),this.gameCenter.onEventHandler(e)},a.prototype.setBgFrameVisible=function(){var t=DataStorage.readLocalData(LocalStorage.setting.Game_bg_frame,"0");this.Image_frame.visible="1"==t},a.prototype.changeBg=function(){0==GameConst.game_bg_index?this.Image_bg.source="img_GameUI_BgNEW_jpg":this.Image_bg.source=Utils.format("img_GameUI_BgNEW_{0}_jpg",GameConst.game_bg_index)},a.prototype.statusChanged=function(){var e=GlobalData.gameData.getGameStatus();t.LogUtils.info("游戏状态改变 "+e),this.setStatus(e)},a.prototype.setStatus=function(t){var e=this;if(t==GameConst.GAME_STATUS_TYPE.playing&&GlobalData.gameData.isNeedPlayStartStatus()){if(GlobalData.gameData.isNeedCheckCheat())return;this.needReconnectBeforeGameStart=!0;var a=(new Date).getTime();a-this.lastForegroundTime<=500?(this.needReconnectBeforeGameStart=!1,this.lastForegroundTime=0):(t=GameConst.GAME_STATUS_TYPE.before_playing,this.getEffectLayer().playShaiZi(function(){e.gameUILayer.setStatus(GameConst.GAME_STATUS_TYPE.playing),e.cardLayer.setStatus(GameConst.GAME_STATUS_TYPE.playing,!0),e.gameCenter.setStatus(GameConst.GAME_STATUS_TYPE.playing),GlobalData.gameData.isPlayBack()&&e.Replayer&&e.Replayer.startReplayer()}))}GlobalData.gameData.setNeedPlayStartStatus(!1),this.gameUILayer.setStatus(t),this.cardLayer.setStatus(t),this.gameCenter.setStatus(t),(t==GameConst.GAME_STATUS_TYPE.before_playing||t==GameConst.GAME_STATUS_TYPE.playing)&&GlobalData.gameData.setCheatStatus(!1),this.checkCheatStatus()},a.prototype.checkCheatInfo=function(){GlobalData.gameData.isNeedCheckCheat()&&(GlobalData.gameData.setCheatStatus(!0),t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.checkCheat.index))},a.prototype.checkCheatStatus=function(){var e=GlobalData.gameData.isCheatStatus();if(e)null==t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.checkCheat.index)&&null==t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.preventCheat.index)&&t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.preventCheatStatusBox.index);else{var a=t.DialogManager.getInstance().getBox(Constants.UI_PANEL_DATA_SET.preventCheatStatusBox.index);null!=a&&a.close()}},a.prototype.test=function(){GameConfig.localVersion?this.testBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.testFunc,this):this.testBtn.visible=!1},a.prototype.testFunc=function(){t.Mock.getInstance().mockJiaPai()},a.prototype.initTouch=function(){GlobalData.gameData.isPlayBack()},a.prototype.resetClickEvent=function(){null!=this.gameUILayer&&this.gameUILayer.setMoreInfo(!1),null!=this.cardLayer&&this.cardLayer.clearSelectCard()},a.prototype.getEffectLayer=function(){return this.gameEffect},a.prototype.getCardLayer=function(){return this.cardLayer},a.prototype.getGameUILayer=function(){return this.gameUILayer},a.prototype.getGameCenter=function(){return this.gameCenter},a.prototype.getReplayer=function(){return this.Replayer},a.prototype.clean=function(){e.prototype.clean.call(this),t.EAppFacade.getInstance().removeCommand("gameScene",this.onEventHandler,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.userloginComplete,this),this.gameUILayer.release(),this.cardLayer.release(),this.gameCenter.release(),GlobalData.gameData.clearData(),GlobalData.gameData.setPlayBack(!1),null!=this.Replayer&&(this.Replayer.release(),this.Replayer=null),this.lastForegroundTime=0,this.needReconnectBeforeGameStart=!1},a}(t.SceneBase);t.GameScene=e,__reflect(e.prototype,"game.GameScene")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.scoreNumber=e,a.skinName="resource/skins/game/gameScoreEffectSkin.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){var e=this;t.prototype.onCreateViewComplete.call(this),this.scoreNumber>0?(this.Text_score.text="+"+this.scoreNumber,this.Text_score.textColor=16757262):(this.Text_score.text=""+this.scoreNumber,this.Text_score.textColor=7968960);var a=egret.Tween.get(this);a.to({x:this.x+20,y:this.y-20},1e3),a.to({alpha:0},300),a.call(function(){e.parent.removeChild(e)})},e}(t.EComponent);t.GameScoreEffect=e,__reflect(e.prototype,"game.GameScoreEffect")}(game||(game={}));var GameUILayer=function(t){function e(){var e=t.call(this)||this;return e.needCheckPlayerNum=!1,e.systemTimeSchedulerId=null,e.otherSystemInfoSchedulerId=null,e.isMoreInfoOpen=!1,e.kickOfflineTime=0,e.schedulerKickOfflineId=0,e.tempDataType={FAFEN:1},e.skinName="resource/skins/game/gameUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.init()},e.prototype.init=function(){this.initData(),this.Text_RoomNumber.text=""+GlobalData.gameData.getRoomInfo().getRoomNum(),this.initHeadNode(),this.initOperateNode(),this.initInviteNode(),this.initTingTint(),this.initDelayAuto(),this.initMoreInfo(),this.initBackBtn(),this.initOtherUI(),this.initSystemInfo(),this.initOtherTime(),this.changeCardBack()
},e.prototype.initOtherTime=function(){},e.prototype.initSystemInfo=function(){var t=this;GlobalData.gameData.isPlayBack()&&(this.systemInfoNode.visible=!1),this.systemTimeSchedulerId=setInterval(function(){t.updateSystemTime()},3e4),this.otherSystemInfoSchedulerId=setInterval(function(){t.updateOtherSystemInfo()},15e3)},e.prototype.updateSystemTime=function(){var t=new Date,e=t.getHours(),a=t.getMinutes(),n=""+a;10>a&&(n="0"+a),this.Text_time.text=Utils.format("{0}:{1}",e,n)},e.prototype.updateOtherSystemInfo=function(){return __awaiter(this,void 0,void 0,function(){var t,e,a;return __generator(this,function(n){switch(n.label){case 0:return GameConfig.platform!=GameConfig.PLATFORM_SET.weChat?[2]:[4,platform.getSystemInfo()];case 1:return t=n.sent(),e=t.batteryLevel,void 0!=e&&this.updateBattery(e),a=t.wifiSignal,void 0!=a&&this.updateSingalLevel(a),[2]}})})},e.prototype.initOtherUI=function(){this.Button_bxh.visible=!1,this.Text_autoDiscard.visible=!1,this.addTapEvent(this.ChangePlayerNumBtn,this.changePlayerNumEvent),this.checkPlayerNum(),this.Button_voice.visible=!1,this.addTapEvent(this.Button_chat,this.showChatBox),this.addTapEvent(this.Button_bxh,this.showBxhDes),GlobalData.gameData.isPlayBack()&&(this.Button_chat.visible=!1),this.addTapEvent(this.Button_scoreBoard,this.showScoreBoardBox),this.addTapEvent(this.Button_tint,this.showMyTingInfoView)},e.prototype.showScoreBoardBox=function(){game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.GameScoreBoard.index)},e.prototype.showBxhDes=function(){game.DialogManager.getInstance().popUp1(GlobalData.gameData.getBiXiaHuDesc())},e.prototype.showChatBox=function(){game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.chatBox.index)},e.prototype.changePlayerNumEvent=function(){game.DialogManager.getInstance().popUp2(Strings.applyThreePlayer,function(){game.SocketManager.getInstance().sendMsg(game.MsgConstant.HALL,game.MsgConstant.CMD_switch_player_num)})},e.prototype.initBackBtn=function(){this.addTapEvent(this.Button_quit,this.backEvent)},e.prototype.initMoreInfo=function(){var t=this;this.setPopBtnStatus(1),GlobalData.gameData.isPlayBack()&&(this.moreInfoNode.visible=!1,this.Button_more.visible=!1),this.setMoreInfo(!1),this.addTapEvent(this.Button_setting,this.showSetting),this.addTapEvent(this.Button_more,function(){t.setMoreInfo(!t.isMoreInfoOpen)}),this.addTapEvent(this.Button_applyQuit,this.applyQuitEvent),this.addTapEvent(this.Button_help,this.showHelp)},e.prototype.showHelp=function(){this.setMoreInfo(!1),game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.roomInfoBox.index)},e.prototype.backEvent=function(){var t=GlobalData.gameData.getRoomInfo().getPayMode()==Constants.ROOM_PAY_MODE.other;if(GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.ready){var e=function(){GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.ready&&(!GlobalData.gameData.isMeCreator()||t||GlobalData.gameData.getRoomInfo().isClubRoom()?game.SocketManager.getInstance().sendMsg(game.MsgConstant.HALL,game.MsgConstant.CMD_LEAVE_ROOM):game.SocketManager.getInstance().sendMsg(game.MsgConstant.HALL,game.MsgConstant.CMD_CANCEL_ROOM))},a=null;!GlobalData.gameData.isMeCreator()||t||GlobalData.gameData.getRoomInfo().isClubRoom()?a=Strings.exitRoom:(a=Strings.dismissRoom,"0"==GlobalData.clientConfigs.showCreateRoom&&(a="是否确认解散房间?")),game.DialogManager.getInstance().popUp2(a,e)}else game.SocketManager.getInstance().sendMsg(game.MsgConstant.HALL,game.MsgConstant.CMD_DISMISS_ROOM)},e.prototype.applyQuitEvent=function(){this.setMoreInfo(!1),this.backEvent()},e.prototype.showSetting=function(){game.LogUtils.info("设置框"),game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.gameSetting.index)},e.prototype.initInviteNode=function(){this.addTapEvent(this.Button_weChat,this.share),this.addTapEvent(this.Button_dismissRoom,this.dissolveRoom)},e.prototype.setPopBtnStatus=function(t){var e=2==t;this.Image_moreInfo_bg.visible=e,this.Button_setting.visible=e,this.Button_help.visible=e},e.prototype.dissolveRoom=function(){game.LogUtils.info("解散房间");var t=function(){game.SocketManager.getInstance().sendMsg(game.MsgConstant.HALL,game.MsgConstant.CMD_CANCEL_ROOM)},e=Strings.dismissRoom;"0"==GlobalData.clientConfigs.showCreateRoom&&(e="是否确认解散房间?"),game.DialogManager.getInstance().popUp2(e,t)},e.prototype.share=function(){game.LogUtils.info("分享"),platform.shareWithImg("麻将约起来，就等你了！","","","key1=1&key2=2")},e.prototype.initDelayAuto=function(){this.autoDelayNode.visible=!1,this.addTapEvent(this.cancelAutoBtn,function(){game.SocketManager.getInstance().sendMsg(game.MsgConstant.GAME,game.MsgConstant.CMD_Notice_AutoHost_cancel)})},e.prototype.initTingTint=function(){var t=this;null!=this.tingTint||GlobalData.gameData.isPlayBack()||(this.tinyMask=new eui.Rect,this.tinyMask.alpha=0,this.tinyMask.width=1280,this.tinyMask.height=720,this.addChild(this.tinyMask),this.addTapEvent(this.tinyMask,function(){t.hideMyTingInfoView()}),this.tingTint=new game.TingTint,this.addChild(this.tingTint),this.hideMyTingInfoView())},e.prototype.initHeadNode=function(){this.headGroup=[this.headDown,this.headRight,this.headTop,this.headLeft];for(var t=0;t<this.headGroup.length;t++){var e=this.headGroup[t].localToGlobal(this.headGroup[t].width/2,this.headGroup[t].height/2);GameConst.PLAYER_HEAD_POSITION[t].x=e.x,GameConst.PLAYER_HEAD_POSITION[t].y=e.y,this.headGroup[t].init(),this.headGroup[t].setDir(t)}},e.prototype.updatePlayerHead=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.headGroup[t].visible=!1;game.LogUtils.info("initPlayerHead");for(var t=0;t<GlobalData.gameData.getPlayerNum();t++){var e=GlobalData.gameData.changeIndexToClientId(t);game.LogUtils.info("getPlayerInfo clientId "+e);var a=GlobalData.gameData.getPlayerByClientId(e);if(null==a)this.headGroup[e].visible=!1;else if(this.headGroup[e].visible=!0,this.headGroup[e].setData(a),this.headGroup[e].updateGameStatus(this.status),null!=a.getCardData()){var n=a.getCardData().getJiaPaiValue();0!=n?this.headGroup[t].setJiapaiData(n):this.headGroup[t].cancelJiapaiData()}}for(var t=0;t<GlobalData.gameData.getPlayerNum();t++){var e=GlobalData.gameData.changeIndexToClientId(t);this.headGroup[e].updateGameStatus(this.status)}if(this.status==GameConst.GAME_STATUS_TYPE.playing)for(var t=0;t<GlobalData.gameData.getPlayerNum();t++){var e=GlobalData.gameData.changeIndexToClientId(t);this.headGroup[e].updateHuaNum(this.gs.getCardLayer().getHuaNum(e))}else if(this.status==GameConst.GAME_STATUS_TYPE.over||this.status==GameConst.GAME_STATUS_TYPE.allOver)for(var t=0;t<GameConst.maxPlayerNum;t++)this.headGroup[t].updateTingStatus(!1),this.headGroup[t].cancelJiapaiData()},e.prototype.initData=function(){this.status=GameConst.GAME_STATUS_TYPE.ready,this.needCheckPlayerNum=!0,this.systemTimeSchedulerId=null,this.allScheduler=[],this.tempDataBeforeGameStart=[]},e.prototype.onEventHandler=function(t){var e=t.data,a=e.cmd,n=e.data;if(a==game.GameCmd.OPERATE||a==game.GameCmd.OPERATE_BACK)if(a==game.GameCmd.OPERATE){var o=!0;this.status==GameConst.GAME_STATUS_TYPE.playing&&this.gs.getCardLayer().isBuhuaing()&&(o=!1),o&&this.operateCome(),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)}else a==game.GameCmd.OPERATE_BACK&&(this.OperateGroup.visible=!1);else if(a==game.GameCmd.OTHER_PLAYER_IN){var i=n,s=i.getChairId(),r=GlobalData.gameData.changeChairIdToClientId(s);game.LogUtils.info("加入玩家的clientId "+r),this.headGroup[r].visible=!0,this.headGroup[r].setData(i),this.checkPlayerNum()}else if(a==game.GameCmd.PLAYER_LEAVE)GlobalData.gameData.getRoomInfo().isClubRoom()?game.SceneSkip.skipToClubScene():game.SceneSkip.skipToHallScene();else if(a==game.GameCmd.OTHER_PLAYER_LEAVE){var r=n.clientId;this.headGroup[r].updateStatus(GameConst.PLAYER_STATUS.NULL),this.checkPlayerNum()}else if(a==game.GameCmd.PLAYER_STATUS_CHANGED){var r=n.clientId,l=n.status;this.headGroup[r].updateStatus(l)}else if(a==game.GameCmd.PLAYER_HUA_NUM_CHANGED){var r=n.clientId,c=n.huaNum;this.headGroup[r].updateHuaNum(c)}else if(a==game.GameCmd.PLAYER_SCORE_FAFEN||a==game.GameCmd.PLAYER_SCORE_FAFEN_BACK)a==game.GameCmd.PLAYER_SCORE_FAFEN?this.status==GameConst.GAME_STATUS_TYPE.before_playing?this.tempDataBeforeGameStart.push({type:this.tempDataType.FAFEN,data:n}):this.playFaFenEffect(n):a==game.GameCmd.PLAYER_SCORE_FAFEN_BACK&&this.playFaFenEffectBack(n);else if(a==game.GameCmd.PLAYER_SCORE_NUM_CHANGED){game.LogUtils.info("玩家分数改变");var r=n.clientId,c=n.score;this.headGroup[r].updateScore(c)}else if(a==game.GameCmd.OPERATE_PONG){var r=n.clientId;this.gs.getEffectLayer().playPong(r),r==GameConst.ME_DIR&&(this.Button_tint.visible=!1,this.hideMyTingInfoView())}else if(a==game.GameCmd.OPERATE_KONG){var r=n.clientId;this.gs.getEffectLayer().playKong(r),r==GameConst.ME_DIR&&(this.Button_tint.visible=!1,this.hideMyTingInfoView())}else if(a==game.GameCmd.OPERATE_READY||a==game.GameCmd.OPERATE_READY_BACK){var u=n.chairId,r=GlobalData.gameData.changeChairIdToClientId(u);a==game.GameCmd.OPERATE_READY?(this.headGroup[r].updateTingStatus(!0),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)):a==game.GameCmd.OPERATE_READY_BACK&&this.headGroup[r].updateTingStatus(!1)}else if(a==game.GameCmd.OPERATE_PASS){var r=n.clientId;GlobalData.gameData.isPlayBack()?(this.gs.getEffectLayer().playPass(r),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)):r==GameConst.ME_DIR&&(this.OperateGroup.visible=!1,GlobalData.gameData.resetOperateTypes())}else if(a==game.GameCmd.BATTERY_CHANGED){var h=n.battery;this.updateBattery(h)}else if(a==game.GameCmd.APP_NET_SINGAL_CHANGED){var d=n.singalLevel;this.updateSingalLevel(d)}else if(a==game.GameCmd.WIN_OVER){for(var r=n.clientId,m=n.actionIndex,p=0;p<r.length;p++)this.gs.getEffectLayer().playWin(r[p],m[p]);var g=n.chuchongIndex;null!=g&&g>0&&this.gs.getEffectLayer().playChuchongEffect(g)}else if(a==game.GameCmd.PLAYER_BEGIN_JIA_PAI){var r=n.clientId,C=n.value;this.startJiaPai(r,C)}else if(a==game.GameCmd.PLAYER_CANCEL_JIA_PAI){var r=n.clientId;this.cancelJiapai(r)}else if(a==game.GameCmd.CHAT_MSG){var u=n.chairId,r=GlobalData.gameData.changeChairIdToClientId(u),_=n.type,f=parseInt(n.msgId)-1;this.gs.getEffectLayer().playChatMsg(r,_,f)}else if(a==game.GameCmd.START_PLAY_VOICE){var r=n.clientId;this.gs.getEffectLayer().playVoiceEffect(r)}else if(a==game.GameCmd.VOICE_OVER)this.gs.getEffectLayer().stopVoiceEffect();else if(a==game.GameCmd.POINT_EMOTION){var u=n.chairId,D=n.toChairId,r=GlobalData.gameData.changeChairIdToClientId(u),I=GlobalData.gameData.changeChairIdToClientId(D),f=parseInt(n.msgId);this.gs.getEffectLayer().playPointEmotion(r,I,f)}else if(a==game.GameCmd.GET_MY_TING_INFO){var E=n.tingValue;this.Button_tint.visible=E}else if(a==game.GameCmd.DRAW_CARD){var u=n.chairId;u==GlobalData.gameData.getMyChairId()&&(this.Button_tint.visible=!1,this.hideMyTingInfoView())}else if(a==game.GameCmd.START_AUTO_OF_DEALY||a==game.GameCmd.CANCEL_AUTO_OF_DEALY)this.updateAutoDelay();else if(a==game.GameCmd.NOTICE_KICK_LEFT_TIME)this.updateOtherTime();else if(a==game.GameCmd.CANCEL_KICK_LEFT_TIME)this.updateOtherTime();else if(a==game.GameCmd.CHANGE_CARD_BACK)this.changeCardBack();else if(a==game.GameCmd.UPDATE_AUTODISCARD_Text_Visible){var y=n.visible;this.Text_autoDiscard.visible=y}},e.prototype.resetClock=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=!1)},e.prototype.changeCardBack=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)this.headGroup[t].changeCardBack()},e.prototype.updateOtherTime=function(){this.stopOtherTimer(),this.otherTimeGroup.visible=!1,(this.status==GameConst.GAME_STATUS_TYPE.ready||this.status==GameConst.GAME_STATUS_TYPE.waiting)&&this.startKickOfflineTimer()},e.prototype.stopOtherTimer=function(){0!=this.schedulerKickOfflineId&&(clearInterval(this.schedulerKickOfflineId),this.schedulerKickOfflineId=0)},e.prototype.startKickOfflineTimer=function(){var t=this;this.kickOfflineTime=GlobalData.gameData.getKickOfflineTime(),this.kickOfflineTime>0&&(this.otherTimeGroup.visible=!0,this.Text_otherTime.textFlow=this.getKickOfflineTimeInfo(this.kickOfflineTime),this.schedulerKickOfflineId=setInterval(function(){t.kickOfflineTime=Math.max(t.kickOfflineTime-1,0),t.Text_otherTime.textFlow=t.getKickOfflineTimeInfo(t.kickOfflineTime),t.kickOfflineTime<=0&&t.stopOtherTimer()},1e3))},e.prototype.getKickOfflineTimeInfo=function(t){return[{text:"系统将在",style:{textColor:15592941}},{text:""+t,style:{textColor:16711680}},{text:"秒后踢出离线玩家",style:{textColor:15592941}}]},e.prototype.updateInviteNode=function(){if(this.status!=GameConst.GAME_STATUS_TYPE.ready)this.inviteNode.visible=!1;else{this.inviteNode.visible=!0,GlobalData.gameData.getRoomInfo().getRoomType()==Constants.ROOM_TYPE.jinYuanZi?this.Image_roomType.source="text_house_1_png":this.Image_roomType.source="text_house_2_png",this.Text_RoomNumber.text=""+GlobalData.gameData.getRoomInfo().getRoomNum();var t=GlobalData.gameData.getRoomInfo().getPayMode()==Constants.ROOM_PAY_MODE.other;this.Button_dismissRoom.visible=GlobalData.gameData.isMeCreator()&&!t,GlobalData.gameData.getRoomInfo().isClubRoom()&&(this.Button_dismissRoom.visible=!1);var e=GlobalData.gameData.getRoomInfo().getGameUIRulesDesc();this.Text_rules.text=e}},e.prototype.updateAutoDelay=function(){for(var t=0;t<GameConst.maxPlayerNum;t++)if(this.status==GameConst.GAME_STATUS_TYPE.playing){var e=GlobalData.gameData.isAutoDelay(t);this.headGroup[t].updateAutoStatus(),t==GameConst.ME_DIR&&(this.autoDelayNode.visible=e)}else this.autoDelayNode.visible=!1},e.prototype.cancelJiapai=function(t){this.headGroup[t].cancelJiapaiData(),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)},e.prototype.startJiaPai=function(t,e){this.headGroup[t].setJiapaiData(e),game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)},e.prototype.showMyTingInfoView=function(){var t=GlobalData.gameData.getMyTingInfo();null!=this.tingTint&&(this.tingTint.initData(t,1280),this.tingTint.visible=!0),this.tinyMask&&(this.tinyMask.visible=!0,this.tinyMask.touchEnabled=!0)},e.prototype.hideMyTingInfoView=function(){null!=this.tingTint&&(this.tingTint.visible=!1),null!=this.tinyMask&&(this.tinyMask.visible=!1,this.tinyMask.touchEnabled=!1)},e.prototype.updateSingalLevel=function(t){1>t&&(t=1),t>4&&(t=4),this.Image_singnal.source="system_wifi_"+t+".png"},e.prototype.updateBattery=function(t){var e="system_power_4_png";90>t&&t>=60?e="system_power_3_png":60>t&&t>=15?e="system_power_2_png":15>t&&(e="system_power_1_png"),this.Image_battery.source=e},e.prototype.playFaFenEffectBack=function(t){var e=t.faFenType,a=t.faFenUserInfos;if(null!=e&&null!=a)for(var n=0;n<a.length;n++){var o=a[n],i=o.chairId,s=parseInt(o.faScore),r=(parseInt(o.score),o.score-s),l=GlobalData.gameData.changeChairIdToClientId(i);this.headGroup[l].updateScore(r)}},e.prototype.playFaFenEffect=function(t){var e=t.faFenType,a=t.faFenUserInfos;if(null!=e&&null!=a)for(var n=0;n<a.length;n++){var o=a[n],i=o.chairId,s=o.faScore,r=o.score,l=GlobalData.gameData.changeChairIdToClientId(i);this.gs.getEffectLayer().showScoreEffect(l,s),this.headGroup[l].updateScore(r),e==GameConst.FaFenType.FLOWER_KONG&&s>0&&this.gs.getEffectLayer().playHuaKong(l),e==GameConst.FaFenType.DNXB&&s>0&&this.gs.getEffectLayer().playSiFeng(l),GlobalData.gameData.isPlayBack()?0==n&&this.addSchedulerFunc(function(){game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)},.5):s>0&&this.addSchedulerFunc(function(){game.EAppFacade.getInstance().sendNotification(game.GameCmd.REPLAYER_ACTION_FINISH)},.5)}},e.prototype.checkPlayerNum=function(){var t=GlobalData.gameData.getCurPlayerNum(),e=this.ChangePlayerNumGroup.width;if(egret.Tween.removeTweens(this.ChangePlayerNumGroup),3==t&&GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.ready&&this.needCheckPlayerNum){var a=egret.Tween.get(this.ChangePlayerNumGroup);a.to({x:0},200)}else this.ChangePlayerNumGroup.x=-e;GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.playing&&(this.needCheckPlayerNum=!1)},e.prototype.setGameScene=function(t){this.gs=t},e.prototype.setStatus=function(t){this.status=t,this.updatePlayerHead(),this.updateInviteNode(),this.updateOtherUI(),this.updateOperateNode(),this.updateBackBtn(),this.updateMoreInfo(),this.updateSystemInfo(),this.excuteTempDataWhenGameBegin(),this.checkPlayerNum(),this.updateAutoDelay(),this.updateOtherTime(),this.status==GameConst.GAME_STATUS_TYPE.before_playing&&GlobalData.gameData.isBiXiaHu()&&this.gs.getEffectLayer().playBixihuaEffect()},e.prototype.updateSystemInfo=function(){this.status==GameConst.GAME_STATUS_TYPE.ready?this.systemInfoNode.x=67:this.systemInfoNode.x=5,this.updateSystemTime(),this.updateOtherSystemInfo()},e.prototype.excuteTempDataWhenGameBegin=function(){if(this.status==GameConst.GAME_STATUS_TYPE.playing){for(var t=0;t<this.tempDataBeforeGameStart.length;t++){var e=this.tempDataBeforeGameStart[t],a=e.type;a==this.tempDataType.FAFEN&&this.playFaFenEffect(e.data)}this.tempDataBeforeGameStart=[]}},e.prototype.updateOperateNode=function(){this.status==GameConst.GAME_STATUS_TYPE.playing?this.operateCome():this.OperateGroup.visible=!1},e.prototype.showJiaPai=function(){for(var t=0;t<GlobalData.gameData.getPlayerNum();t++){var e=GlobalData.gameData.changeIndexToClientId(t),a=GlobalData.gameData.getCardData(e);if(null==a)return void game.LogUtils.error("initJiaPai cardData is null dir "+e);var n=a.getJiaPaiValue();game.LogUtils.info("jiaPaiValue "+n),null!=n&&n>0&&this.startJiaPai(e,n)}},e.prototype.checkTingStatus=function(){for(var t=0;t<GameConst.maxPlayerNum;t++){var e=GlobalData.gameData.getCardData(t);if(null==e)return void game.LogUtils.error("initJiaPai cardData is null dir "+t);var a=e.isTing();game.LogUtils.info("isTing "+a),this.headGroup[t].updateTingStatus(a)}},e.prototype.checkMyTingInfoBtn=function(){if(null!=GlobalData.gameData.getMyTingInfo()){var t=this.gs.getCardLayer().getHandCardsNum(GameConst.ME_DIR),e=this.gs.getCardLayer().getDrawCardIndex(GameConst.ME_DIR)+1;t!=e?this.Button_tint.visible=!0:(this.Button_tint.visible=!1,this.hideMyTingInfoView())}},e.prototype.updateOtherUI=function(){if(this.roomNumberLabel.text="房间号:"+GlobalData.gameData.getRoomInfo().getRoomNum(),this.Button_tint.visible=!1,this.hideMyTingInfoView(),this.status==GameConst.GAME_STATUS_TYPE.ready)this.Button_bxh.visible=!1,this.Button_scoreBoard.visible=!1;else if(this.status==GameConst.GAME_STATUS_TYPE.before_playing);else if(this.status==GameConst.GAME_STATUS_TYPE.playing)GlobalData.gameData.isPlayBack()?this.Button_scoreBoard.visible=!1:this.Button_scoreBoard.visible=!0,this.Button_bxh.visible=GlobalData.gameData.isBiXiaHu(),this.showJiaPai(),this.checkTingStatus(),this.checkMyTingInfoBtn();else if(this.status==GameConst.GAME_STATUS_TYPE.waiting)for(var t=0;t<GameConst.maxPlayerNum;t++)this.headGroup[t].cancelJiapaiData()},e.prototype.updateBackBtn=function(){if(this.status==GameConst.GAME_STATUS_TYPE.ready){GlobalData.gameData.isMeCreator(),GlobalData.gameData.getRoomInfo().getPayMode()==Constants.ROOM_PAY_MODE.other;game.LogUtils.info("是否俱乐部房间:"+GlobalData.gameData.getRoomInfo().isClubRoom()),this.Button_quit.visible=!0}else this.Button_quit.visible=!1},e.prototype.updateMoreInfo=function(){this.status!=GameConst.GAME_STATUS_TYPE.ready?(this.Image_moreInfo_bg.height=260,this.Button_applyQuit.visible=this.isMoreInfoOpen):(this.Image_moreInfo_bg.height=200,this.Button_applyQuit.visible=!1)},e.prototype.initOperateNode=function(){this.operateBtns=[],this.operateBtns[GameConst.OPERATE_TYPE.pass-1]=this.Btn_Pass,this.operateBtns[GameConst.OPERATE_TYPE.ready-1]=this.Btn_Ready,this.operateBtns[GameConst.OPERATE_TYPE.win-1]=this.Btn_Win,this.operateBtns[GameConst.OPERATE_TYPE.kong-1]=this.Btn_Kong,this.operateBtns[GameConst.OPERATE_TYPE.pong-1]=this.Btn_Pong,this.tingPosX=this.Btn_Pass.x,GlobalData.gameData.isPlayBack()?this.OperateGroup.touchChildren=!1:(this.addTapEvent(this.Btn_Pong,this.sendPong),this.addTapEvent(this.Btn_Kong,this.sendKong),this.addTapEvent(this.Btn_Pass,this.clickPass),this.addTapEvent(this.Btn_Win,this.sendWin),this.addTapEvent(this.Btn_Ready,this.sendReady)),this.OperateGroup.visible=!1},e.prototype.operateCome=function(){if(this.status==GameConst.GAME_STATUS_TYPE.playing){game.LogUtils.info("operateCome");for(var t=GlobalData.gameData.getOperateTypes(),e=t.length,a=!1,n=0;5>n;n++)this.operateBtns[n].visible=!1;if(e>0){this.gs.getGameCenter().updateDirArrow(GameConst.ME_DIR),game.LogUtils.info("玩家有操作");for(var n=0;e>n;n++)if(this.operateBtns[t[n]-1].visible=!0,t[n]==GameConst.OPERATE_TYPE.win){a=!0;break}this.Btn_Pass.visible=!0,a?this.Btn_Pass.x=this.tingPosX-667:this.Btn_Pass.x=this.tingPosX,this.OperateGroup.visible=!0}}},e.prototype.sendOperateType=function(t,e){GlobalData.gameData.isAutoDelay(GameConst.ME_DIR)||(this.gs.getCardLayer().clearSelectCard(),this.OperateGroup.visible=!1,game.LogUtils.info("operate type "+e),GlobalData.gameData.resetOperateTypes(),game.SocketManager.getInstance().sendMsg(game.MsgConstant.GAME,t,{operateType:e}))},e.prototype.sendPong=function(){var t=game.MsgConstant.CMD_PONG,e=GameConst.OPERATE_TYPE.pong;this.sendOperateType(t,e)},e.prototype.sendKong=function(){var t=game.MsgConstant.CMD_KONG,e=GameConst.OPERATE_TYPE.kong;this.sendOperateType(t,e)},e.prototype.sendPass=function(){var t=game.MsgConstant.CMD_PASS,e=GameConst.OPERATE_TYPE.pass;this.sendOperateType(t,e)},e.prototype.sendWin=function(){var t=game.MsgConstant.CMD_WIN,e=GameConst.OPERATE_TYPE.win;this.sendOperateType(t,e)},e.prototype.clickPass=function(){if(this.isZiMo()){var t={confirmFunc:this.sendWin.bind(this),cancelFun:this.sendPass.bind(this)};return void game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.discardWinConfirmBox.index,t)}this.sendPass()},e.prototype.sendReady=function(){var t=game.MsgConstant.CMD_READY,e=GameConst.OPERATE_TYPE.win;this.sendOperateType(t,e)},e.prototype.isZiMo=function(){for(var t=GlobalData.gameData.getOperateTypes(),e=t.length,a=!1,n=0;e>n;n++)if(t[n]==GameConst.OPERATE_TYPE.win){a=!0;break}if(!a)return!1;var o=this.gs.getCardLayer().cardNumberIsMax(GameConst.ME_DIR);return o},e.prototype.setMoreInfo=function(t){this.isMoreInfoOpen=t,t?(this.Button_setting.visible=!0,this.Button_help.visible=!0,this.Image_moreInfo_bg.visible=!0,this.Button_applyQuit.visible=this.status!=GameConst.GAME_STATUS_TYPE.ready):(this.Button_setting.visible=!1,this.Button_help.visible=!1,this.Image_moreInfo_bg.visible=!1,this.Button_applyQuit.visible=!1)},e.prototype.addSchedulerFunc=function(t,e){var a=this,n=egret.Tween.get(this);n.wait(e),n.call(function(){a.allScheduler.splice(a.allScheduler.indexOf(t),1),t()}),this.allScheduler.push(t)},e.prototype.clearAllScheduler=function(){for(egret.Tween.removeTweens(this);this.allScheduler.length>0;){var t=this.allScheduler.pop();t.call(this)}this.allScheduler=[]},e.prototype.release=function(){null!=this.systemTimeSchedulerId&&clearInterval(this.systemTimeSchedulerId),null!=this.otherSystemInfoSchedulerId&&clearInterval(this.otherSystemInfoSchedulerId),this.clearAllScheduler()},e}(game.EComponent);__reflect(GameUILayer.prototype,"GameUILayer"),window.GameUILayer=GameUILayer;var game;!function(t){var e=function(){function e(){this.canHeart=!1,this.lastHeartTime=0,this.lastSendTime=0,t.EAppFacade.getInstance().registerCommand(t.GameCmd.SOCKET_STATUS_CHANGE,this.socketStatusChange,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_HEAR_THROB),this.heartCmdCallback,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.USER_LOGIN_SUCCESS,this.userloginSuccessNotice,this)}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.sendHeartCmd=function(){if(this.canHeart){var e=(new Date).getTime();e-this.lastHeartTime>15e3?(t.LogUtils.info("heart timeout close socket."),t.ConnectService.getInstance().close()):e-this.lastSendTime>=5e3&&(this.sendHeartCmd_(),this.lastSendTime=e)}},e.prototype.sendHeartCmd_=function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.GAME,t.MsgConstant.CMD_HEAR_THROB,null);t.SocketManager.getInstance().send(e)},e.prototype.heartCmdCallback=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS&&(this.lastHeartTime=(new Date).getTime())},e.prototype.userloginSuccessNotice=function(t){this.startHeart()},e.prototype.startHeart=function(){this.lastHeartTime=(new Date).getTime(),this.lastSendTime=0,this.canHeart=!0},e.prototype.reConnect=function(){t.ConnectService.getInstance().getStatus()==ConnectConst.ConnectStatus.ConnectClose&&(t.WaitingUI.show(),t.LogUtils.info("Socket 连接已断开，自动重连"),t.ConnectService.getInstance().connect(!0))},e.prototype.socketStatusChange=function(t){if(null!=t.data){var e=t.data.status;e==ConnectConst.ConnectStatus.Connected||e==ConnectConst.ConnectStatus.ConnectClose&&(this.canHeart=!1)}},e.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.SOCKET_STATUS_CHANGE,this.socketStatusChange,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_HEAR_THROB),this.heartCmdCallback,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.USER_LOGIN_SUCCESS,this.userloginSuccessNotice,this)},e}();t.HeartBeatService=e,__reflect(e.prototype,"game.HeartBeatService")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.startX=193,t.cardW=109,t.cardGap=10,t.originalWidth=0,t.originalHeight=0,t.curWidth=0,t.curHeight=0,t.cardNodeList=[],t.skinName="resource/skins/game/gameTingTintSkin.exml",t.init(),t}return __extends(a,e),a.prototype.on=function(){e.prototype.onCreateViewComplete.call(this),this.init()},a.prototype.init=function(){this.startX=145,this.cardW=109,this.cardGap=10,this.originalWidth=this.width,this.originalHeight=this.height,this.curWidth=this.originalWidth,this.curHeight=this.originalHeight,this.cardNodeList=[]},a.prototype.initData=function(e,a){this.curWidth=this.originalWidth;for(var n=0;n<this.cardNodeList.length;n++)this.cardNodeList[n].visible=!1;for(var o=e.length,i=this.cardW+this.cardGap,n=0;o>n;n++){var s=e[n],r=this.cardNodeList[n];null==r?(r=new t.TingTintCard,this.cardNodeList.push(r),this.addChild(r)):r.visible=!0,r.setData(s),r.x=this.startX+n*i,r.y=23,this.curWidth=this.curWidth+i}this.Image_bg.width=this.curWidth,this.Image_bg.height=this.curHeight;var l=a-75;10>l&&(l=10),l+this.curWidth>GameConfig.ScreenW-10&&(l=GameConfig.ScreenW-10-this.curWidth),this.x=l,this.y=400},a}(t.EComponent);t.TingTint=e,__reflect(e.prototype,"game.TingTint")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/gameTingTintCardSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this)},e.prototype.setData=function(t){this.back.source=Utils.getCardBack("me-hand{0}_png"),this.face.source=Utils.format("meHand_{0}_png",Utils.getNumberFormatStr(t.tileId)),this.Text_num.text=t.num},e}(t.EComponent);t.TingTintCard=e,__reflect(e.prototype,"game.TingTintCard")}(game||(game={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var game;!function(t){var e=function(e){function a(t,a){var n=e.call(this,a.dir,a.cardValue,a.idx)||this;return n._canSelect=!0,n._beSelected=!1,n.cardLayer=t,n.params=a,n.skinName=a.nodePath,n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.changeCardBack(),this.resetPosition(this.idx,this.params.actionType),GlobalData.gameData.isPlayBack()&&(this.dir==GameConst.PLAY_DIR.left||this.dir==GameConst.PLAY_DIR.right)&&(this.scaleX=.9,this.scaleY=.9)},a.prototype.setCardValue=function(a){if(e.prototype.setCardValue.call(this,a),this._value=a,0==this._value&&(this.dir==GameConst.ME_DIR||GlobalData.gameData.isPlayBack()))return void t.LogUtils.error("手牌数据错误 value:"+this._value);if(0!=this._value&&(this.dir==GameConst.ME_DIR||GlobalData.gameData.isPlayBack())){var n=this.getCardFaceImgName(this._value);this.face.source=n}},a.prototype.getCardFaceImgName=function(t){var e="";return this.dir==GameConst.PLAY_DIR.down?e=Utils.format("meHand_{0}_png",Utils.getNumberFormatStr(t)):this.dir==GameConst.PLAY_DIR.left||this.dir==GameConst.PLAY_DIR.right?GlobalData.gameData.isPlayBack()&&(e=Utils.format("leftDachu_{0}_png",Utils.getNumberFormatStr(t))):this.dir==GameConst.PLAY_DIR.up&&GlobalData.gameData.isPlayBack()&&(e=Utils.format("meDachu_{0}_png",Utils.getNumberFormatStr(t))),e},a.prototype.init=function(){this.setTingFlagVisible(!1)},a.prototype.setTingFlagVisible=function(t){this.dir==GameConst.ME_DIR&&(this.tingFlag.visible=t)},a.prototype.changeCardBack=function(){var t="";GlobalData.gameData.isPlayBack()?this.dir==GameConst.PLAY_DIR.right?t=Utils.getCardBack("left-dachu{0}_png"):this.dir==GameConst.PLAY_DIR.left?t=Utils.getCardBack("left-dachu{0}_png"):this.dir==GameConst.PLAY_DIR.up?t=Utils.getCardBack("me-dachu{0}_png"):this.dir==GameConst.PLAY_DIR.down&&(t=Utils.getCardBack("me-hand{0}_png")):this.dir==GameConst.PLAY_DIR.down?t=Utils.getCardBack("me-hand{0}_png"):this.dir==GameConst.PLAY_DIR.left?t=Utils.getCardBack("left-hand{0}_png"):this.dir==GameConst.PLAY_DIR.right?t=Utils.getCardBack("left-hand{0}_png"):this.dir==GameConst.PLAY_DIR.up&&(t=Utils.getCardBack("up-hand{0}_png")),this.back.source=t},a.prototype.isSelected=function(){return this._beSelected},a.prototype.setSelect=function(t){this._beSelected=t,this._beSelected?this.y=GameConst.GAME_ALL_CARD_NODE_POSITION.HAND_CARD[this.dir].y-30:this.y=GameConst.GAME_ALL_CARD_NODE_POSITION.HAND_CARD[this.dir].y},a.prototype.canSelect=function(){return this._canSelect},a.prototype.getHandCardPosition=function(t,e){var a=GameConst.CARD_DATA.HAND_CARD[t].offx,n=GameConst.CARD_DATA.HAND_CARD[t].offy,o=GameConst.CARD_DATA.HAND_CARD[t].gapLastX,i=GameConst.CARD_DATA.HAND_CARD[t].gapLastY;GlobalData.gameData.isPlayBack()&&(a=GameConst.CARD_DATA.HAND_CARD[t].playBackOffx,n=GameConst.CARD_DATA.HAND_CARD[t].playBackOffy,o=GameConst.CARD_DATA.HAND_CARD[t].gapPlayBackLastX,i=GameConst.CARD_DATA.HAND_CARD[t].gapPlayBackLastY),e=this.cardLayer.getPongKongTotalCardNum(t)+e;var s=a*e,r=n*e;GameConst.perPlayerTotalCardNum==e+1&&(s+=o,r+=i);var l=GameConst.GAME_ALL_CARD_NODE_POSITION.HAND_CARD[t].x,c=GameConst.GAME_ALL_CARD_NODE_POSITION.HAND_CARD[t].y;return{x:s+l,y:r+c}},a.prototype.showSideCardEffect=function(t){},a.prototype.resetPosition=function(t,e){void 0===e&&(e=0);var a=this.getHandCardPosition(this.dir,t),n=this.cardLayer.getDrawCardIndex(this.dir);if(t==n?this.showSideCardEffect(!0):this.showSideCardEffect(!1),e>0&&(this._canSelect=!1,this.alpha=1,egret.Tween.removeTweens(this)),e==GameConst.HAND_CARD_ACTION_TYPE.MOVE_HORIZONTAL){var o=egret.Tween.get(this,{loop:!1});o.to({x:a.x,y:a.y},200),o.call(function(){this._canSelect=!0})}else if(e==GameConst.HAND_CARD_ACTION_TYPE.INSERT_DRAW_CARD){var i=0,s=0;GlobalData.gameData.isPlayBack()?this.dir==GameConst.ME_DIR?s=-GameConst.CARD_SIZE.HAND_CARD[this.dir].height_playBack:this.dir==GameConst.PLAY_DIR.up?s=GameConst.CARD_SIZE.HAND_CARD[this.dir].height_playBack:this.dir==GameConst.PLAY_DIR.left?i=GameConst.CARD_SIZE.HAND_CARD[this.dir].width_playBack:this.dir==GameConst.PLAY_DIR.right&&(i=-GameConst.CARD_SIZE.HAND_CARD[this.dir].width_playBack):this.dir==GameConst.ME_DIR?s=-GameConst.CARD_SIZE.HAND_CARD[this.dir].height:this.dir==GameConst.PLAY_DIR.up?s=GameConst.CARD_SIZE.HAND_CARD[this.dir].height:this.dir==GameConst.PLAY_DIR.left?i=GameConst.CARD_SIZE.HAND_CARD[this.dir].width:this.dir==GameConst.PLAY_DIR.right&&(i=-GameConst.CARD_SIZE.HAND_CARD[this.dir].width);
var o=egret.Tween.get(this,{loop:!1});o.to({x:this.x+i,y:this.y+s},200),o.to({x:a.x+i,y:a.y+s},200),o.to({x:a.x,y:a.y},200),o.call(function(){this._canSelect=!0})}else if(e==GameConst.HAND_CARD_ACTION_TYPE.DRAW_CARD_ME){this.x=a.x,this.y=a.y-30,this.alpha=.1;var o=egret.Tween.get(this,{loop:!1});o.to({alpha:1,x:a.x,y:a.y},200,egret.Ease.getPowIn(5)),o.call(function(){this._canSelect=!0})}else if(e==GameConst.HAND_CARD_ACTION_TYPE.DRAW_CARD_OTHER){this.x=a.x,this.y=a.y,this.alpha=.1;var o=egret.Tween.get(this,{loop:!1});o.to({alpha:1,x:a.x,y:a.y},100),o.call(function(){this._canSelect=!0})}else this.x=a.x,this.y=a.y},a}(t.BaseCardNode);t.HandCardNode=e,__reflect(e.prototype,"game.HandCardNode")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this,e.dir,e.cardValue,e.idx)||this;return a.params=e,a.skinName=e.nodePath,a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this);var e=this.getPosition(this.dir,this.idx);this.x=e.x,this.y=e.y,this.changeCardBack()},e.prototype.getPosition=function(t,e){var a=GameConst.CARD_DATA.HUA_CARD[t].offx*e,n=GameConst.CARD_DATA.HUA_CARD[t].offy*e,o=GameConst.GAME_ALL_CARD_NODE_POSITION.HUA_CARD[t].x,i=GameConst.GAME_ALL_CARD_NODE_POSITION.HUA_CARD[t].y;return{x:a+o,y:n+i}},e.prototype.changeCardBack=function(){var t="";this.dir==GameConst.PLAY_DIR.right?t="left-peng{0}_png":this.dir==GameConst.PLAY_DIR.left?t="left-peng{0}_png":this.dir==GameConst.PLAY_DIR.up?t="me-hua{0}_png":this.dir==GameConst.PLAY_DIR.down&&(t="me-hua{0}_png");var e=Utils.getCardBack(t);this.back.source=e},e.prototype.setCardValue=function(e){t.prototype.setCardValue.call(this,e);var a=this.getCardFaceImgName(this._value);this.face.source=a},e.prototype.getCardFaceImgName=function(t){var e="";return this.dir==GameConst.PLAY_DIR.down?e=Utils.format("meHua_{0}_png",Utils.getNumberFormatStr(t)):this.dir==GameConst.PLAY_DIR.left||this.dir==GameConst.PLAY_DIR.right?e=Utils.format("leftPeng_{0}_png",Utils.getNumberFormatStr(t)):this.dir==GameConst.PLAY_DIR.up&&(e=Utils.format("meHua_{0}_png",Utils.getNumberFormatStr(t))),e},e}(t.BaseCardNode);t.HuaCardNode=e,__reflect(e.prototype,"game.HuaCardNode")}(game||(game={}));var game;!function(t){var e=function(t){function e(e,a){var n=t.call(this)||this;return n.dir=e,n.value=a,n.skinName="resource/skins/game/card/OutCardEffectSkin.exml",n}return __extends(e,t),e.prototype.onCreateViewComplete=function(){var e=this;t.prototype.onCreateViewComplete.call(this),this.back.source=Utils.getCardBack("me-hand{0}_png"),this.face.source=Utils.format("meHand_{0}_png",Utils.getNumberFormatStr(this.value)),this.x=GameConst.CARD_DATA.EFFECT_OUT_CARD[this.dir].x-this.width/2,this.y=GameConst.CARD_DATA.EFFECT_OUT_CARD[this.dir].y-this.height/2;var a=egret.Tween.get(this);a.wait(300),a.to({alpha:0},100),a.call(function(){e.parent.removeChild(e)})},e}(t.EComponent);t.OutCardEffect=e,__reflect(e.prototype,"game.OutCardEffect")}(game||(game={}));var game;!function(t){var e=function(t){function e(e,a,n,o,i){void 0===i&&(i=null);var s=t.call(this,n,a,o)||this;return s.pos=null,s.skinName=e,s.pos=i,t.prototype.onCreateViewComplete,s}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this);var e=this.pos;null==this.pos&&(e=this.getOutCardPosition(this.dir,this.idx)),this.x=e.x,this.y=e.y,this.changeCardBack()},e.prototype.setCardValue=function(e){t.prototype.setCardValue.call(this,e);var a=this.getCardFaceImgName(e);this.face.source=a},e.prototype.getCardFaceImgName=function(t){var e="";return this.dir==GameConst.PLAY_DIR.down?e=Utils.format("meDachu_{0}_png",Utils.getNumberFormatStr(t)):this.dir==GameConst.PLAY_DIR.left||this.dir==GameConst.PLAY_DIR.right?e=Utils.format("leftDachu_{0}_png",Utils.getNumberFormatStr(t)):this.dir==GameConst.PLAY_DIR.up&&(e=Utils.format("meDachu_{0}_png",Utils.getNumberFormatStr(t))),e},e.prototype.getOutCardPosition=function(t,e){var a=GameConst.CARD_DATA.OUT_CARD[t].offx,n=GameConst.CARD_DATA.OUT_CARD[t].offy,o=GameConst.CARD_DATA.OUT_CARD[t].multiLineXOff,i=GameConst.CARD_DATA.OUT_CARD[t].multiLineYOff,s=0,r=0,l=0,c=0;t==GameConst.PLAY_DIR.down||t==GameConst.PLAY_DIR.up?(s=e%10+1,r=Math.floor(e/10),r>1&&(l=o,c=i,r%=2)):(r=e%10+1,s=Math.floor(e/10),s>1&&(l=o,c=i,s%=2));var u=a*(s-1)+l,h=n*(r-1)+c,d=GameConst.GAME_ALL_CARD_NODE_POSITION.OUT_CARD[t].x,m=GameConst.GAME_ALL_CARD_NODE_POSITION.OUT_CARD[t].y;return{x:u+d,y:h+m}},e.prototype.changeCardBack=function(){var t="";this.dir==GameConst.PLAY_DIR.right?t="left-dachu{0}_png":this.dir==GameConst.PLAY_DIR.left?t="left-dachu{0}_png":this.dir==GameConst.PLAY_DIR.up?t="me-dachu{0}_png":this.dir==GameConst.PLAY_DIR.down&&(t="me-dachu{0}_png");var e=Utils.getCardBack(t);this.back.source=e},e}(t.BaseCardNode);t.OutCardNode=e,__reflect(e.prototype,"game.OutCardNode")}(game||(game={}));var game;!function(t){var e=function(t){function e(e,a,n,o,i){void 0===i&&(i=null);var s=t.call(this,n,0,o)||this;return s.skinName=e,s.pongKongData=a,s.pos=i,s}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.childCardNodes=[this.Node1,this.Node2,this.Node3,this.Node4,this.Node5,this.Node6],this.backs=[this.back1,this.back2,this.back3,this.back4,this.back5,this.back6],this.anGangFaces=[this.anGangFace1,this.anGangFace2,this.anGangFace3,this.anGangFace4],this.faces=[this.face1,this.face2,this.face3,this.face4,this.face5,this.face6];var e=this.pos;null==e&&(e=this.getPosition(this.dir,this.idx,this.pongKongData.getProvideClientId())),this.x=e.x,this.y=e.y,this.setData(this.pongKongData),this.changeCardBack()},e.prototype.setData=function(t){this.pongKongData=t;var e=t.getType(),a=t.getProvideClientId(),n=t.getValue(),o=[0],i=[],s=(this.dir-a+4)%4;0==s||2==s?(o.push(1),o.push(2),i.push(4),i.push(5)):3==s?(o.push(1),o.push(5),i.push(2),i.push(4)):1==s&&(o.push(2),o.push(4),i.push(1),i.push(5));for(var r=0;r<this.faces.length;r++)this.faces[r].source=this.getCardFaceImgName(n,r);if(e==GameConst.GAIN_TYPE.PONG){i.push(3);for(var r=0;r<this.anGangFaces.length;r++)this.anGangFaces[r].visible=!1}else if(e==GameConst.GAIN_TYPE.Exposed||e==GameConst.GAIN_TYPE.PongKong||e==GameConst.GAIN_TYPE.ConcealedKong)if(e==GameConst.GAIN_TYPE.ConcealedKong?(o=[0,1,2,3],i=[4,5]):o.push(3),e==GameConst.GAIN_TYPE.ConcealedKong)for(var r=0;r<this.anGangFaces.length;r++)r<this.anGangFaces.length-1?this.anGangFaces[r].visible=!0:this.anGangFaces[r].visible=!1;else for(var r=0;r<this.anGangFaces.length;r++)this.anGangFaces[r].visible=!1;for(var r=0;r<o.length;r++)this.childCardNodes[o[r]].visible=!0;for(var r=0;r<i.length;r++)this.childCardNodes[i[r]].visible=!1},e.prototype.changeCardBack=function(){var t="",e="",a="";this.dir==GameConst.PLAY_DIR.right?(t="left-peng{0}_png",e="left-angang{0}_png",a="left-peng_dao{0}_png"):this.dir==GameConst.PLAY_DIR.left?(t="left-peng{0}_png",e="left-angang{0}_png",a="left-peng_dao{0}_png"):this.dir==GameConst.PLAY_DIR.up?(t="me-hua{0}_png",e="up-angang{0}_png",a="left-peng{0}_png"):this.dir==GameConst.PLAY_DIR.down&&(t="me-peng{0}_png",e="me-angang{0}_png",a="me-peng_dao{0}_png");for(var n=0;n<this.backs.length;n++)4==n||5==n?this.backs[n].source=Utils.getCardBack(a):this.backs[n].source=Utils.getCardBack(t);for(var n=0;n<this.anGangFaces.length;n++)this.anGangFaces[n].source=Utils.getCardBack(e)},e.prototype.getCardFaceImgName=function(t,e){var a="";return this.dir==GameConst.PLAY_DIR.down?a=4==e||5==e?Utils.format("mePeng_dao_{0}_png",Utils.getNumberFormatStr(t)):Utils.format("mePeng_{0}_png",Utils.getNumberFormatStr(t)):this.dir==GameConst.PLAY_DIR.left||this.dir==GameConst.PLAY_DIR.right?a=4==e||5==e?Utils.format("leftPeng_dao_{0}_png",Utils.getNumberFormatStr(t)):Utils.format("leftPeng_{0}_png",Utils.getNumberFormatStr(t)):this.dir==GameConst.PLAY_DIR.up&&(a=4==e||5==e?Utils.format("leftPeng_{0}_png",Utils.getNumberFormatStr(t)):Utils.format("meHua_{0}_png",Utils.getNumberFormatStr(t))),a},e.prototype.getPosition=function(t,e,a){var n=GameConst.CARD_DATA.PONG_KONG_CARD[t].offx,o=GameConst.CARD_DATA.PONG_KONG_CARD[t].offy,i=n*e,s=o*e,r=(this.dir-a)%4;this.pongKongData.getType()==GameConst.GAIN_TYPE.ConcealedKong&&(r=0),0==r||2==r||(1==r?(i+=GameConst.CARD_DATA.PONG_KONG_CARD[t].dirOffx,s+=GameConst.CARD_DATA.PONG_KONG_CARD[t].dirOffy):3==r&&(i-=GameConst.CARD_DATA.PONG_KONG_CARD[t].dirOffx,s-=GameConst.CARD_DATA.PONG_KONG_CARD[t].dirOffy));var l=GameConst.GAME_ALL_CARD_NODE_POSITION.PONG_KONG_NODE[t].x,c=GameConst.GAME_ALL_CARD_NODE_POSITION.PONG_KONG_NODE[t].y;return{x:i+l,y:s+c}},e.prototype.getData=function(){return this.pongKongData},e.prototype.getCardValue=function(){return this.pongKongData.getValue()},e.prototype.flagSameValueCard=function(){for(var t=[],e=0;e<this.childCardNodes.length;e++)if(this.pongKongData.getType()!=GameConst.GAIN_TYPE.ConcealedKong||5==e){var a=4==e||5==e,n=this.getFlagMaskImgName(a),o=new eui.Image(n);o.x=0,o.y=0,this.childCardNodes[e].addChild(o),t.push(o)}return t},e.prototype.getFlagMaskImgName=function(t){var e=null;return this.dir==GameConst.ME_DIR?e=t?"cover_me-peng_dao_png":"cover_me-peng_png":this.dir==GameConst.PLAY_DIR.left?e=t?"cover_left-peng_dao_png":"cover_left-peng_png":this.dir==GameConst.PLAY_DIR.up?e=t?"cover_left-peng_png":"cover_up-peng_png":this.dir==GameConst.PLAY_DIR.right&&(e=t?"cover_left-peng_dao_png":"cover_left-peng_png"),e},e}(t.BaseCardNode);t.PongKongCardNode=e,__reflect(e.prototype,"game.PongKongCardNode")}(game||(game={}));var game;!function(t){var e=function(e){function a(t,a){var n=e.call(this)||this;return n.value=t,n.x=a.x,n.y=a.y,n.skinName="resource/skins/game/card/PongKongPerNodeSkin.exml",n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this);var a=Utils.format("mePeng_{0}_png",Utils.getNumberFormatStr(this.value));t.LogUtils.info("faceImgName "+a),this.face.source=a,this.back.source=Utils.getCardBack("me-peng{0}_png")},a}(t.EComponent);t.PongKongPerNode=e,__reflect(e.prototype,"game.PongKongPerNode")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this,Constants.UI_PANEL_DATA_SET.discardWinConfirmBox.index,!1)||this;return a.params=e,a.skinName="resource/skins/game/panel/AbandomWinConfirm.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.Button_cancel,this.cancelEvent.bind(this)),this.addTapEvent(this.Button_win,this.winEvent.bind(this)),this.updateUI()},e.prototype.cancelEvent=function(){null!=this.params&&this.params.cancelFun&&this.params.cancelFun(),this.close()},e.prototype.winEvent=function(){null!=this.params&&this.params.confirmFunc&&this.params.confirmFunc(),this.close()},e}(t.EDialog);t.AbandomWinConfirmBox=e,__reflect(e.prototype,"game.AbandomWinConfirmBox")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this,Constants.UI_PANEL_DATA_SET.about.index)||this;return e.skinName="resource/skins/game/panel/AboutBoxSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.Button_close,this.close.bind(this)),this.updateUI()},e.prototype.updateUI_=function(){this.Text_info.text="当前版本："+GameConfig.version},e}(t.EDialog);t.AboutBox=e,__reflect(e.prototype,"game.AboutBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.applyQuit.index,!1)||this;return a.leftSeconds=0,a.data=t,a.skinName="resource/skins/game/panel/applyQuitRoom.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.addTapEvent(this.Button_oppose,this.opposeEvent),this.addTapEvent(this.Button_agree,this.agreeEvent),this.updateUI()},a.prototype.init=function(){this.PlayerNodeSet=[this.Player1,this.Player2,this.Player3,this.Player4],this.playerStatus=[this.Text_playerStatus_1,this.Text_playerStatus_2,this.Text_playerStatus_3,this.Text_playerStatus_4],this.playerNames=[this.Text_playerName_1,this.Text_playerName_2,this.Text_playerName_3,this.Text_playerName_4]},a.prototype.setData=function(t){this.data=t,this.updateUI()},a.prototype.updateTimeLabel=function(){var t="";if(this.leftSeconds>59){var e=Math.floor(this.leftSeconds/60),a=this.leftSeconds%60;t=e+"分"+a+"秒"}else t=this.leftSeconds+"秒";this.Text_time.text=Utils.format("倒计时:{0}",t)},a.prototype.startTime=function(){this.stopTimer(),this.timerId=t.TimerItemManager.getInstance().startTimer(t.TimerItem.TimerType.perSec,1e3*this.leftSeconds,this.timerEvent.bind(this),this)},a.prototype.stopTimer=function(){null!=this.timerId&&(t.TimerItemManager.getInstance().stopTimer(this.timerId),this.timerId=null)},a.prototype.timerEvent=function(){this.leftSeconds=Math.max(0,this.leftSeconds-1),this.updateTimeLabel()},a.prototype.updateUI_=function(){var t=this.data;this.leftSeconds=Math.floor(t.leftTime/1e3),this.updateTimeLabel(),this.startTime(),t.statusList.sort(function(t,e){return t.chairId-e.chairId});for(var e=t.statusList,a=0,n=0;n<GameConst.maxPlayerNum;n++)if(n>=e.length)this.PlayerNodeSet[n].visible=!1;else{this.PlayerNodeSet[n].visible=!0;var o=e[n],i=o.chairId,s=o.userName;this.playerNames[n].text=s;var r=o.agree,l=GameConst.APPLY_QUIT_STATUS.unchosen;r&&(l=GameConst.APPLY_QUIT_STATUS.agree,a+=1),this.setStatus(n,i,l)}a>=e.length&&this.close()},a.prototype.setStatus=function(t,e,a){var n=GlobalData.getCurGameData();e==n.getMyChairId()&&(a==GameConst.APPLY_QUIT_STATUS.apply||a==GameConst.APPLY_QUIT_STATUS.agree?this.Button_agree.enabled=!1:this.Button_agree.enabled=!0);var o=this.playerStatus[t];a==GameConst.APPLY_QUIT_STATUS.unchosen?(o.textColor=Utils.RGBA2Color(152,19,19),o.text="未选择"):a==GameConst.APPLY_QUIT_STATUS.apply||a==GameConst.APPLY_QUIT_STATUS.agree?(o.textColor=Utils.RGBA2Color(45,206,64),o.text="同意"):a==GameConst.APPLY_QUIT_STATUS.reject&&(o.textColor=Utils.RGBA2Color(45,206,64),o.text="不同意")},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.CLOSE_APPLY_QUIT_PANEL&&this.close()},a.prototype.agreeEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_DISMISS_ROOM)},a.prototype.opposeEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_REJECT_DISMISS_ROOM)},a.prototype.close=function(){this.stopTimer(),e.prototype.close.call(this)},a}(t.EDialog);t.ApplyQuitBox=e,__reflect(e.prototype,"game.ApplyQuitBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.changePlayerNumBox.index,!1)||this;return a.params=t,a.skinName="resource/skins/game/panel/changePlayerNum.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.Button_reject,this.rejectEvent.bind(this)),this.addTapEvent(this.Button_agree,this.agreeEvent.bind(this)),"0"==GlobalData.clientConfigs.showCreateRoom&&(this.Text_info.visible=!1),this.updateUI()},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.CLOSE_CHANGE_PLAYERNUM_PANEL&&this.close()},a.prototype.updateUI_=function(){var e=this.params,a=e.statusList;a.sort(function(t,e){return t.chairId-e.chairId});for(var n=a.length,o=0,i=0;n>i;i++){var s=this.getChildByName("playHead"+i);null==s&&(s=new t.ChangePlayerNumNode,s.name="playHead"+i,this.Group_head.addChild(s));var r=207*i,l=0;s.x=r,s.y=l;var c=a[i];s.setData(c);var u=c.agree,h=GameConst.CHANGE_PALYER_NUM_STATUS.unchosen;u&&(o+=1,h=GameConst.CHANGE_PALYER_NUM_STATUS.agree);var d=c.chairId;d==GlobalData.gameData.getMyChairId()&&(h==GameConst.CHANGE_PALYER_NUM_STATUS.apply||h==GameConst.CHANGE_PALYER_NUM_STATUS.agree?this.Button_agree.enabled=!1:this.Button_agree.enabled=!0)}o>=n&&this.close()},a.prototype.setData=function(t){this.params=t,this.updateUI_()},a.prototype.rejectEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_switch_reject)},a.prototype.agreeEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_switch_player_num)},a}(t.EDialog);t.ChangePlayerNumBox=e,__reflect(e.prototype,"game.ChangePlayerNumBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.skinName="resource/skins/game/panel/changePlayerNumInfoNode.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init()},a.prototype.init=function(){this.Image_selected.visible=!1},a.prototype.setData=function(t){this.data=t,this.updateUI_()},a.prototype.updateUI_=function(){var e=this,a=this.data,n=(a.chairId,a.userName);this.Text_userName.text=n;var o=a.headImgUrl;t.ResManager.loadWebImage(o,function(t){e.Image_head.texture=t,e.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){e.Image_head.texture=t},e)},this);var i=a.agree,s=GameConst.CHANGE_PALYER_NUM_STATUS.unchosen;i&&(s=GameConst.CHANGE_PALYER_NUM_STATUS.agree),s==GameConst.CHANGE_PALYER_NUM_STATUS.unchosen||s==GameConst.CHANGE_PALYER_NUM_STATUS.reject?this.Image_selected.visible=!1:(s==GameConst.CHANGE_PALYER_NUM_STATUS.apply||s==GameConst.CHANGE_PALYER_NUM_STATUS.agree)&&(this.Image_selected.visible=!0)},a}(t.EComponent);t.ChangePlayerNumNode=e,__reflect(e.prototype,"game.ChangePlayerNumNode")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.serverTimeDelta=0,this.eventDispatcher=new egret.EventDispatcher}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.sendNotification=function(t,e){void 0===e&&(e=null),this.notificationAll(t,e)},t.prototype.registerCommand=function(t,e,a){this.eventDispatcher.addEventListener(t,e,a)},t.prototype.removeCommand=function(t,e,a){this.eventDispatcher.removeEventListener(t,e,a)},t.prototype.notificationAll=function(t,e){this.eventDispatcher.dispatchEvent(new egret.Event(t,!1,!1,e))},t.prototype.getNowTime=function(){return(new Date).getTime()+this.serverTimeDelta},t.prototype.updateServerTime=function(t){this.serverTimeDelta=t-(new Date).getTime()},t.prototype.startUp=function(){},t}();t.EAppFacade=e,__reflect(e.prototype,"game.EAppFacade");var a=function(){function t(t,e){this.fun=t,this.thisObject=e}return t}();__reflect(a.prototype,"valueObject")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.chatBox.index)||this;return t.skinName="resource/skins/game/panel/GameChatBoxSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI()},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.CLOSE_CHAT_BOX_PANEL&&this.close()},a.prototype.updateUI_=function(){this.listLeft.clearContent(),this.leftListData=[];for(var t=0;t<GameConst.CHAT_EMOTION_NAME.length;t++){var e=Math.floor(t/3);null==this.leftListData[e]&&(this.leftListData[e]=[]),this.leftListData[e].push({index:t,emotionName:GameConst.CHAT_EMOTION_NAME[t]})}this.listLeft.setScrollerContent(this.leftListData),this.listRight.clearContent();var a=Strings.chatText;GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.standard&&(a=Strings.chatText_standard),this.rightListData=[];for(var t=0;t<a.length;t++)this.rightListData.push({index:t,text:a[t]});this.listRight.setScrollerContent(this.rightListData)},a.prototype.init=function(){this.initLeftScroller(),this.initRightScroller()},a.prototype.initLeftScroller=function(){this.listLeft.setElementViewInfo(136,0),this.listLeft.setElementCreateFunction(this.createLeftElement.bind(this)),this.listLeft.setElementUpdateDataFun(this.updateLeftElement.bind(this)),this.listLeft.setElementUpdateUIFun(this.updateLeftElementUI.bind(this))},a.prototype.createLeftElement=function(e){var a=new t.GameChatEmotionItem(e);return a},a.prototype.updateLeftElement=function(t,e){t.setData(e)},a.prototype.updateLeftElementUI=function(t){t.updateUI()},a.prototype.initRightScroller=function(){this.listRight.setElementViewInfo(69,0),this.listRight.setElementCreateFunction(this.createRightElement.bind(this)),this.listRight.setElementUpdateDataFun(this.updateRightElement.bind(this)),this.listRight.setElementUpdateUIFun(this.updateRightElementUI.bind(this))},a.prototype.createRightElement=function(e){var a=new t.GameChatTextItem(e);return a},a.prototype.updateRightElement=function(t,e){t.setData(e)},a.prototype.updateRightElementUI=function(t){t.updateUI()},a.sendChatMsg=function(e,a){var n=GlobalData.getCurGameData();n.canSendChatMsg()?(n.getGameStatus()!=GameConst.GAME_STATUS_TYPE.allOver&&(n.updateSendChatTime(),t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_SEND_MSG,{type:e,msgId:a})),Utils.sendPanelEvent(t.GameCmd.CLOSE_CHAT_BOX_PANEL)):t.CommonView.showToast(Strings.tooShortTime)},a}(t.EDialog);t.GameChatBox=e,__reflect(e.prototype,"game.GameChatBox")}(game||(game={}));var GameChatEmotion=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/GameChatBoxEmotionSkin.exml",e}return __extends(e,t),e.prototype.setData=function(t){this.data=t,this.setSelected(!1),this.updateUI()},e.prototype.updateUI_=function(){this.Image_emotion.source=this.data.emotionName+"_png"},e.prototype.setSelected=function(t){this.Image_bg.visible=t},e.prototype.sendMsg=function(){game.LogUtils.info("发送表情"+this.data.index),game.GameChatBox.sendChatMsg(GameConst.CHAT_MSG_TYPE.EMOTION,this.data.index+1)},e}(game.EComponent);__reflect(GameChatEmotion.prototype,"GameChatEmotion"),window.GameChatEmotion=GameChatEmotion;var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.itemData=e,a.skinName="resource/skins/game/panel/GameChatBoxEmotionItemSkin.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.emotionSet=[this.emotion1,this.emotion2,this.emotion3];for(var e=0;e<this.emotionSet.length;e++)this.emotionSet[e].addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginEvent,this),this.emotionSet[e].addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchEndEvent,this),this.emotionSet[e].addEventListener(egret.TouchEvent.TOUCH_END,this.touchEndEvent,this),this.emotionSet[e].addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEndEvent,this),this.emotionSet[e].addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMsg,this);this.updateUI()},e.prototype.sendMsg=function(t){var e=t.currentTarget;e instanceof GameChatEmotion&&e.sendMsg()},e.prototype.touchBeginEvent=function(t){var e=t.currentTarget;e instanceof GameChatEmotion&&e.setSelected(!0)},e.prototype.touchEndEvent=function(t){var e=t.currentTarget;e instanceof GameChatEmotion&&e.setSelected(!1)},e.prototype.setData=function(t){this.itemData=t,this.updateUI()},e.prototype.updateUI_=function(){for(var t=0;t<this.emotionSet.length;t++){var e=this.itemData[t];null==e?this.emotionSet[t].visible=!1:this.emotionSet[t].setData(e)}},e}(t.EComponent);t.GameChatEmotionItem=e,__reflect(e.prototype,"game.GameChatEmotionItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.itemData=t,a.skinName="resource/skins/game/panel/GameChatTextItemSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.setSelected(!1),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBeginEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchEndEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEndEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchEndEvent,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.sendMsg,this),this.updateUI()},a.prototype.sendMsg=function(){t.LogUtils.info("发送文字"+this.itemData.index),t.GameChatBox.sendChatMsg(GameConst.CHAT_MSG_TYPE.TEXT,this.itemData.index+1)},a.prototype.touchBeginEvent=function(){this.setSelected(!0)},a.prototype.touchEndEvent=function(){this.setSelected(!1)},a.prototype.setData=function(t){this.itemData=t,this.updateUI()},a.prototype.updateUI_=function(){this.Text_info.text=this.itemData.text},a.prototype.setSelected=function(t){this.Image_bg.visible=t},a}(t.EComponent);t.GameChatTextItem=e,__reflect(e.prototype,"game.GameChatTextItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){void 0===t&&(t=null);var a=e.call(this,Constants.UI_PANEL_DATA_SET.gameOverBox.index,!1)||this;return a.params=t,a.skinName="resource/skins/game/panel/GameOverResultSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.UserSet=[this.User1,this.User2,this.User3,this.User4],this.addTapEvent(this.Button_back,this.backEvent),this.addTapEvent(this.Button_share2All,this.share2AllEvent.bind(this)),this.addTapEvent(this.Button_share2Friend,this.share2FriendEvent.bind(this)),this.updateUI()},a.prototype.share2FriendEvent=function(){var e=new t.ShareOverResultView(GlobalData.gameData.getAllOverData());t.DialogManager.getInstance().show(e)},a.prototype.share2AllEvent=function(){},a.prototype.updateUI_=function(){var e=this;this.Button_direct2App.visible=!1;var a=GlobalData.gameData.getAllOverData(),n=Utils.format("http://api.k780.com:88/?app=qr.get&data={0}&level=H&size=15","http://www.baidu.com");t.ResManager.loadWebImage(n,function(t){e.Image_qrcode.texture=t,e.Image_qrcode.addEventListener(eui.UIEvent.COMPLETE,function(){e.Image_qrcode.texture=t},e)},this),null!=a.clubName?(this.Text_club.visible=!0,this.Text_club.text="俱乐部名称："+a.clubName):this.Text_club.visible=!1,this.Text_roomNumber.text="房间号："+a.msgRoom.roomNumber,this.Text_data.text=t.DateUtils.dateFormat(a.time),this.Image_roomType.source="img_nj_settle_jinyuanzi_png",a.msgRoom.roomType==Constants.ROOM_TYPE.jinYuanZi?this.Image_roomType.source="img_nj_settle_jinyuanzi_png":a.msgRoom.roomType==Constants.ROOM_TYPE.changKaiTou&&(this.Image_roomType.source="img_nj_settle_changkaihuai_png"),a.msgRoom.turnMode==Constants.ROOM_TIME_MODE.ba?this.Text_turnNumber.text=Utils.format("把数：{0}/{1}",a.curTurnNum,a.msgRoom.turnNumber):a.msgRoom.turnMode==Constants.ROOM_TIME_MODE.quan&&(null==a.curTurnDirection?this.Text_turnNumber.text=Utils.format("圈数：{0}/{0}",a.curTurnNum,a.msgRoom.turnNumber):this.Text_turnNumber.text=Utils.format("圈数：{0} {1}/{2}",GameConst.DIRECT_DESC[a.curTurnDirection],a.curTurnNum,a.msgRoom.turnNumber));for(var o=a.userInfoList,i=0;i<this.UserSet.length;i++)i>=o.length?this.UserSet[i].visible=!1:(this.UserSet[i].visible=!0,this.UserSet[i].setData(i+1,o[i]))},a.prototype.backEvent=function(){return null!=this.params&&this.params.isFromReplay?void this.close():(this.close(),void(GlobalData.gameData.getRoomInfo().isClubRoom()?t.SceneSkip.skipToClubScene():t.SceneSkip.skipToHallScene()))},a}(t.EDialog);t.GameOverBox=e,__reflect(e.prototype,"game.GameOverBox")}(game||(game={}));var GameOverUserItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/GameOverUserItemSkin.exml",e}return __extends(e,t),e.prototype.setData=function(t,e){this.orderNumner=t,this.data=e,this.updateUI()},e.prototype.updateUI_=function(){var t=this;this.Image_bg.source="btn_nj_settle_rankbg_"+this.orderNumner+"_png",this.Image_baomi.visible=this.data.baoMi,this.Image_homer.visible=this.data.master,this.Image_myself.visible=this.data.userId==GlobalData.userData.getUserId(),game.ResManager.loadWebImage(this.data.headImgUrl,function(e){t.Image_head.texture=e,t.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){t.Image_head.texture=e},t)},this),this.Text_userName.text=this.data.userName,this.Text_userId.text=this.data.userId,this.data.score>=0?(this.Text_score.text="+"+this.data.score,this.Text_score.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_score.text=this.data.score,this.Text_score.textColor=Utils.RGBA2Color(136,180,243)),this.data.waibaoFen>=0?(this.Text_score_wb.text="+"+this.data.waibaoFen,this.Text_score_wb.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_score_wb.text=this.data.waibaoFen,this.Text_score_wb.textColor=Utils.RGBA2Color(136,180,243)),null!=this.data.showCalNum&&this.data.showCalNum?(this.Text_count.visible=!0,this.data.calNum>=0?(this.Text_count.text="+"+this.data.calNum,this.Text_count.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_count.text=this.data.calNum,this.Text_count.textColor=Utils.RGBA2Color(136,180,243))):this.Text_count.visible=!1},e}(game.EComponent);__reflect(GameOverUserItem.prototype,"GameOverUserItem"),window.GameOverUserItem=GameOverUserItem;var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.GameScoreBoard.index,!1)||this;return t.skinName="resource/skins/game/panel/gameScoreBoard.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.Button_close,this.close.bind(this)),this.initUI(),this.initScroller(),t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_GET_SCORECARD_INFOS)},a.prototype.onEventHandler=function(a){if(e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.UPDATE_GAEMSCORE_BOARD){if(this.scoreBoardData=this.eventData,this.itemListData=[],this.scoreBoardData.length>0)for(var n=0;n<this.scoreBoardData[0].scoreInfos.length;n++){null==this.itemListData[n]&&(this.itemListData[n]={}),this.itemListData[n].order=n+1;for(var o=0;o<this.scoreBoardData.length;o++){var i=this.scoreBoardData[o].scoreInfos;null==this.itemListData[n].infos&&(this.itemListData[n].infos=[]),null==this.itemListData[n].infos[o]&&(this.itemListData[n].infos[o]={}),this.itemListData[n].infos[o].score=i[n].score,this.itemListData[n].infos[o].waibaoScore=i[n].waibaoScore}}this.updateUI()}},a.prototype.initUI=function(){this.PlayerNameSet=[this.PlayerName1,this.PlayerName2,this.PlayerName3,this.PlayerName4];for(var t in this.PlayerNameSet)this.PlayerNameSet[t].visible=!1;this.totalScoreSet=[this.totalScore1,this.totalScore2,this.totalScore3,this.totalScore4];for(var t in this.totalScoreSet)this.totalScoreSet[t].visible=!1},a.prototype.updateUI_=function(){for(var t in this.scoreBoardData){var e=this.scoreBoardData[t];this.PlayerNameSet[t].visible=!0,this.totalScoreSet[t].visible=!0,this.PlayerNameSet[t].text=e.nickNames,this.totalScoreSet[t].setData(e.totalScores,e.waibaoTotalScores)}this.itemList.clearContent(),this.itemList.setScrollerContent(this.itemListData)},a.prototype.initScroller=function(){this.itemList.setElementViewInfo(72,0),this.itemList.setElementCreateFunction(this.createElement.bind(this)),this.itemList.setElementUpdateDataFun(this.updateElement.bind(this)),this.itemList.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(t){var e=new GameScoreBoardItem(t);return e},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a}(t.EDialog);t.GameScoreBoardBox=e,__reflect(e.prototype,"game.GameScoreBoardBox")}(game||(game={}));var GameScoreBoardItem=function(t){function e(e){var a=t.call(this)||this;return a.itemData=e,a.skinName="resource/skins/game/panel/gameScoreBoardItem.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.scoreSet=[this.score1,this.score2,this.score3,this.score4];for(var e in this.scoreSet)this.scoreSet[parseInt(e)].visible=!1;this.updateUI()},e.prototype.setData=function(t){this.itemData=t,this.updateUI()},e.prototype.updateUI_=function(){this.Text_order.text=this.itemData.order;for(var t in this.itemData.infos){var e=parseInt(t),a=this.itemData.infos[e];
this.scoreSet[e].visible=!0,this.scoreSet[e].setData(a.score,a.waibaoScore)}},e}(game.EComponent);__reflect(GameScoreBoardItem.prototype,"GameScoreBoardItem");var GameScoreBoardScoreUnit=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/gameScoreBoardScoreUnit.exml",e}return __extends(e,t),e.prototype.setData=function(t,e){void 0===e&&(e=0),this.score=t,this.score_wb=e,this.updateUI()},e.prototype.updateUI_=function(){this.score>0?(this.Text_score.textColor=Utils.RGBA2Color(255,94,0),this.Text_score.text="+"+this.score):(this.Text_score.textColor=Utils.RGBA2Color(51,102,174),this.Text_score.text=""+this.score),null==this.score_wb||0==this.score_wb?this.Group_wb.visible=!1:(this.Group_wb.visible=!0,this.score_wb>0?(this.Text_score_wb.textColor=Utils.RGBA2Color(255,94,0),this.Text_score_wb.text="+"+this.score_wb):(this.Text_score_wb.textColor=Utils.RGBA2Color(51,102,174),this.Text_score_wb.text=""+this.score_wb))},e}(game.EComponent);__reflect(GameScoreBoardScoreUnit.prototype,"GameScoreBoardScoreUnit"),window.GameScoreBoardScoreUnit=GameScoreBoardScoreUnit;var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.gameSetting.index)||this;return t.skinName="resource/skins/game/panel/GameSettingBox.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI()},a.prototype.init=function(){var e=this;this.addTapEvent(this.Button_close,this.close),this.addTapEvent(this.Button_music_status,function(){var a=t.SoundService.getInstance().getBgMusicSwitch();e.Button_music_status.selected=a,t.SoundService.getInstance().setBgMusicSwitch(!a),a?t.SoundService.getInstance().pauseBgMusic():t.SoundService.getInstance().playMusic(),e.updateMusic()}),this.addTapEvent(this.Button_sound_status,function(){var a=t.SoundService.getInstance().getAudioSwitch();t.SoundService.getInstance().setAudioSwitch(!a),e.updateSound()}),this.addTapEvent(this.Button_flower_status,function(){var a=GlobalData.gameData.getFlowerCardVisible();GlobalData.gameData.setFlowerCardVisible(!a),Utils.sendGameEvent(t.GameCmd.FLOWER_VISIBLE),e.updateFlower()}),this.addTapEvent(this.Button_clickType_status,function(){var t=GlobalData.gameData.getClickCardType();t==GameConst.CLICK_CARD_TYPE.click?t=GameConst.CLICK_CARD_TYPE.doubleClick:t==GameConst.CLICK_CARD_TYPE.doubleClick&&(t=GameConst.CLICK_CARD_TYPE.click),GlobalData.gameData.setClickType(t),e.updateClickCardType()}),this.addTapEvent(this.Group_local,function(){GameConst.sound_type=GameConst.SOUND_TYPE_ENUM.nanjing,DataStorage.writeLocalData(LocalStorage.setting.Sound_type,""+GameConst.sound_type),e.updateLocalLanguage()}),this.addTapEvent(this.Group_standrad,function(){GameConst.sound_type=GameConst.SOUND_TYPE_ENUM.standard,DataStorage.writeLocalData(LocalStorage.setting.Sound_type,""+GameConst.sound_type),e.updateLocalLanguage()}),this.addTapEvent(this.Group_CardBg1,function(){GameConst.card_back_index=0,DataStorage.writeLocalData(LocalStorage.setting.Card_back_index,""+GameConst.card_back_index),Utils.sendGameEvent(t.GameCmd.CHANGE_CARD_BACK),e.updateCardBg()}),this.addTapEvent(this.Group_CardBg2,function(){GameConst.card_back_index=1,DataStorage.writeLocalData(LocalStorage.setting.Card_back_index,""+GameConst.card_back_index),Utils.sendGameEvent(t.GameCmd.CHANGE_CARD_BACK),e.updateCardBg()}),this.addTapEvent(this.Group_CardBg3,function(){GameConst.card_back_index=2,DataStorage.writeLocalData(LocalStorage.setting.Card_back_index,""+GameConst.card_back_index),Utils.sendGameEvent(t.GameCmd.CHANGE_CARD_BACK),e.updateCardBg()}),this.addTapEvent(this.Group_deskFrame,function(){var a=DataStorage.readLocalData(LocalStorage.setting.Game_bg_frame,"1");"1"==a?DataStorage.writeLocalData(LocalStorage.setting.Game_bg_frame,"0"):DataStorage.writeLocalData(LocalStorage.setting.Game_bg_frame,"1"),Utils.sendGameEvent(t.GameCmd.CHANGE_GAME_BG_FRAME),e.updateDeskFrame()}),this.addTapEvent(this.Group_deskBg1,function(){GameConst.game_bg_index=0,DataStorage.writeLocalData(LocalStorage.setting.Game_bg_index,""+GameConst.game_bg_index),Utils.sendGameEvent(t.GameCmd.CHANGE_GAME_BG),e.updateDeskBg()}),this.addTapEvent(this.Group_deskBg2,function(){GameConst.game_bg_index=1,DataStorage.writeLocalData(LocalStorage.setting.Game_bg_index,""+GameConst.game_bg_index),Utils.sendGameEvent(t.GameCmd.CHANGE_GAME_BG),e.updateDeskBg()}),this.addTapEvent(this.Group_deskBg3,function(){GameConst.game_bg_index=2,DataStorage.writeLocalData(LocalStorage.setting.Game_bg_index,""+GameConst.game_bg_index),Utils.sendGameEvent(t.GameCmd.CHANGE_GAME_BG),e.updateDeskBg()})},a.prototype.updateUI_=function(){this.updateUserInfo(),this.updateMusic(),this.updateSound(),this.updateFlower(),this.updateClickCardType(),this.updateLocalLanguage(),this.updateCardBg(),this.updateDeskFrame(),this.updateDeskBg()},a.prototype.updateUserInfo=function(){var e=this,a=GlobalData.userData.getHeadIMGUrl();t.ResManager.loadWebImage(a,function(t){e.Image_head.texture=t,e.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){e.Image_head.texture=t},e)},this),this.Text_userName.text=GlobalData.userData.getUserName(),this.Text_userId.text="ID:"+GlobalData.userData.getUserId()},a.prototype.updateMusic=function(){var e=t.SoundService.getInstance().getBgMusicSwitch();e?this.Button_music_status.selected=!0:this.Button_music_status.selected=!1},a.prototype.updateSound=function(){var e=t.SoundService.getInstance().getAudioSwitch();e?this.Button_sound_status.selected=!0:this.Button_sound_status.selected=!1},a.prototype.updateFlower=function(){var t=GlobalData.gameData.getFlowerCardVisible();t?this.Button_flower_status.selected=!0:this.Button_flower_status.selected=!1},a.prototype.updateClickCardType=function(){var t=GlobalData.gameData.getClickCardType();t==GameConst.CLICK_CARD_TYPE.click?this.Button_clickType_status.selected=!0:t==GameConst.CLICK_CARD_TYPE.doubleClick&&(this.Button_clickType_status.selected=!1)},a.prototype.updateLocalLanguage=function(){GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.nanjing?(this.CheckBox_local.selected=!0,this.CheckBox_standrad.selected=!1):GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.standard&&(this.CheckBox_standrad.selected=!0,this.CheckBox_local.selected=!1)},a.prototype.updateCardBg=function(){this.CheckBox_cardBg_1.selected=0==GameConst.card_back_index,this.CheckBox_cardBg_2.selected=1==GameConst.card_back_index,this.CheckBox_cardBg_3.selected=2==GameConst.card_back_index},a.prototype.updateDeskFrame=function(){var t=DataStorage.readLocalData(LocalStorage.setting.Game_bg_frame,"1");this.CheckBox_deskFrame.selected="1"==t},a.prototype.updateDeskBg=function(){this.CheckBox_deskBg1.selected=0==GameConst.game_bg_index,this.CheckBox_deskBg2.selected=1==GameConst.game_bg_index,this.CheckBox_deskBg3.selected=2==GameConst.game_bg_index},a}(t.EDialog);t.GameSettingBox=e,__reflect(e.prototype,"game.GameSettingBox")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.data=e,a.skinName="resource/skins/game/panel/GameSettleWinnerFanItemSkin.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.Text_fanSet=[this.Text_fan1,this.Text_fan2,this.Text_fan3],this.Group_fanSet=[this.Group_fan1,this.Group_fan2,this.Group_fan3],this.updateUI()},e.prototype.setData=function(t){this.data=t,this.updateUI()},e.prototype.updateUI_=function(){for(var t=0;t<this.Group_fanSet.length;t++)null==this.data[t]?this.Group_fanSet[t].visible=!1:(this.Group_fanSet[t].visible=!0,this.Text_fanSet[t].text=this.data[t])},e}(t.EComponent);t.GameSettleFanItem=e,__reflect(e.prototype,"game.GameSettleFanItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.GameSettle_auto1.index,!1)||this;if(a.totalCountdownTimeNumber=10,a.curCountdownTime=10,a.overType=-1,a.overData=t,a.overType=-1,0==parseInt(t.winPlayerNum))a.overType=-2;else for(var n=0;n<t.xJSUserInfos.length;n++)if(t.xJSUserInfos[n].msgUser.userId==GlobalData.userData.getUserId()&&t.xJSUserInfos[n].superPointType>0&&t.xJSUserInfos[n].superPointType<=15){a.overType=n;break}return-1==a.overType?a.skinName="resource/skins/game/panel/GameSettle_auto1.exml":-2==a.overType?a.skinName="resource/skins/game/panel/GameSettle_auto2.exml":a.overType>=0&&(a.skinName="resource/skins/game/panel/GameSettle_auto3.exml"),a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI()},a.prototype.init=function(){var e=this;this.UserInfoSet=[this.UserInfo1,this.UserInfo2,this.UserInfo3,this.UserInfo4],this.addTapEvent(this.Button_continue,this.continueEvent),this.addTapEvent(this.Button_quicklook,this.quickLookEvent),this.addTapEvent(this.Button_share,this.shareEvent),this.addTapEvent(this.Button_copyReplayId,this.copyReplayIdEvent.bind(this)),this.curCountdownTime=this.totalCountdownTimeNumber;var a=Utils.format("http://api.k780.com:88/?app=qr.get&data={0}&level=L&size=8","http://www.baidu.com");t.ResManager.loadWebImage(a,function(t){e.Image_qrcode.texture=t,e.Image_qrcode.addEventListener(eui.UIEvent.COMPLETE,function(){e.Image_qrcode.texture=t},e)},this)},a.prototype.copyReplayIdEvent=function(){console.log("拷贝回放码"+this.overData.replayId),Utils.copyToClipboard(""+this.overData.replayId),console.log("拷贝成功")},a.prototype.timerEventHandler=function(t){var e=t.data;this.curCountdownTime=Math.floor(e.leftTime/1e3),this.updateCountdownTime(),this.curCountdownTime<=0&&(this.overData.roomStatus==GameConst.GAME_STATUS_TYPE.over?this.continueEvent():this.overData.roomStatus==GameConst.GAME_STATUS_TYPE.allOver&&this.quickLookEvent())},a.prototype.updateCountdownTime=function(){this.Text_continue_countdown.text=Utils.format("({0})",this.curCountdownTime),this.Text_quicklook_countdown.text=Utils.format("{0}",this.curCountdownTime)},a.prototype.updateUI_=function(){this.updateCountdownTime();var e=this.overData;if(GlobalData.gameData.isPlayBack())this.Group_quick.visible=!1,this.Group_continue.visible=!1;else{this.startTimer(),this.Group_quick.visible=!1,this.Group_continue.visible=!1;var a=e.roomStatus;a==GameConst.GAME_STATUS_TYPE.over?this.Group_continue.visible=!0:a==GameConst.GAME_STATUS_TYPE.allOver&&(this.Group_quick.visible=!0)}if(this.overType>=0)this.winnerInfo.setData(e.xJSUserInfos[0],e.bankerChairId),this.Image_title.source=Utils.format("img_nj_settle_wordtitle_{0}_png",e.xJSUserInfos[this.overType].superPointType),this.showWinnerCard(e.xJSUserInfos[0].heapInfos),this.showWinnerScore(e.xJSUserInfos[0]);else if(-1==this.overType){this.showWinnerCard(e.xJSUserInfos[0].heapInfos),this.winnerInfo.setData(e.xJSUserInfos[0],e.bankerChairId),this.showWinnerScore(e.xJSUserInfos[0]);for(var n=1;n<this.UserInfoSet.length;n++){var o=n-1;if(n>=e.xJSUserInfos.length)this.UserInfoSet[o].visible=!1;else{this.UserInfoSet[o].visible=!0;var i=this.getHeadFlagValue(o,e.xJSUserInfos[n].win);this.UserInfoSet[o].setData(e.xJSUserInfos[n],i)}}}else if(-2==this.overType){var s=e.liuJuType;4==s&&(s=1),this.Image_title.source=Utils.format("img_nj_settle_liujutitle_{0}_png",s);for(var n=0;n<this.UserInfoSet.length;n++)if(n>=e.xJSUserInfos.length)this.UserInfoSet[n].visible=!1;else{this.UserInfoSet[n].visible=!0;var i=this.getHeadFlagValue(n,e.xJSUserInfos[n].win);this.UserInfoSet[n].setData(e.xJSUserInfos[n],i)}}this.Text_date.text=t.DateUtils.dateFormat(e.time),this.Text_replayId.text=""+e.replayId},a.prototype.showWinnerCard=function(e){if(null!=e){var a=0,n=.7;this.Group_winner_card.scaleX=n,this.Group_winner_card.scaleY=n;for(var o=!1,i=0;i<e.length;i++){var s=e[i],r=s.gain;if(r){var l=GameConst.GAIN_TYPE.PONG;4==s.tileIds.length&&(l=0==s.direction?GameConst.GAIN_TYPE.ConcealedKong:GameConst.GAIN_TYPE.Exposed);var c={type:l,provideClientId:s.direction,value:s.tileIds[0]},u=new t.PongKongData(c),h=Constants.UI_GAME_CSB_PATH+GameConst.CARD_DATA.PONG_KONG_CARD[GameConst.ME_DIR].path,d=240;(s.direction==GameConst.ME_DIR||s.direction==GameConst.PLAY_DIR.up)&&(d=230,a-=10),s.direction==GameConst.PLAY_DIR.right?(d=240,a-=10):s.direction==GameConst.PLAY_DIR.left&&(d=230);var m={x:a,y:0},p=new t.PongKongCardNode(h,u,GameConst.ME_DIR,0,m);this.Group_winner_card.addChild(p),a+=d,a+=5,o=!0}else{for(var g=0;g<s.tileIds.length;g++){var h=Constants.UI_GAME_CSB_PATH+GameConst.CARD_DATA.OUT_CARD[GameConst.ME_DIR].path;o&&(o=!1,a+=10);var m={x:a,y:0},C=new t.PongKongPerNode(s.tileIds[0],m);this.Group_winner_card.addChild(C),a+=74}a+=5}}}},a.prototype.showWinnerScore=function(t){this.Text_winner_score.text="+"+t.curScore;var e=t.faScore;0!=e?(this.Group_winner_fafen.visible=!0,t.faScore>0?this.Text_winner_fafen.text="+"+t.faScore:this.Text_winner_fafen.text=""+t.faScore):this.Group_winner_fafen.visible=!1;var a=t.waibaoScore;0!=a?(this.Group_winner_wb.visible=!0,t.waibaoScore>0?this.Text_winner_wb.text="+"+t.waibaoScore:this.Text_winner_wb.text=""+t.waibaoScore):this.Group_winner_wb.visible=!1},a.prototype.getHeadFlagValue=function(t,e){var a={genhu:!1,sanbao:!1,doublekill:!1,bankerChairId:this.overData.bankerChairId};1!=t&&this.overData.winPlayerNum>1&&e&&(a.genhu=!0);var n=this.overData.xJSUserInfos[t].curScore;return 1!=t&&0>n&&this.overData.baoPai&&(a.sanbao=!0),1!=t&&this.overData.winPlayerNum>1&&0>n&&(a.doublekill=!0),a},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.CLOSE_GAME_SETTLE_PANEL&&(this.close(),GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.playing&&(GlobalData.gameData.setGameStatus(GameConst.GAME_STATUS_TYPE.waiting),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED)))},a.prototype.quickLookEvent=function(){this.close();var e=GlobalData.gameData.getAllOverData();null!=e&&(t.GameDataService.getInstance().isGameOverTimeOut=!0,t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.gameOverBox.index))},a.prototype.continueEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_READY_FOR_NEXT)},a.prototype.shareEvent=function(){},a.prototype.startTimer=function(){this.stopTimer(),this.tickScheduler=t.TimerItemManager.getInstance().startTimer(t.TimerItem.TimerType.perSec,1e3*this.totalCountdownTimeNumber,this.timerEventHandler,this)},a.prototype.stopTimer=function(){null!=this.tickScheduler&&(t.TimerItemManager.getInstance().stopTimer(this.tickScheduler),this.tickScheduler=null)},a.prototype.close=function(){this.stopTimer(),e.prototype.close.call(this)},a}(t.EDialog);t.GameSettleNormal=e,__reflect(e.prototype,"game.GameSettleNormal")}(game||(game={}));var GameSettleUserInfo=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/GameSette_UserInfoSkin.exml",e}return __extends(e,t),e.prototype.setData=function(t,e){this.data=t,this.bankerChairId=e.bankerChairId,this.sanbao=e.sanbao,this.doublekill=e.doublekill,this.genhu=e.genhu,this.updateUI()},e.prototype.updateUI_=function(){var t=this;game.ResManager.loadWebImage(this.data.msgUser.headImgUrl,function(e){t.Image_head.texture=e,t.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){t.Image_head.texture=e},t)},this),this.Image_myself.visible=GlobalData.userData.getUserId()==this.data.msgUser.userId,this.Image_homer.visible=!1,this.Image_banker.visible=this.bankerChairId==this.data.userChairId,this.Text_userName.text=this.data.msgUser.nickName,this.data.curScore>0?(this.Text_score.text="+"+this.data.curScore,this.Text_score.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_score.text=this.data.curScore,this.Text_score.textColor=Utils.RGBA2Color(136,180,243)),this.data.faScore>0?(this.Text_fafen.text="+"+this.data.faScore,this.Text_fafen.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_fafen.text=this.data.faScore,this.Text_fafen.textColor=Utils.RGBA2Color(136,180,243)),this.data.waibaoScore>0?(this.Text_wb.text="+"+this.data.waibaoScore,this.Text_wb.textColor=Utils.RGBA2Color(255,197,0)):(this.Text_wb.text=this.data.waibaoScore,this.Text_wb.textColor=Utils.RGBA2Color(136,180,243)),this.Image_sanbao.visible=this.sanbao,this.Image_yipaoduoxiang.visible=this.doublekill,this.Image_genhu.visible=this.genhu,this.showCard(this.data.heapInfos)},e.prototype.showCard=function(t){if(null!=t){var e=0,a=.6;this.cardGroup.scaleX=a,this.cardGroup.scaleY=a;for(var n=!1,o=0;o<t.length;o++){var i=t[o],s=i.gain;if(s){var r=GameConst.GAIN_TYPE.PONG;4==i.tileIds.length&&(r=0==i.direction?GameConst.GAIN_TYPE.ConcealedKong:GameConst.GAIN_TYPE.Exposed);var l={type:r,provideClientId:i.direction,value:i.tileIds[0]},c=new game.PongKongData(l),u=Constants.UI_GAME_CSB_PATH+GameConst.CARD_DATA.PONG_KONG_CARD[GameConst.ME_DIR].path,h=240;(i.direction==GameConst.ME_DIR||i.direction==GameConst.PLAY_DIR.up)&&(h=230,e-=10),i.direction==GameConst.PLAY_DIR.right?(h=240,e-=10):i.direction==GameConst.PLAY_DIR.left&&(h=230);var d={x:e,y:0},m=new game.PongKongCardNode(u,c,GameConst.ME_DIR,0,d);this.cardGroup.addChild(m),e+=h,e+=5,n=!0}else{for(var p=0;p<i.tileIds.length;p++){var u=Constants.UI_GAME_CSB_PATH+GameConst.CARD_DATA.OUT_CARD[GameConst.ME_DIR].path;n&&(n=!1,e+=10);var d={x:e,y:0},g=new game.PongKongPerNode(i.tileIds[p],d);this.cardGroup.addChild(g),e+=74}e+=5}}}},e}(game.EComponent);__reflect(GameSettleUserInfo.prototype,"GameSettleUserInfo"),window.GameSettleUserInfo=GameSettleUserInfo;var GameSettleWinerInfo=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/GameSettleWinerInfoSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.initScroller()},e.prototype.initScroller=function(){this.FanList.setElementViewInfo(33,2),this.FanList.setElementCreateFunction(this.createElement.bind(this)),this.FanList.setElementUpdateDataFun(this.updateElement.bind(this)),this.FanList.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.GameSettleFanItem(t);return e},e.prototype.updateElement=function(t,e){t.setData(e)},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.setData=function(t,e){if(this.data=t,this.bankerChairId=e,this.fanListData=[],null!=this.data.winTypeInfos)for(var a=0;a<this.data.winTypeInfos.length;a++){var n=Math.floor(a/3);null==this.fanListData[n]&&(this.fanListData[n]=[]);var o=this.data.winTypeInfos[a],i=o.name+" "+o.desc;this.fanListData[n].push(i)}this.updateUI()},e.prototype.updateUI_=function(){var t=this;game.ResManager.loadWebImage(this.data.msgUser.headImgUrl,function(e){t.Image_head.texture=e,t.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){t.Image_head.texture=e},t)},this),this.Image_myself.visible=GlobalData.userData.getUserId()==this.data.msgUser.userId,this.Image_homer.visible=!1,this.Image_banker.visible=this.bankerChairId==this.data.userChairId,this.Text_userName.text=this.data.msgUser.nickName,this.FanList.clearContent(),this.FanList.setScrollerContent(this.fanListData)},e}(game.EComponent);__reflect(GameSettleWinerInfo.prototype,"GameSettleWinerInfo"),window.GameSettleWinerInfo=GameSettleWinerInfo;var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.params=t,a.skinName="resource/skins/game/panel/personInfo.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI(),t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_PERSON_AGAINS),t.EAppFacade.getInstance().registerCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this)},a.prototype.updateDiamondNum=function(){this.Text_diamond.text=""+this.params.getDiamondNum()},a.prototype.updateGoldNum=function(){this.Text_gold.text=""+this.params.getGoldNum()},a.prototype.onEventHandler=function(a){if(e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.PLAY_SINGLE_MESSAGE){var n=this.eventData;this.Text_yestodayNum.text=n.yesterday.gameTotal,this.Text_yestoday_ratio.text=n.yesterday.successRate+"%",this.Text_todayNum.text=n.today.gameTotal,this.Text_today_ratio.text=n.today.successRate+"%"}},a.prototype.init=function(){this.addTapEvent(this.Button_history,this.showHistoryBox.bind(this))},a.prototype.showHistoryBox=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.todayRecords.index)},a.prototype.updateUI_=function(){var e=this;this.updateDiamondNum(),this.updateGoldNum(),this.Text_userName.text=this.params.getUserName(),this.Text_userId.text="ID:"+this.params.getUserId(),this.Text_ip.text="IP:"+this.params.getIP();var a=this.params.getGender()==Constants.GENDER.man;a?this.Image_gender.source="item_male_png":this.Image_gender.source="item_female_png",t.ResManager.loadWebImage(this.params.getHeadIMGUrl(),function(t){e.Image_head.texture=t,e.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){e.Image_head.texture=t},e)},this)},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this),e.prototype.clean.call(this)},a}(t.EDialog);t.PersonalInfoBox=e,__reflect(e.prototype,"game.PersonalInfoBox")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.index=e,a.skinName="resource/skins/game/panel/personalInfoPointEmotion.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.init()},e.prototype.init=function(){this.Image_emotion.source="img_personal_item_"+this.index+"_png",this.Text_gold.text=""+GameConst.POINT_EMOTION_PRICE[this.index-1]},e.prototype.getIndex=function(){return this.index},e.prototype.setSelected=function(t){t?this.Image_bg.source="bg_personal_item_2_png":this.Image_bg.source="bg_personal_item_1_png"},e}(t.EComponent);t.PersonalInfoEmotion=e,__reflect(e.prototype,"game.PersonalInfoEmotion")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.params=t,a.skinName="resource/skins/game/panel/personInfoOtherSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI()},a.prototype.onEventHandler=function(a){if(e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.UPDATE_PLAYER_POSITION){if(null==this.params)return;var n,o=this.params.getChairId(),i=GlobalData.getCurGameData();if(n=i.getPlayer(o),null!=n){var s=n.getDetailAddress();this.updateAddress(s)}}},a.prototype.init=function(){for(var e=0;8>e;e++){var a=new t.PersonalInfoEmotion(e+1),n=135*(e%5),o=122*Math.floor(e/5);a.x=n,a.y=o,this.emotionGroup.addChild(a),a.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.touchBegin,this),a.addEventListener(egret.TouchEvent.TOUCH_END,this.touchEnd,this),a.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.touchCancel,this),a.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.touchCancel,this)}},a.prototype.touchBegin=function(t){var e=t.currentTarget;e.getIndex();e.setSelected(!0)},a.prototype.touchCancel=function(t){var e=t.currentTarget;e.setSelected(!1)},a.prototype.touchEnd=function(e){var a=e.currentTarget,n=a.getIndex();a.setSelected(!1);var o=!1;t.SceneManager.getInstance().isInGame()&&(o=this.sendData(n)),o&&this.close()},a.prototype.sendData=function(e){var a=GameConst.POINT_EMOTION_PRICE[e-1];return a>GlobalData.userData.getGoldNum()?(t.CommonView.showToast(Strings.goldNotEnough),!1):(GlobalData.gameData.getGameStatus()!=GameConst.GAME_STATUS_TYPE.allOver&&t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_SEND_MSG_ANI,{toChairId:this.params.getChairId(),msgId:e}),!0)},a.prototype.updateUI_=function(){var e=this;this.Text_userName.text=this.params.getUserName(),this.Text_userId.text="ID:"+this.params.getUserId(),this.Text_ip.text="IP:"+this.params.getIP();var a=this.params.getGender()==Constants.GENDER.man;a?this.Image_gender.source="item_male_png":this.Image_gender.source="item_female_png";var n=this.params.getDetailAddress();this.updateAddress(n),t.ResManager.loadWebImage(this.params.getHeadIMGUrl(),function(t){e.Image_head.texture=t,e.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){e.Image_head.texture=t},e)},this)},a.prototype.updateAddress=function(t){(null==t||0==t.length)&&(t="无法获取定位"),this.Text_location.text=t},a}(t.EDialog);t.PersonalInfoOtherBox=e,__reflect(e.prototype,"game.PersonalInfoOtherBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.preventCheat.index,!1,.3)||this;return a.params=t,a.skinName="resource/skins/game/panel/preventCheatSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),Utils.sendPanelEvent(t.GameCmd.CLOSE_CHEAT_STATUS_BOX),this.addTapEvent(this.Button_quit,this.clickQuitEvent),this.addTapEvent(this.Button_continue,this.clickContinueEvent),this.addTapEvent(this.Button_dissolve,this.clickDissolveEvent),this.userSet=[this.user1,this.user2,this.user3];var a=GlobalData.getCurGameData(),n=a.getRoomInfo().isClubRoom(),o=a.getRoomInfo().getPayMode()==Constants.ROOM_PAY_MODE.other,i=a.isMeCreator();!i||o||n?(this.Button_dissolve.visible=!1,this.Button_quit.visible=!0):(this.Button_dissolve.visible=!0,this.Button_quit.visible=!1),this.updateUI()},a.prototype.updateUI_=function(){for(var t=this.params,e=t.juliUserInfo,a=0;a<this.userSet.length;a++){var n=e[a],o=this.userSet[a];null!=n?(o.visible=!0,o.setData(n)):o.visible=!1}var i=e.length;if(2==i){var s=144;this.userSet[0].x=GameConfig.ScreenW/2-s/2-80,this.userSet[1].x=GameConfig.ScreenW/2-s/2+80}},a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.CLOSE_CHEAT_INFO_BOX&&(this.close(),Utils.sendGameEvent(t.GameCmd.CHECK_CHEAT_STATUS))},a.prototype.clickDissolveEvent=function(){var e=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_CANCEL_ROOM)},a=Strings.dismissRoom;"0"==GlobalData.clientConfigs.showCreateRoom&&(a="是否确认解散房间?"),t.DialogManager.getInstance().popUp2(a,e)},a.prototype.clickQuitEvent=function(){var e=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_LEAVE_ROOM)},a=Strings.exitRoom;t.DialogManager.getInstance().popUp2(a,e)},a.prototype.clickContinueEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.GAME,t.MsgConstant.CMD_IGNORE_CHEAT)},a}(t.EDialog);t.PreventCheatBox=e,__reflect(e.prototype,"game.PreventCheatBox")}(game||(game={}));var preventCheatNode=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/game/panel/preventCheatNodeSkin.exml",e}return __extends(e,t),e.prototype.setData=function(t){this.data=t,this.updateUI()},e.prototype.updateUI_=function(){var t=this;this.Text_userName.text=this.data.nickName,game.ResManager.loadWebImage(this.data.headImgUrl,function(e){t.Image_head.texture=e,t.Image_head.addEventListener(eui.UIEvent.COMPLETE,function(){t.Image_head.texture=e},t)},this)},e}(game.EComponent);__reflect(preventCheatNode.prototype,"preventCheatNode"),window.preventCheatNode=preventCheatNode;var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.preventCheatStatusBox.index,!1)||this;return t.skinName="resource/skins/game/panel/PreventCheatStatusBox.exml",t}return __extends(a,e),a.prototype.onEventHandler=function(a){e.prototype.onEventHandler.call(this,a),(this.eventId==t.GameCmd.CLOSE_CHEAT_INFO_BOX||this.eventId==t.GameCmd.CLOSE_CHEAT_STATUS_BOX)&&this.close()},a}(t.EDialog);t.PreventCheatStatusBox=e,__reflect(e.prototype,"game.PreventCheatStatusBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.roomInfoBox.index)||this;return t.skinName="resource/skins/game/panel/RoomInfoBoxSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),this.updateUI()},a.prototype.init=function(){"0"==GlobalData.clientConfigs.showCreateRoom&&(this.Text_payModeTitle.visible=!1,this.Text_payMode.visible=!1),this.addTapEvent(this.Button_close,this.close),this.addTapEvent(this.Button_rules,this.showRulesBox)},a.prototype.showRulesBox=function(){var e=new t.RuleDialog;t.DialogManager.getInstance().show(e)},a.prototype.updateUI_=function(){var t=GlobalData.gameData.getRoomInfo();this.Text_roomNumber.text=""+t.getRoomNum(),this.Text_turnNumber.text=t.getTurnNumber()+t.getTurnModeDesc(),this.Text_payMode.text=t.getPayModeDesc(),this.Text_roomType.text=t.getRoomTypeDesc(),this.Text_rules.text=t.getRulesDesc(),this.Text_bixiahu.text="庄家连庄，接庄比，流局，包牌，大胡（清一色，混一色，对对胡，全球独钓，七对，杠后开花，天胡，地胡、压绝、无花果）、花杠、罚分、一炮多响"},a}(t.EDialog);t.RoomInfoBox=e,__reflect(e.prototype,"game.RoomInfoBox")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this,Constants.UI_PANEL_DATA_SET.wechatShare.index)||this;return e.skinName="resource/skins/game/panel/ShareBoxSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.init()},e.prototype.init=function(){this.addTapEvent(this.Button_close,this.close.bind(this)),this.addTapEvent(this.Button_share2friend,this.share2FriendEvent.bind(this)),this.addTapEvent(this.Button_share2Group,this.share2GroupEvent.bind(this))},e.prototype.share2FriendEvent=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return t="测试",[2]})})},e.prototype.share2GroupEvent=function(){},e}(t.EDialog);t.ShareBox=e,__reflect(e.prototype,"game.ShareBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.skinName="resource/skins/game/panel/todayRecords.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.init(),t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_PERSON_TOTAL_AGAINS)},a.prototype.onEventHandler=function(a){if(e.prototype.onEventHandler.call(this,a),this.eventId==t.GameCmd.PLAY_TOTAL_MESSAGE){var n=this.eventData;if(n.length<=0)return void(this.emptyGroup.visible=!0);this.emptyGroup.visible=!1,this.listData=n.userAgainsRecord,this.totalData=n.totalAgainsRecord,this.updateUI()}},a.prototype.updateUI_=function(){this.recordList.clearContent(),this.recordList.setScrollerContent(this.listData),this.Text_allGameDraw.text=this.totalData.gameDraw,this.Text_mvpTimes.text=this.totalData.winHome,this.Text_allGameFail.text=this.totalData.gameFail,this.Text_allGameWin.text=this.totalData.gameWin,this.Text_allGameTotal.text=this.totalData.gameTotal},a.prototype.init=function(){this.addTapEvent(this.Button_close,this.close.bind(this)),this.initScroller()},a.prototype.initScroller=function(){this.recordList.setElementViewInfo(60,2),this.recordList.setElementCreateFunction(this.createElement.bind(this)),this.recordList.setElementUpdateDataFun(this.updateElement.bind(this)),this.recordList.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(e){var a=new t.TodayRecordsItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a}(t.EDialog);t.TodayRecordsBox=e,__reflect(e.prototype,"game.TodayRecordsBox")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this)||this;return a.itemData=e,a.skinName="resource/skins/game/panel/todayRecordsItem.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()
},e.prototype.setData=function(t){this.itemData=t,this.updateUI()},e.prototype.updateUI_=function(){this.Text_time.text=this.itemData.playTime,this.Text_today_num.text=this.itemData.gameTotal,this.Text_winNum.text=this.itemData.gameWin,this.Text_lose.text=this.itemData.gameFail,this.Text_draw.text=this.itemData.gameDraw,this.Text_winner.text=this.itemData.winHome},e}(t.EComponent);t.TodayRecordsItem=e,__reflect(e.prototype,"game.TodayRecordsItem")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this,Constants.UI_PANEL_DATA_SET.gameActivity.index)||this;return e.skinName="resource/skins/hall/gameActivitySkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close)},e}(t.EDialog);t.ActivityDialog=e,__reflect(e.prototype,"game.ActivityDialog")}(game||(game={}));var game;!function(t){var e=function(t){function e(e){var a=t.call(this,Constants.UI_PANEL_DATA_SET.advert.index)||this;return a.params=e,a.skinName="resource/skins/hall/advertBoxSkin.exml",a}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.tab(this.params.type),this.addTapEvent(this.Button_close,this.close.bind(this))},e.prototype.tab=function(t){this.Group_advert.visible=!1,this.Group_public.visible=!1,1==t?(this.Group_advert.visible=!0,this.Text_wx.text=GlobalData.clientConfigs.investment_info,this.addTapEvent(this.Button_copy,this.copyInvestment.bind(this))):2==t&&(this.Group_public.visible=!0,this.Text_public_name.text=GlobalData.clientConfigs.weixin_mp_name,this.addTapEvent(this.Button_copy_public,this.copyPublic.bind(this)))},e.prototype.copyInvestment=function(){Utils.copyToClipboard(this.Text_wx.text)},e.prototype.copyPublic=function(){Utils.copyToClipboard(this.Text_public_name.text)},e}(t.EDialog);t.AdvertBox=e,__reflect(e.prototype,"game.AdvertBox")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.SCENE_INDEX.MAIN)||this;return t.skinName="resource/skins/hall/hallSceneSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClub,this.clickClub),this.addTapEvent(this.btnCreateRoom,this.clickCreateRoom),this.addTapEvent(this.btnJoinRoom,this.clickJoinRoom),this.addTapEvent(this.btnZhanJi,this.clickZhanji),this.addTapEvent(this.btnStore,this.clickStore),this.addTapEvent(this.btnWanFa,this.clickWanFa),this.addTapEvent(this.btnTask,this.clickTask),this.addTapEvent(this.btnActive,this.clickActive),this.addTapEvent(this.btnSetting,this.clickSetting),this.addTapEvent(this.btnTest,this.test),this.addTapEvent(this.btnTest1,this.test1),this.addTapEvent(this.btnPlay,this.testPlay),this.addTapEvent(this.btnPause,this.testPause),this.addTapEvent(this.btnResume,this.testResume),this.addTapEvent(this.btnStop,this.testStop),this.addTapEvent(this.Group_head,this.showPersonInfoEvent),this.addTapEvent(this.btnBuyDiamond,this.showDiamondShopBox),this.addTapEvent(this.btnBuyGold,this.showGoldShopBox),this.addTapEvent(this.Button_share,this.showShareBoxEvent),"0"==GlobalData.clientConfigs.showCreateRoom?(this.Button_agent.visible=!1,this.Button_public.visible=!1,this.Image_hot.visible=!1):(this.addTapEvent(this.Button_agent,this.showAdvertAgent.bind(this)),this.addTapEvent(this.Button_public,this.showAdvertPublic.bind(this))),t.SoundService.getInstance().playMusic("bg_mp3"),this.updateUI(),this.checkAutoInGame(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this)},a.prototype.showDiamondShopBox=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.shop.index,{tabIndex:t.StoreBox.STORE_TAB.DIAMOND})},a.prototype.showGoldShopBox=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.shop.index,{tabIndex:t.StoreBox.STORE_TAB.GOLD})},a.prototype.showShareBoxEvent=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return platform.shareWithImg("新华网出品，南京名嘴秦岭、查老倾情献声，邀您来组局了！","index.html","https://res.qixiyx.cn/file/share.jpg","key1=1&key2=2"),[2]})})},a.prototype.showAdvertAgent=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.advert.index,{type:1})},a.prototype.showAdvertPublic=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.advert.index,{type:2})},a.prototype.showPersonInfoEvent=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.personInfo.index,GlobalData.userData)},a.prototype.updateDiamondNum=function(){this.labelDiamond.text=""+GlobalData.userData.getDiamondNum()},a.prototype.updateGoldNum=function(){this.labelGold.text=""+GlobalData.userData.getGoldNum()},a.prototype.checkAutoInGame=function(){var e=GlobalData.userData.getRoomNumber();if(0!=e){var a={roomNumber:e};t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,a)}else if(0!=GlobalData.platformRoomNumber){var a={roomNumber:GlobalData.platformRoomNumber};t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,a)}GlobalData.userData.setRoomNumber(0),GlobalData.platformRoomNumber=0},a.prototype.testPlay=function(){t.SoundManager.getInstance().play("bg_mp3",0)},a.prototype.testPause=function(){t.SoundManager.getInstance().pauseAllSound()},a.prototype.testResume=function(){t.SoundManager.getInstance().resumeAllSound()},a.prototype.testStop=function(){t.SoundManager.getInstance().stopAllSound()},a.prototype.timerEvent=function(t){console.log("==========="+t.data.leftTime);var e=t.data;0==e.status||2==e.status},a.prototype.updateUI_=function(){var e=t.UserInfoService.getInstance().getUserInfo();this.updateDiamondNum(),this.updateGoldNum(),this.labelNickName.text=e.getUserName(),this.labelUserId.text="ID:"+e.getUserId(),this.headLoadComplete()},a.prototype.headLoadComplete=function(){var e=this,a=GlobalData.userData.getHeadIMGUrl();t.ResManager.loadWebImage(a,function(t){e.imgPerson.texture=t,e.imgPerson.addEventListener(eui.UIEvent.COMPLETE,function(){e.imgPerson.texture=t},e)},this)},a.prototype.clickClub=function(){"0"==GlobalData.clientConfigs.showClubRoom?t.DialogManager.getInstance().popUp1("更多功能下载app体验"):t.SceneSkip.skipToClubScene()},a.prototype.clickCreateRoom=function(){if("0"==GlobalData.clientConfigs.showCreateRoom){var e={};e.roomType=Constants.ROOM_TYPE.jinYuanZi,e.roomScore=100,e.turnMode=0,e.turnNumber=8,e.payMode=Constants.ROOM_PAY_MODE.AA,e.huaZa=!0,e.faFen=!0,e.jieZhuangBi=!0,e.calNum=0,e.autoHost=!0,e.baoMi=!1,e.free=!0,t.RoomService.getInstance().createRoom(e)}else{var a=new t.CreateRoomDialog(null);t.DialogManager.getInstance().show(a,t.EDialog.show_ani_type_null)}},a.prototype.clickJoinRoom=function(){var e=new t.JoinRoomDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickZhanji=function(){var e=new t.ZhanJiDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickStore=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.shop.index)},a.prototype.clickWanFa=function(){var e=new t.RuleDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickTask=function(){var e=new t.TaskDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickActive=function(){var e=new t.ActivityDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.clickSetting=function(){var e=new t.SettingDialog;t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.test=function(){t.LogUtils.info("test")},a.prototype.test1=function(){t.SoundManager.getInstance().stopAllSound()},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this),e.prototype.clean.call(this)},a}(t.SceneBase);t.HallScene=e,__reflect(e.prototype,"game.HallScene")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.checkCheat.index)||this;return t.skinName="resource/skins/hall/settingDialogSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnAbout,this.showAbout),this.addTapEvent(this.btnBgMusic,this.switchBgMusic),this.addTapEvent(this.btnSound,this.switchSound),this.addTapEvent(this.btnChangeAccount,this.switchAccount),this.updateUI()},a.prototype.updateUI_=function(){this.labelNickName.text=t.UserInfoService.getInstance().getUserInfo().getUserName();var e=t.UserInfoService.getInstance().getUserInfo().getHeadIMGUrl(),a=this;t.ResManager.loadWebImage(e,function(t){a.imgPerson.texture=t,a.imgPerson.addEventListener(eui.UIEvent.COMPLETE,function(){a.imgPerson.texture=t},this)},this),this.updateUI_BgMusic(),this.updateUI_Sound()},a.prototype.updateUI_BgMusic=function(){var e=t.SoundService.getInstance().getBgMusicSwitch();this.imgBgMusicOn.visible=e,this.imgBgMusicOff.visible=!e},a.prototype.updateUI_Sound=function(){var e=t.SoundService.getInstance().getAudioSwitch();this.imgSoundOn.visible=e,this.imgSoundOff.visible=!e},a.prototype.showAbout=function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.about.index)},a.prototype.switchBgMusic=function(){t.SoundService.getInstance().setBgMusicSwitch(!t.SoundService.getInstance().getBgMusicSwitch()),this.updateUI_BgMusic(),t.SoundService.getInstance().getBgMusicSwitch()?t.SoundService.getInstance().playMusic():t.SoundService.getInstance().pauseBgMusic()},a.prototype.switchSound=function(){t.SoundService.getInstance().setAudioSwitch(!t.SoundService.getInstance().getAudioSwitch()),this.updateUI_Sound(),t.SoundService.getInstance().getAudioSwitch()||t.SoundService.getInstance().stopAllAudio()},a.prototype.switchAccount=function(){DataStorage.removeLocalData(DataStorageConst.DATA_KEY_UnionId),t.ConnectService.getInstance().stopTimer(),t.ConnectService.getInstance().close(),GlobalData.userData.cleanUser(),t.SceneSkip.skipToLoginScene()},a}(t.EDialog);t.SettingDialog=e,__reflect(e.prototype,"game.SettingDialog")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this,Constants.UI_PANEL_DATA_SET.taskBox.index)||this;return e.skinName="resource/skins/hall/taskDialogSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.tabDayTask,this.selectTab1),this.addTapEvent(this.tabGrowTask,this.selectTab2),this.selectTab1()},e.prototype.selectTab1=function(){this.btnDayTask.selected=!0,this.dayTaskLab.textColor=7945995,this.btnGrowTask.selected=!1,this.growTaskLab.textColor=12892344},e.prototype.selectTab2=function(){this.btnDayTask.selected=!1,this.dayTaskLab.textColor=12892344,this.btnGrowTask.selected=!0,this.growTaskLab.textColor=7945995},e}(t.EDialog);t.TaskDialog=e,__reflect(e.prototype,"game.TaskDialog")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getDiamondCostNum=function(e,a,n,o,i){var s=t.getKey(a,n,o,i);return e[s]},t.getDiamondCostNums=function(){var e={};return e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,4)]=5,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,8)]=7,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,12)]=10,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,16)]=10,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,1)]=7,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,2)]=10,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,3)]=15,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,4)]=15,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,4)]=20,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,8)]=28,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,12)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,16)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,1)]=28,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,2)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,3)]=60,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,4)]=60,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,4)]=25,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,8)]=35,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,12)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,16)]=40,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,1)]=35,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,2)]=45,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,3)]=60,e[t.getKey(Constants.ROOM_TYPE.jinYuanZi,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,4)]=60,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,4)]=5,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,8)]=7,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,12)]=10,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.ba,16)]=10,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,1)]=7,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,2)]=10,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,3)]=15,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.AA,Constants.ROOM_TIME_MODE.quan,4)]=15,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,4)]=20,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,8)]=28,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,12)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.ba,16)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,1)]=28,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,2)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,3)]=60,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.creator,Constants.ROOM_TIME_MODE.quan,4)]=60,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,4)]=25,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,8)]=35,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,12)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.ba,16)]=40,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,1)]=35,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,2)]=45,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,3)]=60,e[t.getKey(Constants.ROOM_TYPE.changKaiTou,Constants.ROOM_PAY_MODE.other,Constants.ROOM_TIME_MODE.quan,4)]=60,e},t.getKey=function(t,e,a,n){return"key_"+t+"_"+e+"_"+a+"_"+n},t}();t.CreateRoomCost=e,__reflect(e.prototype,"game.CreateRoomCost")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.create_room.index)||this;return a.clubId=null,a.clubId=t,a.skinName="resource/skins/hall/room/createRoomDialogSkin.exml",a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnCreate,this.clickCreateRoom),this.panelMahjong.setClubId(this.clubId),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CREATE_ROOM),this.createRoomCallBack,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.diamondChange,this),this.updateUI()},a.prototype.updateUI_=function(){this.labelDiamond.text=""+GlobalData.userData.getDiamondNum()},a.prototype.clickCreateRoom=function(){var e=this.panelMahjong.getAdjustRoomInfo();t.RoomService.getInstance().createRoom(e)},a.prototype.createRoomCallBack=function(e){var a=e.data;a.code==t.CmdResultType.SUCCESS?(this.panelMahjong.saveLocalRoomInfo(),this.close()):a.errorCode==t.MsgConstant.ERROR_diamondNoEnough&&t.CommonView.showToast("创建房间钻石不够了")},a.prototype.diamondChange=function(){var t=GlobalData.userData.getDiamondNum();this.labelDiamond.text=""+t},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_CREATE_ROOM),this.createRoomCallBack,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.diamondChange,this),e.prototype.clean.call(this)},a}(t.EDialog);t.CreateRoomDialog=e,__reflect(e.prototype,"game.CreateRoomDialog")}(game||(game={}));var CreateRoomMahjong=function(t){function e(){var e=t.call(this)||this;return e.clubId=null,e.hasInited=!1,e.skinName="resource/skins/hall/room/createRoomMahjongSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.payModeAA,this.clickPayModeAA),this.addTapEvent(this.payModeMaster,this.clickPayModeMaster),this.addTapEvent(this.payModeDaiKai,this.clickPayModeDaiKai),this.addTapEvent(this.roomTypeJYZ,this.clickRoomTypeJYZ),this.addTapEvent(this.roomTypeCKT,this.clickRoomTypeCKT),this.addTapEvent(this.jieSuanNoLimit,this.clickJieSuanNoLimit),this.addTapEvent(this.jieSuan300,this.clickjieSuan300),this.addTapEvent(this.turnModeBa,this.clickTurnModeBa),this.addTapEvent(this.turnModeQuan,this.clickTurnModeQuan),this.addTapEvent(this.turn1,this.clickTurn1),this.addTapEvent(this.turn2,this.clickTurn2),this.addTapEvent(this.turn3,this.clickTurn3),this.addTapEvent(this.turn4,this.clickTurn4),this.addTapEvent(this.modeFaZa2,this.clickTurnmodeFaZa2),this.addTapEvent(this.modeSiFeng,this.clickModeSiFeng),this.addTapEvent(this.modeJieZhuang,this.clickModeJieZhuang),this.addTapEvent(this.modeBaoMi,this.clickModeBaoMi),this.addTapEvent(this.modeAutoHost,this.clickModeAutoHost),this.updateUI()},e.prototype.updateUI_=function(){if(this.hasInited){this.modeFaZa2.setText("花砸2"),this.modeSiFeng.setText("东南西北罚分"),this.modeJieZhuang.setText("接庄比"),this.modeBaoMi.setText("保米"),this.modeAutoHost.setText("超时托管"),this.payModeAA.setText("AA模式"),this.payModeMaster.setText("房主模式"),this.payModeDaiKai.setText("会长模式"),this.roomTypeJYZ.setText("进园子"),this.roomTypeCKT.setText("敞开头"),this.turnModeBa.setText("按把模式"),this.turnModeQuan.setText("按圈模式"),this.jieSuan300.setText("300"),this.jieSuanNoLimit.setText("无限制");var t=this.getRoomInfo();this.payModeMaster.visible=null==this.clubId,this.payModeDaiKai.visible=null!=this.clubId,this.resetRadioFalse();var e=t.roomType;e==Constants.ROOM_TYPE.jinYuanZi?(this.roomTypeJYZ.setSelected(!0),this.labelJieSuanScore.text="携带积分：",this.jieSuanNoLimit.visible=!1,this.jieSuan300.setText("100"),this.jieSuan300.setSelected(!0),this.groupMainMode_JYZ.visible=!0,this.labelMainMode_CKT.visible=!this.groupMainMode_JYZ.visible):(this.roomTypeCKT.setSelected(!0),this.labelJieSuanScore.text="单把上限：",this.jieSuanNoLimit.visible=!0,this.jieSuan300.setText("300"),this.groupMainMode_JYZ.visible=!1,this.labelMainMode_CKT.visible=!this.groupMainMode_JYZ.visible);var a=t.payMode;a==Constants.ROOM_PAY_MODE.AA?this.payModeAA.setSelected(!0):a==Constants.ROOM_PAY_MODE.creator?this.payModeMaster.setSelected(!0):this.payModeDaiKai.setSelected(!0);var n=t.turnMode;n==Constants.ROOM_TIME_MODE.ba?this.turnModeBa.setSelected(!0):this.turnModeQuan.setSelected(!0);var o=t.roomScore;0>=o?this.jieSuanNoLimit.setSelected(!0):this.jieSuan300.setSelected(!0);var i=t.turnNumber;n==Constants.ROOM_TIME_MODE.ba?4==i?this.turn1.setSelected(!0):12==i?this.turn3.setSelected(!0):16==i?this.turn4.setSelected(!0):this.turn2.setSelected(!0):1==i?this.turn1.setSelected(!0):3==i?this.turn3.setSelected(!0):4==i?this.turn4.setSelected(!0):this.turn2.setSelected(!0),this.modeFaZa2.setSelected(t.huaZa),this.modeSiFeng.setSelected(t.faFen),this.modeJieZhuang.setSelected(t.jieZhuangBi),this.modeBaoMi.setSelected(t.baoMi),this.modeAutoHost.setSelected(t.autoHost);var s=game.CreateRoomCost.getDiamondCostNums(),r=1,l="圈";n==Constants.ROOM_TIME_MODE.ba&&(r=4,l="把"),this.turn1.setText(1*r+l,game.CreateRoomCost.getDiamondCostNum(s,e,a,n,1*r)),this.turn2.setText(2*r+l,game.CreateRoomCost.getDiamondCostNum(s,e,a,n,2*r)),this.turn3.setText(3*r+l,game.CreateRoomCost.getDiamondCostNum(s,e,a,n,3*r)),this.turn4.setText(4*r+l,game.CreateRoomCost.getDiamondCostNum(s,e,a,n,4*r))}},e.prototype.resetRadioFalse=function(){this.payModeAA.setSelected(!1),this.payModeMaster.setSelected(!1),this.payModeDaiKai.setSelected(!1),this.roomTypeJYZ.setSelected(!1),this.roomTypeCKT.setSelected(!1),this.jieSuanNoLimit.setSelected(!1),this.jieSuan300.setSelected(!1),this.turnModeBa.setSelected(!1),this.turnModeQuan.setSelected(!1),this.turn1.setSelected(!1),this.turn2.setSelected(!1),this.turn3.setSelected(!1),this.turn4.setSelected(!1),this.modeFaZa2.setSelected(!1),this.modeSiFeng.setSelected(!1),this.modeJieZhuang.setSelected(!1),this.modeBaoMi.setSelected(!1),this.modeAutoHost.setSelected(!1)},e.prototype.clickPayModeAA=function(){var t=this.getRoomInfo();t.payMode=Constants.ROOM_PAY_MODE.AA,this.updateUI()},e.prototype.clickPayModeMaster=function(){var t=this.getRoomInfo();t.payMode=Constants.ROOM_PAY_MODE.creator,this.updateUI()},e.prototype.clickPayModeDaiKai=function(){var t=this.getRoomInfo();t.payMode=Constants.ROOM_PAY_MODE.other,this.updateUI()},e.prototype.clickRoomTypeJYZ=function(){var t=this.getRoomInfo();t.roomType=Constants.ROOM_TYPE.jinYuanZi,t.roomScore=100,this.updateUI()},e.prototype.clickRoomTypeCKT=function(){var t=this.getRoomInfo();t.roomType=Constants.ROOM_TYPE.changKaiTou,this.updateUI()},e.prototype.clickJieSuanNoLimit=function(){var t=this.getRoomInfo();t.roomScore=0,this.updateUI()},e.prototype.clickjieSuan300=function(){var t=this.getRoomInfo();t.roomType==Constants.ROOM_TYPE.jinYuanZi?t.roomScore=100:t.roomScore=300,this.updateUI()},e.prototype.clickTurnModeBa=function(){var t=this.getRoomInfo();t.turnMode=Constants.ROOM_TIME_MODE.ba,t.turnNumber=8,this.updateUI()},e.prototype.clickTurnModeQuan=function(){var t=this.getRoomInfo();t.turnMode=Constants.ROOM_TIME_MODE.quan,t.turnNumber=2,this.updateUI()},e.prototype.clickTurn1=function(){var t=this.getRoomInfo(),e=1;t.turnMode==Constants.ROOM_TIME_MODE.ba&&(e=4),t.turnNumber=1*e,this.updateUI()},e.prototype.clickTurn2=function(){var t=this.getRoomInfo(),e=1;t.turnMode==Constants.ROOM_TIME_MODE.ba&&(e=4),t.turnNumber=2*e,this.updateUI()},e.prototype.clickTurn3=function(){var t=this.getRoomInfo(),e=1;t.turnMode==Constants.ROOM_TIME_MODE.ba&&(e=4),t.turnNumber=3*e,this.updateUI()},e.prototype.clickTurn4=function(){var t=this.getRoomInfo(),e=1;t.turnMode==Constants.ROOM_TIME_MODE.ba&&(e=4),t.turnNumber=4*e,this.updateUI()},e.prototype.clickTurnmodeFaZa2=function(){var t=this.getRoomInfo();t.huaZa=this.modeFaZa2.isSelected(),this.updateUI()},e.prototype.clickModeSiFeng=function(){var t=this.getRoomInfo();t.faFen=this.modeSiFeng.isSelected(),this.updateUI()},e.prototype.clickModeJieZhuang=function(){var t=this.getRoomInfo();t.jieZhuangBi=this.modeJieZhuang.isSelected(),this.updateUI()},e.prototype.clickModeBaoMi=function(){var t=this.getRoomInfo();t.baoMi=this.modeBaoMi.isSelected(),this.updateUI()},e.prototype.clickModeAutoHost=function(){var t=this.getRoomInfo();t.autoHost=this.modeAutoHost.isSelected(),this.updateUI()},e.prototype.getRoomInfo=function(){if(!this.hasInited)return null;if(null==this.roomInfo){var t=this.getLocalRoomInfo();if(null!=t)this.roomInfo=t;else{var e={};e.roomType=Constants.ROOM_TYPE.jinYuanZi,e.roomScore=100,e.turnMode=0,e.turnNumber=8,e.payMode=Constants.ROOM_PAY_MODE.AA,e.huaZa=!0,e.faFen=!0,e.jieZhuangBi=!0,null!=this.clubId&&(e.clubId=this.clubId),e.calNum=0,e.autoHost=!0,e.baoMi=!1,this.roomInfo=e}}return this.roomInfo},e.prototype.getAdjustRoomInfo=function(){var t=this.getRoomInfo();return t.roomType==Constants.ROOM_TYPE.changKaiTou&&(t.huaZa=!0,t.faFen=!0,t.jieZhuangBi=!0,t.baoMi=!1),t},e.prototype.getLocalRoomInfo=function(){var t=null==this.clubId?"0":this.clubId,e=DataStorage.readLocalData("roomInfo_clubId+"+t);return e.length>0?JSON.parse(e):null},e.prototype.saveLocalRoomInfo=function(){var t=this.getRoomInfo(),e=null==this.clubId?"0":this.clubId;DataStorage.writeLocalData("roomInfo_clubId+"+e,JSON.stringify(t))},e.prototype.setClubId=function(t){this.clubId=t;this.getRoomInfo();this.hasInited=!0,this.updateUI()},e}(game.EComponent);__reflect(CreateRoomMahjong.prototype,"CreateRoomMahjong"),window.CreateRoomMahjong=CreateRoomMahjong;var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.join_room.index)||this;return t.numbers="",t.skinName="resource/skins/hall/room/joinRoomSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnClear,this.clickClear),this.addTapEvent(this.btnDelete,this.clickDelete),this.initBtnsEvent(),this.updateUI()},a.prototype.initBtnsEvent=function(){for(var t=this.getBtns(),e=t.length,a=0;e>a;a++)this.addTapEvent(t[a],this.clickBtn)},a.prototype.getBtns=function(){return[this.btn0,this.btn1,this.btn2,this.btn3,this.btn4,this.btn5,this.btn6,this.btn7,this.btn8,this.btn9]},a.prototype.getNumbers=function(){return[this.labelNumber1,this.labelNumber2,this.labelNumber3,this.labelNumber4,this.labelNumber5,this.labelNumber6]},a.prototype.getBtnNumber=function(t){for(var e=t.currentTarget,a=this.getBtns(),n=a.length,o=0;n>o;o++)if(e==a[o])return o;return 0},a.prototype.updateUI_=function(){for(var t=this.getNumbers(),e=t.length,a=0;e>a;a++)this.numbers.length>=a?(t[a].visible=!0,t[a].text=this.numbers.substring(a,a+1)):t[a].visible=!1},a.prototype.clickBtn=function(e){if(!(this.numbers.length>=6)){var a=this.getBtnNumber(e);if(this.numbers+=a,this.updateUI(),6==this.numbers.length){var n={roomNumber:parseInt(this.numbers)};t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,n)}}},a.prototype.clickClear=function(){this.numbers="",this.updateUI()},a.prototype.clickDelete=function(){this.numbers.length>0&&(this.numbers=this.numbers.substr(0,this.numbers.length-1)),this.updateUI()},a}(t.EDialog);t.JoinRoomDialog=e,__reflect(e.prototype,"game.JoinRoomDialog")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.intstance&&(e.intstance=new e),e.intstance},e.prototype.createRoom=function(e){var a={};a.msgRoom=e;var n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CREATE_ROOM,a);t.SocketManager.getInstance().send(n)},e.prototype.createRoomCallBack=function(e){if(e.code==t.CmdResultType.SUCCESS){var a=e.data,n=a.fromClub;if(null==n||!n){if(null!=a.diamond&&GlobalData.userData.setDiamondNum(a.diamond),Constants.ROOM_PAY_MODE.other==a.msgRoom.payMode){a.useDiamond,a.msgRoom;return}var o={roomNumber:a.msgRoom.roomNumber};t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,o)}}else{var i=e.errorCode;if(i==t.MsgConstant.ERROR_diamondNoEnough)t.DialogManager.getInstance().popUp2(Strings.noRoomCard,function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.shop.index)});else if(i==t.MsgConstant.ERROR_creamRoom_paramError)t.DialogManager.getInstance().popUp1(Strings.createRoomParamsError);else if(i==t.MsgConstant.ERROR_creamRoom_inRoom){var a=e.data,s=(a.gameId,Utils.format(Strings.hasInRoomWhenCreateRoom,"麻将"));t.DialogManager.getInstance().popUp1(s)}}},e.prototype.joinRoomCallBack=function(e){if(e.code==t.CmdResultType.SUCCESS){var a=e.data;null!=a.diamond&&GlobalData.userData.setDiamondNum(a.diamond);var n=a.roomStatus;GlobalData.gameData.setGameStatus(n),GlobalData.gameData.getRoomInfo().parse(a.msgRoom);var o=!1;null!=a.doCheat&&(o=a.doCheat),o&&GlobalData.gameData.setCheatStatus(o);var i=a.kickLeftTime;null!=i&&GlobalData.gameData.setKickOfflineTime(Math.floor(i/1e3));var s=a.userInfos;GlobalData.gameData.clearPlayerData();for(var r=0;r<s.length;r++){var l=s[r].chairId,c=GlobalData.gameData.getPlayer(l);null==c&&(c=new t.PlayerInfo,GlobalData.gameData.addPlayer(l,c)),c.parse(s[r]),c.getUserId()==GlobalData.userData.getUserId()&&(GlobalData.gameData.setMyChairId(l),t.LogUtils.info("我的椅子id "+l))}GlobalData.gameData.getGameStatus()==GameConst.GAME_STATUS_TYPE.ready&&GlobalData.isReconnecting&&GlobalData.setReconnecting(!1),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED),t.SceneManager.getInstance().curScene.getIndex()!=Constants.SCENE_INDEX.GAME&&t.SceneSkip.skipToGameScene()}else{var u=e.errorCode;u==t.MsgConstant.ERROR_join_ROOM_USERMAX?t.DialogManager.getInstance().popUp1(Strings.roomPlayerFull):u==t.MsgConstant.ERROR_join_inOtherRoom?t.DialogManager.getInstance().popUp1(Strings.hasInRoomWhenJoinRoom):u==t.MsgConstant.ERROR_joinRoom_roomId_error?t.DialogManager.getInstance().popUp1(Strings.roomNumberNotExist):u==t.MsgConstant.ERROR_diamondNoEnough&&t.DialogManager.getInstance().popUp2(Strings.noRoomCard,function(){t.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.shop.index)})}},e.prototype.cancelRoom=function(){var e=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CANCEL_ROOM,null);t.SocketManager.getInstance().send(e)},e.prototype.cancelDaiKaiRoom=function(e){var a={roomId:e},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CANCEL_DAIKAI_ROOM,a);t.SocketManager.getInstance().send(n)},e.prototype.joinRoom=function(e){var a={roomNumber:e},n=GlobalData.userData.getLocation();(0!=n.longitude||0!=n.latitude)&&(a.gpsLocation=n);var o=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_JOIN_ROOM,a);t.SocketManager.getInstance().send(o)},e.intstance=null,e}();t.RoomService=e,__reflect(e.prototype,"game.RoomService")}(game||(game={}));var TurnNumberRadioButton=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/room/turnModeRadioSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.rect,this.onThisClick)
},e.prototype.onThisClick=function(){this.radioButton.setSelected(!this.radioButton.isSelected())},e.prototype.setSelected=function(t){this.radioButton.setSelected(t)},e.prototype.setText=function(t,e){this.radioButton.setText(t),this.labelCostNum.text="x"+e},e}(game.EComponent);__reflect(TurnNumberRadioButton.prototype,"TurnNumberRadioButton"),window.TurnNumberRadioButton=TurnNumberRadioButton;var DiamondItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/store/diamondItemSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this)},e.prototype.setData=function(t){this.diamondData=t,this.updateUI()},e.prototype.updateUI=function(){null!=this.diamondData&&(this.price.text=this.diamondData.price/100+"",this.num.text="x"+this.diamondData.itemTotalNum,800==this.diamondData.price?this.dmdImg.source="item_diamond_1_png":2e3==this.diamondData.price?this.dmdImg.source="item_diamond_2_png":5e3==this.diamondData.price?this.dmdImg.source="item_diamond_3_png":1e4==this.diamondData.price?this.dmdImg.source="item_diamond_4_png":3e4==this.diamondData.price?this.dmdImg.source="item_diamond_5_png":1e5==this.diamondData.price&&(this.dmdImg.source="item_diamond_6_png"))},e}(game.EComponent);__reflect(DiamondItem.prototype,"DiamondItem"),window.DiamondItem=DiamondItem;var GoldItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/store/goldItemSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this)},e.prototype.setData=function(t){this.goldData=t,this.updateUI()},e.prototype.updateUI=function(){null!=this.goldData&&(this.price.text=this.goldData.price/100+"",this.num.text="x"+this.goldData.itemTotalNum,800==this.goldData.price?this.goldImg.source="item_gold_1_png":2e3==this.goldData.price?this.goldData.source="item_gold_2_png":5e3==this.goldData.price?this.goldImg.source="item_gold_3_png":1e4==this.goldData.price?this.goldImg.source="item_gold_4_png":3e4==this.goldData.price&&(this.goldImg.source="item_gold_5_png"))},e}(game.EComponent);__reflect(GoldItem.prototype,"GoldItem"),window.GoldItem=GoldItem;var game;!function(t){var e=function(e){function a(t){var n=e.call(this,Constants.UI_PANEL_DATA_SET.shop.index)||this;return n.curTabIndex=a.STORE_TAB.DIAMOND,null!=t&&t.tabIndex&&(n.curTabIndex=t.tabIndex),n.skinName="resource/skins/hall/store/storeMainSkin.exml",n}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnBack,this.clickBack),this.addTapEvent(this.tab1,this.tabToDimamond),this.addTapEvent(this.tab2,this.tabToGold),this.addTapEvent(this.tabTitle1,this.tabToDimamond),this.addTapEvent(this.tabTitle2,this.tabToGold),this.getStoreList(),this.updateDiamondNum(),this.updateGoldNum(),this.diamondItemGrp.visible=!0,this.goldItemGrp.visible=!1,this.tab1.selected=!0,t.EAppFacade.getInstance().registerCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this),this.curTabIndex==a.STORE_TAB.DIAMOND?this.tabToDimamond():this.curTabIndex==a.STORE_TAB.GOLD&&this.tabToGold()},a.prototype.updateDiamondNum=function(){this.dmdNum.text=GlobalData.userData.getDiamondNum()+""},a.prototype.updateGoldNum=function(){this.goldNum.text=GlobalData.userData.getGoldNum()+""},a.prototype.clickBack=function(){this.close()},a.prototype.tabToDimamond=function(){this.diamondItemGrp.visible=!0,this.goldItemGrp.visible=!1,this.tab1.selected=!0,this.tab2.selected=!1},a.prototype.tabToGold=function(){this.diamondItemGrp.visible=!1,this.goldItemGrp.visible=!0,this.tab1.selected=!1,this.tab2.selected=!0},a.prototype.getStoreList=function(){t.StoreService.getInstance().getStoreList(this.getStoreListBack.bind(this))},a.prototype.getStoreListBack=function(e){var a=e,n=a;if(n.code==t.CmdResultType.SUCCESS){var o=n.data;this.diaMondItemData=o.diamonds,this.goldItemData=o.golds;for(var i=[this.dmdItem0,this.dmdItem1,this.dmdItem2,this.dmdItem3,this.dmdItem4,this.dmdItem5],s=[this.goldItem0,this.goldItem1,this.goldItem2,this.goldItem3,this.goldItem4],r=this.diaMondItemData.length,l=0;r>l;l++){var c=null;r>l&&(c=this.diaMondItemData[l]),i[l].setData(c)}for(var u=this.goldItemData.length,l=0;u>l;l++){var h=null;r>l&&(h=this.goldItemData[l]),s[l].setData(h)}console.log("======>>>>>"+h)}},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.DIAMOND_NUMBER_CHANGE,this.updateDiamondNum,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.GOLD_NUMBER_CHANGE,this.updateGoldNum,this),e.prototype.clean.call(this)},a.STORE_TAB={GOLD:1,DIAMOND:2},a}(t.EDialog);t.StoreBox=e,__reflect(e.prototype,"game.StoreBox")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getStoreList=function(e){t.GameHttpManager.getStoreList(e)},e}();t.StoreService=e,__reflect(e.prototype,"game.StoreService")}(game||(game={}));var game;!function(t){var e=function(t){function e(){var e=t.call(this,Constants.UI_PANEL_DATA_SET.rulesBox.index)||this;return e.skinName="resource/skins/hall/wanfa/ruleDescSkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.tab1,this.showJYZ),this.addTapEvent(this.tab2,this.showCKT),this.showJYZ()},e.prototype.initRuleData1=function(){var t="一．简介\n进园子是“门一跑一”和“两家干”的游戏规则，增加“花砸2”和“接庄比”两种玩法。\n\n二．基本规则\n1．“花砸2”：硬花、软花的总数*2。\n2．门一跑一：成牌后门清，加10个花，俗称“门一”；在成牌后加底花10个花，俗称“跑一”。\n3．两家干：当有两家积分为0时，游戏立即结束。\n4．胡牌结算规则：\nA．南京麻将成牌后，输赢额度由成牌花的多少来决定。\nB．牌型花数：混一色：20个花；对对胡：20个花；压绝：20个花；无花果20个花；清一色：加30个花；全球独钓：加30个花。普通七对：加30个花。双七对：加80个花。豪华双七对：加120个花。超豪华双七对：成牌后算做160个花。\nC．杠后开花：小杠开花：加10个花。大杠开花：加20个花。\nD．天胡：庄家摸到牌后直接成牌，另外三家直接干。\nE．地胡：天听后不碰不杠直接成牌，另加30个花。\nF．海底捞月：最后2墩（小于等于4张）时自摸胡牌，加20个花。\n5．比下胡规则：胡牌的总花数*2。\n比下胡条件：\n庄家连庄，接庄比，流局，包牌，大胡（清一色，混一色，对对胡，全球独钓，七对，杠后开花，天胡，地胡、压绝、无花果）、花杠、罚分、一炮多响。\n\n三．进园子包牌规则\n1．大杠开花和抢杠算自摸\n2．外包规则：a.全球独钓，b.三打四包，c.清一色外包。\n\n四．其他规则\n南京麻将现场汇：分别是“杠”和“罚分”。\n超时托管：勾选此规则后，每个玩家整局牌局中总共拥有300秒超时时间。该时间用完后，该局游戏内，玩家再次超时未操作，将进行系统托管。托管将由系统自动摸牌打牌，有操作提示时自动选择“过”。\n\n五．结算\n结算页面显示的输赢=玩家携带积分-100。";this.ruleLabel.text=t},e.prototype.initRuleData2=function(){var t="一．简介\n南京麻将敞开头沿用了现实“门一跑一”的游戏规则。\n\n二．基本规则\n1．“花砸2”：硬花、软花的总数乘2。\n2．门一跑一：成牌后门清，加10个花，俗称“门一”；在成牌后加底花10个花，俗称“跑一”。\n3．胡牌结算规则：\nA．南京麻将成牌后，输赢额度由成牌花的多少来决定。\nB．牌型花数：混一色：20个花；对对胡：20个花；压绝：20个花；无花果20个花；清一色：加30个花；全球独钓：加30个花。七对：加30个花。双七对：加80个花。豪华双七对：加120个花。超豪华双七对：成牌后算做160个花。\nC．杠后开花：小杠开花：加10个花。大杠开花：加20个花。\nD．天胡：加200个花。地胡：天听后不碰不杠直接成牌，加30个花。海底捞月：最后2墩（小于等于4张）时自摸胡牌，加20个花。\n4. 比下胡规则：胡牌的总花数*2。\n比下胡条件：\n庄家连庄，接庄比，流局，包牌，大胡（清一色，混一色，对对胡，全球独钓，七对，杠后开花，天胡，地胡、压绝、无花果）、花杠、罚分、一炮多响。\n\n三．敞开头包牌规则\n1．大杠开花和抢杠算自摸。2.三打四包。3.清一色包牌。\n\n四．其他规则\n南京麻将现场汇：“杠”和“罚分”。\n超时托管：勾选此规则后，每个玩家整局牌局中总共拥有300秒超时时间。该时间用完后，该局游戏内，玩家再次超时未操作，将进行系统托管。托管将由系统自动摸牌打牌，有操作提示时自动选择“过”。";this.ruleLabel.text=t},e.prototype.showJYZ=function(){this.tab1.selected=!0,this.tab2.selected=!1,this.initRuleData1()},e.prototype.showCKT=function(){this.tab1.selected=!1,this.tab2.selected=!0,this.initRuleData2()},e.prototype.clean=function(){t.prototype.clean.call(this)},e}(t.EDialog);t.RuleDialog=e,__reflect(e.prototype,"game.RuleDialog")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.parse=function(e){this.roomId=e.roomId,this.endTime=e.endTime,this.curTurnDirection=e.curTurnDirection,this.curTurnNum=e.curTurnNum,this.turnNumber=e.turnNumber,this.roomNumber=e.roomNumber,this.masterUserId=e.masterUserId,this.roomType=e.roomType,this.turnMode=e.turnMode,this.userList=[];var a=e.userList;for(var n in a){var o=a[n],i=new t.CombatUserData;i.parse(o),this.userList.push(i)}},e}();t.CombatData=e,__reflect(e.prototype,"game.CombatData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.skinName="resource/skins/hall/zhanji/combatItemSkin.exml",a.combatData=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnInfo,this.showGainList),this.addTapEvent(this.rectCombatData,this.getCombatReplayData),this.updateUI()},a.prototype.setData=function(t){this.combatData=t,this.updateUI()},a.prototype.updateUI=function(){if(this.isViewCreated&&null!=this.combatData){this.labelRules.text=this.getRulesInfo(),this.labelRoomType.text=t.ConstantUtils.getRoomTypeName(this.combatData.roomType);for(var e=[this.userItem1,this.userItem2,this.userItem3,this.userItem4],a=e.length,n=this.combatData.userList.length,o=0;a>o;o++)n>o?(e[o].visible=!0,e[o].setData(this.combatData.masterUserId,this.combatData.userList[o])):e[o].visible=!1}},a.prototype.getRulesInfo=function(){var e="房号:"+this.combatData.roomNumber+"    ";return e+="把数:"+this.combatData.curTurnNum+"/"+this.combatData.turnNumber+"    ",e+=t.DateUtils.dateFormat(this.combatData.endTime)},a.prototype.showGainList=function(){var e=new t.GainListDialog(this.combatData.roomId);t.DialogManager.getInstance().show(e,t.EDialog.show_ani_type_null)},a.prototype.getCombatReplayData=function(){t.WaitingUI.show(),t.ZhanjiService.getInstance().getCombatReplayData(this.combatData.roomId)},a}(t.EComponent);t.CombatItem=e,__reflect(e.prototype,"game.CombatItem")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.prototype.parse=function(t){this.roomId=t.roomId,this.userId=t.userId,this.nickName=t.nickName,this.headUrl=t.headUrl,this.score=t.score,this.waiBaoScore=t.waiBaoScore,this.chairId=t.chairId,this.recordTime=t.recordTime},t}();t.CombatUserData=e,__reflect(e.prototype,"game.CombatUserData")}(game||(game={}));var CombatUserItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/zhanji/combatUserItemSkin",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.setData=function(t,e){this.masterId=t,this.combatUserData=e,this.updateUI()},e.prototype.updateUI_=function(){this.isViewCreated&&null!=this.combatUserData&&(this.labelNickName.text=this.combatUserData.nickName,this.labelScore.text=this.combatUserData.score+"",this.labelScore.textColor=game.ZhanJiColorUtils.getScoreColor(this.combatUserData.score),this.labelWaiBaoScore.text=this.combatUserData.waiBaoScore+"",this.labelWaiBaoScore.textColor=game.ZhanJiColorUtils.getWaiboScoreColor(this.combatUserData.waiBaoScore),this.imgMaster.visible=this.combatUserData.userId==this.masterId)},e}(game.EComponent);__reflect(CombatUserItem.prototype,"CombatUserItem"),window.CombatUserItem=CombatUserItem;var game;!function(t){var e=function(){function e(){}return e.prototype.parse=function(e){this.turnIndex=e.turnIndex,this.replayId=e.replayId,this.bankerChairId=e.bankerChairId,this.bxh=e.bxh,this.gainUserInfos=[];var a=e.gainUserInfos;for(var n in a){var o=a[n],i=new t.GainUserData;i.parse(o),this.gainUserInfos.push(i)}},e}();t.GainData=e,__reflect(e.prototype,"game.GainData")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this)||this;return a.skinName="resource/skins/hall/zhanji/gainItemSkin.exml",a.gainData=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnCopyReplayId,this.copyReplayId),this.addTapEvent(this.btnReplay,this.rqsReplayDataEvent),this.updateUI()},a.prototype.setData=function(t){this.gainData=t,this.updateUI()},a.prototype.updateUI=function(){if(this.isViewCreated&&null!=this.gainData){this.labelTurnIndex.text="第"+this.gainData.turnIndex+"把",this.labelReplayId.text=this.gainData.replayId+"",this.imgBxh.visible=this.gainData.bxh;for(var t=[this.gainUserItem1,this.gainUserItem2,this.gainUserItem3,this.gainUserItem4],e=t.length,a=this.gainData.gainUserInfos.length,n=0;e>n;n++)a>n?(t[n].visible=!0,t[n].setData(this.gainData.bankerChairId,this.gainData.gainUserInfos[n])):t[n].visible=!1}},a.prototype.copyReplayId=function(){Utils.copyToClipboard(this.gainData.replayId+"")},a.prototype.rqsReplayDataEvent=function(){t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_REPLAY,{replayId:this.gainData.replayId,gameId:Constants.GAME_ID_SET.nanjing})},a}(t.EComponent);t.GainItem=e,__reflect(e.prototype,"game.GainItem")}(game||(game={}));var game;!function(t){var e=function(e){function a(t){var a=e.call(this,Constants.UI_PANEL_DATA_SET.clubRecordDetails.index)||this;return a.roomId=0,a.skinName="resource/skins/hall/zhanji/gainListSkin.exml",a.roomId=t,a}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.initScroller(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_ZHANJI_DES_LIST),this.getGainListBack,this),this.getGainList()},a.prototype.getGainList=function(){t.ZhanjiService.getInstance().getGainList(this.roomId)},a.prototype.getGainListBack=function(e){var a=e.data;if(a.code==t.CmdResultType.SUCCESS){this.gainDataList=[];var n=a.data;for(var o in n){var i=n[o],s=new t.GainData;s.parse(i),this.gainDataList.push(s)}this.updateUI()}},a.prototype.initScroller=function(){this.list.setElementViewInfo(122,2),this.list.setElementCreateFunction(this.createElement.bind(this)),this.list.setElementUpdateDataFun(this.updateElement.bind(this)),this.list.setElementUpdateUIFun(this.updateElementUI.bind(this))},a.prototype.createElement=function(e){var a=new t.GainItem(e);return a},a.prototype.updateElement=function(t,e){t.setData(e)},a.prototype.updateElementUI=function(t){t.updateUI()},a.prototype.updateUI_=function(){this.list.clearContent(),this.list.setScrollerContent(this.gainDataList)},a.prototype.clean=function(){t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_ZHANJI_DES_LIST),this.getGainListBack,this),e.prototype.clean.call(this)},a}(t.EDialog);t.GainListDialog=e,__reflect(e.prototype,"game.GainListDialog")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.curScore=0,this.waibaoScore=0,this.faScore=0}return t.prototype.parse=function(t){this.userId=t.userId,this.nickName=t.nickName,this.userChairId=t.userChairId,this.curScore=t.curScore,this.waibaoScore=t.waibaoScore,this.faScore=t.faScore},t}();t.GainUserData=e,__reflect(e.prototype,"game.GainUserData")}(game||(game={}));var GainUserItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/zhanji/gainUserItemSkin",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.updateUI()},e.prototype.setData=function(t,e){this.bankerChairId=t,this.gainUserData=e,this.updateUI()},e.prototype.updateUI_=function(){if(null!=this.gainUserData){this.labelNickName.text=this.gainUserData.nickName,this.labelScore.text=this.gainUserData.curScore+"",this.labelScore.textColor=game.ZhanJiColorUtils.getScoreColor(this.gainUserData.curScore);var t=this.gainUserData.faScore,e=0!=t;this.labelFaScore.visible=e,e&&(t>0?this.labelFaScore.text="+"+t:this.labelFaScore.text=t+"",this.labelFaScore.textColor=game.ZhanJiColorUtils.getFaScoreColor(t)),this.labelWaiBaoScore.text=this.gainUserData.waibaoScore+"",this.labelWaiBaoScore.textColor=game.ZhanJiColorUtils.getWaiboScoreColor(this.gainUserData.waibaoScore),this.imgMaster.visible=this.gainUserData.userChairId==this.bankerChairId}},e}(game.EComponent);__reflect(GainUserItem.prototype,"GainUserItem"),window.GainUserItem=GainUserItem;var game;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/zhanji/combatItemSkin.exml",e}return __extends(e,t),e}(t.EComponent);t.Test=e,__reflect(e.prototype,"game.Test")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,null,!1)||this;return t.skinName="resource/skins/hall/zhanji/viewReplaySkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnCancel,this.close),this.addTapEvent(this.btnOK,this.clickOK),this.editReplayId.inputType=egret.TextFieldInputType.TEL,this.editReplayId.restrict="0-9",t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_REPLAY),this.replayCallback,this)},a.prototype.clickOK=function(){t.WaitingUI.show();var e=this.editReplayId.text.trim();return e.length<=0?(t.WaitingUI.hide(),void t.CommonView.showToast("请输入回放码")):Utils.isNumbers(e)?void t.SocketManager.getInstance().sendMsg(t.MsgConstant.HALL,t.MsgConstant.CMD_REPLAY,{replayId:e,gameId:Constants.GAME_ID_SET.nanjing}):(t.WaitingUI.hide(),void t.CommonView.showToast("回放码应该为数字"))},a.prototype.replayCallback=function(e){t.WaitingUI.hide();var a=e.data;a.code==t.CmdResultType.SUCCESS||a.errorCode==t.MsgConstant.ERROR_replaycode_no_exist&&t.CommonView.showToast("回放码不存在")},a}(t.EDialog);t.ViewReplayDialog=e,__reflect(e.prototype,"game.ViewReplayDialog")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getScoreColor=function(e){return t.getWaiboScoreColor(e)},t.getFaScoreColor=function(t){return 0>t?9830697:t>0?5476618:16777215},t.getWaiboScoreColor=function(t){return 0>t?8628704:t>0?16763904:16777215},t}();t.ZhanJiColorUtils=e,__reflect(e.prototype,"game.ZhanJiColorUtils")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.UI_PANEL_DATA_SET.zhanjiBox.index)||this;return t.skinName="resource/skins/hall/zhanji/zhanJiSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.btnClose,this.close),this.addTapEvent(this.btnViewOtherReplay,this.viewReplay),this.zhanjiUI.getCombatList()},a.prototype.viewReplay=function(){var e=new t.ViewReplayDialog;t.DialogManager.getInstance().show(e)},a.prototype.clean=function(){e.prototype.clean.call(this)},a}(t.EDialog);t.ZhanJiDialog=e,__reflect(e.prototype,"game.ZhanJiDialog")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.getCombatList=function(){var e={daiKai:!1},a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_ZHANJI_LIST,e);t.SocketManager.getInstance().send(a)},e.prototype.getCombatList_Club=function(e){var a={clubId:e},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_CLUB_ZHANJI_LIST,a);t.SocketManager.getInstance().send(n)},e.prototype.getGainList=function(e){var a={roomId:e},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_ZHANJI_DES_LIST,a);t.SocketManager.getInstance().send(n)},e.prototype.getCombatReplayData=function(e){var a={roomId:e},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_Combat_REPLAY_data,a);t.SocketManager.getInstance().send(n)},e.prototype.replay=function(e){var a={replayId:e,gameId:Constants.GAME_ID_SET.nanjing},n=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_REPLAY,a);t.SocketManager.getInstance().send(n)},e}();t.ZhanjiService=e,__reflect(e.prototype,"game.ZhanjiService")}(game||(game={}));var ZhanJiUI=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/hall/zhanji/zhanJiUISkin.exml",e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.initScroller(),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_ZHANJI_LIST),this.getCombatListBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ZHANJI_LIST),this.getCombatListBack,this),game.EAppFacade.getInstance().registerCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_Combat_REPLAY_data),this.getCombatReplayDataCallback,this)},e.prototype.getCombatReplayDataCallback=function(t){game.WaitingUI.hide();var e=t.data;if(e.code==game.CmdResultType.SUCCESS){var a=e.data;GlobalData.gameData.setAllOverData(a),game.DialogManager.getInstance().showPopBox(Constants.UI_PANEL_DATA_SET.gameOverBox.index,{isFromReplay:!0})}},e.prototype.getCombatList=function(){game.ZhanjiService.getInstance().getCombatList()},e.prototype.getCombatList_Club=function(t){game.ZhanjiService.getInstance().getCombatList_Club(t)},e.prototype.getCombatListBack=function(t){var e=t.data;if(e.code==game.CmdResultType.SUCCESS){this.combatDataList=[];var a=e.data;for(var n in a){var o=a[n],i=new game.CombatData;i.parse(o),this.combatDataList.push(i)}this.updateUI()}},e.prototype.initScroller=function(){this.list.setElementViewInfo(153,2),this.list.setElementCreateFunction(this.createElement.bind(this)),this.list.setElementUpdateDataFun(this.updateElement.bind(this)),this.list.setElementUpdateUIFun(this.updateElementUI.bind(this))},e.prototype.createElement=function(t){var e=new game.CombatItem(t);return e},e.prototype.updateElement=function(t,e){t.setData(e)},e.prototype.updateElementUI=function(t){t.updateUI()},e.prototype.updateUI_=function(){this.list.clearContent(),this.list.setScrollerContent(this.combatDataList)},e.prototype.clean=function(){game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_ZHANJI_LIST),this.getCombatListBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_CLUB_ZHANJI_LIST),this.getCombatListBack,this),game.EAppFacade.getInstance().removeCommand(game.GameCmd.getCmdFromNet(game.MsgConstant.CMD_Combat_REPLAY_data),this.getCombatReplayDataCallback,this),t.prototype.clean.call(this)},e}(game.EComponent);__reflect(ZhanJiUI.prototype,"ZhanJiUI"),window.ZhanJiUI=ZhanJiUI;var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.SCENE_INDEX.HOT_UPDATE)||this;return t.Image_progress_startX=0,t.skinName="resource/skins/loading/LoadingSceneSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){e.prototype.onCreateViewComplete.call(this),this.Image_progress_startX=this.Image_progress.x,this.loadingBar.labelFunction=function(t,e){return"资源加载中..."+t+"/"+e},RES.setMaxRetryTimes(50),RES.setMaxLoadingThread(5),RES.createGroup("load",["action"]),this.startLoadRes()},a.prototype.startLoadRes=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,RES.loadGroup("load",0,this)];case 1:return t.sent(),this.skip(),[2]}})})},a.prototype.skip=function(){t.SceneSkip.skipToLoginScene()},a.prototype.onProgress=function(t,e){this.loadingBar.value=Math.floor(t/e*100),this.Image_progress.x=this.Image_progress_startX+this.loadingBar.width*this.loadingBar.value/100},a.prototype.onCancel=function(){console.log("取消资源加载")},a.prototype.onPause=function(){},a.prototype.onResume=function(){var t=RES.isGroupLoaded("load");console.log("LoadingScene onResume loaded:"+t),t&&this.skip()},a}(t.SceneBase);t.LoadingScene=e,__reflect(e.prototype,"game.LoadingScene",["RES.PromiseTaskReporter"])}(game||(game={}));var ConnectConst;!function(t){t.ConnectStatus={Wait:0,Connecting:1,Connected:2,ConnectClose:3}}(ConnectConst||(ConnectConst={}));var game;!function(t){var e=function(){function e(){this.status=ConnectConst.ConnectStatus.Wait,this.timerRunning=!1}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.connect=function(a){this.udpateStatus(ConnectConst.ConnectStatus.Connecting),t.SocketManager.getInstance().connect(e.server_url,e.port,this.connectHandler.bind(this),t.DispatchHandler.getInstance().dispatch,a)},e.prototype.close=function(){t.SocketManager.getInstance().close()},e.prototype.udpateStatus=function(e){this.status=e,t.EAppFacade.getInstance().sendNotification(t.GameCmd.SOCKET_STATUS_CHANGE,{status:this.status}),t.LogUtils.info("连接状态变化="+this.status)},e.prototype.connectHandler=function(e){var a=e.status;this.udpateStatus(a),a==ConnectConst.ConnectStatus.Connected&&(this.timerRunning||(t.HeartBeatService.getInstance(),this.timerRunning=!0,this.startTimer()),t.UserInfoService.getInstance().autoLogin())},e.prototype.getStatus=function(){return this.status},e.prototype.startTimer=function(){null==this.timer&&(this.timer=new egret.Timer(1e3,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this)),this.timer.start()},e.prototype.stopTimer=function(){this.timer.stop(),this.timerRunning=!1},e.prototype.onTimer=function(){var e=this.status;e==ConnectConst.ConnectStatus.Connected?t.HeartBeatService.getInstance().sendHeartCmd():e==ConnectConst.ConnectStatus.ConnectClose&&t.HeartBeatService.getInstance().reConnect()},e.port=9001,e.server_url=Constants.server_url_current,e}();t.ConnectService=e,__reflect(e.prototype,"game.ConnectService")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.hallHandler=new t.HallHandler,this.gameHandler=new t.GameHandler}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.dispatch=function(a){var n=e.getInstance(),o=JSON.parse(a),i=t.MsgDomain.toBean(o),s=i.area;i.cmd;s==t.MsgConstant.HALL?n.hallHandler.handle(i):s==t.MsgConstant.GAME&&n.gameHandler.handle(i)},e}();t.DispatchHandler=e,__reflect(e.prototype,"game.DispatchHandler")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.getRequestDomain=function(e,a,n){var o=new t.MsgDomain;return o.area=e,o.cmd=a,o.data=n,o},e.getSuccessResponseDomain=function(e,a,n){var o=new t.MsgDomain;return o.area=e,o.cmd=a,o.data=n,o.code=t.MsgResultStatus.SUCCESS,o},e.getFailedResponseDomain=function(e,a,n,o,i){var s=new t.MsgDomain;return s.area=e,s.cmd=a,s.data=i,s.code=t.MsgResultStatus.FAILED,s.errorCode=n,s.msg=o,s},e}();t.DomainUtils=e,__reflect(e.prototype,"game.DomainUtils")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.handle=function(e){var a=e.cmd;switch(a){case t.MsgConstant.CMD_DEAL:t.GameDataService.getInstance().startGame(e);break;case t.MsgConstant.CMD_UPDATE_BOARD_INFO:GlobalData.isReconnecting&&GlobalData.setReconnecting(!1),t.GameDataService.getInstance().gameReconect(e),Utils.sendGameEvent(t.GameCmd.GAME_STATUS_CHANGED);break;case t.MsgConstant.CMD_USER_RECONNECTION:GlobalData.setReconnecting(!1),t.GameDataService.getInstance().parseReconnect(e);break;case t.MsgConstant.CMD_DRAW:t.GameDataService.getInstance().drawCard(e);break;case t.MsgConstant.CMD_DISCARD_OTHER:t.GameDataService.getInstance().otherDiscard(e);break;case t.MsgConstant.CMD_USER_STATUS_CHANGE:t.GameDataService.getInstance().playerStatusChanged(e);break;case t.MsgConstant.CMD_FAFEN:t.GameDataService.getInstance().faFenOperation(e);break;case t.MsgConstant.CMD_OPERATE_TIP:t.GameDataService.getInstance().operationCome(e);break;case t.MsgConstant.CMD_PONG:t.GameDataService.getInstance().pong(e);break;case t.MsgConstant.CMD_KONG:t.GameDataService.getInstance().kong(e);break;case t.MsgConstant.CMD_READY:t.GameDataService.getInstance().ready(e);break;case t.MsgConstant.CMD_DISCARD:t.GameDataService.getInstance().discard(e);break;case t.MsgConstant.CMD_PASS:t.GameDataService.getInstance().pass(e);break;case t.MsgConstant.CMD_AUTO_PASS:t.GameDataService.getInstance().autoPass(e);break;case t.MsgConstant.CMD_READY_FOR_NEXT:Utils.sendPanelEvent(t.GameCmd.CLOSE_GAME_SETTLE_PANEL);break;case t.MsgConstant.CMD_XJS_DATA:t.GameDataService.getInstance().xjsData(e);break;case t.MsgConstant.CMD_CHEAT:t.GameDataService.getInstance().preventCheatInfo(e);break;case t.MsgConstant.CMD_IGNORE_CHEAT:Utils.sendPanelEvent(t.GameCmd.CLOSE_CHEAT_INFO_BOX);break;case t.MsgConstant.CMD_CHEAT_LEAVE:GlobalData.gameData.setCheatStatus(!1),GlobalData.gameData.setNeedCheckCheat(!1),GlobalData.gameData.setPreventCheatInfo(null),Utils.sendPanelEvent(t.GameCmd.CLOSE_CHEAT_INFO_BOX);break;case t.MsgConstant.CMD_AUTO_DISCARD:t.GameDataService.getInstance().autoDiscard(e);break;case t.MsgConstant.CMD_Notice_AutoHost_start:t.GameDataService.getInstance().startAutoOfDelay(e);break;case t.MsgConstant.CMD_Notice_AutoHost_cancel:t.GameDataService.getInstance().cancelAutoOfDelay(e);break;case t.MsgConstant.CMD_Notice_AutoHost_Timer_start:t.GameDataService.getInstance().startAutoDiscardTimer(e);break;case t.MsgConstant.CMD_GET_SCORECARD_INFOS:t.GameDataService.getInstance().parseScoreBoardData(e);break;case t.MsgConstant.CMD_DJS_DATA:t.GameDataService.getInstance().djsData(e);break;case t.MsgConstant.CMD_SEND_MSG:t.GameDataService.getInstance().parseChatData(e);break;case t.MsgConstant.CMD_SEND_MSG_ANI:t.GameDataService.getInstance().parsePointEmotion(e);break;case t.MsgConstant.CMD_JIA:t.GameDataService.getInstance().beginJiapai(e);break;case t.MsgConstant.CMD_CANEL_JIA:t.GameDataService.getInstance().cancelJiapai(e);break;case t.MsgConstant.CMD_SYNC_POSITION:t.GameDataService.getInstance().parseAddress(e);break;case t.MsgConstant.CMD_getFlowerIds:t.GameDataService.getInstance().forceUpdateHuaCards(e);break;default:t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(a),e)}},e}();t.GameHandler=e,__reflect(e.prototype,"game.GameHandler")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.prototype.handle=function(e){var a=e.cmd;switch(a){case t.MsgConstant.CMD_USER_LOGIN:t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(a),e);break;case t.MsgConstant.CMD_CREATE_ROOM:t.RoomService.getInstance().createRoomCallBack(e),t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(a),e);break;case t.MsgConstant.CMD_JOIN_ROOM:t.RoomService.getInstance().joinRoomCallBack(e);break;case t.MsgConstant.CMD_SYSTEM_DISMISS_ROOM:Utils.sendPanelEvent(t.GameCmd.CLOSE_APPLY_QUIT_PANEL);break;case t.MsgConstant.CMD_DISMISS_ROOM:t.GameDataService.getInstance().dissolveRoom(e);break;case t.MsgConstant.CMD_REJECT_DISMISS_ROOM:Utils.sendGameEvent(t.GameCmd.APPLY_QUIT_REJECT,e.data);break;case t.MsgConstant.CMD_CANCEL_ROOM:case t.MsgConstant.CMD_CANCEL_DAIKAI_ROOM:case t.MsgConstant.CMD_CANCEL_TIMEOUT_ROOM:t.GameDataService.getInstance().cancelRoom(e);break;case t.MsgConstant.CMD_LEAVE_ROOM:t.GameDataService.getInstance().playerLeaveRoom(e);break;case t.MsgConstant.CMD_OTHER_LEAVE_ROOM:t.GameDataService.getInstance().otherPlayerLeaveRoom(e);break;case t.MsgConstant.CMD_OTHER_JOIN_ROOM:t.GameDataService.getInstance().otherPlayerJoinRoom(e);break;case t.MsgConstant.CMD_PERSON_AGAINS:t.GameDataService.getInstance().myAgainstData(e);break;case t.MsgConstant.CMD_PERSON_TOTAL_AGAINS:t.GameDataService.getInstance().totalAgainstData(e);break;case t.MsgConstant.CMD_switch_reject:t.GameDataService.getInstance().rejectChangePlayerNum(e);break;case t.MsgConstant.CMD_switch_player_num:t.GameDataService.getInstance().agreeChangePlayerNum(e);break;case t.MsgConstant.CMD_switch_cancel:t.GameDataService.getInstance().cancelChangePlayerNum(e);break;case t.MsgConstant.CMD_REPLAY:t.GameDataService.getInstance().parseReplayData(e),t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(a),e);break;case t.MsgConstant.CMD_USER_DIAMOND_CHANGE:t.GameDataService.getInstance().parseDiamond(e);break;case t.MsgConstant.CMD_USER_GOLD_CHANGE:t.GameDataService.getInstance().parseGold(e);break;case t.MsgConstant.CMD_Notice_kick_lefttime:t.GameDataService.getInstance().noticeKickLeftTime(e);break;case t.MsgConstant.CMD_Notice_cancel_kick:t.GameDataService.getInstance().cancelKickLeftTime(e);break;default:t.EAppFacade.getInstance().sendNotification(t.GameCmd.getCmdFromNet(a),e)}},e}();t.HallHandler=e,__reflect(e.prototype,"game.HallHandler")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.HALL=0,t.GAME=1,t.VERSION_ID=2,t.VERSION_NAME="2.0",t.ERROR_need_relogin=99999,t.ERROR_illegal_operation=99998,t.ERROR_forbid_login=99997,t.ERROR_creamRoom_inRoom=10001,t.ERROR_diamondNoEnough=10002,t.ERROR_creamRoom_paramError=10003,t.ERROR_room_over=10004,t.ERROR_joinRoom_roomId_error=10005,t.ERROR_join_inOtherRoom=10006,t.ERROR_join_ROOM_USERMAX=10007,t.ERROR_cancelDaiKai_gaming=10008,t.ERROR_hasNot_roomNumber=10009,t.ERROR_unionId_null=10010,t.ERROR_daiKai_maxLimit=10011,t.ERROR_Lack_userInfo=10012,t.ERROR_game_no_open=10013,t.ERROR_replaycode_no_exist=10014,t.ERROR_DataFormatIllegal=10020,t.ERROR_SaveEmailFail=10021,t.ERROR_playerNum3_low_version=10101,t.ERROR_playerNum3_repeatApply=10102,t.ERROR_Gold_not_enough=10201,t.ERROR_creamRoom_inRoom_new=10211,t.ERROR_content_already_end=10301,t.ERROR_redBag_valid_invite_not_enouth=10401,t.ERROR_redBag_valid_jus_not_enouth=10402,t.ERROR_club_hasPassed_member=10501,t.ERROR_club_hasUnCheck_member=10502,t.ERROR_club_memberTypeCanNotOperate=10503,t.ERROR_club_canNotRemoveSelf=10504,t.ERROR_club_monitorCanNotQuit=10505,t.ERROR_club_userIsNotInClub=10506,t.ERROR_club_MemberHasChecked=10507,t.ERROR_club_UserIdIsNotDaiLi=10508,t.ERROR_club_IsNotFund=10509,t.ERROR_club_userIsNotFund=10510,t.ERROR_invite_bind_no_proxy=10601,t.ERROR_invite_bind_has_proxy=10602,t.ERROR_need_refresh_board=10701,t.CMD_ADMIN_ForceCancelRoom=900001,t.CMD_CREATE_ROOM=101,t.CMD_JOIN_ROOM=102,t.CMD_LEAVE_ROOM=103,t.CMD_CANCEL_ROOM=104,t.CMD_DISMISS_ROOM=105,t.CMD_REJECT_DISMISS_ROOM=106,t.CMD_SYSTEM_DISMISS_ROOM=107,t.CMD_CANCEL_DAIKAI_ROOM=108,t.CMD_CANCEL_TIMEOUT_ROOM=109,t.CMD_CLICK_CREATE_ROOM=110,t.CMD_CANCEL_DAIKAI_ROOM_BACK=131,t.CMD_CHEAT=132,t.CMD_IGNORE_CHEAT=133,t.CMD_CHEAT_LEAVE=134,t.CMD_SYNC_POSITION=135,t.CMD_CLIENT_QUERY_ROOMNUMBER=136,t.CMD_switch_player_num=151,t.CMD_switch_reject=152,t.CMD_switch_cancel=153,t.CMD_getCanUseNumber=160,t.CMD_OTHER_JOIN_ROOM=112,t.CMD_OTHER_LEAVE_ROOM=113,t.CMD_USER_LOGIN=201,t.CMD_USER_InviteCode=202,t.CMD_USER_Change_Status=203,t.CMD_EMAIL_LIST=401,t.CMD_SEND_EMAIL=402,t.CMD_SAVE_EMAIL=403,t.CMD_VIEW_EMAIL=404,t.CMD_DRAW_EMAIL_ATTACH=405,t.CMD_EMAIL_TIP=406,t.CMD_SEND_MSG=501,t.CMD_SEND_CHAT=502,t.CMD_SEND_FACE=503,t.CMD_SEND_MSG_ANI=504,t.CMD_ZHANJI_LIST=601,t.CMD_ZHANJI_DES_LIST=602,t.CMD_DAIKAI_LIST=603,t.CMD_CLUB_ZHANJI_LIST=605,t.CMD_REPLAY=610,t.CMD_Combat_REPLAY_data=611,t.CMD_PERSON_AGAINS=620,t.CMD_PERSON_TOTAL_AGAINS=621,t.CMD_get_clientConfigs=701,t.CMD_record_errorInfo=702,t.CMD_CONTENT_LIST=801,t.CMD_ADDORUPDATE_CONTENT=802,t.CMD_CONTENT_DETAIL=803,t.CMD_CONTENT_DELETE=804,t.CMD_CONTENT_SHOW_TYPE=805,t.CMD_Activity_ShowType=806,t.CMD_DRAW_LOTTERY_INITDATA=850,t.CMD_DRAW_LOTTERY_OPER=851,t.CMD_DRAW_LOTTERY_RECORDS=852,t.CMD_DRAW_LOTTERY_TAKED=853,t.CMD_DRAW_LOTTERY_ONERECORD=854,t.CMD_DRAW_LOTTERY_TIMES=855,t.CMD_GET_TASK_LIST=901,t.CMD_GET_TASK_REWARD=902,t.CMD_TASK_TIP=903,t.CMD_SHARE_SUCCESS=904,t.CMD_HTTP_ADD_NEW_TASK=905,t.CMD_HTTP_CHANGE_TASK_STATUS=906,t.CMD_HTTP_DEL_ALL_TASK=907,t.CMD_GET_SCORECARD_INFOS=920,t.CMD_HEAR_THROB=1e3,t.CMD_DISCARD=1001,t.CMD_PONG=1002,t.CMD_KONG=1003,t.CMD_CHOW=1004,t.CMD_WIN=1005,t.CMD_READY=1006,t.CMD_PASS=1007,t.CMD_FAFEN=1008,t.CMD_getFlowerIds=1011,t.CMD_DRAW=1012,t.CMD_JIA=1014,t.CMD_CANEL_JIA=1015,t.CMD_DEAL=1021,t.CMD_UPDATE_BOARD_INFO=1022,t.CMD_USER_RECONNECTION=1023,t.CMD_USER_STATUS_CHANGE=1031,t.CMD_READY_FOR_NEXT=1032,t.CMD_BACK_HALL=1033,t.CMD_BACK_GAME=1034,t.CMD_APP_Background=1035,t.CMD_APP_Foreground=1036,t.CMD_DISCARD_OTHER=1101,t.CMD_PONG_OTHER=1102,t.CMD_OPERATE_TIP=1201,t.CMD_XJS_DATA=1301,t.CMD_DJS_DATA=1401,t.CMD_AUTO_DISCARD=1501,t.CMD_AUTO_PASS=1502,t.CMD_Notice_AutoHost_start=1511,t.CMD_Notice_AutoHost_cancel=1512,t.CMD_Notice_AutoHost_Timer_start=1513,t.CMD_Notice_kick_lefttime=1601,t.CMD_Notice_cancel_kick=1602,t.ERROR_WEB_BODY_NULL=8e3,t.ERROR_WEB_UNKNOWN_ERROR=8001,t.ERROR_WEB_BODY_ERROR=8002,t.ERROR_WEB_need_bind_proxy=8003,t.CMD_CREATE_ORDER=2001,t.CMD_ORDER_FINISH=2002,t.CMD_QUERY_ORDER_STATUS=2003,t.CMD_GET_ITEL_INFOS=2004,t.CMD_GRANT_ITEM=3e3,t.CMD_USER_DIAMOND_CHANGE=3001,t.CMD_PROXY_GRANT_ITEM=3002,t.CMD_USER_GOLD_CHANGE=3101,t.CMD_checkHotUpdate=4001,t.CMD_checkAppUpdate=4002,t.CMD_getAllScrollMsg=5001,t.CMD_AddScrollMsg=5002,t.CMD_deleteScrollMsg=5003,t.CMD_getSingleScrollMsg=5004,t.CMD_updateScrollMsgStatus=5005,t.CMD_getUserInviteInfos=6001,t.CMD_getTotalInviteInfos=6002,t.CMD_getInviteInfos=6003,t.CMD_Invite_draw_user_reward=6004,t.CMD_Invite_draw_total_reward=6005,t.CMD_Invite_bind_proxy=6006,t.CMD_Invite_getUserInviteInfos=6021,t.CMD_Invite_applyDrawInviteReward=6022,t.CMD_Invite_getUserInviteHistory=6023,t.CMD_Invite_sendUserInviteReward=6024,t.CMD_getHallShareCfgs=6031,t.CMD_addHallShareCfgs=6032,t.CMD_getAllHallShareCfgs=6033,t.CMD_delHallShareCfgById=6034,t.CMD_httpSendMail=7001,t.CMD_SELF_CHECK_DEAL=80001,t.mail_valid_sec=1296e3,t.show_type=1,t.CMD_COMMON_gold_change=90001001,t.CMD_COMMON_diamond_change=90001002,t.CMD_COMMON_start_game_backDiamond=90001003,t.CMD_COMMON_close_room=90002001,t.CMD_COMMON_create_room=10001001,t.CMD_COMMON_check_startGame=10002001,t.CMD_COMMON_liujiu_over=10002002,t.CMD_CLUB_CREATE=9001,t.CMD_CLUB_CHECK=9002,t.CMD_CLUB_ALLLIST=9003,t.CMD_CLUB_JOIN=9004,t.CMD_CLUB_MEMBER_CHECK=9005,t.CMD_CLUB_MEMBERLIST=9006,t.CMD_CLUB_SET_MEMBER=9007,t.CMD_CLUB_BACK=9008,t.CMD_CLUB_ROOMINFOLIST=9009,t.CMD_CLUB_ROMEINFHIS=9010,t.CMD_CLUB_LIST=9011,t.CMD_CLUB_SET_HASPUSH=9012,t.CMD_CLUB_WAITCHECK_MEMBERLIST=9013,t.CMD_CLUB_SENDNOTICE=9014,t.CMD_CLUB_REMOVEMEMBER=9015,t.CMD_CLUB_NOTICE=9016,t.CMD_CLUB_ROOMINFO_CHANGE=9017,t.CMD_CLUB_MEMBER_CHANGE=9018,t.CMD_CLUB_ROOM_AUTOCREATE=9019,t.CMD_CLUB_ONE=9020,t.CMD_CLUB_get_inviteMember_info=9021,t.CMD_CLUB_medify_club_info=9022,t.CMD_CLUB_set_hasPopNotice=9023,t.CMD_CLUB_get_hasPopNotice=9024,t.CMD_CLUB_setting=9025,t.CMD_CLUB_getSettingInfo=9026,t.CMD_CLUB_forceCancelRoom=9031,t.CMD_CLUB_transferManager=9032,t.CMD_CLUB_BIND_ALL_MEMBER=9033,t.CMD_CLUB_BIND_ONE_MEMBER=9034,t
}();t.MsgConstant=e,__reflect(e.prototype,"game.MsgConstant")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.version=t.MsgConstant.VERSION_NAME,this.versionId=t.MsgConstant.VERSION_ID,this.timestamp=(new Date).getTime(),this.code=a.FAILED,this.errorCode=0}return e.toBean=function(t){var a=new e;return a.area=t.area,a.cmd=t.cmd,a.code=t.code,a.msg=t.msg,a.errorCode=t.errorCode,a.data=t.data,a},e}();t.MsgDomain=e,__reflect(e.prototype,"game.MsgDomain");var a;!function(t){t[t.FAILED=0]="FAILED",t[t.SUCCESS=1]="SUCCESS"}(a=t.MsgResultStatus||(t.MsgResultStatus={}))}(game||(game={}));var EMarqueeText=function(t){function e(){var e=t.call(this)||this;return e.scrollSpeed=30,e.text="",e.addEventListener(eui.UIEvent.COMPLETE,e.onSelfViewComplete,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.clean,e),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.onSelfViewComplete=function(){console.log("ffff")},e.prototype.init=function(){this.touchEnabled=!0,this.label=new eui.Label,this.label.x=0,this.label.y=0,this.label.touchEnabled=!1,this.addChild(this.label),this.mask=new egret.Rectangle(0,0,this.width,this.height)},e.prototype.start=function(t){this.text=t,this.label.text=this.text,null==this._timer&&(this._timer=new egret.Timer(this.scrollSpeed),this._timer.addEventListener(egret.TimerEvent.TIMER,this.update,this)),this._timer.running&&this._timer.stop(),this.label.width>this.width&&(this.resetX(),this._timer.start())},e.prototype.setTextSize=function(t){this.label.size=t},e.prototype.setTextColor=function(t){this.label.textColor=t},e.prototype.resetX=function(){this.label.x=this.width+20},e.prototype.update=function(){this.label.x=this.label.x-2,this.label.x+this.label.width<0&&this.resetX()},e.prototype.clean=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.clean,this),null!=this._timer&&(this._timer.stop(),this._timer=null),this.removeChild(this.label),this.label=null},e}(eui.Group);__reflect(EMarqueeText.prototype,"EMarqueeText"),window.EMarqueeText=EMarqueeText;var game;!function(t){var e=function(){function e(){this.curScene=null}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.skipToScene=function(e){t.DialogManager.getInstance().clearAllDialog(),null!=this.curScene&&(Main.instance.sceneLayer.removeChild(this.curScene),this.curScene.onClose(),this.curScene=null),this.curScene=e,Main.instance.sceneLayer.addChild(this.curScene),this.curScene.onShow()},e.prototype.isInGame=function(){return this.curScene instanceof t.GameScene?!0:!1},e.instance=null,e}();t.SceneManager=e,__reflect(e.prototype,"game.SceneManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.skipToGameScene=function(e){var a=new t.GameScene(e);t.SceneManager.getInstance().skipToScene(a)},e.skipToLoginScene=function(){var e=new t.LoginScene;t.SceneManager.getInstance().skipToScene(e)},e.skipToHallScene=function(){var e=new t.HallScene;t.SceneManager.getInstance().skipToScene(e)},e.skipToClubScene=function(){var e=new t.ClubScene;t.SceneManager.getInstance().skipToScene(e)},e.skipToLoadinScene=function(){var e=new t.LoadingScene;t.SceneManager.getInstance().skipToScene(e)},e.skipToScene=function(t){switch(t){case Constants.SCENE_INDEX.HOT_UPDATE:e.skipToLoadinScene();break;case Constants.SCENE_INDEX.GAME:e.skipToGameScene();break;case Constants.SCENE_INDEX.MAIN:e.skipToHallScene();break;case Constants.SCENE_INDEX.CLUB:e.skipToClubScene();break;case Constants.SCENE_INDEX.LOGIN:e.skipToLoginScene()}},e}();t.SceneSkip=e,__reflect(e.prototype,"game.SceneSkip")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.hasLoadBgm=!1}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.loadBGM=function(t,e){},t.prototype.getBGMUrl=function(){},t.prototype.onLoadComplete=function(t){var e=t.target;this.sound=e.data},t}();t.BGMManager=e,__reflect(e.prototype,"game.BGMManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.sounds=new t.HashMap}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.addSound=function(t,e){this.sounds.put(t.hashCode,e)},e.prototype.removeSound=function(t){this.sounds.remove(t)},e.prototype.play=function(e,a){void 0===a&&(a=1);var n=RES.getRes(e),o=n.play(0,a),i=new t.SoundItem(e,n,o,a);return this.addSound(o,i),i},e.prototype.playSound=function(t,e){return __awaiter(this,void 0,void 0,function(){var a;return __generator(this,function(n){return a=t,RES.hasRes(a)&&RES.getResAsync(a,function(t){var a=t.originAudio;a.play(0,e)},this),[2]})})},e.prototype.playWxMusic=function(){platform.playBackgroundAudio("https://res.qixiyx.cn/file/bg.mp3")},e.prototype.playMusic=function(e,a,n){if(void 0===n&&(n=0),null!=t.SoundService.getInstance().curMusicChannel)return void(t.SoundService.getInstance().curMusicChannel.position=t.SoundService.getInstance().curMusicChannel.position);var o=e;if(RES.hasRes(o)){var i=RES.getRes(o);if(null==i)RES.getResAsync(o,function(t){this.playMusic(e,a)},this);else{t.SoundService.getInstance().curMusic=i;var s=t.SoundService.getInstance().curMusic.play(0,a);t.SoundService.getInstance().curMusicChannel=s}}},e.prototype.stopAllAudio=function(){var t=this.sounds.values();for(var e in t){var a=t[e];a.isBgMusic||(a.stop(),this.sounds.remove(a))}},e.prototype.stopAllSound=function(){var t=this.sounds.values();for(var e in t){var a=t[e];a.stop(),this.sounds.remove(a)}},e.prototype.pauseAllSound=function(){var t=this.sounds.values();for(var e in t){var a=t[e];a.pause()}},e.prototype.resumeAllSound=function(){var t=this.sounds.values();for(var e in t){var a=t[e];a.resume()}},e.prototype.resumeAllAudio=function(){var t=this.sounds.values();for(var e in t){var a=t[e];a.isBgMusic||a.resume()}},e}();t.SoundManager=e,__reflect(e.prototype,"game.SoundManager");var a=function(){function t(t,e,a,n){this.position=0,this.isPlaying=!1,this.isBgMusic=!1,this.name=t,this.sound=e,this.soundChannel=a,this.loops=n,this.isPlaying=!0,this.soundChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.playFinishCallback,this)}return t.prototype.playFinishCallback=function(t){egret.log("onSoundComplete");var a=t.target;e.getInstance().removeSound(a.hashCode)},t.prototype.stop=function(){this.clean()},t.prototype.pause=function(){this.position=this.soundChannel.position,this.clean()},t.prototype.resume=function(){if(!this.isPlaying){this.isPlaying=!0;var t=this.sound.play(this.position,this.loops);this.soundChannel=t,this.soundChannel.addEventListener(egret.Event.SOUND_COMPLETE,this.playFinishCallback,this),e.getInstance().addSound(this.soundChannel,this)}},t.prototype.clean=function(){this.isPlaying=!1,this.soundChannel.stop(),e.getInstance().removeSound(this.soundChannel.hashCode),this.soundChannel.removeEventListener(egret.Event.SOUND_COMPLETE,this.playFinishCallback,this)},t}();t.SoundItem=a,__reflect(a.prototype,"game.SoundItem")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.isBgMusicOn=!0,this.isPlaying=!1,this.isAudioOn=!1,this.bgMusic=null,this.curMusic=null,this.curMusicChannel=null,this.curMusicChannelPos=0,this.curPos=0,this.initData()}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.initData=function(){this.isBgMusicOn=this.getBgMusicSwitch_(),this.isAudioOn=this.getAudioSwitch_(),t.EAppFacade.getInstance().registerCommand(t.GameCmd.onResume,this.onResumeEvent,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.onPause,this.onPauseEvent,this)},e.prototype.onResumeEvent=function(){this.playMusic()},e.prototype.onPauseEvent=function(){this.pauseBgMusic()},e.prototype.getBgMusicSwitch=function(){return this.isBgMusicOn},e.prototype.getBgMusicSwitch_=function(){var t=DataStorage.readLocalData(LocalStorage.setting.GameMusicOn,"1");return"1"==t},e.prototype.setBgMusicSwitch=function(t){var e=t?1:0;this.isBgMusicOn=t,DataStorage.writeLocalData(LocalStorage.setting.GameMusicOn,""+e)},e.prototype.getAudioSwitch=function(){return this.isAudioOn},e.prototype.getAudioSwitch_=function(){var t=DataStorage.readLocalData(LocalStorage.setting.GameEffectOn,"1");return"1"==t},e.prototype.setAudioSwitch=function(t){var e=t?1:0;this.isAudioOn=t,DataStorage.writeLocalData(LocalStorage.setting.GameEffectOn,""+e)},e.prototype.playAudio=function(e,a){this.isAudioOn&&t.SoundManager.getInstance().playSound(e,a)},e.prototype.playMusic=function(e){void 0===e&&(e="bg_mp3"),this.isPlaying||(this.isBgMusicOn&&(GameConfig.platform==GameConfig.PLATFORM_SET.H5?t.SoundManager.getInstance().playMusic(e,0,this.curMusicChannelPos):t.SoundManager.getInstance().playWxMusic()),this.isPlaying=!0)},e.prototype.playBgMusic=function(e){void 0===e&&(e="bg_mp3"),this.isBgMusicOn&&(null==this.bgMusic?(this.bgMusic=t.SoundManager.getInstance().play(e,0),this.bgMusic.isBgMusic=!0):this.bgMusic.resume())},e.prototype.pauseBgMusic=function(){this.isPlaying=!1,GameConfig.platform==GameConfig.PLATFORM_SET.H5?null!=this.curMusicChannel&&(this.curMusicChannelPos=this.curMusicChannel.position,this.curMusicChannel.stop(),this.curMusicChannel=null):GameConfig.platform==GameConfig.PLATFORM_SET.weChat&&platform.pauseBackgroundAudio()},e.prototype.resumeBgMusic=function(){this.playMusic()},e.prototype.stopAllAudio=function(){t.SoundManager.getInstance().stopAllAudio()},e.prototype.resumeAllAudio=function(){this.isAudioOn&&t.SoundManager.getInstance().resumeAllAudio()},e.instance=null,e}();t.SoundService=e,__reflect(e.prototype,"game.SoundService")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.loginInfo=null,t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.loginCallBack,this)}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.login=function(e){this.loginInfo=e;var a=t.DomainUtils.getRequestDomain(t.MsgConstant.HALL,t.MsgConstant.CMD_USER_LOGIN,e);t.SocketManager.getInstance().send(a)},e.prototype.autoLogin=function(){var a=DataStorage.readLocalData(DataStorageConst.DATA_KEY_UnionId);if(a.length>0){var n=new t.MsgLoginInfo;n.unionId=a,e.getInstance().login(n)}else e.getInstance().login(this.loginInfo)},e.prototype.loginCallBack=function(e){t.WaitingUI.hide();var a=e.data;if(a.code==t.MsgResultStatus.SUCCESS)GlobalData.userData.parse(a.data),GlobalData.userData.setDiamondNum(a.data.diamond),GlobalData.userData.setGoldNum(a.data.gold),this.loginInfo.loginUserType!=t.LoginUserType.GUEST&&DataStorage.writeLocalData(DataStorageConst.DATA_KEY_UnionId,this.loginInfo.unionId),t.EAppFacade.getInstance().sendNotification(t.GameCmd.USER_LOGIN_SUCCESS);else{var n=a.errorCode;if(n==t.MsgConstant.ERROR_forbid_login){t.WaitingUI.hide();Utils.format(Strings.fobidLogin,GlobalData.clientConfigs.customer_info)}}},e.prototype.getUserInfo=function(){return GlobalData.userData},e.prototype.setLoginInfo=function(t){this.loginInfo=t},e}();t.UserInfoService=e,__reflect(e.prototype,"game.UserInfoService")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this,Constants.SCENE_INDEX.LOGIN)||this;return t.weChatLoginBtn=null,t.connectCount=0,t.skinName="resource/skins/login/loginSceneSkin.exml",t}return __extends(a,e),a.prototype.onCreateViewComplete=function(){GameConfig.platform==GameConfig.PLATFORM_SET.H5?(this.Group_test.visible=!0,this.addTapEvent(this.btnGuestLogin1,this.guestLogin),this.addTapEvent(this.btnGuestLogin2,this.guestLogin),this.addTapEvent(this.btnGuestLogin3,this.guestLogin),this.addTapEvent(this.btnGuestLogin4,this.guestLogin),this.addTapEvent(this.btnGuestLogin5,this.guestLogin)):this.Group_test.visible=!1,this.addTapEvent(this.btnWeiXinLogin,this.wxLoginEvent.bind(this)),t.EAppFacade.getInstance().registerCommand(t.GameCmd.SOCKET_STATUS_CHANGE,this.connectHandler,this),t.EAppFacade.getInstance().registerCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.userloginCallback,this),t.GameHttpManager.checkAppUpdate(),this.getLocation(),RES.createGroup("load",["common_json","bg_mp3","shareResult"]),RES.loadGroup("load"),GameConfig.platform==GameConfig.PLATFORM_SET.weChat?(this.btnWeiXinLogin.visible=!1,this.initLoginBtn()):this.btnWeiXinLogin.visible=!0},a.prototype.initLoginBtn=function(){var e=this,a=306,n=a/GameConfig.ScreenW*GameConfig.windowWidth/GameConfig.pixelRatio,o=102,i=o/GameConfig.ScreenH*GameConfig.windowHeight/GameConfig.pixelRatio;this.weChatLoginBtn=wx.createUserInfoButton({type:"image",image:"button_login_1.png",style:{left:(GameConfig.windowWidth/GameConfig.pixelRatio-n)/2,top:444/GameConfig.ScreenH*GameConfig.windowHeight/GameConfig.pixelRatio,width:n,height:i,lineHeight:40,backgroundColor:"#ff0000",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}}),this.weChatLoginBtn.onTap(function(a){a.errMsg.indexOf("auth deny")>-1||a.errMsg.indexOf("auth denied")>-1?t.CommonView.showToast("授权失败"):e.wxLoginByWechatLoginBtnEvent(a)}),this.weChatLoginBtn.show()},a.prototype.getLocation=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(a){switch(a.label){case 0:return t=GlobalData.userData.getLocation(),0!=t.latitude||0!=t.longitude?[2]:[4,platform.getLocation()];case 1:return e=a.sent(),null!=e&&(console.log(e),GlobalData.userData.setLocation(e.longitude,e.latitude)),[2]}})})},a.prototype.wxLoginByWechatLoginBtnEvent=function(e){return __awaiter(this,void 0,void 0,function(){var a,n,o,i;return __generator(this,function(s){switch(s.label){case 0:return t.WaitingUI.show(),this.weChatLoginBtn&&this.weChatLoginBtn.hide(),a=e.userInfo,console.log(e),void 0==a.nickName||null==a.nickName?(t.WaitingUI.hide(),console.log("userInfo is null"),this.weChatLoginBtn.show(),[2]):(console.log(a),this.userInfo=e.userInfo,[4,platform.login()]);case 1:return n=s.sent(),void 0==n.code||null==n.code?(t.WaitingUI.hide(),console.log("loginData is null"),this.weChatLoginBtn.show(),[2]):(console.log(n),o=e.encryptedData,i=e.iv,t.GameHttpManager.getUnionId(n.code,o,i,this.getUnionIdCallBack.bind(this)),[2])}})})},a.prototype.wxLoginEvent=function(){return __awaiter(this,void 0,void 0,function(){var e,a,n,o,i,s,r;return __generator(this,function(l){switch(l.label){case 0:return[4,this.checkAuthSetting()];case 1:return(e=l.sent())?(console.log("checkAuthSetting failed"),[2]):(t.WaitingUI.show(),[4,platform.getUserInfo(function(){t.WaitingUI.hide(),t.DialogManager.getInstance().popUp1("您拒绝授权，重新授权页面的进入路径为：右上角菜单->关于（小程序名字）->右上角菜单->设置")})]);case 2:return a=l.sent(),n=a.errMsg.indexOf("auth deny"),console.log(a),a.errMsg.indexOf("auth deny")>-1||a.errMsg.indexOf("auth denied")>-1?(t.WaitingUI.hide(),t.DialogManager.getInstance().popUp1("您拒绝授权，重新授权页面的进入路径为：右上角菜单->关于（小程序名字）->右上角菜单->设置"),[2]):(o=a.userInfo,console.log(o),void 0==o.nickName||null==o.nickName?(t.WaitingUI.hide(),console.log("userInfo is null"),[2]):(console.log(o),this.userInfo=o,[4,platform.login()]));case 3:return i=l.sent(),void 0==i.code||null==i.code?(t.WaitingUI.hide(),console.log("loginData is null"),[2]):(console.log(i),s=a.encryptedData,r=a.iv,t.GameHttpManager.getUnionId(i.code,s,r,this.getUnionIdCallBack.bind(this)),[2])}})})},a.prototype.checkAuthSetting=function(){return __awaiter(this,void 0,void 0,function(){var e,a;return __generator(this,function(n){switch(n.label){case 0:return[4,platform.getSetting()];case 1:if(e=n.sent(),console.log(e),a=e.authSetting,a["scope.userInfo"]===!0);else if(a["scope.userInfo"]===!1)return t.DialogManager.getInstance().popUp1("您拒绝授权，重新授权页面的进入路径为：右上角菜单->关于（小程序名字）->右上角菜单->设置"),[2,!0];return[2,!1]}})})},a.prototype.getUnionIdCallBack=function(e){if(t.WaitingUI.hide(),e.code==t.CmdResultType.SUCCESS){console.log(e);var a=e.data,n=a.unionId,o=a.openId,i=new t.MsgLoginInfo;i.openId=o,i.channel="mina",i.platform="qinghuai",i.headImgUrl=this.userInfo.avatarUrl,i.nickName=this.userInfo.nickName,i.gender=this.userInfo.gender,i.unionId=n,i.hasRegisterInfo=!0,i.loginUserType=t.LoginUserType.WEIXIN,t.UserInfoService.getInstance().setLoginInfo(i),t.ConnectService.getInstance().getStatus()==ConnectConst.ConnectStatus.Connected?(t.WaitingUI.show(),t.UserInfoService.getInstance().login(i)):this.connectSocketServer(!0)}else t.CommonView.showToast(Strings.loginFailed),this.weChatLoginBtn&&this.weChatLoginBtn.show()},a.prototype.connectSocketServer=function(e){t.WaitingUI.show(),this.connectCount++,t.ConnectService.getInstance().connect(!0)},a.prototype.connectHandler=function(t){if(null!=t.data){var e=t.data.status;if(e==ConnectConst.ConnectStatus.ConnectClose){egret.setTimeout(function(t){this.connectSocketServer(!1)},this,2e3,"egret")}else e==ConnectConst.ConnectStatus.Connected}},a.prototype.guestLogin=function(e){var a=this.getGuestIndex(e),n=new t.MsgLoginInfo,o=110;n.openId="openId_"+(o+a),n.channel="android",n.platform="qinghuai",n.headImgUrl="http://wx.qlogo.cn/mmopen/QiaGV991oIlm6kG5bjbRKhq5AeRWfOiaAibLqMon7F5iceQ7o31Pvj7mUroEb7W32KZiad9DrkGVMvJx4ULDJiaKRCzh8LEAzGR3Sv/0",n.nickName="guest_"+(o+a),n.gender=a%2==0?t.GenderType.MAN:t.GenderType.WOMAN,n.unionId="unionId_"+(o+a),n.hasRegisterInfo=!0,n.loginUserType=t.LoginUserType.GUEST,t.UserInfoService.getInstance().setLoginInfo(n),t.ConnectService.getInstance().getStatus()==ConnectConst.ConnectStatus.Connected?(t.WaitingUI.show(),t.UserInfoService.getInstance().login(n)):this.connectSocketServer(!0)},a.prototype.getGuestIndex=function(t){var e=t.currentTarget;return e==this.btnGuestLogin1?1:e==this.btnGuestLogin2?2:e==this.btnGuestLogin3?3:e==this.btnGuestLogin4?4:e==this.btnGuestLogin5?5:0},a.prototype.userloginCallback=function(e){t.WaitingUI.hide();var a=e.data;a.code==t.CmdResultType.SUCCESS?t.SceneSkip.skipToHallScene():t.CommonView.showToast("登陆失败，请重试!")},a.prototype.clean=function(){null!=this.weChatLoginBtn&&(this.weChatLoginBtn.hide(),this.weChatLoginBtn.destroy()),t.EAppFacade.getInstance().removeCommand(t.GameCmd.SOCKET_STATUS_CHANGE,this.connectHandler,this),t.EAppFacade.getInstance().removeCommand(t.GameCmd.getCmdFromNet(t.MsgConstant.CMD_USER_LOGIN),this.userloginCallback,this),e.prototype.clean.call(this)},a}(t.SceneBase);t.LoginScene=e,__reflect(e.prototype,"game.LoginScene")}(game||(game={}));var game;!function(t){var e;!function(t){t[t.NULL=0]="NULL",t[t.WEIXIN=1]="WEIXIN",t[t.GUEST=2]="GUEST"}(e=t.LoginUserType||(t.LoginUserType={}));var a;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.MAN=1]="MAN",t[t.WOMAN=2]="WOMAN"}(a=t.GenderType||(t.GenderType={}))}(game||(game={}));var game;!function(t){var e=function(){function e(){this.openId="HHFJIAKAAK",this.nickName="老辛",this.hasRegisterInfo=!1,this.loginUserType=t.LoginUserType.NULL}return e.prototype.toJsonString=function(){return JSON.stringify(this)},e}();t.MsgLoginInfo=e,__reflect(e.prototype,"game.MsgLoginInfo")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.allCards={normalCard:[],huaCard:[]},this.cardValueList={Character:[1,2,3,4,5,6,7,8,9],Bamboo:[11,12,13,14,15,16,17,18,19],Dot:[21,22,23,24,25,26,27,28,29],Flower:[51,53,55,57,61,63,65,67],Wind:[31,33,35,37],Dragon:[41,43,45]},this.playerSet={},this.gameStatus=GameConst.GAME_STATUS_TYPE.playing,this.playerNum=4,this.isPlayBack=!0,this.testChairId=1}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.prototype.initMockData=function(){this.initUserData(),this.initRoomData(),this.initAllCards(),this.initAllPlayers()},e.prototype.initAllPlayers=function(){var e=1;GlobalData.gameData.setMyChairId(e),GlobalData.gameData.setDiscardChairId(e),this.testChairId=e;for(var a=(GameConst.ME_DIR,0);a<this.playerNum;a++){var n=a+1,o=GlobalData.gameData.changeChairIdToClientId(a),i=new t.PlayerInfo,s=Utils.getRandom(1,3);n==e?(i.setIP(GlobalData.userData.getIP()),i.setHeadIMGUrl(GlobalData.userData.getHeadIMGUrl()),i.setGender(GlobalData.userData.getGender()),i.setUserId(GlobalData.userData.getUserId()),i.setUserName(GlobalData.userData.getUserName())):(i.setIP("192.168.1."+n),i.setHeadIMGUrl(Constants.DEFAULT_HEAD_IMG_URL),i.setGender(s),i.setUserId(111+n),i.setUserName("1234456"+n)),i.setScore(GlobalData.gameData.getRoomInfo().getRoomScore()),i.setChairId(n),i.setStatus(GameConst.PLAYER_STATUS.PLAYING);var r=new t.PlayerCardData;i.setCardData(r),r.setPongKongCards(this.getPongKongCards());var l=r.getPongKongNum();r.setPlayerHandCards(this.getHandCards(l,o,GlobalData.gameData.getDiscardChairId()==n)),r.setPlayerHuaCards(this.getHuaCards(o)),r.setPlayerOutCards(this.getOutCards(o)),this.playerSet[i.getChairId()]=i}},e.prototype.use=function(e){var a=e.area,n=e.cmd,o=null,i=a,s=n;a==t.MsgConstant.GAME&&n==t.MsgConstant.CMD_DISCARD&&(s=t.MsgConstant.CMD_DRAW,o={chairId:GlobalData.gameData.getMyChairId(),tileIds:[1],tingInfos:this.getTingTintData()}),null!=o&&this.sendMockData(i,s,o)},e.prototype.getPongKongCards=function(){for(var e=0,a=[],n=0;e>n;n++){var o=GameConst.PLAY_DIR.left;0==n?o=GameConst.PLAY_DIR.down:1==n&&(o=GameConst.PLAY_DIR.up);var i={type:GameConst.GAIN_TYPE.PongKong,provideClientId:o,value:[1]},s=new t.PongKongData(i);a.push(s)}return a},e.prototype.getOutCards=function(e){for(var a=15,n=[],o=0;a>o;o++){var i=this.allCards.normalCard.pop();null==i&&t.LogUtils.info(""),n.push(i)}return n},e.prototype.getHuaCards=function(t){for(var e=5,a=[],n=0;e>n&&0!=this.allCards.huaCard.length;n++){var o=this.allCards.huaCard.pop();a.push(o)}return a},e.prototype.getHandCards=function(t,e,a){for(var n=14-3*t,o=[],i=0;n>i;i++)if(e==GameConst.ME_DIR||this.isPlayBack){var s=this.allCards.normalCard.pop();o.push(1)}else o.push(0);if(o.sort(function(t,e){return t-e}),a)if(e==GameConst.ME_DIR||this.isPlayBack){var s=this.allCards.normalCard.pop();o.push(s)}else o.push(0);return o},e.prototype.initAllCards=function(){t.LogUtils.info("initAllCards");for(var e=0;e<this.cardValueList.Character.length;e++)for(var a=0;4>a;a++)this.allCards.normalCard.push(this.cardValueList.Character[e]);for(var e=0;e<this.cardValueList.Bamboo.length;e++)for(var a=0;4>a;a++)this.allCards.normalCard.push(this.cardValueList.Bamboo[e]);for(var e=0;e<this.cardValueList.Dot.length;e++)for(var a=0;4>a;a++)this.allCards.normalCard.push(this.cardValueList.Dot[e]);for(var e=0;e<this.cardValueList.Flower.length;e++)this.allCards.huaCard.push(this.cardValueList.Flower[e]);for(var e=0;e<this.cardValueList.Wind.length;e++)for(var a=0;4>a;a++)this.allCards.normalCard.push(this.cardValueList.Wind[e]);for(var e=0;e<this.cardValueList.Dragon.length;e++)for(var a=0;4>a;a++)this.allCards.huaCard.push(this.cardValueList.Dragon[e]);this.Shuffle()},e.prototype.Shuffle=function(){for(var t=this.allCards.normalCard.length,e=0;t>e;e++){var a=Utils.getRandom(e,t),n=this.allCards.normalCard[a];this.allCards.normalCard[a]=this.allCards.normalCard[e],this.allCards.normalCard[e]=n}for(var o=this.allCards.huaCard.length,e=0;o>e;e++){var a=Utils.getRandom(e,o),n=this.allCards.huaCard[a],n=this.allCards.huaCard[a];this.allCards.huaCard[a]=this.allCards.huaCard[e],this.allCards.huaCard[e]=n}},e.prototype.initRoomData=function(){var t={roomNumber:888888,roomType:Constants.ROOM_TYPE.jinYuanZi,roomScore:100,turnMode:Constants.ROOM_TIME_MODE.ba,turnNumber:8,payMode:Constants.ROOM_PAY_MODE.creator,huaZa:!0,faFen:!0,jieZhuangBi:!0,roomId:1,masterUserId:GlobalData.userData.getUserId()};GlobalData.gameData.getRoomInfo().parse(t)},e.prototype.initUserData=function(){var t={roomNumber:0,user:{userId:1,ip:"11.11.11.11",gender:Constants.GENDER.man,nickName:"测试玩家",headImgUrl:Constants.DEFAULT_HEAD_IMG_URL}};GlobalData.userData.parse(t),GlobalData.userData.setDiamondNum(123456),GlobalData.userData.setGoldNum(123456)},e.prototype.getMockGameData=function(){for(var e=this.getAllUserInfos(),a=[],n=0;n<this.playerNum;n++){t.LogUtils.info("mock reconnect msgUserGames i "+n);for(var o=n+1,i={msgUserData:e[o],jiaTileId:0,hasTing:!1,discardTileIds:this.playerSet[o].getCardData().getPlayerOutCards(),flowerIds:this.playerSet[o].getCardData().getPlayerHuaCards(),userTileIds:this.playerSet[o].getCardData().getPlayerHandCards(),gainTileInfos:[]},s=(GlobalData.gameData.changeChairIdToClientId(o),this.playerSet[o].getCardData().getPongKongCards()),r=0;r<s.length;r++){var l=s[r],c={discardChairId:GlobalData.gameData.changeClientIdToChairId(l.getProvideClientId()),gainType:l.getType(),tileIds:l.getValue()};i.gainTileInfos.push(c)}a.push(i)}var u=GlobalData.gameData.getRoomInfo(),h={bankerChairId:this.testChairId,biXiaHu:!0,biXiaHuDesc:"比下胡原因描述比下胡原因描述比下胡原因描述比下胡原因描述比下胡原因描述比下胡原因描述",curTurnNum:1,curTurnDirection:1,curChairId:GlobalData.gameData.getDiscardChairId(),lastDiscardChairId:4,lastDiscardTileId:1,stackTileNum:81,playerNum:this.playerNum,msgRoomGaming:{msgRoom:{roomNumber:u.getRoomNum(),roomType:u.getRoomType(),roomScore:u.getRoomScore(),turnMode:u.getTurnMode(),turnNumber:u.getTurnNumber(),payMode:u.getPayMode(),huaZa:u.isHuaZa(),faFen:u.isFaFen(),jieZhuangBi:u.isJieZhuangBi(),roomId:u.getRoomId(),masterUserId:u.getMasterUserId()},roomStatus:this.gameStatus},msgUserGames:a};return h},e.prototype.getAllUserInfos=function(){for(var t=[],e=0;e<this.playerNum;e++){var a=e+1,n=this.playerSet[a],o={chairId:n.getChairId(),userStatus:n.getStatus(),score:100,faScore:0,waiBaoScore:0,msgUser:this.getUserBaseInfo(a)};t[o.chairId]=o}return t},e.prototype.getUserBaseInfo=function(t){var e=this.playerSet[t],a={ip:e.getIP(),userId:e.getUserId(),gender:e.getGender(),headImgUrl:e.getHeadIMGUrl(),nickName:e.getUserName()};return a},e.prototype.sendMockData=function(e,a,n){var o={code:t.MsgResultStatus.SUCCESS,area:e,cmd:a,data:n},i=JSON.stringify(o),s=t.Base64Utils.encode(i+"\n");t.SocketManager.getInstance().onReceiveMessageEvent(s)},e.prototype.sendMockGameSettleData=function(){var e=this.getOverData();this.sendMockData(t.MsgConstant.GAME,t.MsgConstant.CMD_XJS_DATA,e)},e.prototype.getOverData=function(){for(var t={bankerChairId:GlobalData.gameData.getMyChairId(),baoPai:!0,baoPaiChairId:4,liuJuType:2,roomStatus:GameConst.GAME_STATUS_TYPE.over,winType:2,time:(new Date).getTime(),winPlayerNum:0,xJSUserInfos:null},e=[{curScore:210,faScore:90,score:400,superPointType:0,userChairId:1,waiBao:!0,waibaoScore:100,win:!0,msgUser:null,heapInfos:[{gain:!1,tileIds:[27,27]},{gain:!1,tileIds:[28,28]},{gain:!1,tileIds:[29,29]},{gain:!1,tileIds:[29,29]},{gain:!1,tileIds:[29,29]},{gain:!1,tileIds:[29,29]},{gain:!1,tileIds:[29,29]}],winTypeInfos:[{desc:"+10",name:"成牌",score:10,winPointType:0},{desc:"+10",name:"成牌",score:10,winPointType:0},{desc:"+10",name:"成牌",score:10,winPointType:0}]},{curScore:0,faScore:-30,score:0,superPointType:0,userChairId:4,waiBao:!1,waibaoScore:0,win:!1,msgUser:null,heapInfos:[{gain:!0,direction:1,tileIds:[27,27,27]},{gain:!0,direction:1,tileIds:[28,28,28,28]},{gain:!0,direction:1,tileIds:[29,29,29]},{gain:!0,direction:1,tileIds:[29,29,29]},{gain:!1,tileIds:[1]},{gain:!1,tileIds:[3]}],winTypeInfos:[{desc:"+10",name:"成牌",score:10,winPointType:0},{desc:"+10",name:"成牌",score:10,winPointType:0},{desc:"+10",name:"成牌",score:10,winPointType:0}]},{curScore:0,faScore:-30,score:0,superPointType:0,userChairId:2,waiBao:!1,waibaoScore:0,win:!1,msgUser:null,heapInfos:[{gain:!1,tileIds:[27,27,27,28,28,28,28,29,29,29,29,31,31]}]}],a=0;a<e.length;a++){var n=e[a].userChairId;e[a].msgUser=this.getUserBaseInfo(n)}return t.xJSUserInfos=e,t},e.prototype.getTingTintData=function(){for(var t=[],e=1;5>e;e++){var a={tileId:1,tingInfos:null};a.tileId=e;for(var n=[],o=0;2>o;o++){var i={tileId:1,num:1};i.tileId=e,i.num=e,n.push(i)}a.tingInfos=n,t.push(a)}return t},e.prototype.mockJiaPai=function(){var e={chairId:1,jiaTileId:1};this.sendMockData(t.MsgConstant.GAME,t.MsgConstant.CMD_JIA,e)},e}();t.Mock=e,__reflect(e.prototype,"game.Mock")}(game||(game={}));var game;!function(t){var e=function(){function e(e,a){this.startTime=0,this.needTime=0,this.status=0,this.itemCmd=t.UUID.generateUUID(),this.timerType=a,this.needTime=e}return e.prototype.start=function(){var a=t.EAppFacade.getInstance().getNowTime();this.status=e.TimerStatus.start,this.startTime=a,this.updateLeftTime(a)},e.prototype.update=function(t){this.status=e.TimerStatus.process,this.updateLeftTime(t)},e.prototype.updateLeftTime=function(t){this.leftTime=this.needTime-(t-this.startTime),this.leftTime<0&&(this.leftTime=0,this.status=e.TimerStatus.end)},e.TimerType={once:1,perSec:2},e.TimerStatus={start:1,process:2,end:0},e}();t.TimerItem=e,__reflect(e.prototype,"game.TimerItem")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.lastTime=0,this.items=new t.HashMap,this.initData()}return e.prototype.initData=function(){t.EAppFacade.getInstance().getNowTime()},e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.onTimer=function(){var a=t.EAppFacade.getInstance().getNowTime();if(a-this.lastTime>=e.UPDATE_TIME){t.EAppFacade.getInstance().sendNotification(t.TimerType.ONE_SECOND,""),this.lastTime=a;for(var n=this.items.values(),o=n.length,i=o-1;i>=0;i--){var s=n[i];s.update(a),s.leftTime<=0?(t.EAppFacade.getInstance().sendNotification(s.itemCmd,s),this.items.remove(s.itemCmd)):s.timerType==t.TimerItem.TimerType.perSec&&t.EAppFacade.getInstance().sendNotification(s.itemCmd,s)}}},e.prototype.startTimer=function(e,a,n,o){var i=new t.TimerItem(a,e);return t.EAppFacade.getInstance().registerCommand(i.itemCmd,n,o),this.items.put(i.itemCmd,i),i.start(),i.itemCmd},e.prototype.stopTimer=function(e,a){void 0===a&&(a=!1);var n=this.items.get(e);null!=n&&(this.items.remove(n.itemCmd),a&&t.EAppFacade.getInstance().sendNotification(e,n))},e.UPDATE_TIME=1e3,e}();t.TimerItemManager=e,__reflect(e.prototype,"game.TimerItemManager")}(game||(game={}));var game;!function(t){var e=function(){function e(){this.timer=new egret.Timer(100,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this)}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.onTimer=function(){t.TimerItemManager.getInstance().onTimer()},e.prototype.start=function(){this.timer.start()},e.prototype.stop=function(){this.timer.stop()},e}();t.TimerManager=e,__reflect(e.prototype,"game.TimerManager")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.ONE_SECOND="TIMER_ONE_SECOND",t}();t.TimerType=e,__reflect(e.prototype,"game.TimerType")}(game||(game={}));var Base64;!function(t){function e(t){for(var e="",a=0;a<t.length;a++)""===e?e=t.charCodeAt(a).toString(16):e+=","+t.charCodeAt(a).toString(16);return new Uint8Array(e.match(/[\da-f]{2}/gi).map(function(t){return parseInt(t,16)})).buffer}function a(t){var e,a,n,o,i,s;for(e="",n=t.length,a=0;n>a;)switch(o=t[a++],o>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCharCode(o);break;case 12:case 13:i=t[a++],e+=String.fromCharCode((31&o)<<6|63&i);break;case 14:i=t[a++],s=t[a++],e+=String.fromCharCode((15&o)<<12|(63&i)<<6|(63&s)<<0)}var r=new RegExp("[%$]+","ig");e=e.replace(r,"");var l=decodeURIComponent(e);return l}function n(t){for(var e=new Uint16Array(t),a=e.length,n="",o=Math.pow(2,16)-1,i=0;a>i;i+=o)i+o>a&&(o=a-i),n+=String.fromCharCode.apply(null,e.subarray(i,i+o));return decodeURIComponent(n)}function o(e){var a=e.length;if(0===a)return"";if(a%4!==0)throw new Error("Bad length: "+a);if(!e.match(/^[a-zA-Z0-9+\/]+={0,2}$/))throw new Error("Invalid base64 encoded value");var n=3*(a/4),o=0;"="===e.charAt(a-1)&&(o++,n--),"="===e.charAt(a-2)&&(o++,n--);var i,r=new Uint8Array(new ArrayBuffer(n)),l=0,c=0;for(o>0&&(a-=4);a>l;){i=0;for(var u=0;4>u;++u)i=i<<6|s[e.charAt(l+u)];r[c++]=i>>16&255,r[c++]=i>>8&255,r[c++]=255&i,l+=4}if(o>0){i=0;for(var u=0;4-o>u;++u)i=i<<6|s[e.charAt(l+u)];1===o?(i>>=2,r[c++]=i>>8&255,r[c++]=255&i):(i>>=4,r[c++]=255&i)}return t.Utf8ArrayToStr(r)}for(var i="pqabcdeABCDEFGHIJKLklmMNOPQRS34TUVWX8YZfghijnor+stuvwxyz0125679/",s={},r=0;r<i.length;++r)s[i[r]]=r;t.stringToUint=e,t.Utf8ArrayToStr=a,t.arrayBufferToString=n,t.decode=o}(Base64||(Base64={}));var game;!function(t){var e=function(){function t(){}return t.getBytes=function(t){for(var e=[],a=0;a<t.length;++a)e.push(t.charCodeAt(a));
return e},t.encode=function(e){e=e.replace(/\r\n/g,"\n");var a,n,o,i,s,r,l,c="",u=0;for(e=t._utf8_encode(e);u<e.length;)a=e.charCodeAt(u++),n=e.charCodeAt(u++),o=e.charCodeAt(u++),i=a>>2,s=(3&a)<<4|n>>4,r=(15&n)<<2|o>>6,l=63&o,isNaN(n)?r=l=64:isNaN(o)&&(l=64),c=c+t._keyStr.charAt(i)+t._keyStr.charAt(s)+t._keyStr.charAt(r)+t._keyStr.charAt(l);return c},t._utf8_encode=function(t){for(var e="",a=0;a<t.length;a++){var n=t.charCodeAt(a);128>n?e+=String.fromCharCode(n):n>127&&2048>n?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e},t._utf8_decode=function(t){for(var e="",a=0,n=0,o=0,i=0;a<t.length;)n=t.charCodeAt(a),128>n?(e+=String.fromCharCode(n),a++):n>191&&224>n?(o=t.charCodeAt(a+1),e+=String.fromCharCode((31&n)<<6|63&o),a+=2):(o=t.charCodeAt(a+1),i=t.charCodeAt(a+2),e+=String.fromCharCode((15&n)<<12|(63&o)<<6|63&i),a+=3);return e},t._keyStr="pqabcdeABCDEFGHIJKLklmMNOPQRS34TUVWX8YZfghijnor+stuvwxyz0125679/",t}();t.Base64Utils=e,__reflect(e.prototype,"game.Base64Utils")}(game||(game={}));var DataStorage=function(){function t(){}return t.writeLocalData=function(t,e){egret.localStorage.setItem(t,e)},t.readLocalData=function(t,e){(void 0==e||null==e)&&(e="");var a="";return a=egret.localStorage.getItem(t),a=""==a||void 0==a||null==a?e:a},t.removeLocalData=function(t){egret.localStorage.removeItem(t)},t}();__reflect(DataStorage.prototype,"DataStorage");var DataStorageConst=function(){function t(){}return t.DATA_KEY_UnionId="login_user_unionId_1",t}();__reflect(DataStorageConst.prototype,"DataStorageConst");var game;!function(t){var e=function(){function t(){}return t.dateToString=function(t){},t.dateFormat=function(t){var e=new Date(t),a=e.getFullYear(),n=e.getMonth()+1,o=e.getDate(),i=e.getHours(),s=e.getMinutes(),r=e.getSeconds(),l=a+"-";return 10>n&&(l+="0"),l+=n+"-",10>o&&(l+="0"),l+=o+" ",10>i&&(l+="0"),l+=i+":",10>s&&(l+="0"),l+=s+":",10>r&&(l+="0"),l+=r},t}();t.DateUtils=e,__reflect(e.prototype,"game.DateUtils")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.length=0,this.obj=new Object}return t.prototype.isEmpty=function(){return 0==this.length},t.prototype.containsKey=function(t){return t in this.obj},t.prototype.containsValue=function(t){for(var e in this.obj)if(this.obj[e]==t)return!0;return!1},t.prototype.put=function(t,e){this.containsKey(t)||this.length++,this.obj[t]=e},t.prototype.get=function(t){return this.containsKey(t)?this.obj[t]:null},t.prototype.remove=function(t){this.containsKey(t)&&delete this.obj[t]&&this.length--},t.prototype.values=function(){var t=new Array;for(var e in this.obj)t.push(this.obj[e]);return t},t.prototype.keySet=function(){var t=new Array;for(var e in this.obj)t.push(e);return t},t.prototype.size=function(){return this.length},t.prototype.clear=function(){this.length=0,this.obj=new Object},t}();t.HashMap=e,__reflect(e.prototype,"game.HashMap")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.getStringFromJson=function(t,e){var a=t[e];return null==a?"":a},t.getNumberFromJson=function(t,e){var a=t[e];return null==a?0:Number(a)},t}();t.JsonUtils=e,__reflect(e.prototype,"game.JsonUtils")}(game||(game={}));var game;!function(t){var e=function(){function e(){}return e.info=function(e){console.log(t.DateUtils.dateFormat((new Date).getTime())+" "+e)},e.error=function(e){console.error(t.DateUtils.dateFormat((new Date).getTime())+" "+e)},e}();t.LogUtils=e,__reflect(e.prototype,"game.LogUtils")}(game||(game={}));var game;!function(t){var e=function(){function t(){this.hexcase=0,this.b64pad=""}return t.prototype.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.md5_16=function(t){var e=this.hex_md5(t);return e.substring(8,24)},t.prototype.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.prototype.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.prototype.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.prototype.any_hmac_md5=function(t,e,a){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),a)},t.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.prototype.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.prototype.rstr_hmac_md5=function(t,e){var a=this.rstr2binl(t);a.length>16&&(a=this.binl_md5(a,8*t.length));for(var n=Array(16),o=Array(16),i=0;16>i;i++)n[i]=909522486^a[i],o[i]=1549556828^a[i];var s=this.binl_md5(n.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(o.concat(s),640))},t.prototype.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var a,n=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",o="",i=0;i<t.length;i++)a=t.charCodeAt(i),o+=n.charAt(a>>>4&15)+n.charAt(15&a);return o},t.prototype.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",o=t.length,i=0;o>i;i+=3)for(var s=t.charCodeAt(i)<<16|(o>i+1?t.charCodeAt(i+1)<<8:0)|(o>i+2?t.charCodeAt(i+2):0),r=0;4>r;r++)n+=8*i+6*r>8*t.length?this.b64pad:a.charAt(s>>>6*(3-r)&63);return n},t.prototype.rstr2any=function(t,e){var a,n,o,i,s,r=e.length,l=Array(Math.ceil(t.length/2));for(a=0;a<l.length;a++)l[a]=t.charCodeAt(2*a)<<8|t.charCodeAt(2*a+1);var c=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),u=Array(c);for(n=0;c>n;n++){for(s=Array(),i=0,a=0;a<l.length;a++)i=(i<<16)+l[a],o=Math.floor(i/r),i-=o*r,(s.length>0||o>0)&&(s[s.length]=o);u[n]=i,l=s}var h="";for(a=u.length-1;a>=0;a--)h+=e.charAt(u[a]);return h},t.prototype.str2rstr_utf8=function(t){for(var e,a,n="",o=-1;++o<t.length;)e=t.charCodeAt(o),a=o+1<t.length?t.charCodeAt(o+1):0,e>=55296&&56319>=e&&a>=56320&&57343>=a&&(e=65536+((1023&e)<<10)+(1023&a),o++),127>=e?n+=String.fromCharCode(e):2047>=e?n+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?n+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(n+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return n},t.prototype.str2rstr_utf16le=function(t){for(var e="",a=0;a<t.length;a++)e+=String.fromCharCode(255&t.charCodeAt(a),t.charCodeAt(a)>>>8&255);return e},t.prototype.str2rstr_utf16be=function(t){for(var e="",a=0;a<t.length;a++)e+=String.fromCharCode(t.charCodeAt(a)>>>8&255,255&t.charCodeAt(a));return e},t.prototype.rstr2binl=function(t){for(var e=Array(t.length>>2),a=0;a<e.length;a++)e[a]=0;for(var a=0;a<8*t.length;a+=8)e[a>>5]|=(255&t.charCodeAt(a/8))<<a%32;return e},t.prototype.binl2rstr=function(t){for(var e="",a=0;a<32*t.length;a+=8)e+=String.fromCharCode(t[a>>5]>>>a%32&255);return e},t.prototype.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var a=1732584193,n=-271733879,o=-1732584194,i=271733878,s=0;s<t.length;s+=16){var r=a,l=n,c=o,u=i;a=this.md5_ff(a,n,o,i,t[s+0],7,-680876936),i=this.md5_ff(i,a,n,o,t[s+1],12,-389564586),o=this.md5_ff(o,i,a,n,t[s+2],17,606105819),n=this.md5_ff(n,o,i,a,t[s+3],22,-1044525330),a=this.md5_ff(a,n,o,i,t[s+4],7,-176418897),i=this.md5_ff(i,a,n,o,t[s+5],12,1200080426),o=this.md5_ff(o,i,a,n,t[s+6],17,-1473231341),n=this.md5_ff(n,o,i,a,t[s+7],22,-45705983),a=this.md5_ff(a,n,o,i,t[s+8],7,1770035416),i=this.md5_ff(i,a,n,o,t[s+9],12,-1958414417),o=this.md5_ff(o,i,a,n,t[s+10],17,-42063),n=this.md5_ff(n,o,i,a,t[s+11],22,-1990404162),a=this.md5_ff(a,n,o,i,t[s+12],7,1804603682),i=this.md5_ff(i,a,n,o,t[s+13],12,-40341101),o=this.md5_ff(o,i,a,n,t[s+14],17,-1502002290),n=this.md5_ff(n,o,i,a,t[s+15],22,1236535329),a=this.md5_gg(a,n,o,i,t[s+1],5,-165796510),i=this.md5_gg(i,a,n,o,t[s+6],9,-1069501632),o=this.md5_gg(o,i,a,n,t[s+11],14,643717713),n=this.md5_gg(n,o,i,a,t[s+0],20,-373897302),a=this.md5_gg(a,n,o,i,t[s+5],5,-701558691),i=this.md5_gg(i,a,n,o,t[s+10],9,38016083),o=this.md5_gg(o,i,a,n,t[s+15],14,-660478335),n=this.md5_gg(n,o,i,a,t[s+4],20,-405537848),a=this.md5_gg(a,n,o,i,t[s+9],5,568446438),i=this.md5_gg(i,a,n,o,t[s+14],9,-1019803690),o=this.md5_gg(o,i,a,n,t[s+3],14,-187363961),n=this.md5_gg(n,o,i,a,t[s+8],20,1163531501),a=this.md5_gg(a,n,o,i,t[s+13],5,-1444681467),i=this.md5_gg(i,a,n,o,t[s+2],9,-51403784),o=this.md5_gg(o,i,a,n,t[s+7],14,1735328473),n=this.md5_gg(n,o,i,a,t[s+12],20,-1926607734),a=this.md5_hh(a,n,o,i,t[s+5],4,-378558),i=this.md5_hh(i,a,n,o,t[s+8],11,-2022574463),o=this.md5_hh(o,i,a,n,t[s+11],16,1839030562),n=this.md5_hh(n,o,i,a,t[s+14],23,-35309556),a=this.md5_hh(a,n,o,i,t[s+1],4,-1530992060),i=this.md5_hh(i,a,n,o,t[s+4],11,1272893353),o=this.md5_hh(o,i,a,n,t[s+7],16,-155497632),n=this.md5_hh(n,o,i,a,t[s+10],23,-1094730640),a=this.md5_hh(a,n,o,i,t[s+13],4,681279174),i=this.md5_hh(i,a,n,o,t[s+0],11,-358537222),o=this.md5_hh(o,i,a,n,t[s+3],16,-722521979),n=this.md5_hh(n,o,i,a,t[s+6],23,76029189),a=this.md5_hh(a,n,o,i,t[s+9],4,-640364487),i=this.md5_hh(i,a,n,o,t[s+12],11,-421815835),o=this.md5_hh(o,i,a,n,t[s+15],16,530742520),n=this.md5_hh(n,o,i,a,t[s+2],23,-995338651),a=this.md5_ii(a,n,o,i,t[s+0],6,-198630844),i=this.md5_ii(i,a,n,o,t[s+7],10,1126891415),o=this.md5_ii(o,i,a,n,t[s+14],15,-1416354905),n=this.md5_ii(n,o,i,a,t[s+5],21,-57434055),a=this.md5_ii(a,n,o,i,t[s+12],6,1700485571),i=this.md5_ii(i,a,n,o,t[s+3],10,-1894986606),o=this.md5_ii(o,i,a,n,t[s+10],15,-1051523),n=this.md5_ii(n,o,i,a,t[s+1],21,-2054922799),a=this.md5_ii(a,n,o,i,t[s+8],6,1873313359),i=this.md5_ii(i,a,n,o,t[s+15],10,-30611744),o=this.md5_ii(o,i,a,n,t[s+6],15,-1560198380),n=this.md5_ii(n,o,i,a,t[s+13],21,1309151649),a=this.md5_ii(a,n,o,i,t[s+4],6,-145523070),i=this.md5_ii(i,a,n,o,t[s+11],10,-1120210379),o=this.md5_ii(o,i,a,n,t[s+2],15,718787259),n=this.md5_ii(n,o,i,a,t[s+9],21,-343485551),a=this.safe_add(a,r),n=this.safe_add(n,l),o=this.safe_add(o,c),i=this.safe_add(i,u)}return[a,n,o,i]},t.prototype.md5_cmn=function(t,e,a,n,o,i){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(n,i)),o),a)},t.prototype.md5_ff=function(t,e,a,n,o,i,s){return this.md5_cmn(e&a|~e&n,t,e,o,i,s)},t.prototype.md5_gg=function(t,e,a,n,o,i,s){return this.md5_cmn(e&n|a&~n,t,e,o,i,s)},t.prototype.md5_hh=function(t,e,a,n,o,i,s){return this.md5_cmn(e^a^n,t,e,o,i,s)},t.prototype.md5_ii=function(t,e,a,n,o,i,s){return this.md5_cmn(a^(e|~n),t,e,o,i,s)},t.prototype.safe_add=function(t,e){var a=(65535&t)+(65535&e),n=(t>>16)+(e>>16)+(a>>16);return n<<16|65535&a},t.prototype.bit_rol=function(t,e){return t<<e|t>>>32-e},t}();t.md5=e,__reflect(e.prototype,"game.md5")}(game||(game={}));var SoundUtils;!function(t){function e(t,e){var a=GlobalData.gameData.getPlayerByClientId(t);if(null!=a){var n=a.getAgeType(),o=a.getGender(),i="nan";o==Constants.GENDER.female&&(i="nv");var s=Utils.format("{0}_chat_{1}_{2}_mp3",i,n,e);GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.standard&&(s=Utils.format("{0}_chat_{1}_mp3",i,e)),game.SoundService.getInstance().playAudio(s)}}function a(e,a,n){var o=GlobalData.gameData.getPlayerByClientId(e);if(null!=o){var i=o.getAgeType(),s=o.getGender(),r=t.getSoundName(s,i,a,n);null!=r&&game.SoundService.getInstance().playAudio(r)}}function n(t,e,a,n){if(null==n){var o=SoundCost.soundData[t][e][a];if(null==o)return;n=Utils.getRandom(1,o+1)}var i="nan";t==Constants.GENDER.female&&(i="nv");var s=Utils.format("{0}_{1}_{2}_{3}_mp3",i,a,e,n);return GameConst.sound_type==GameConst.SOUND_TYPE_ENUM.standard&&(s=Utils.format("{0}_{1}_mp3",i,a)),s}t.playChatMsgEffectSoundNameBindPlayer=e,t.playEffectSoundNameBindPlayer=a,t.getSoundName=n}(SoundUtils||(SoundUtils={}));var game;!function(t){var e=function(){function e(){}return e.showTips=function(e,a,n,o,i,s){void 0===i&&(i=120),void 0===s&&(s=20);var r=new eui.Group;Main.instance.toastLayer.addChild(r),r.touchThrough=!0,r.touchChildren=!1;var l=new eui.Rect(GameConfig.ScreenW,GameConfig.ScreenH);l.touchEnabled=!1,l.alpha=0,r.addChild(l);var c=new t.TipsView;r.addChild(c),c.setInfo(o,i,s),c.setPopPosition(e,a,n),r.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){r.parent.removeChild(r)},this)},e}();t.TipsUtils=e,__reflect(e.prototype,"game.TipsUtils")}(game||(game={}));var game;!function(t){var e=function(){function t(){}return t.showByKey=function(e,a){t.show(e,a)},t.show=function(e,a){t.showToastString(e,a?a:t.defaultY,t.defaultDuration)},t.showToastString=function(t,e,n){var o=Main.instance.toastLayer,i=new a(t);i.alpha=0,i.anchorOffsetY=.5*i.height,i.y=e,o.addChild(i);var s=egret.Tween.get(i);s.to({alpha:1},300),s.wait(n),s.to({alpha:0},500),s.call(function(){o.removeChild(i)})},t.defaultY=80,t.defaultDuration=1300,t}();t.ToastUtils=e,__reflect(e.prototype,"game.ToastUtils");var a=function(e){function a(t){var a=e.call(this)||this;return a.str=t,a.init(),a}return __extends(a,e),a.prototype.init=function(){this.touchEnabled=!1,this.width=GameConfig.ScreenW;var e=t.ResManager.createBitmap("frame_tips_png");e.anchorOffsetX=.5*e.width,e.anchorOffsetY=.5*e.height,e.x=this.width/2,e.y=0,e.touchEnabled=!1,e.alpha=1,this.width=e.texture.textureWidth,this.height=e.texture.textureHeight,this.addChild(e);var a=new egret.TextField;a.touchEnabled=!1,a.bold=!0,a.fontFamily="黑体",a.text=this.str,a.size=24,a.anchorOffsetX=.5*a.width,a.anchorOffsetY=.5*a.height,a.x=this.width/2,a.y=0,this.addChild(a)},a}(egret.Sprite);__reflect(a.prototype,"ToastView")}(game||(game={}));var ERadioButton=function(t){function e(){var e=t.call(this)||this;return e.selected=!1,e}return __extends(e,t),e.prototype.onCreateViewComplete=function(){t.prototype.onCreateViewComplete.call(this),this.addTapEvent(this.rect,this.onThisClick)},e.prototype.onThisClick=function(){this.setSelected(!this.selected)},e.prototype.setSelected=function(t){this.selected=t,this.imgOn.visible=this.selected},e.prototype.isSelected=function(){return this.selected},e.prototype.setText=function(t){this.labelText.text=t},e}(game.EComponent);__reflect(ERadioButton.prototype,"ERadioButton"),window.ERadioButton=ERadioButton;var game;!function(t){var e=function(){function t(){}return t.generateUUID=function(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),a=new Array(36),n=0,o=0;36>o;o++)8===o||13===o||18===o||23===o?a[o]="-":14===o?a[o]="4":(2>=n&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,a[o]=e[19===o?3&t|8:t]);return a.join("")},t}();t.UUID=e,__reflect(e.prototype,"game.UUID")}(game||(game={}));var game;!function(t){var e=function(e){function a(){var t=e.call(this)||this;return t.createView(),t}return __extends(a,e),a.prototype.createView=function(){this.width=GameConfig.ScreenW,this.height=GameConfig.ScreenH,this.touchEnabled=!0,this.background=new egret.Shape,this.background.width=this.width,this.background.height=this.height,this.background.graphics.beginFill(0,.5),this.background.graphics.drawRect(0,0,this.width,this.height),this.background.graphics.endFill(),this.addChild(this.background),this.icon=new eui.Image,this.icon.source="common_json.waiting_png",this.icon.anchorOffsetX=50,this.icon.anchorOffsetY=50,this.icon.x=this.width/2,this.icon.y=this.height/2,this.addChild(this.icon)},a.prototype.rotationLoop=function(){var t=2e3,e=this;this.icon.rotation=0;var a=egret.Tween.get(this.icon);a.to({rotation:360},t),a.call(function(){e.rotationLoop()})},a.prototype.stopRotation=function(){egret.Tween.removeTweens(this.icon)},a.showWaiting=function(t,e,n){if(!a.bShow){a.bShow=!0;var o=!0;if(void 0!=e&&(o=e),o){a.instance||(a.instance=new a),n?a.instance.background.alpha=1:a.instance.background.alpha=0;var i=Main.instance.confirmDialogLayer;i.addChild(a.instance),a.instance.rotationLoop()}t&&(a.currentTimeout=egret.setTimeout(function(){a.hide(),egret.clearTimeout(a.currentTimeout),a.currentTimeout=-1},this,t))}},a.show=function(e,n){t.LogUtils.info("waiting show");var o=!0;void 0!=n&&(o=n),a.showWaiting(null,e,o)},a.isShowing=function(){return a.bShow},a.hide=function(){if(t.LogUtils.info("waiting hide"),-1!=a.currentTimeout&&(egret.clearTimeout(a.currentTimeout),a.currentTimeout=-1),a.bShow=!1,a.instance){var e=Main.instance.confirmDialogLayer;e.contains(a.instance)&&(a.instance.stopRotation(),e.removeChild(a.instance))}},a.bShow=!1,a.currentTimeout=-1,a}(egret.Sprite);t.WaitingUI=e,__reflect(e.prototype,"game.WaitingUI")}(game||(game={})),window.Main=Main;